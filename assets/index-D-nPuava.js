var pN=Object.defineProperty;var gN=(t,e,r)=>e in t?pN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Wu=(t,e,r)=>gN(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();function vN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j1={exports:{}},Ku={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zy;function xN(){if(Zy)return Ku;Zy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return Ku.Fragment=e,Ku.jsx=r,Ku.jsxs=r,Ku}var eE;function _N(){return eE||(eE=1,j1.exports=xN()),j1.exports}var h=_N(),P1={exports:{}},_t={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tE;function yN(){if(tE)return _t;tE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(ee){return ee===null||typeof ee!="object"?null:(ee=y&&ee[y]||ee["@@iterator"],typeof ee=="function"?ee:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function b(ee,ue,z){this.props=ee,this.context=ue,this.refs=S,this.updater=z||T}b.prototype.isReactComponent={},b.prototype.setState=function(ee,ue){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,ue,"setState")},b.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function O(){}O.prototype=b.prototype;function L(ee,ue,z){this.props=ee,this.context=ue,this.refs=S,this.updater=z||T}var A=L.prototype=new O;A.constructor=L,E(A,b.prototype),A.isPureReactComponent=!0;var D=Array.isArray,V={H:null,A:null,T:null,S:null,V:null},H=Object.prototype.hasOwnProperty;function C(ee,ue,z,X,G,K){return z=K.ref,{$$typeof:t,type:ee,key:ue,ref:z!==void 0?z:null,props:K}}function N(ee,ue){return C(ee.type,ue,void 0,void 0,void 0,ee.props)}function R(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function F(ee){var ue={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(z){return ue[z]})}var P=/\/+/g;function M(ee,ue){return typeof ee=="object"&&ee!==null&&ee.key!=null?F(""+ee.key):ue.toString(36)}function U(){}function Me(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(U,U):(ee.status="pending",ee.then(function(ue){ee.status==="pending"&&(ee.status="fulfilled",ee.value=ue)},function(ue){ee.status==="pending"&&(ee.status="rejected",ee.reason=ue)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function Ne(ee,ue,z,X,G){var K=typeof ee;(K==="undefined"||K==="boolean")&&(ee=null);var Q=!1;if(ee===null)Q=!0;else switch(K){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(ee.$$typeof){case t:case e:Q=!0;break;case g:return Q=ee._init,Ne(Q(ee._payload),ue,z,X,G)}}if(Q)return G=G(ee),Q=X===""?"."+M(ee,0):X,D(G)?(z="",Q!=null&&(z=Q.replace(P,"$&/")+"/"),Ne(G,ue,z,"",function(Ae){return Ae})):G!=null&&(R(G)&&(G=N(G,z+(G.key==null||ee&&ee.key===G.key?"":(""+G.key).replace(P,"$&/")+"/")+Q)),ue.push(G)),1;Q=0;var ye=X===""?".":X+":";if(D(ee))for(var Ee=0;Ee<ee.length;Ee++)X=ee[Ee],K=ye+M(X,Ee),Q+=Ne(X,ue,z,K,G);else if(Ee=_(ee),typeof Ee=="function")for(ee=Ee.call(ee),Ee=0;!(X=ee.next()).done;)X=X.value,K=ye+M(X,Ee++),Q+=Ne(X,ue,z,K,G);else if(K==="object"){if(typeof ee.then=="function")return Ne(Me(ee),ue,z,X,G);throw ue=String(ee),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return Q}function ie(ee,ue,z){if(ee==null)return ee;var X=[],G=0;return Ne(ee,X,"","",function(K){return ue.call(z,K,G++)}),X}function me(ee){if(ee._status===-1){var ue=ee._result;ue=ue(),ue.then(function(z){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=z)},function(z){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=z)}),ee._status===-1&&(ee._status=0,ee._result=ue)}if(ee._status===1)return ee._result.default;throw ee._result}var Pe=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)};function oe(){}return _t.Children={map:ie,forEach:function(ee,ue,z){ie(ee,function(){ue.apply(this,arguments)},z)},count:function(ee){var ue=0;return ie(ee,function(){ue++}),ue},toArray:function(ee){return ie(ee,function(ue){return ue})||[]},only:function(ee){if(!R(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},_t.Component=b,_t.Fragment=r,_t.Profiler=a,_t.PureComponent=L,_t.StrictMode=n,_t.Suspense=d,_t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,_t.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return V.H.useMemoCache(ee)}},_t.cache=function(ee){return function(){return ee.apply(null,arguments)}},_t.cloneElement=function(ee,ue,z){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var X=E({},ee.props),G=ee.key,K=void 0;if(ue!=null)for(Q in ue.ref!==void 0&&(K=void 0),ue.key!==void 0&&(G=""+ue.key),ue)!H.call(ue,Q)||Q==="key"||Q==="__self"||Q==="__source"||Q==="ref"&&ue.ref===void 0||(X[Q]=ue[Q]);var Q=arguments.length-2;if(Q===1)X.children=z;else if(1<Q){for(var ye=Array(Q),Ee=0;Ee<Q;Ee++)ye[Ee]=arguments[Ee+2];X.children=ye}return C(ee.type,G,void 0,void 0,K,X)},_t.createContext=function(ee){return ee={$$typeof:l,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:o,_context:ee},ee},_t.createElement=function(ee,ue,z){var X,G={},K=null;if(ue!=null)for(X in ue.key!==void 0&&(K=""+ue.key),ue)H.call(ue,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(G[X]=ue[X]);var Q=arguments.length-2;if(Q===1)G.children=z;else if(1<Q){for(var ye=Array(Q),Ee=0;Ee<Q;Ee++)ye[Ee]=arguments[Ee+2];G.children=ye}if(ee&&ee.defaultProps)for(X in Q=ee.defaultProps,Q)G[X]===void 0&&(G[X]=Q[X]);return C(ee,K,void 0,void 0,null,G)},_t.createRef=function(){return{current:null}},_t.forwardRef=function(ee){return{$$typeof:u,render:ee}},_t.isValidElement=R,_t.lazy=function(ee){return{$$typeof:g,_payload:{_status:-1,_result:ee},_init:me}},_t.memo=function(ee,ue){return{$$typeof:m,type:ee,compare:ue===void 0?null:ue}},_t.startTransition=function(ee){var ue=V.T,z={};V.T=z;try{var X=ee(),G=V.S;G!==null&&G(z,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(oe,Pe)}catch(K){Pe(K)}finally{V.T=ue}},_t.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},_t.use=function(ee){return V.H.use(ee)},_t.useActionState=function(ee,ue,z){return V.H.useActionState(ee,ue,z)},_t.useCallback=function(ee,ue){return V.H.useCallback(ee,ue)},_t.useContext=function(ee){return V.H.useContext(ee)},_t.useDebugValue=function(){},_t.useDeferredValue=function(ee,ue){return V.H.useDeferredValue(ee,ue)},_t.useEffect=function(ee,ue,z){var X=V.H;if(typeof z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(ee,ue)},_t.useId=function(){return V.H.useId()},_t.useImperativeHandle=function(ee,ue,z){return V.H.useImperativeHandle(ee,ue,z)},_t.useInsertionEffect=function(ee,ue){return V.H.useInsertionEffect(ee,ue)},_t.useLayoutEffect=function(ee,ue){return V.H.useLayoutEffect(ee,ue)},_t.useMemo=function(ee,ue){return V.H.useMemo(ee,ue)},_t.useOptimistic=function(ee,ue){return V.H.useOptimistic(ee,ue)},_t.useReducer=function(ee,ue,z){return V.H.useReducer(ee,ue,z)},_t.useRef=function(ee){return V.H.useRef(ee)},_t.useState=function(ee){return V.H.useState(ee)},_t.useSyncExternalStore=function(ee,ue,z){return V.H.useSyncExternalStore(ee,ue,z)},_t.useTransition=function(){return V.H.useTransition()},_t.version="19.1.0",_t}var rE;function tv(){return rE||(rE=1,P1.exports=yN()),P1.exports}var ne=tv();const oi=vN(ne);var F1={exports:{}},Xu={},L1={exports:{}},M1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nE;function EN(){return nE||(nE=1,function(t){function e(ie,me){var Pe=ie.length;ie.push(me);e:for(;0<Pe;){var oe=Pe-1>>>1,ee=ie[oe];if(0<a(ee,me))ie[oe]=me,ie[Pe]=ee,Pe=oe;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var me=ie[0],Pe=ie.pop();if(Pe!==me){ie[0]=Pe;e:for(var oe=0,ee=ie.length,ue=ee>>>1;oe<ue;){var z=2*(oe+1)-1,X=ie[z],G=z+1,K=ie[G];if(0>a(X,Pe))G<ee&&0>a(K,X)?(ie[oe]=K,ie[G]=Pe,oe=G):(ie[oe]=X,ie[z]=Pe,oe=z);else if(G<ee&&0>a(K,Pe))ie[oe]=K,ie[G]=Pe,oe=G;else break e}}return me}function a(ie,me){var Pe=ie.sortIndex-me.sortIndex;return Pe!==0?Pe:ie.id-me.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var d=[],m=[],g=1,y=null,_=3,T=!1,E=!1,S=!1,b=!1,O=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function D(ie){for(var me=r(m);me!==null;){if(me.callback===null)n(m);else if(me.startTime<=ie)n(m),me.sortIndex=me.expirationTime,e(d,me);else break;me=r(m)}}function V(ie){if(S=!1,D(ie),!E)if(r(d)!==null)E=!0,H||(H=!0,M());else{var me=r(m);me!==null&&Ne(V,me.startTime-ie)}}var H=!1,C=-1,N=5,R=-1;function F(){return b?!0:!(t.unstable_now()-R<N)}function P(){if(b=!1,H){var ie=t.unstable_now();R=ie;var me=!0;try{e:{E=!1,S&&(S=!1,L(C),C=-1),T=!0;var Pe=_;try{t:{for(D(ie),y=r(d);y!==null&&!(y.expirationTime>ie&&F());){var oe=y.callback;if(typeof oe=="function"){y.callback=null,_=y.priorityLevel;var ee=oe(y.expirationTime<=ie);if(ie=t.unstable_now(),typeof ee=="function"){y.callback=ee,D(ie),me=!0;break t}y===r(d)&&n(d),D(ie)}else n(d);y=r(d)}if(y!==null)me=!0;else{var ue=r(m);ue!==null&&Ne(V,ue.startTime-ie),me=!1}}break e}finally{y=null,_=Pe,T=!1}me=void 0}}finally{me?M():H=!1}}}var M;if(typeof A=="function")M=function(){A(P)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,Me=U.port2;U.port1.onmessage=P,M=function(){Me.postMessage(null)}}else M=function(){O(P,0)};function Ne(ie,me){C=O(function(){ie(t.unstable_now())},me)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ie){switch(_){case 1:case 2:case 3:var me=3;break;default:me=_}var Pe=_;_=me;try{return ie()}finally{_=Pe}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(ie,me){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Pe=_;_=ie;try{return me()}finally{_=Pe}},t.unstable_scheduleCallback=function(ie,me,Pe){var oe=t.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?oe+Pe:oe):Pe=oe,ie){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=Pe+ee,ie={id:g++,callback:me,priorityLevel:ie,startTime:Pe,expirationTime:ee,sortIndex:-1},Pe>oe?(ie.sortIndex=Pe,e(m,ie),r(d)===null&&ie===r(m)&&(S?(L(C),C=-1):S=!0,Ne(V,Pe-oe))):(ie.sortIndex=ee,e(d,ie),E||T||(E=!0,H||(H=!0,M()))),ie},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ie){var me=_;return function(){var Pe=_;_=me;try{return ie.apply(this,arguments)}finally{_=Pe}}}}(M1)),M1}var aE;function TN(){return aE||(aE=1,L1.exports=EN()),L1.exports}var B1={exports:{}},yn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sE;function wN(){if(sE)return yn;sE=1;var t=tv();function e(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,m,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:m,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,m){if(d==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return yn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,yn.createPortal=function(d,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(d,m,null,g)},yn.flushSync=function(d){var m=l.T,g=n.p;try{if(l.T=null,n.p=2,d)return d()}finally{l.T=m,n.p=g,n.d.f()}},yn.preconnect=function(d,m){typeof d=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,n.d.C(d,m))},yn.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},yn.preinit=function(d,m){if(typeof d=="string"&&m&&typeof m.as=="string"){var g=m.as,y=u(g,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,T=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?n.d.S(d,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:T}):g==="script"&&n.d.X(d,{crossOrigin:y,integrity:_,fetchPriority:T,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},yn.preinitModule=function(d,m){if(typeof d=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=u(m.as,m.crossOrigin);n.d.M(d,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&n.d.M(d)},yn.preload=function(d,m){if(typeof d=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,y=u(g,m.crossOrigin);n.d.L(d,g,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},yn.preloadModule=function(d,m){if(typeof d=="string")if(m){var g=u(m.as,m.crossOrigin);n.d.m(d,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else n.d.m(d)},yn.requestFormReset=function(d){n.d.r(d)},yn.unstable_batchedUpdates=function(d,m){return d(m)},yn.useFormState=function(d,m,g){return l.H.useFormState(d,m,g)},yn.useFormStatus=function(){return l.H.useHostTransitionStatus()},yn.version="19.1.0",yn}var iE;function SN(){if(iE)return B1.exports;iE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),B1.exports=wN(),B1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function bN(){if(oE)return Xu;oE=1;var t=TN(),e=tv(),r=SN();function n(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function l(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function u(s){if(o(s)!==s)throw Error(n(188))}function d(s){var i=s.alternate;if(!i){if(i=o(s),i===null)throw Error(n(188));return i!==s?null:s}for(var c=s,f=i;;){var v=c.return;if(v===null)break;var x=v.alternate;if(x===null){if(f=v.return,f!==null){c=f;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===c)return u(v),s;if(x===f)return u(v),i;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=v,f=x;else{for(var I=!1,B=v.child;B;){if(B===c){I=!0,c=v,f=x;break}if(B===f){I=!0,f=v,c=x;break}B=B.sibling}if(!I){for(B=x.child;B;){if(B===c){I=!0,c=x,f=v;break}if(B===f){I=!0,f=x,c=v;break}B=B.sibling}if(!I)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:i}function m(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=m(s),i!==null)return i;s=s.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),L=Symbol.for("react.consumer"),A=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var U=Symbol.for("react.client.reference");function Me(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===U?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case S:return"StrictMode";case V:return"Suspense";case H:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case T:return"Portal";case A:return(s.displayName||"Context")+".Provider";case L:return(s._context.displayName||"Context")+".Consumer";case D:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return i=s.displayName||null,i!==null?i:Me(s.type)||"Memo";case N:i=s._payload,s=s._init;try{return Me(s(i))}catch{}}return null}var Ne=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pe={pending:!1,data:null,method:null,action:null},oe=[],ee=-1;function ue(s){return{current:s}}function z(s){0>ee||(s.current=oe[ee],oe[ee]=null,ee--)}function X(s,i){ee++,oe[ee]=s.current,s.current=i}var G=ue(null),K=ue(null),Q=ue(null),ye=ue(null);function Ee(s,i){switch(X(Q,i),X(K,s),X(G,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?Cy(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=Cy(i),s=Ny(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}z(G),X(G,s)}function Ae(){z(G),z(K),z(Q)}function be(s){s.memoizedState!==null&&X(ye,s);var i=G.current,c=Ny(i,s.type);i!==c&&(X(K,s),X(G,c))}function Ze(s){K.current===s&&(z(G),z(K)),ye.current===s&&(z(ye),Hu._currentValue=Pe)}var re=Object.prototype.hasOwnProperty,Ct=t.unstable_scheduleCallback,We=t.unstable_cancelCallback,lt=t.unstable_shouldYield,Fe=t.unstable_requestPaint,je=t.unstable_now,Wt=t.unstable_getCurrentPriorityLevel,Tr=t.unstable_ImmediatePriority,Rr=t.unstable_UserBlockingPriority,tr=t.unstable_NormalPriority,On=t.unstable_LowPriority,lr=t.unstable_IdlePriority,wr=t.log,Wr=t.unstable_setDisableYieldValue,It=null,Se=null;function Ke(s){if(typeof wr=="function"&&Wr(s),Se&&typeof Se.setStrictMode=="function")try{Se.setStrictMode(It,s)}catch{}}var Je=Math.clz32?Math.clz32:St,tt=Math.log,wt=Math.LN2;function St(s){return s>>>=0,s===0?32:31-(tt(s)/wt|0)|0}var gt=256,or=4194304;function cr(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function xn(s,i,c){var f=s.pendingLanes;if(f===0)return 0;var v=0,x=s.suspendedLanes,I=s.pingedLanes;s=s.warmLanes;var B=f&134217727;return B!==0?(f=B&~x,f!==0?v=cr(f):(I&=B,I!==0?v=cr(I):c||(c=B&~s,c!==0&&(v=cr(c))))):(B=f&~x,B!==0?v=cr(B):I!==0?v=cr(I):c||(c=f&~s,c!==0&&(v=cr(c)))),v===0?0:i!==0&&i!==v&&(i&x)===0&&(x=v&-v,c=i&-i,x>=c||x===32&&(c&4194048)!==0)?i:v}function qt(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function ra(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jn(){var s=gt;return gt<<=1,(gt&4194048)===0&&(gt=256),s}function Fa(){var s=or;return or<<=1,(or&62914560)===0&&(or=4194304),s}function Yn(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function La(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ss(s,i,c,f,v,x){var I=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var B=s.entanglements,ae=s.expirationTimes,pe=s.hiddenUpdates;for(c=I&~c;0<c;){var Ce=31-Je(c),Ie=1<<Ce;B[Ce]=0,ae[Ce]=-1;var xe=pe[Ce];if(xe!==null)for(pe[Ce]=null,Ce=0;Ce<xe.length;Ce++){var _e=xe[Ce];_e!==null&&(_e.lane&=-536870913)}c&=~Ie}f!==0&&xa(s,f,0),x!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=x&~(I&~i))}function xa(s,i,c){s.pendingLanes|=i,s.suspendedLanes&=~i;var f=31-Je(i);s.entangledLanes|=i,s.entanglements[f]=s.entanglements[f]|1073741824|c&4194090}function wo(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var f=31-Je(c),v=1<<f;v&i|s[f]&i&&(s[f]|=i),c&=~v}}function is(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ti(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function os(){var s=me.p;return s!==0?s:(s=window.event,s===void 0?32:Yy(s.type))}function wl(s,i){var c=me.p;try{return me.p=s,i()}finally{me.p=c}}var ar=Math.random().toString(36).slice(2),Sr="__reactFiber$"+ar,ur="__reactProps$"+ar,Wn="__reactContainer$"+ar,So="__reactEvents$"+ar,Xc="__reactListeners$"+ar,j="__reactHandles$"+ar,Z="__reactResources$"+ar,Y="__reactMarker$"+ar;function W(s){delete s[Sr],delete s[ur],delete s[So],delete s[Xc],delete s[j]}function J(s){var i=s[Sr];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Wn]||c[Sr]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=Dy(s);s!==null;){if(c=s[Sr])return c;s=Dy(s)}return i}s=c,c=s.parentNode}return null}function te(s){if(s=s[Sr]||s[Wn]){var i=s.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return s}return null}function de(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(n(33))}function Te(s){var i=s[Z];return i||(i=s[Z]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ce(s){s[Y]=!0}var ge=new Set,ve={};function Oe(s,i){Be(s,i),Be(s+"Capture",i)}function Be(s,i){for(ve[s]=i,s=0;s<i.length;s++)ge.add(i[s])}var $e=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Le={},Ge={};function ct(s){return re.call(Ge,s)?!0:re.call(Le,s)?!1:$e.test(s)?Ge[s]=!0:(Le[s]=!0,!1)}function Ht(s,i,c){if(ct(i))if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+c)}}function Dt(s,i,c){if(c===null)s.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+c)}}function Ot(s,i,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(i,c,""+f)}}var na,ls;function Pn(s){if(na===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);na=i&&i[1]||"",ls=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+na+s+ls}var Kn=!1;function cs(s,i){if(!s||Kn)return"";Kn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(_e){var xe=_e}Reflect.construct(s,[],Ie)}else{try{Ie.call()}catch(_e){xe=_e}s.call(Ie.prototype)}}else{try{throw Error()}catch(_e){xe=_e}(Ie=s())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(_e){if(_e&&xe&&typeof _e.stack=="string")return[_e.stack,xe.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),I=x[0],B=x[1];if(I&&B){var ae=I.split(`
`),pe=B.split(`
`);for(v=f=0;f<ae.length&&!ae[f].includes("DetermineComponentFrameRoot");)f++;for(;v<pe.length&&!pe[v].includes("DetermineComponentFrameRoot");)v++;if(f===ae.length||v===pe.length)for(f=ae.length-1,v=pe.length-1;1<=f&&0<=v&&ae[f]!==pe[v];)v--;for(;1<=f&&0<=v;f--,v--)if(ae[f]!==pe[v]){if(f!==1||v!==1)do if(f--,v--,0>v||ae[f]!==pe[v]){var Ce=`
`+ae[f].replace(" at new "," at ");return s.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",s.displayName)),Ce}while(1<=f&&0<=v);break}}}finally{Kn=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Pn(c):""}function Fn(s){switch(s.tag){case 26:case 27:case 5:return Pn(s.type);case 16:return Pn("Lazy");case 13:return Pn("Suspense");case 19:return Pn("SuspenseList");case 0:case 15:return cs(s.type,!1);case 11:return cs(s.type.render,!1);case 1:return cs(s.type,!0);case 31:return Pn("Activity");default:return""}}function Sl(s){try{var i="";do i+=Fn(s),s=s.return;while(s);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Ln(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Qc(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Mm(s){var i=Qc(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),f=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var v=c.get,x=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return v.call(this)},set:function(I){f=""+I,x.call(this,I)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function bl(s){s._valueTracker||(s._valueTracker=Mm(s))}function Jc(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return s&&(f=Qc(s)?s.checked?"true":"false":s.value),s=f,s!==c?(i.setValue(s),!0):!1}function bo(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Bm=/[\n"\\]/g;function kr(s){return s.replace(Bm,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function aa(s,i,c,f,v,x,I,B){s.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.type=I:s.removeAttribute("type"),i!=null?I==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+Ln(i)):s.value!==""+Ln(i)&&(s.value=""+Ln(i)):I!=="submit"&&I!=="reset"||s.removeAttribute("value"),i!=null?wi(s,I,Ln(i)):c!=null?wi(s,I,Ln(c)):f!=null&&s.removeAttribute("value"),v==null&&x!=null&&(s.defaultChecked=!!x),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?s.name=""+Ln(B):s.removeAttribute("name")}function Ao(s,i,c,f,v,x,I,B){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),i!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||i!=null))return;c=c!=null?""+Ln(c):"",i=i!=null?""+Ln(i):c,B||i===s.value||(s.value=i),s.defaultValue=i}f=f??v,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=B?s.checked:!!f,s.defaultChecked=!!f,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(s.name=I)}function wi(s,i,c){i==="number"&&bo(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Ms(s,i,c,f){if(s=s.options,i){i={};for(var v=0;v<c.length;v++)i["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=i.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&f&&(s[c].defaultSelected=!0)}else{for(c=""+Ln(c),i=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,f&&(s[v].defaultSelected=!0);return}i!==null||s[v].disabled||(i=s[v])}i!==null&&(i.selected=!0)}}function Qt(s,i,c){if(i!=null&&(i=""+Ln(i),i!==s.value&&(s.value=i),c==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=c!=null?""+Ln(c):""}function Co(s,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(n(92));if(Ne(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=Ln(i),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f)}function _a(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var No=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wh(s,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":f?s.setProperty(i,c):typeof c!="number"||c===0||No.has(i)?i==="float"?s.cssFloat=c:s[i]=(""+c).trim():s[i]=c+"px"}function Zc(s,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var v in i)f=i[v],i.hasOwnProperty(v)&&c[v]!==f&&wh(s,v,f)}else for(var x in i)i.hasOwnProperty(x)&&wh(s,x,i[x])}function eu(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Um=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Al(s){return Um.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Bs=null;function ya(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Vs=null,Us=null;function tu(s){var i=te(s);if(i&&(s=i.stateNode)){var c=s[ur]||null;e:switch(s=i.stateNode,i.type){case"input":if(aa(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+kr(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==s&&f.form===s.form){var v=f[ur]||null;if(!v)throw Error(n(90));aa(f,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===s.form&&Jc(f)}break e;case"textarea":Qt(s,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Ms(s,!!c.multiple,i,!1)}}}var us=!1;function Sh(s,i,c){if(us)return s(i,c);us=!0;try{var f=s(i);return f}finally{if(us=!1,(Vs!==null||Us!==null)&&(vd(),Vs&&(i=Vs,s=Us,Us=Vs=null,tu(i),s)))for(i=0;i<s.length;i++)tu(s[i])}}function Ro(s,i){var c=s.stateNode;if(c===null)return null;var f=c[ur]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ea=!1;if(Ma)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){Ea=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{Ea=!1}var fs=null,Si=null,zs=null;function ru(){if(zs)return zs;var s,i=Si,c=i.length,f,v="value"in fs?fs.value:fs.textContent,x=v.length;for(s=0;s<c&&i[s]===v[s];s++);var I=c-s;for(f=1;f<=I&&i[c-f]===v[x-f];f++);return zs=v.slice(s,1<f?1-f:void 0)}function hs(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function ds(){return!0}function nu(){return!1}function Kr(s){function i(c,f,v,x,I){this._reactName=c,this._targetInst=v,this.type=f,this.nativeEvent=x,this.target=I,this.currentTarget=null;for(var B in s)s.hasOwnProperty(B)&&(c=s[B],this[B]=c?c(x):x[B]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ds:nu,this.isPropagationStopped=nu,this}return g(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),i}var Yt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cl=Kr(Yt),Io=g({},Yt,{view:0,detail:0}),bh=Kr(Io),Nl,Rl,ms,Do=g({},Io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Po,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ms&&(ms&&s.type==="mousemove"?(Nl=s.screenX-ms.screenX,Rl=s.screenY-ms.screenY):Rl=Nl=0,ms=s),Nl)},movementY:function(s){return"movementY"in s?s.movementY:Rl}}),Ta=Kr(Do),Ah=g({},Do,{dataTransfer:0}),zm=Kr(Ah),Oo=g({},Io,{relatedTarget:0}),kl=Kr(Oo),au=g({},Yt,{animationName:0,elapsedTime:0,pseudoElement:0}),Il=Kr(au),Ch=g({},Yt,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Dl=Kr(Ch),Hm=g({},Yt,{data:0}),su=Kr(Hm),jo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iu(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=Rh[s])?!!i[s]:!1}function Po(){return iu}var kh=g({},Io,{key:function(s){if(s.key){var i=jo[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=hs(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Nh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Po,charCode:function(s){return s.type==="keypress"?hs(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?hs(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ol=Kr(kh),Ih=g({},Do,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ou=Kr(Ih),Hs=g({},Io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Po}),Dh=Kr(Hs),Oh=g({},Yt,{propertyName:0,elapsedTime:0,pseudoElement:0}),jh=Kr(Oh),Ph=g({},Do,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),jl=Kr(Ph),Mn=g({},Yt,{newState:0,oldState:0}),Fh=Kr(Mn),Lh=[9,13,27,32],ps=Ma&&"CompositionEvent"in window,p=null;Ma&&"documentMode"in document&&(p=document.documentMode);var w=Ma&&"TextEvent"in window&&!p,k=Ma&&(!ps||p&&8<p&&11>=p),q=" ",fe=!1;function we(s,i){switch(s){case"keyup":return Lh.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function He(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var jt=!1;function Br(s,i){switch(s){case"compositionend":return He(i);case"keypress":return i.which!==32?null:(fe=!0,q);case"textInput":return s=i.data,s===q&&fe?null:s;default:return null}}function Pt(s,i){if(jt)return s==="compositionend"||!ps&&we(s,i)?(s=ru(),zs=Si=fs=null,jt=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return k&&i.locale!=="ko"?null:i.data;default:return null}}var Xr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vr(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!Xr[s.type]:i==="textarea"}function Gs(s,i,c,f){Vs?Us?Us.push(f):Us=[f]:Vs=f,i=wd(i,"onChange"),0<i.length&&(c=new Cl("onChange","change",null,c,f),s.push({event:c,listeners:i}))}var an=null,gs=null;function lu(s){Ty(s,0)}function Mh(s){var i=de(s);if(Jc(i))return s}function Hx(s,i){if(s==="change")return i}var Gx=!1;if(Ma){var Gm;if(Ma){var qm="oninput"in document;if(!qm){var qx=document.createElement("div");qx.setAttribute("oninput","return;"),qm=typeof qx.oninput=="function"}Gm=qm}else Gm=!1;Gx=Gm&&(!document.documentMode||9<document.documentMode)}function $x(){an&&(an.detachEvent("onpropertychange",Yx),gs=an=null)}function Yx(s){if(s.propertyName==="value"&&Mh(gs)){var i=[];Gs(i,gs,s,ya(s)),Sh(lu,i)}}function q3(s,i,c){s==="focusin"?($x(),an=i,gs=c,an.attachEvent("onpropertychange",Yx)):s==="focusout"&&$x()}function $3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Mh(gs)}function Y3(s,i){if(s==="click")return Mh(i)}function W3(s,i){if(s==="input"||s==="change")return Mh(i)}function K3(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var sa=typeof Object.is=="function"?Object.is:K3;function cu(s,i){if(sa(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var v=c[f];if(!re.call(i,v)||!sa(s[v],i[v]))return!1}return!0}function Wx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Kx(s,i){var c=Wx(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=i&&f>=i)return{node:c,offset:i-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Wx(c)}}function Xx(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Xx(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Qx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=bo(s.document);i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=bo(s.document)}return i}function $m(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var X3=Ma&&"documentMode"in document&&11>=document.documentMode,Pl=null,Ym=null,uu=null,Wm=!1;function Jx(s,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Wm||Pl==null||Pl!==bo(f)||(f=Pl,"selectionStart"in f&&$m(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),uu&&cu(uu,f)||(uu=f,f=wd(Ym,"onSelect"),0<f.length&&(i=new Cl("onSelect","select",null,i,c),s.push({event:i,listeners:f}),i.target=Pl)))}function Fo(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var Fl={animationend:Fo("Animation","AnimationEnd"),animationiteration:Fo("Animation","AnimationIteration"),animationstart:Fo("Animation","AnimationStart"),transitionrun:Fo("Transition","TransitionRun"),transitionstart:Fo("Transition","TransitionStart"),transitioncancel:Fo("Transition","TransitionCancel"),transitionend:Fo("Transition","TransitionEnd")},Km={},Zx={};Ma&&(Zx=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function Lo(s){if(Km[s])return Km[s];if(!Fl[s])return s;var i=Fl[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in Zx)return Km[s]=i[c];return s}var e_=Lo("animationend"),t_=Lo("animationiteration"),r_=Lo("animationstart"),Q3=Lo("transitionrun"),J3=Lo("transitionstart"),Z3=Lo("transitioncancel"),n_=Lo("transitionend"),a_=new Map,Xm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Xm.push("scrollEnd");function Ba(s,i){a_.set(s,i),Oe(i,[s])}var s_=new WeakMap;function wa(s,i){if(typeof s=="object"&&s!==null){var c=s_.get(s);return c!==void 0?c:(i={value:s,source:i,stack:Sl(i)},s_.set(s,i),i)}return{value:s,source:i,stack:Sl(i)}}var Sa=[],Ll=0,Qm=0;function Bh(){for(var s=Ll,i=Qm=Ll=0;i<s;){var c=Sa[i];Sa[i++]=null;var f=Sa[i];Sa[i++]=null;var v=Sa[i];Sa[i++]=null;var x=Sa[i];if(Sa[i++]=null,f!==null&&v!==null){var I=f.pending;I===null?v.next=v:(v.next=I.next,I.next=v),f.pending=v}x!==0&&i_(c,v,x)}}function Vh(s,i,c,f){Sa[Ll++]=s,Sa[Ll++]=i,Sa[Ll++]=c,Sa[Ll++]=f,Qm|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function Jm(s,i,c,f){return Vh(s,i,c,f),Uh(s)}function Ml(s,i){return Vh(s,null,null,i),Uh(s)}function i_(s,i,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var v=!1,x=s.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(v=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,v&&i!==null&&(v=31-Je(c),s=x.hiddenUpdates,f=s[v],f===null?s[v]=[i]:f.push(i),i.lane=c|536870912),x):null}function Uh(s){if(50<Pu)throw Pu=0,a1=null,Error(n(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Bl={};function eC(s,i,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ia(s,i,c,f){return new eC(s,i,c,f)}function Zm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function qs(s,i){var c=s.alternate;return c===null?(c=ia(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function o_(s,i){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,i=c.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function zh(s,i,c,f,v,x){var I=0;if(f=s,typeof s=="function")Zm(s)&&(I=1);else if(typeof s=="string")I=rN(s,c,G.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=ia(31,c,i,v),s.elementType=R,s.lanes=x,s;case E:return Mo(c.children,v,x,i);case S:I=8,v|=24;break;case b:return s=ia(12,c,i,v|2),s.elementType=b,s.lanes=x,s;case V:return s=ia(13,c,i,v),s.elementType=V,s.lanes=x,s;case H:return s=ia(19,c,i,v),s.elementType=H,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:case A:I=10;break e;case L:I=9;break e;case D:I=11;break e;case C:I=14;break e;case N:I=16,f=null;break e}I=29,c=Error(n(130,s===null?"null":typeof s,"")),f=null}return i=ia(I,c,i,v),i.elementType=s,i.type=f,i.lanes=x,i}function Mo(s,i,c,f){return s=ia(7,s,f,i),s.lanes=c,s}function ep(s,i,c){return s=ia(6,s,null,i),s.lanes=c,s}function tp(s,i,c){return i=ia(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var Vl=[],Ul=0,Hh=null,Gh=0,ba=[],Aa=0,Bo=null,$s=1,Ys="";function Vo(s,i){Vl[Ul++]=Gh,Vl[Ul++]=Hh,Hh=s,Gh=i}function l_(s,i,c){ba[Aa++]=$s,ba[Aa++]=Ys,ba[Aa++]=Bo,Bo=s;var f=$s;s=Ys;var v=32-Je(f)-1;f&=~(1<<v),c+=1;var x=32-Je(i)+v;if(30<x){var I=v-v%5;x=(f&(1<<I)-1).toString(32),f>>=I,v-=I,$s=1<<32-Je(i)+v|c<<v|f,Ys=x+s}else $s=1<<x|c<<v|f,Ys=s}function rp(s){s.return!==null&&(Vo(s,1),l_(s,1,0))}function np(s){for(;s===Hh;)Hh=Vl[--Ul],Vl[Ul]=null,Gh=Vl[--Ul],Vl[Ul]=null;for(;s===Bo;)Bo=ba[--Aa],ba[Aa]=null,Ys=ba[--Aa],ba[Aa]=null,$s=ba[--Aa],ba[Aa]=null}var Bn=null,xr=null,$t=!1,Uo=null,vs=!1,ap=Error(n(519));function zo(s){var i=Error(n(418,""));throw du(wa(i,s)),ap}function c_(s){var i=s.stateNode,c=s.type,f=s.memoizedProps;switch(i[Sr]=s,i[ur]=f,c){case"dialog":At("cancel",i),At("close",i);break;case"iframe":case"object":case"embed":At("load",i);break;case"video":case"audio":for(c=0;c<Lu.length;c++)At(Lu[c],i);break;case"source":At("error",i);break;case"img":case"image":case"link":At("error",i),At("load",i);break;case"details":At("toggle",i);break;case"input":At("invalid",i),Ao(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),bl(i);break;case"select":At("invalid",i);break;case"textarea":At("invalid",i),Co(i,f.value,f.defaultValue,f.children),bl(i)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||Ay(i.textContent,c)?(f.popover!=null&&(At("beforetoggle",i),At("toggle",i)),f.onScroll!=null&&At("scroll",i),f.onScrollEnd!=null&&At("scrollend",i),f.onClick!=null&&(i.onclick=Sd),i=!0):i=!1,i||zo(s)}function u_(s){for(Bn=s.return;Bn;)switch(Bn.tag){case 5:case 13:vs=!1;return;case 27:case 3:vs=!0;return;default:Bn=Bn.return}}function fu(s){if(s!==Bn)return!1;if(!$t)return u_(s),$t=!0,!1;var i=s.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||y1(s.type,s.memoizedProps)),c=!c),c&&xr&&zo(s),u_(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8)if(c=s.data,c==="/$"){if(i===0){xr=Ua(s.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;s=s.nextSibling}xr=null}}else i===27?(i=xr,Vi(s.type)?(s=S1,S1=null,xr=s):xr=i):xr=Bn?Ua(s.stateNode.nextSibling):null;return!0}function hu(){xr=Bn=null,$t=!1}function f_(){var s=Uo;return s!==null&&(Jn===null?Jn=s:Jn.push.apply(Jn,s),Uo=null),s}function du(s){Uo===null?Uo=[s]:Uo.push(s)}var sp=ue(null),Ho=null,Ws=null;function bi(s,i,c){X(sp,i._currentValue),i._currentValue=c}function Ks(s){s._currentValue=sp.current,z(sp)}function ip(s,i,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),s===c)break;s=s.return}}function op(s,i,c,f){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var x=v.dependencies;if(x!==null){var I=v.child;x=x.firstContext;e:for(;x!==null;){var B=x;x=v;for(var ae=0;ae<i.length;ae++)if(B.context===i[ae]){x.lanes|=c,B=x.alternate,B!==null&&(B.lanes|=c),ip(x.return,c,s),f||(I=null);break e}x=B.next}}else if(v.tag===18){if(I=v.return,I===null)throw Error(n(341));I.lanes|=c,x=I.alternate,x!==null&&(x.lanes|=c),ip(I,c,s),I=null}else I=v.child;if(I!==null)I.return=v;else for(I=v;I!==null;){if(I===s){I=null;break}if(v=I.sibling,v!==null){v.return=I.return,I=v;break}I=I.return}v=I}}function mu(s,i,c,f){s=null;for(var v=i,x=!1;v!==null;){if(!x){if((v.flags&524288)!==0)x=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var I=v.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var B=v.type;sa(v.pendingProps.value,I.value)||(s!==null?s.push(B):s=[B])}}else if(v===ye.current){if(I=v.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Hu):s=[Hu])}v=v.return}s!==null&&op(i,s,c,f),i.flags|=262144}function qh(s){for(s=s.firstContext;s!==null;){if(!sa(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Go(s){Ho=s,Ws=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return h_(Ho,s)}function $h(s,i){return Ho===null&&Go(s),h_(s,i)}function h_(s,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Ws===null){if(s===null)throw Error(n(308));Ws=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Ws=Ws.next=i;return c}var tC=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){i.aborted=!0,s.forEach(function(c){return c()})}},rC=t.unstable_scheduleCallback,nC=t.unstable_NormalPriority,Ur={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lp(){return{controller:new tC,data:new Map,refCount:0}}function pu(s){s.refCount--,s.refCount===0&&rC(nC,function(){s.controller.abort()})}var gu=null,cp=0,zl=0,Hl=null;function aC(s,i){if(gu===null){var c=gu=[];cp=0,zl=f1(),Hl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return cp++,i.then(d_,d_),i}function d_(){if(--cp===0&&gu!==null){Hl!==null&&(Hl.status="fulfilled");var s=gu;gu=null,zl=0,Hl=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function sC(s,i){var c=[],f={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){f.status="fulfilled",f.value=i;for(var v=0;v<c.length;v++)(0,c[v])(i)},function(v){for(f.status="rejected",f.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),f}var m_=ie.S;ie.S=function(s,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&aC(s,i),m_!==null&&m_(s,i)};var qo=ue(null);function up(){var s=qo.current;return s!==null?s:sr.pooledCache}function Yh(s,i){i===null?X(qo,qo.current):X(qo,i.pool)}function p_(){var s=up();return s===null?null:{parent:Ur._currentValue,pool:s}}var vu=Error(n(460)),g_=Error(n(474)),Wh=Error(n(542)),fp={then:function(){}};function v_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Kh(){}function x_(s,i,c){switch(c=s[c],c===void 0?s.push(i):c!==i&&(i.then(Kh,Kh),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,y_(s),s;default:if(typeof i.status=="string")i.then(Kh,Kh);else{if(s=sr,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=i,s.status="pending",s.then(function(f){if(i.status==="pending"){var v=i;v.status="fulfilled",v.value=f}},function(f){if(i.status==="pending"){var v=i;v.status="rejected",v.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,y_(s),s}throw xu=i,vu}}var xu=null;function __(){if(xu===null)throw Error(n(459));var s=xu;return xu=null,s}function y_(s){if(s===vu||s===Wh)throw Error(n(483))}var Ai=!1;function hp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dp(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ci(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ni(s,i,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Kt&2)!==0){var v=f.pending;return v===null?i.next=i:(i.next=v.next,v.next=i),f.pending=i,i=Uh(s),i_(s,null,c),i}return Vh(s,f,i,c),Uh(s)}function _u(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,wo(s,c)}}function mp(s,i){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var v=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var I={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?v=x=I:x=x.next=I,c=c.next}while(c!==null);x===null?v=x=i:x=x.next=i}else v=x=i;c={baseState:f.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}var pp=!1;function yu(){if(pp){var s=Hl;if(s!==null)throw s}}function Eu(s,i,c,f){pp=!1;var v=s.updateQueue;Ai=!1;var x=v.firstBaseUpdate,I=v.lastBaseUpdate,B=v.shared.pending;if(B!==null){v.shared.pending=null;var ae=B,pe=ae.next;ae.next=null,I===null?x=pe:I.next=pe,I=ae;var Ce=s.alternate;Ce!==null&&(Ce=Ce.updateQueue,B=Ce.lastBaseUpdate,B!==I&&(B===null?Ce.firstBaseUpdate=pe:B.next=pe,Ce.lastBaseUpdate=ae))}if(x!==null){var Ie=v.baseState;I=0,Ce=pe=ae=null,B=x;do{var xe=B.lane&-536870913,_e=xe!==B.lane;if(_e?(Ft&xe)===xe:(f&xe)===xe){xe!==0&&xe===zl&&(pp=!0),Ce!==null&&(Ce=Ce.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var ut=s,at=B;xe=i;var er=c;switch(at.tag){case 1:if(ut=at.payload,typeof ut=="function"){Ie=ut.call(er,Ie,xe);break e}Ie=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=at.payload,xe=typeof ut=="function"?ut.call(er,Ie,xe):ut,xe==null)break e;Ie=g({},Ie,xe);break e;case 2:Ai=!0}}xe=B.callback,xe!==null&&(s.flags|=64,_e&&(s.flags|=8192),_e=v.callbacks,_e===null?v.callbacks=[xe]:_e.push(xe))}else _e={lane:xe,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Ce===null?(pe=Ce=_e,ae=Ie):Ce=Ce.next=_e,I|=xe;if(B=B.next,B===null){if(B=v.shared.pending,B===null)break;_e=B,B=_e.next,_e.next=null,v.lastBaseUpdate=_e,v.shared.pending=null}}while(!0);Ce===null&&(ae=Ie),v.baseState=ae,v.firstBaseUpdate=pe,v.lastBaseUpdate=Ce,x===null&&(v.shared.lanes=0),Fi|=I,s.lanes=I,s.memoizedState=Ie}}function E_(s,i){if(typeof s!="function")throw Error(n(191,s));s.call(i)}function T_(s,i){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)E_(c[s],i)}var Gl=ue(null),Xh=ue(0);function w_(s,i){s=ri,X(Xh,s),X(Gl,i),ri=s|i.baseLanes}function gp(){X(Xh,ri),X(Gl,Gl.current)}function vp(){ri=Xh.current,z(Gl),z(Xh)}var Ri=0,yt=null,Jt=null,Ir=null,Qh=!1,ql=!1,$o=!1,Jh=0,Tu=0,$l=null,iC=0;function br(){throw Error(n(321))}function xp(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!sa(s[c],i[c]))return!1;return!0}function _p(s,i,c,f,v,x){return Ri=x,yt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ie.H=s===null||s.memoizedState===null?i2:o2,$o=!1,x=c(f,v),$o=!1,ql&&(x=b_(i,c,f,v)),S_(s),x}function S_(s){ie.H=ad;var i=Jt!==null&&Jt.next!==null;if(Ri=0,Ir=Jt=yt=null,Qh=!1,Tu=0,$l=null,i)throw Error(n(300));s===null||Qr||(s=s.dependencies,s!==null&&qh(s)&&(Qr=!0))}function b_(s,i,c,f){yt=s;var v=0;do{if(ql&&($l=null),Tu=0,ql=!1,25<=v)throw Error(n(301));if(v+=1,Ir=Jt=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ie.H=dC,x=i(c,f)}while(ql);return x}function oC(){var s=ie.H,i=s.useState()[0];return i=typeof i.then=="function"?wu(i):i,s=s.useState()[0],(Jt!==null?Jt.memoizedState:null)!==s&&(yt.flags|=1024),i}function yp(){var s=Jh!==0;return Jh=0,s}function Ep(s,i,c){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~c}function Tp(s){if(Qh){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Qh=!1}Ri=0,Ir=Jt=yt=null,ql=!1,Tu=Jh=0,$l=null}function Xn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ir===null?yt.memoizedState=Ir=s:Ir=Ir.next=s,Ir}function Dr(){if(Jt===null){var s=yt.alternate;s=s!==null?s.memoizedState:null}else s=Jt.next;var i=Ir===null?yt.memoizedState:Ir.next;if(i!==null)Ir=i,Jt=s;else{if(s===null)throw yt.alternate===null?Error(n(467)):Error(n(310));Jt=s,s={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},Ir===null?yt.memoizedState=Ir=s:Ir=Ir.next=s}return Ir}function wp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wu(s){var i=Tu;return Tu+=1,$l===null&&($l=[]),s=x_($l,s,i),i=yt,(Ir===null?i.memoizedState:Ir.next)===null&&(i=i.alternate,ie.H=i===null||i.memoizedState===null?i2:o2),s}function Zh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wu(s);if(s.$$typeof===A)return _n(s)}throw Error(n(438,String(s)))}function Sp(s){var i=null,c=yt.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=yt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(v){return v.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=wp(),yt.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(s),f=0;f<s;f++)c[f]=F;return i.index++,c}function Xs(s,i){return typeof i=="function"?i(s):i}function ed(s){var i=Dr();return bp(i,Jt,s)}function bp(s,i,c){var f=s.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var v=s.baseQueue,x=f.pending;if(x!==null){if(v!==null){var I=v.next;v.next=x.next,x.next=I}i.baseQueue=v=x,f.pending=null}if(x=s.baseState,v===null)s.memoizedState=x;else{i=v.next;var B=I=null,ae=null,pe=i,Ce=!1;do{var Ie=pe.lane&-536870913;if(Ie!==pe.lane?(Ft&Ie)===Ie:(Ri&Ie)===Ie){var xe=pe.revertLane;if(xe===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Ie===zl&&(Ce=!0);else if((Ri&xe)===xe){pe=pe.next,xe===zl&&(Ce=!0);continue}else Ie={lane:0,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(B=ae=Ie,I=x):ae=ae.next=Ie,yt.lanes|=xe,Fi|=xe;Ie=pe.action,$o&&c(x,Ie),x=pe.hasEagerState?pe.eagerState:c(x,Ie)}else xe={lane:Ie,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(B=ae=xe,I=x):ae=ae.next=xe,yt.lanes|=Ie,Fi|=Ie;pe=pe.next}while(pe!==null&&pe!==i);if(ae===null?I=x:ae.next=B,!sa(x,s.memoizedState)&&(Qr=!0,Ce&&(c=Hl,c!==null)))throw c;s.memoizedState=x,s.baseState=I,s.baseQueue=ae,f.lastRenderedState=x}return v===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function Ap(s){var i=Dr(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var f=c.dispatch,v=c.pending,x=i.memoizedState;if(v!==null){c.pending=null;var I=v=v.next;do x=s(x,I.action),I=I.next;while(I!==v);sa(x,i.memoizedState)||(Qr=!0),i.memoizedState=x,i.baseQueue===null&&(i.baseState=x),c.lastRenderedState=x}return[x,f]}function A_(s,i,c){var f=yt,v=Dr(),x=$t;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=i();var I=!sa((Jt||v).memoizedState,c);I&&(v.memoizedState=c,Qr=!0),v=v.queue;var B=R_.bind(null,f,v,s);if(Su(2048,8,B,[s]),v.getSnapshot!==i||I||Ir!==null&&Ir.memoizedState.tag&1){if(f.flags|=2048,Yl(9,td(),N_.bind(null,f,v,c,i),null),sr===null)throw Error(n(349));x||(Ri&124)!==0||C_(f,i,c)}return c}function C_(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=yt.updateQueue,i===null?(i=wp(),yt.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function N_(s,i,c,f){i.value=c,i.getSnapshot=f,k_(i)&&I_(s)}function R_(s,i,c){return c(function(){k_(i)&&I_(s)})}function k_(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!sa(s,c)}catch{return!0}}function I_(s){var i=Ml(s,2);i!==null&&fa(i,s,2)}function Cp(s){var i=Xn();if(typeof s=="function"){var c=s;if(s=c(),$o){Ke(!0);try{c()}finally{Ke(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:s},i}function D_(s,i,c,f){return s.baseState=c,bp(s,Jt,typeof f=="function"?f:Xs)}function lC(s,i,c,f,v){if(nd(s))throw Error(n(485));if(s=i.action,s!==null){var x={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){x.listeners.push(I)}};ie.T!==null?c(!0):x.isTransition=!1,f(x),c=i.pending,c===null?(x.next=i.pending=x,O_(i,x)):(x.next=c.next,i.pending=c.next=x)}}function O_(s,i){var c=i.action,f=i.payload,v=s.state;if(i.isTransition){var x=ie.T,I={};ie.T=I;try{var B=c(v,f),ae=ie.S;ae!==null&&ae(I,B),j_(s,i,B)}catch(pe){Np(s,i,pe)}finally{ie.T=x}}else try{x=c(v,f),j_(s,i,x)}catch(pe){Np(s,i,pe)}}function j_(s,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){P_(s,i,f)},function(f){return Np(s,i,f)}):P_(s,i,c)}function P_(s,i,c){i.status="fulfilled",i.value=c,F_(i),s.state=c,i=s.pending,i!==null&&(c=i.next,c===i?s.pending=null:(c=c.next,i.next=c,O_(s,c)))}function Np(s,i,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,F_(i),i=i.next;while(i!==f)}s.action=null}function F_(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function L_(s,i){return i}function M_(s,i){if($t){var c=sr.formState;if(c!==null){e:{var f=yt;if($t){if(xr){t:{for(var v=xr,x=vs;v.nodeType!==8;){if(!x){v=null;break t}if(v=Ua(v.nextSibling),v===null){v=null;break t}}x=v.data,v=x==="F!"||x==="F"?v:null}if(v){xr=Ua(v.nextSibling),f=v.data==="F!";break e}}zo(f)}f=!1}f&&(i=c[0])}}return c=Xn(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:L_,lastRenderedState:i},c.queue=f,c=n2.bind(null,yt,f),f.dispatch=c,f=Cp(!1),x=Op.bind(null,yt,!1,f.queue),f=Xn(),v={state:i,dispatch:null,action:s,pending:null},f.queue=v,c=lC.bind(null,yt,v,x,c),v.dispatch=c,f.memoizedState=s,[i,c,!1]}function B_(s){var i=Dr();return V_(i,Jt,s)}function V_(s,i,c){if(i=bp(s,i,L_)[0],s=ed(Xs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=wu(i)}catch(I){throw I===vu?Wh:I}else f=i;i=Dr();var v=i.queue,x=v.dispatch;return c!==i.memoizedState&&(yt.flags|=2048,Yl(9,td(),cC.bind(null,v,c),null)),[f,x,s]}function cC(s,i){s.action=i}function U_(s){var i=Dr(),c=Jt;if(c!==null)return V_(i,c,s);Dr(),i=i.memoizedState,c=Dr();var f=c.queue.dispatch;return c.memoizedState=s,[i,f,!1]}function Yl(s,i,c,f){return s={tag:s,create:c,deps:f,inst:i,next:null},i=yt.updateQueue,i===null&&(i=wp(),yt.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,i.lastEffect=s),s}function td(){return{destroy:void 0,resource:void 0}}function z_(){return Dr().memoizedState}function rd(s,i,c,f){var v=Xn();f=f===void 0?null:f,yt.flags|=s,v.memoizedState=Yl(1|i,td(),c,f)}function Su(s,i,c,f){var v=Dr();f=f===void 0?null:f;var x=v.memoizedState.inst;Jt!==null&&f!==null&&xp(f,Jt.memoizedState.deps)?v.memoizedState=Yl(i,x,c,f):(yt.flags|=s,v.memoizedState=Yl(1|i,x,c,f))}function H_(s,i){rd(8390656,8,s,i)}function G_(s,i){Su(2048,8,s,i)}function q_(s,i){return Su(4,2,s,i)}function $_(s,i){return Su(4,4,s,i)}function Y_(s,i){if(typeof i=="function"){s=s();var c=i(s);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function W_(s,i,c){c=c!=null?c.concat([s]):null,Su(4,4,Y_.bind(null,i,s),c)}function Rp(){}function K_(s,i){var c=Dr();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&xp(i,f[1])?f[0]:(c.memoizedState=[s,i],s)}function X_(s,i){var c=Dr();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&xp(i,f[1]))return f[0];if(f=s(),$o){Ke(!0);try{s()}finally{Ke(!1)}}return c.memoizedState=[f,i],f}function kp(s,i,c){return c===void 0||(Ri&1073741824)!==0?s.memoizedState=i:(s.memoizedState=c,s=Z2(),yt.lanes|=s,Fi|=s,c)}function Q_(s,i,c,f){return sa(c,i)?c:Gl.current!==null?(s=kp(s,c,f),sa(s,i)||(Qr=!0),s):(Ri&42)===0?(Qr=!0,s.memoizedState=c):(s=Z2(),yt.lanes|=s,Fi|=s,i)}function J_(s,i,c,f,v){var x=me.p;me.p=x!==0&&8>x?x:8;var I=ie.T,B={};ie.T=B,Op(s,!1,i,c);try{var ae=v(),pe=ie.S;if(pe!==null&&pe(B,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ce=sC(ae,f);bu(s,i,Ce,ua(s))}else bu(s,i,f,ua(s))}catch(Ie){bu(s,i,{then:function(){},status:"rejected",reason:Ie},ua())}finally{me.p=x,ie.T=I}}function uC(){}function Ip(s,i,c,f){if(s.tag!==5)throw Error(n(476));var v=Z_(s).queue;J_(s,v,i,Pe,c===null?uC:function(){return e2(s),c(f)})}function Z_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:Pe,baseState:Pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:Pe},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:c},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function e2(s){var i=Z_(s).next.queue;bu(s,i,{},ua())}function Dp(){return _n(Hu)}function t2(){return Dr().memoizedState}function r2(){return Dr().memoizedState}function fC(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var c=ua();s=Ci(c);var f=Ni(i,s,c);f!==null&&(fa(f,i,c),_u(f,i,c)),i={cache:lp()},s.payload=i;return}i=i.return}}function hC(s,i,c){var f=ua();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},nd(s)?a2(i,c):(c=Jm(s,i,c,f),c!==null&&(fa(c,s,f),s2(c,i,f)))}function n2(s,i,c){var f=ua();bu(s,i,c,f)}function bu(s,i,c,f){var v={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(nd(s))a2(i,v);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=i.lastRenderedReducer,x!==null))try{var I=i.lastRenderedState,B=x(I,c);if(v.hasEagerState=!0,v.eagerState=B,sa(B,I))return Vh(s,i,v,0),sr===null&&Bh(),!1}catch{}finally{}if(c=Jm(s,i,v,f),c!==null)return fa(c,s,f),s2(c,i,f),!0}return!1}function Op(s,i,c,f){if(f={lane:2,revertLane:f1(),action:f,hasEagerState:!1,eagerState:null,next:null},nd(s)){if(i)throw Error(n(479))}else i=Jm(s,c,f,2),i!==null&&fa(i,s,2)}function nd(s){var i=s.alternate;return s===yt||i!==null&&i===yt}function a2(s,i){ql=Qh=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function s2(s,i,c){if((c&4194048)!==0){var f=i.lanes;f&=s.pendingLanes,c|=f,i.lanes=c,wo(s,c)}}var ad={readContext:_n,use:Zh,useCallback:br,useContext:br,useEffect:br,useImperativeHandle:br,useLayoutEffect:br,useInsertionEffect:br,useMemo:br,useReducer:br,useRef:br,useState:br,useDebugValue:br,useDeferredValue:br,useTransition:br,useSyncExternalStore:br,useId:br,useHostTransitionStatus:br,useFormState:br,useActionState:br,useOptimistic:br,useMemoCache:br,useCacheRefresh:br},i2={readContext:_n,use:Zh,useCallback:function(s,i){return Xn().memoizedState=[s,i===void 0?null:i],s},useContext:_n,useEffect:H_,useImperativeHandle:function(s,i,c){c=c!=null?c.concat([s]):null,rd(4194308,4,Y_.bind(null,i,s),c)},useLayoutEffect:function(s,i){return rd(4194308,4,s,i)},useInsertionEffect:function(s,i){rd(4,2,s,i)},useMemo:function(s,i){var c=Xn();i=i===void 0?null:i;var f=s();if($o){Ke(!0);try{s()}finally{Ke(!1)}}return c.memoizedState=[f,i],f},useReducer:function(s,i,c){var f=Xn();if(c!==void 0){var v=c(i);if($o){Ke(!0);try{c(i)}finally{Ke(!1)}}}else v=i;return f.memoizedState=f.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},f.queue=s,s=s.dispatch=hC.bind(null,yt,s),[f.memoizedState,s]},useRef:function(s){var i=Xn();return s={current:s},i.memoizedState=s},useState:function(s){s=Cp(s);var i=s.queue,c=n2.bind(null,yt,i);return i.dispatch=c,[s.memoizedState,c]},useDebugValue:Rp,useDeferredValue:function(s,i){var c=Xn();return kp(c,s,i)},useTransition:function(){var s=Cp(!1);return s=J_.bind(null,yt,s.queue,!0,!1),Xn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,c){var f=yt,v=Xn();if($t){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),sr===null)throw Error(n(349));(Ft&124)!==0||C_(f,i,c)}v.memoizedState=c;var x={value:c,getSnapshot:i};return v.queue=x,H_(R_.bind(null,f,x,s),[s]),f.flags|=2048,Yl(9,td(),N_.bind(null,f,x,c,i),null),c},useId:function(){var s=Xn(),i=sr.identifierPrefix;if($t){var c=Ys,f=$s;c=(f&~(1<<32-Je(f)-1)).toString(32)+c,i="«"+i+"R"+c,c=Jh++,0<c&&(i+="H"+c.toString(32)),i+="»"}else c=iC++,i="«"+i+"r"+c.toString(32)+"»";return s.memoizedState=i},useHostTransitionStatus:Dp,useFormState:M_,useActionState:M_,useOptimistic:function(s){var i=Xn();i.memoizedState=i.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=Op.bind(null,yt,!0,c),c.dispatch=i,[s,i]},useMemoCache:Sp,useCacheRefresh:function(){return Xn().memoizedState=fC.bind(null,yt)}},o2={readContext:_n,use:Zh,useCallback:K_,useContext:_n,useEffect:G_,useImperativeHandle:W_,useInsertionEffect:q_,useLayoutEffect:$_,useMemo:X_,useReducer:ed,useRef:z_,useState:function(){return ed(Xs)},useDebugValue:Rp,useDeferredValue:function(s,i){var c=Dr();return Q_(c,Jt.memoizedState,s,i)},useTransition:function(){var s=ed(Xs)[0],i=Dr().memoizedState;return[typeof s=="boolean"?s:wu(s),i]},useSyncExternalStore:A_,useId:t2,useHostTransitionStatus:Dp,useFormState:B_,useActionState:B_,useOptimistic:function(s,i){var c=Dr();return D_(c,Jt,s,i)},useMemoCache:Sp,useCacheRefresh:r2},dC={readContext:_n,use:Zh,useCallback:K_,useContext:_n,useEffect:G_,useImperativeHandle:W_,useInsertionEffect:q_,useLayoutEffect:$_,useMemo:X_,useReducer:Ap,useRef:z_,useState:function(){return Ap(Xs)},useDebugValue:Rp,useDeferredValue:function(s,i){var c=Dr();return Jt===null?kp(c,s,i):Q_(c,Jt.memoizedState,s,i)},useTransition:function(){var s=Ap(Xs)[0],i=Dr().memoizedState;return[typeof s=="boolean"?s:wu(s),i]},useSyncExternalStore:A_,useId:t2,useHostTransitionStatus:Dp,useFormState:U_,useActionState:U_,useOptimistic:function(s,i){var c=Dr();return Jt!==null?D_(c,Jt,s,i):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Sp,useCacheRefresh:r2},Wl=null,Au=0;function sd(s){var i=Au;return Au+=1,Wl===null&&(Wl=[]),x_(Wl,s,i)}function Cu(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function id(s,i){throw i.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(i),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function l2(s){var i=s._init;return i(s._payload)}function c2(s){function i(le,se){if(s){var he=le.deletions;he===null?(le.deletions=[se],le.flags|=16):he.push(se)}}function c(le,se){if(!s)return null;for(;se!==null;)i(le,se),se=se.sibling;return null}function f(le){for(var se=new Map;le!==null;)le.key!==null?se.set(le.key,le):se.set(le.index,le),le=le.sibling;return se}function v(le,se){return le=qs(le,se),le.index=0,le.sibling=null,le}function x(le,se,he){return le.index=he,s?(he=le.alternate,he!==null?(he=he.index,he<se?(le.flags|=67108866,se):he):(le.flags|=67108866,se)):(le.flags|=1048576,se)}function I(le){return s&&le.alternate===null&&(le.flags|=67108866),le}function B(le,se,he,ke){return se===null||se.tag!==6?(se=ep(he,le.mode,ke),se.return=le,se):(se=v(se,he),se.return=le,se)}function ae(le,se,he,ke){var Xe=he.type;return Xe===E?Ce(le,se,he.props.children,ke,he.key):se!==null&&(se.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===N&&l2(Xe)===se.type)?(se=v(se,he.props),Cu(se,he),se.return=le,se):(se=zh(he.type,he.key,he.props,null,le.mode,ke),Cu(se,he),se.return=le,se)}function pe(le,se,he,ke){return se===null||se.tag!==4||se.stateNode.containerInfo!==he.containerInfo||se.stateNode.implementation!==he.implementation?(se=tp(he,le.mode,ke),se.return=le,se):(se=v(se,he.children||[]),se.return=le,se)}function Ce(le,se,he,ke,Xe){return se===null||se.tag!==7?(se=Mo(he,le.mode,ke,Xe),se.return=le,se):(se=v(se,he),se.return=le,se)}function Ie(le,se,he){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=ep(""+se,le.mode,he),se.return=le,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case _:return he=zh(se.type,se.key,se.props,null,le.mode,he),Cu(he,se),he.return=le,he;case T:return se=tp(se,le.mode,he),se.return=le,se;case N:var ke=se._init;return se=ke(se._payload),Ie(le,se,he)}if(Ne(se)||M(se))return se=Mo(se,le.mode,he,null),se.return=le,se;if(typeof se.then=="function")return Ie(le,sd(se),he);if(se.$$typeof===A)return Ie(le,$h(le,se),he);id(le,se)}return null}function xe(le,se,he,ke){var Xe=se!==null?se.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Xe!==null?null:B(le,se,""+he,ke);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case _:return he.key===Xe?ae(le,se,he,ke):null;case T:return he.key===Xe?pe(le,se,he,ke):null;case N:return Xe=he._init,he=Xe(he._payload),xe(le,se,he,ke)}if(Ne(he)||M(he))return Xe!==null?null:Ce(le,se,he,ke,null);if(typeof he.then=="function")return xe(le,se,sd(he),ke);if(he.$$typeof===A)return xe(le,se,$h(le,he),ke);id(le,he)}return null}function _e(le,se,he,ke,Xe){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return le=le.get(he)||null,B(se,le,""+ke,Xe);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case _:return le=le.get(ke.key===null?he:ke.key)||null,ae(se,le,ke,Xe);case T:return le=le.get(ke.key===null?he:ke.key)||null,pe(se,le,ke,Xe);case N:var Tt=ke._init;return ke=Tt(ke._payload),_e(le,se,he,ke,Xe)}if(Ne(ke)||M(ke))return le=le.get(he)||null,Ce(se,le,ke,Xe,null);if(typeof ke.then=="function")return _e(le,se,he,sd(ke),Xe);if(ke.$$typeof===A)return _e(le,se,he,$h(se,ke),Xe);id(se,ke)}return null}function ut(le,se,he,ke){for(var Xe=null,Tt=null,et=se,st=se=0,Zr=null;et!==null&&st<he.length;st++){et.index>st?(Zr=et,et=null):Zr=et.sibling;var Gt=xe(le,et,he[st],ke);if(Gt===null){et===null&&(et=Zr);break}s&&et&&Gt.alternate===null&&i(le,et),se=x(Gt,se,st),Tt===null?Xe=Gt:Tt.sibling=Gt,Tt=Gt,et=Zr}if(st===he.length)return c(le,et),$t&&Vo(le,st),Xe;if(et===null){for(;st<he.length;st++)et=Ie(le,he[st],ke),et!==null&&(se=x(et,se,st),Tt===null?Xe=et:Tt.sibling=et,Tt=et);return $t&&Vo(le,st),Xe}for(et=f(et);st<he.length;st++)Zr=_e(et,le,st,he[st],ke),Zr!==null&&(s&&Zr.alternate!==null&&et.delete(Zr.key===null?st:Zr.key),se=x(Zr,se,st),Tt===null?Xe=Zr:Tt.sibling=Zr,Tt=Zr);return s&&et.forEach(function(qi){return i(le,qi)}),$t&&Vo(le,st),Xe}function at(le,se,he,ke){if(he==null)throw Error(n(151));for(var Xe=null,Tt=null,et=se,st=se=0,Zr=null,Gt=he.next();et!==null&&!Gt.done;st++,Gt=he.next()){et.index>st?(Zr=et,et=null):Zr=et.sibling;var qi=xe(le,et,Gt.value,ke);if(qi===null){et===null&&(et=Zr);break}s&&et&&qi.alternate===null&&i(le,et),se=x(qi,se,st),Tt===null?Xe=qi:Tt.sibling=qi,Tt=qi,et=Zr}if(Gt.done)return c(le,et),$t&&Vo(le,st),Xe;if(et===null){for(;!Gt.done;st++,Gt=he.next())Gt=Ie(le,Gt.value,ke),Gt!==null&&(se=x(Gt,se,st),Tt===null?Xe=Gt:Tt.sibling=Gt,Tt=Gt);return $t&&Vo(le,st),Xe}for(et=f(et);!Gt.done;st++,Gt=he.next())Gt=_e(et,le,st,Gt.value,ke),Gt!==null&&(s&&Gt.alternate!==null&&et.delete(Gt.key===null?st:Gt.key),se=x(Gt,se,st),Tt===null?Xe=Gt:Tt.sibling=Gt,Tt=Gt);return s&&et.forEach(function(mN){return i(le,mN)}),$t&&Vo(le,st),Xe}function er(le,se,he,ke){if(typeof he=="object"&&he!==null&&he.type===E&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case _:e:{for(var Xe=he.key;se!==null;){if(se.key===Xe){if(Xe=he.type,Xe===E){if(se.tag===7){c(le,se.sibling),ke=v(se,he.props.children),ke.return=le,le=ke;break e}}else if(se.elementType===Xe||typeof Xe=="object"&&Xe!==null&&Xe.$$typeof===N&&l2(Xe)===se.type){c(le,se.sibling),ke=v(se,he.props),Cu(ke,he),ke.return=le,le=ke;break e}c(le,se);break}else i(le,se);se=se.sibling}he.type===E?(ke=Mo(he.props.children,le.mode,ke,he.key),ke.return=le,le=ke):(ke=zh(he.type,he.key,he.props,null,le.mode,ke),Cu(ke,he),ke.return=le,le=ke)}return I(le);case T:e:{for(Xe=he.key;se!==null;){if(se.key===Xe)if(se.tag===4&&se.stateNode.containerInfo===he.containerInfo&&se.stateNode.implementation===he.implementation){c(le,se.sibling),ke=v(se,he.children||[]),ke.return=le,le=ke;break e}else{c(le,se);break}else i(le,se);se=se.sibling}ke=tp(he,le.mode,ke),ke.return=le,le=ke}return I(le);case N:return Xe=he._init,he=Xe(he._payload),er(le,se,he,ke)}if(Ne(he))return ut(le,se,he,ke);if(M(he)){if(Xe=M(he),typeof Xe!="function")throw Error(n(150));return he=Xe.call(he),at(le,se,he,ke)}if(typeof he.then=="function")return er(le,se,sd(he),ke);if(he.$$typeof===A)return er(le,se,$h(le,he),ke);id(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,se!==null&&se.tag===6?(c(le,se.sibling),ke=v(se,he),ke.return=le,le=ke):(c(le,se),ke=ep(he,le.mode,ke),ke.return=le,le=ke),I(le)):c(le,se)}return function(le,se,he,ke){try{Au=0;var Xe=er(le,se,he,ke);return Wl=null,Xe}catch(et){if(et===vu||et===Wh)throw et;var Tt=ia(29,et,null,le.mode);return Tt.lanes=ke,Tt.return=le,Tt}finally{}}}var Kl=c2(!0),u2=c2(!1),Ca=ue(null),xs=null;function ki(s){var i=s.alternate;X(zr,zr.current&1),X(Ca,s),xs===null&&(i===null||Gl.current!==null||i.memoizedState!==null)&&(xs=s)}function f2(s){if(s.tag===22){if(X(zr,zr.current),X(Ca,s),xs===null){var i=s.alternate;i!==null&&i.memoizedState!==null&&(xs=s)}}else Ii()}function Ii(){X(zr,zr.current),X(Ca,Ca.current)}function Qs(s){z(Ca),xs===s&&(xs=null),z(zr)}var zr=ue(0);function od(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||w1(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function jp(s,i,c,f){i=s.memoizedState,c=c(f,i),c=c==null?i:g({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Pp={enqueueSetState:function(s,i,c){s=s._reactInternals;var f=ua(),v=Ci(f);v.payload=i,c!=null&&(v.callback=c),i=Ni(s,v,f),i!==null&&(fa(i,s,f),_u(i,s,f))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var f=ua(),v=Ci(f);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=Ni(s,v,f),i!==null&&(fa(i,s,f),_u(i,s,f))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=ua(),f=Ci(c);f.tag=2,i!=null&&(f.callback=i),i=Ni(s,f,c),i!==null&&(fa(i,s,c),_u(i,s,c))}};function h2(s,i,c,f,v,x,I){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,x,I):i.prototype&&i.prototype.isPureReactComponent?!cu(c,f)||!cu(v,x):!0}function d2(s,i,c,f){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==s&&Pp.enqueueReplaceState(i,i.state,null)}function Yo(s,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(s=s.defaultProps){c===i&&(c=g({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}var ld=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function m2(s){ld(s)}function p2(s){console.error(s)}function g2(s){ld(s)}function cd(s,i){try{var c=s.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function v2(s,i,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Fp(s,i,c){return c=Ci(c),c.tag=3,c.payload={element:null},c.callback=function(){cd(s,i)},c}function x2(s){return s=Ci(s),s.tag=3,s}function _2(s,i,c,f){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var x=f.value;s.payload=function(){return v(x)},s.callback=function(){v2(i,c,f)}}var I=c.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(s.callback=function(){v2(i,c,f),typeof v!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})})}function mC(s,i,c,f,v){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&mu(i,c,v,!0),c=Ca.current,c!==null){switch(c.tag){case 13:return xs===null?i1():c.alternate===null&&_r===0&&(_r=3),c.flags&=-257,c.flags|=65536,c.lanes=v,f===fp?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),l1(s,f,v)),!1;case 22:return c.flags|=65536,f===fp?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),l1(s,f,v)),!1}throw Error(n(435,c.tag))}return l1(s,f,v),i1(),!1}if($t)return i=Ca.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=v,f!==ap&&(s=Error(n(422),{cause:f}),du(wa(s,c)))):(f!==ap&&(i=Error(n(423),{cause:f}),du(wa(i,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,f=wa(f,c),v=Fp(s.stateNode,f,v),mp(s,v),_r!==4&&(_r=2)),!1;var x=Error(n(520),{cause:f});if(x=wa(x,c),ju===null?ju=[x]:ju.push(x),_r!==4&&(_r=2),i===null)return!0;f=wa(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=Fp(c.stateNode,f,s),mp(c,s),!1;case 1:if(i=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Li===null||!Li.has(x))))return c.flags|=65536,v&=-v,c.lanes|=v,v=x2(v),_2(v,s,c,f),mp(c,v),!1}c=c.return}while(c!==null);return!1}var y2=Error(n(461)),Qr=!1;function sn(s,i,c,f){i.child=s===null?u2(i,null,c,f):Kl(i,s.child,c,f)}function E2(s,i,c,f,v){c=c.render;var x=i.ref;if("ref"in f){var I={};for(var B in f)B!=="ref"&&(I[B]=f[B])}else I=f;return Go(i),f=_p(s,i,c,I,x,v),B=yp(),s!==null&&!Qr?(Ep(s,i,v),Js(s,i,v)):($t&&B&&rp(i),i.flags|=1,sn(s,i,f,v),i.child)}function T2(s,i,c,f,v){if(s===null){var x=c.type;return typeof x=="function"&&!Zm(x)&&x.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=x,w2(s,i,x,f,v)):(s=zh(c.type,null,f,i,i.mode,v),s.ref=i.ref,s.return=i,i.child=s)}if(x=s.child,!Gp(s,v)){var I=x.memoizedProps;if(c=c.compare,c=c!==null?c:cu,c(I,f)&&s.ref===i.ref)return Js(s,i,v)}return i.flags|=1,s=qs(x,f),s.ref=i.ref,s.return=i,i.child=s}function w2(s,i,c,f,v){if(s!==null){var x=s.memoizedProps;if(cu(x,f)&&s.ref===i.ref)if(Qr=!1,i.pendingProps=f=x,Gp(s,v))(s.flags&131072)!==0&&(Qr=!0);else return i.lanes=s.lanes,Js(s,i,v)}return Lp(s,i,c,f,v)}function S2(s,i,c){var f=i.pendingProps,v=f.children,x=s!==null?s.memoizedState:null;if(f.mode==="hidden"){if((i.flags&128)!==0){if(f=x!==null?x.baseLanes|c:c,s!==null){for(v=i.child=s.child,x=0;v!==null;)x=x|v.lanes|v.childLanes,v=v.sibling;i.childLanes=x&~f}else i.childLanes=0,i.child=null;return b2(s,i,f,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Yh(i,x!==null?x.cachePool:null),x!==null?w_(i,x):gp(),f2(i);else return i.lanes=i.childLanes=536870912,b2(s,i,x!==null?x.baseLanes|c:c,c)}else x!==null?(Yh(i,x.cachePool),w_(i,x),Ii(),i.memoizedState=null):(s!==null&&Yh(i,null),gp(),Ii());return sn(s,i,v,c),i.child}function b2(s,i,c,f){var v=up();return v=v===null?null:{parent:Ur._currentValue,pool:v},i.memoizedState={baseLanes:c,cachePool:v},s!==null&&Yh(i,null),gp(),f2(i),s!==null&&mu(s,i,f,!0),null}function ud(s,i){var c=i.ref;if(c===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(i.flags|=4194816)}}function Lp(s,i,c,f,v){return Go(i),c=_p(s,i,c,f,void 0,v),f=yp(),s!==null&&!Qr?(Ep(s,i,v),Js(s,i,v)):($t&&f&&rp(i),i.flags|=1,sn(s,i,c,v),i.child)}function A2(s,i,c,f,v,x){return Go(i),i.updateQueue=null,c=b_(i,f,c,v),S_(s),f=yp(),s!==null&&!Qr?(Ep(s,i,x),Js(s,i,x)):($t&&f&&rp(i),i.flags|=1,sn(s,i,c,x),i.child)}function C2(s,i,c,f,v){if(Go(i),i.stateNode===null){var x=Bl,I=c.contextType;typeof I=="object"&&I!==null&&(x=_n(I)),x=new c(f,x),i.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=Pp,i.stateNode=x,x._reactInternals=i,x=i.stateNode,x.props=f,x.state=i.memoizedState,x.refs={},hp(i),I=c.contextType,x.context=typeof I=="object"&&I!==null?_n(I):Bl,x.state=i.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(jp(i,c,I,f),x.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(I=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),I!==x.state&&Pp.enqueueReplaceState(x,x.state,null),Eu(i,f,x,v),yu(),x.state=i.memoizedState),typeof x.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(s===null){x=i.stateNode;var B=i.memoizedProps,ae=Yo(c,B);x.props=ae;var pe=x.context,Ce=c.contextType;I=Bl,typeof Ce=="object"&&Ce!==null&&(I=_n(Ce));var Ie=c.getDerivedStateFromProps;Ce=typeof Ie=="function"||typeof x.getSnapshotBeforeUpdate=="function",B=i.pendingProps!==B,Ce||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(B||pe!==I)&&d2(i,x,f,I),Ai=!1;var xe=i.memoizedState;x.state=xe,Eu(i,f,x,v),yu(),pe=i.memoizedState,B||xe!==pe||Ai?(typeof Ie=="function"&&(jp(i,c,Ie,f),pe=i.memoizedState),(ae=Ai||h2(i,c,ae,f,xe,pe,I))?(Ce||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=pe),x.props=f,x.state=pe,x.context=I,f=ae):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{x=i.stateNode,dp(s,i),I=i.memoizedProps,Ce=Yo(c,I),x.props=Ce,Ie=i.pendingProps,xe=x.context,pe=c.contextType,ae=Bl,typeof pe=="object"&&pe!==null&&(ae=_n(pe)),B=c.getDerivedStateFromProps,(pe=typeof B=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(I!==Ie||xe!==ae)&&d2(i,x,f,ae),Ai=!1,xe=i.memoizedState,x.state=xe,Eu(i,f,x,v),yu();var _e=i.memoizedState;I!==Ie||xe!==_e||Ai||s!==null&&s.dependencies!==null&&qh(s.dependencies)?(typeof B=="function"&&(jp(i,c,B,f),_e=i.memoizedState),(Ce=Ai||h2(i,c,Ce,f,xe,_e,ae)||s!==null&&s.dependencies!==null&&qh(s.dependencies))?(pe||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,_e,ae),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,_e,ae)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||I===s.memoizedProps&&xe===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&xe===s.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=_e),x.props=f,x.state=_e,x.context=ae,f=Ce):(typeof x.componentDidUpdate!="function"||I===s.memoizedProps&&xe===s.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||I===s.memoizedProps&&xe===s.memoizedState||(i.flags|=1024),f=!1)}return x=f,ud(s,i),f=(i.flags&128)!==0,x||f?(x=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),i.flags|=1,s!==null&&f?(i.child=Kl(i,s.child,null,v),i.child=Kl(i,null,c,v)):sn(s,i,c,v),i.memoizedState=x.state,s=i.child):s=Js(s,i,v),s}function N2(s,i,c,f){return hu(),i.flags|=256,sn(s,i,c,f),i.child}var Mp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bp(s){return{baseLanes:s,cachePool:p_()}}function Vp(s,i,c){return s=s!==null?s.childLanes&~c:0,i&&(s|=Na),s}function R2(s,i,c){var f=i.pendingProps,v=!1,x=(i.flags&128)!==0,I;if((I=x)||(I=s!==null&&s.memoizedState===null?!1:(zr.current&2)!==0),I&&(v=!0,i.flags&=-129),I=(i.flags&32)!==0,i.flags&=-33,s===null){if($t){if(v?ki(i):Ii(),$t){var B=xr,ae;if(ae=B){e:{for(ae=B,B=vs;ae.nodeType!==8;){if(!B){B=null;break e}if(ae=Ua(ae.nextSibling),ae===null){B=null;break e}}B=ae}B!==null?(i.memoizedState={dehydrated:B,treeContext:Bo!==null?{id:$s,overflow:Ys}:null,retryLane:536870912,hydrationErrors:null},ae=ia(18,null,null,0),ae.stateNode=B,ae.return=i,i.child=ae,Bn=i,xr=null,ae=!0):ae=!1}ae||zo(i)}if(B=i.memoizedState,B!==null&&(B=B.dehydrated,B!==null))return w1(B)?i.lanes=32:i.lanes=536870912,null;Qs(i)}return B=f.children,f=f.fallback,v?(Ii(),v=i.mode,B=fd({mode:"hidden",children:B},v),f=Mo(f,v,c,null),B.return=i,f.return=i,B.sibling=f,i.child=B,v=i.child,v.memoizedState=Bp(c),v.childLanes=Vp(s,I,c),i.memoizedState=Mp,f):(ki(i),Up(i,B))}if(ae=s.memoizedState,ae!==null&&(B=ae.dehydrated,B!==null)){if(x)i.flags&256?(ki(i),i.flags&=-257,i=zp(s,i,c)):i.memoizedState!==null?(Ii(),i.child=s.child,i.flags|=128,i=null):(Ii(),v=f.fallback,B=i.mode,f=fd({mode:"visible",children:f.children},B),v=Mo(v,B,c,null),v.flags|=2,f.return=i,v.return=i,f.sibling=v,i.child=f,Kl(i,s.child,null,c),f=i.child,f.memoizedState=Bp(c),f.childLanes=Vp(s,I,c),i.memoizedState=Mp,i=v);else if(ki(i),w1(B)){if(I=B.nextSibling&&B.nextSibling.dataset,I)var pe=I.dgst;I=pe,f=Error(n(419)),f.stack="",f.digest=I,du({value:f,source:null,stack:null}),i=zp(s,i,c)}else if(Qr||mu(s,i,c,!1),I=(c&s.childLanes)!==0,Qr||I){if(I=sr,I!==null&&(f=c&-c,f=(f&42)!==0?1:is(f),f=(f&(I.suspendedLanes|c))!==0?0:f,f!==0&&f!==ae.retryLane))throw ae.retryLane=f,Ml(s,f),fa(I,s,f),y2;B.data==="$?"||i1(),i=zp(s,i,c)}else B.data==="$?"?(i.flags|=192,i.child=s.child,i=null):(s=ae.treeContext,xr=Ua(B.nextSibling),Bn=i,$t=!0,Uo=null,vs=!1,s!==null&&(ba[Aa++]=$s,ba[Aa++]=Ys,ba[Aa++]=Bo,$s=s.id,Ys=s.overflow,Bo=i),i=Up(i,f.children),i.flags|=4096);return i}return v?(Ii(),v=f.fallback,B=i.mode,ae=s.child,pe=ae.sibling,f=qs(ae,{mode:"hidden",children:f.children}),f.subtreeFlags=ae.subtreeFlags&65011712,pe!==null?v=qs(pe,v):(v=Mo(v,B,c,null),v.flags|=2),v.return=i,f.return=i,f.sibling=v,i.child=f,f=v,v=i.child,B=s.child.memoizedState,B===null?B=Bp(c):(ae=B.cachePool,ae!==null?(pe=Ur._currentValue,ae=ae.parent!==pe?{parent:pe,pool:pe}:ae):ae=p_(),B={baseLanes:B.baseLanes|c,cachePool:ae}),v.memoizedState=B,v.childLanes=Vp(s,I,c),i.memoizedState=Mp,f):(ki(i),c=s.child,s=c.sibling,c=qs(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,s!==null&&(I=i.deletions,I===null?(i.deletions=[s],i.flags|=16):I.push(s)),i.child=c,i.memoizedState=null,c)}function Up(s,i){return i=fd({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function fd(s,i){return s=ia(22,s,null,i),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function zp(s,i,c){return Kl(i,s.child,null,c),s=Up(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function k2(s,i,c){s.lanes|=i;var f=s.alternate;f!==null&&(f.lanes|=i),ip(s.return,i,c)}function Hp(s,i,c,f,v){var x=s.memoizedState;x===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:v}:(x.isBackwards=i,x.rendering=null,x.renderingStartTime=0,x.last=f,x.tail=c,x.tailMode=v)}function I2(s,i,c){var f=i.pendingProps,v=f.revealOrder,x=f.tail;if(sn(s,i,f.children,c),f=zr.current,(f&2)!==0)f=f&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&k2(s,c,i);else if(s.tag===19)k2(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}switch(X(zr,f),v){case"forwards":for(c=i.child,v=null;c!==null;)s=c.alternate,s!==null&&od(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=i.child,i.child=null):(v=c.sibling,c.sibling=null),Hp(i,!1,v,c,x);break;case"backwards":for(c=null,v=i.child,i.child=null;v!==null;){if(s=v.alternate,s!==null&&od(s)===null){i.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Hp(i,!0,c,null,x);break;case"together":Hp(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Js(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),Fi|=i.lanes,(c&i.childLanes)===0)if(s!==null){if(mu(s,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(n(153));if(i.child!==null){for(s=i.child,c=qs(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=qs(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function Gp(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&qh(s)))}function pC(s,i,c){switch(i.tag){case 3:Ee(i,i.stateNode.containerInfo),bi(i,Ur,s.memoizedState.cache),hu();break;case 27:case 5:be(i);break;case 4:Ee(i,i.stateNode.containerInfo);break;case 10:bi(i,i.type,i.memoizedProps.value);break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(ki(i),i.flags|=128,null):(c&i.child.childLanes)!==0?R2(s,i,c):(ki(i),s=Js(s,i,c),s!==null?s.sibling:null);ki(i);break;case 19:var v=(s.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(mu(s,i,c,!1),f=(c&i.childLanes)!==0),v){if(f)return I2(s,i,c);i.flags|=128}if(v=i.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),X(zr,zr.current),f)break;return null;case 22:case 23:return i.lanes=0,S2(s,i,c);case 24:bi(i,Ur,s.memoizedState.cache)}return Js(s,i,c)}function D2(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps)Qr=!0;else{if(!Gp(s,c)&&(i.flags&128)===0)return Qr=!1,pC(s,i,c);Qr=(s.flags&131072)!==0}else Qr=!1,$t&&(i.flags&1048576)!==0&&l_(i,Gh,i.index);switch(i.lanes=0,i.tag){case 16:e:{s=i.pendingProps;var f=i.elementType,v=f._init;if(f=v(f._payload),i.type=f,typeof f=="function")Zm(f)?(s=Yo(f,s),i.tag=1,i=C2(null,i,f,s,c)):(i.tag=0,i=Lp(null,i,f,s,c));else{if(f!=null){if(v=f.$$typeof,v===D){i.tag=11,i=E2(null,i,f,s,c);break e}else if(v===C){i.tag=14,i=T2(null,i,f,s,c);break e}}throw i=Me(f)||f,Error(n(306,i,""))}}return i;case 0:return Lp(s,i,i.type,i.pendingProps,c);case 1:return f=i.type,v=Yo(f,i.pendingProps),C2(s,i,f,v,c);case 3:e:{if(Ee(i,i.stateNode.containerInfo),s===null)throw Error(n(387));f=i.pendingProps;var x=i.memoizedState;v=x.element,dp(s,i),Eu(i,f,null,c);var I=i.memoizedState;if(f=I.cache,bi(i,Ur,f),f!==x.cache&&op(i,[Ur],c,!0),yu(),f=I.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:I.cache},i.updateQueue.baseState=x,i.memoizedState=x,i.flags&256){i=N2(s,i,f,c);break e}else if(f!==v){v=wa(Error(n(424)),i),du(v),i=N2(s,i,f,c);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(xr=Ua(s.firstChild),Bn=i,$t=!0,Uo=null,vs=!0,c=u2(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(hu(),f===v){i=Js(s,i,c);break e}sn(s,i,f,c)}i=i.child}return i;case 26:return ud(s,i),s===null?(c=Fy(i.type,null,i.pendingProps,null))?i.memoizedState=c:$t||(c=i.type,s=i.pendingProps,f=bd(Q.current).createElement(c),f[Sr]=i,f[ur]=s,ln(f,c,s),ce(f),i.stateNode=f):i.memoizedState=Fy(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return be(i),s===null&&$t&&(f=i.stateNode=Oy(i.type,i.pendingProps,Q.current),Bn=i,vs=!0,v=xr,Vi(i.type)?(S1=v,xr=Ua(f.firstChild)):xr=v),sn(s,i,i.pendingProps.children,c),ud(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&$t&&((v=f=xr)&&(f=HC(f,i.type,i.pendingProps,vs),f!==null?(i.stateNode=f,Bn=i,xr=Ua(f.firstChild),vs=!1,v=!0):v=!1),v||zo(i)),be(i),v=i.type,x=i.pendingProps,I=s!==null?s.memoizedProps:null,f=x.children,y1(v,x)?f=null:I!==null&&y1(v,I)&&(i.flags|=32),i.memoizedState!==null&&(v=_p(s,i,oC,null,null,c),Hu._currentValue=v),ud(s,i),sn(s,i,f,c),i.child;case 6:return s===null&&$t&&((s=c=xr)&&(c=GC(c,i.pendingProps,vs),c!==null?(i.stateNode=c,Bn=i,xr=null,s=!0):s=!1),s||zo(i)),null;case 13:return R2(s,i,c);case 4:return Ee(i,i.stateNode.containerInfo),f=i.pendingProps,s===null?i.child=Kl(i,null,f,c):sn(s,i,f,c),i.child;case 11:return E2(s,i,i.type,i.pendingProps,c);case 7:return sn(s,i,i.pendingProps,c),i.child;case 8:return sn(s,i,i.pendingProps.children,c),i.child;case 12:return sn(s,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,bi(i,i.type,f.value),sn(s,i,f.children,c),i.child;case 9:return v=i.type._context,f=i.pendingProps.children,Go(i),v=_n(v),f=f(v),i.flags|=1,sn(s,i,f,c),i.child;case 14:return T2(s,i,i.type,i.pendingProps,c);case 15:return w2(s,i,i.type,i.pendingProps,c);case 19:return I2(s,i,c);case 31:return f=i.pendingProps,c=i.mode,f={mode:f.mode,children:f.children},s===null?(c=fd(f,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=qs(s.child,f),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return S2(s,i,c);case 24:return Go(i),f=_n(Ur),s===null?(v=up(),v===null&&(v=sr,x=lp(),v.pooledCache=x,x.refCount++,x!==null&&(v.pooledCacheLanes|=c),v=x),i.memoizedState={parent:f,cache:v},hp(i),bi(i,Ur,v)):((s.lanes&c)!==0&&(dp(s,i),Eu(i,null,null,c),yu()),v=s.memoizedState,x=i.memoizedState,v.parent!==f?(v={parent:f,cache:f},i.memoizedState=v,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=v),bi(i,Ur,f)):(f=x.cache,bi(i,Ur,f),f!==v.cache&&op(i,[Ur],c,!0))),sn(s,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function Zs(s){s.flags|=4}function O2(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Uy(i)){if(i=Ca.current,i!==null&&((Ft&4194048)===Ft?xs!==null:(Ft&62914560)!==Ft&&(Ft&536870912)===0||i!==xs))throw xu=fp,g_;s.flags|=8192}}function hd(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?Fa():536870912,s.lanes|=i,Zl|=i)}function Nu(s,i){if(!$t)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function mr(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(i)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,f|=v.subtreeFlags&65011712,f|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,f|=v.subtreeFlags,f|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=f,s.childLanes=c,i}function gC(s,i,c){var f=i.pendingProps;switch(np(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(i),null;case 1:return mr(i),null;case 3:return c=i.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Ks(Ur),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(fu(i)?Zs(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,f_())),mr(i),null;case 26:return c=i.memoizedState,s===null?(Zs(i),c!==null?(mr(i),O2(i,c)):(mr(i),i.flags&=-16777217)):c?c!==s.memoizedState?(Zs(i),mr(i),O2(i,c)):(mr(i),i.flags&=-16777217):(s.memoizedProps!==f&&Zs(i),mr(i),i.flags&=-16777217),null;case 27:Ze(i),c=Q.current;var v=i.type;if(s!==null&&i.stateNode!=null)s.memoizedProps!==f&&Zs(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return mr(i),null}s=G.current,fu(i)?c_(i):(s=Oy(v,f,c),i.stateNode=s,Zs(i))}return mr(i),null;case 5:if(Ze(i),c=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==f&&Zs(i);else{if(!f){if(i.stateNode===null)throw Error(n(166));return mr(i),null}if(s=G.current,fu(i))c_(i);else{switch(v=bd(Q.current),s){case 1:s=v.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:s=v.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":s=v.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":s=v.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":s=v.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof f.is=="string"?v.createElement("select",{is:f.is}):v.createElement("select"),f.multiple?s.multiple=!0:f.size&&(s.size=f.size);break;default:s=typeof f.is=="string"?v.createElement(c,{is:f.is}):v.createElement(c)}}s[Sr]=i,s[ur]=f;e:for(v=i.child;v!==null;){if(v.tag===5||v.tag===6)s.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===i)break e;for(;v.sibling===null;){if(v.return===null||v.return===i)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}i.stateNode=s;e:switch(ln(s,c,f),c){case"button":case"input":case"select":case"textarea":s=!!f.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Zs(i)}}return mr(i),i.flags&=-16777217,null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==f&&Zs(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(n(166));if(s=Q.current,fu(i)){if(s=i.stateNode,c=i.memoizedProps,f=null,v=Bn,v!==null)switch(v.tag){case 27:case 5:f=v.memoizedProps}s[Sr]=i,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||Ay(s.nodeValue,c)),s||zo(i)}else s=bd(s).createTextNode(f),s[Sr]=i,i.stateNode=s}return mr(i),null;case 13:if(f=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=fu(i),f!==null&&f.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[Sr]=i}else hu(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;mr(i),v=!1}else v=f_(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return i.flags&256?(Qs(i),i):(Qs(i),null)}if(Qs(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=f!==null,s=s!==null&&s.memoizedState!==null,c){f=i.child,v=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(v=f.alternate.memoizedState.cachePool.pool);var x=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==v&&(f.flags|=2048)}return c!==s&&c&&(i.child.flags|=8192),hd(i,i.updateQueue),mr(i),null;case 4:return Ae(),s===null&&p1(i.stateNode.containerInfo),mr(i),null;case 10:return Ks(i.type),mr(i),null;case 19:if(z(zr),v=i.memoizedState,v===null)return mr(i),null;if(f=(i.flags&128)!==0,x=v.rendering,x===null)if(f)Nu(v,!1);else{if(_r!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(x=od(s),x!==null){for(i.flags|=128,Nu(v,!1),s=x.updateQueue,i.updateQueue=s,hd(i,s),i.subtreeFlags=0,s=c,c=i.child;c!==null;)o_(c,s),c=c.sibling;return X(zr,zr.current&1|2),i.child}s=s.sibling}v.tail!==null&&je()>pd&&(i.flags|=128,f=!0,Nu(v,!1),i.lanes=4194304)}else{if(!f)if(s=od(x),s!==null){if(i.flags|=128,f=!0,s=s.updateQueue,i.updateQueue=s,hd(i,s),Nu(v,!0),v.tail===null&&v.tailMode==="hidden"&&!x.alternate&&!$t)return mr(i),null}else 2*je()-v.renderingStartTime>pd&&c!==536870912&&(i.flags|=128,f=!0,Nu(v,!1),i.lanes=4194304);v.isBackwards?(x.sibling=i.child,i.child=x):(s=v.last,s!==null?s.sibling=x:i.child=x,v.last=x)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=je(),i.sibling=null,s=zr.current,X(zr,f?s&1|2:s&1),i):(mr(i),null);case 22:case 23:return Qs(i),vp(),f=i.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(mr(i),i.subtreeFlags&6&&(i.flags|=8192)):mr(i),c=i.updateQueue,c!==null&&hd(i,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),s!==null&&z(qo),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Ks(Ur),mr(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function vC(s,i){switch(np(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Ks(Ur),Ae(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Ze(i),null;case 13:if(Qs(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(n(340));hu()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return z(zr),null;case 4:return Ae(),null;case 10:return Ks(i.type),null;case 22:case 23:return Qs(i),vp(),s!==null&&z(qo),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Ks(Ur),null;case 25:return null;default:return null}}function j2(s,i){switch(np(i),i.tag){case 3:Ks(Ur),Ae();break;case 26:case 27:case 5:Ze(i);break;case 4:Ae();break;case 13:Qs(i);break;case 19:z(zr);break;case 10:Ks(i.type);break;case 22:case 23:Qs(i),vp(),s!==null&&z(qo);break;case 24:Ks(Ur)}}function Ru(s,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var v=f.next;c=v;do{if((c.tag&s)===s){f=void 0;var x=c.create,I=c.inst;f=x(),I.destroy=f}c=c.next}while(c!==v)}}catch(B){rr(i,i.return,B)}}function Di(s,i,c){try{var f=i.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var x=v.next;f=x;do{if((f.tag&s)===s){var I=f.inst,B=I.destroy;if(B!==void 0){I.destroy=void 0,v=i;var ae=c,pe=B;try{pe()}catch(Ce){rr(v,ae,Ce)}}}f=f.next}while(f!==x)}}catch(Ce){rr(i,i.return,Ce)}}function P2(s){var i=s.updateQueue;if(i!==null){var c=s.stateNode;try{T_(i,c)}catch(f){rr(s,s.return,f)}}}function F2(s,i,c){c.props=Yo(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){rr(s,i,f)}}function ku(s,i){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(v){rr(s,i,v)}}function _s(s,i){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(v){rr(s,i,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){rr(s,i,v)}else c.current=null}function L2(s){var i=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(v){rr(s,s.return,v)}}function qp(s,i,c){try{var f=s.stateNode;MC(f,s.type,c,i),f[ur]=i}catch(v){rr(s,s.return,v)}}function M2(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Vi(s.type)||s.tag===4}function $p(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||M2(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Vi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Yp(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(s),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Sd));else if(f!==4&&(f===27&&Vi(s.type)&&(c=s.stateNode,i=null),s=s.child,s!==null))for(Yp(s,i,c),s=s.sibling;s!==null;)Yp(s,i,c),s=s.sibling}function dd(s,i,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(f!==4&&(f===27&&Vi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(dd(s,i,c),s=s.sibling;s!==null;)dd(s,i,c),s=s.sibling}function B2(s){var i=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,v=i.attributes;v.length;)i.removeAttributeNode(v[0]);ln(i,f,c),i[Sr]=s,i[ur]=c}catch(x){rr(s,s.return,x)}}var ei=!1,Ar=!1,Wp=!1,V2=typeof WeakSet=="function"?WeakSet:Set,Jr=null;function xC(s,i){if(s=s.containerInfo,x1=Id,s=Qx(s),$m(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var v=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var I=0,B=-1,ae=-1,pe=0,Ce=0,Ie=s,xe=null;t:for(;;){for(var _e;Ie!==c||v!==0&&Ie.nodeType!==3||(B=I+v),Ie!==x||f!==0&&Ie.nodeType!==3||(ae=I+f),Ie.nodeType===3&&(I+=Ie.nodeValue.length),(_e=Ie.firstChild)!==null;)xe=Ie,Ie=_e;for(;;){if(Ie===s)break t;if(xe===c&&++pe===v&&(B=I),xe===x&&++Ce===f&&(ae=I),(_e=Ie.nextSibling)!==null)break;Ie=xe,xe=Ie.parentNode}Ie=_e}c=B===-1||ae===-1?null:{start:B,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(_1={focusedElem:s,selectionRange:c},Id=!1,Jr=i;Jr!==null;)if(i=Jr,s=i.child,(i.subtreeFlags&1024)!==0&&s!==null)s.return=i,Jr=s;else for(;Jr!==null;){switch(i=Jr,x=i.alternate,s=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,c=i,v=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var ut=Yo(c.type,v,c.elementType===c.type);s=f.getSnapshotBeforeUpdate(ut,x),f.__reactInternalSnapshotBeforeUpdate=s}catch(at){rr(c,c.return,at)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,c=s.nodeType,c===9)T1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":T1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=i.sibling,s!==null){s.return=i.return,Jr=s;break}Jr=i.return}}function U2(s,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Oi(s,c),f&4&&Ru(5,c);break;case 1:if(Oi(s,c),f&4)if(s=c.stateNode,i===null)try{s.componentDidMount()}catch(I){rr(c,c.return,I)}else{var v=Yo(c.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(v,i,s.__reactInternalSnapshotBeforeUpdate)}catch(I){rr(c,c.return,I)}}f&64&&P2(c),f&512&&ku(c,c.return);break;case 3:if(Oi(s,c),f&64&&(s=c.updateQueue,s!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{T_(s,i)}catch(I){rr(c,c.return,I)}}break;case 27:i===null&&f&4&&B2(c);case 26:case 5:Oi(s,c),i===null&&f&4&&L2(c),f&512&&ku(c,c.return);break;case 12:Oi(s,c);break;case 13:Oi(s,c),f&4&&G2(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=CC.bind(null,c),qC(s,c))));break;case 22:if(f=c.memoizedState!==null||ei,!f){i=i!==null&&i.memoizedState!==null||Ar,v=ei;var x=Ar;ei=f,(Ar=i)&&!x?ji(s,c,(c.subtreeFlags&8772)!==0):Oi(s,c),ei=v,Ar=x}break;case 30:break;default:Oi(s,c)}}function z2(s){var i=s.alternate;i!==null&&(s.alternate=null,z2(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&W(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var fr=null,Qn=!1;function ti(s,i,c){for(c=c.child;c!==null;)H2(s,i,c),c=c.sibling}function H2(s,i,c){if(Se&&typeof Se.onCommitFiberUnmount=="function")try{Se.onCommitFiberUnmount(It,c)}catch{}switch(c.tag){case 26:Ar||_s(c,i),ti(s,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ar||_s(c,i);var f=fr,v=Qn;Vi(c.type)&&(fr=c.stateNode,Qn=!1),ti(s,i,c),Bu(c.stateNode),fr=f,Qn=v;break;case 5:Ar||_s(c,i);case 6:if(f=fr,v=Qn,fr=null,ti(s,i,c),fr=f,Qn=v,fr!==null)if(Qn)try{(fr.nodeType===9?fr.body:fr.nodeName==="HTML"?fr.ownerDocument.body:fr).removeChild(c.stateNode)}catch(x){rr(c,i,x)}else try{fr.removeChild(c.stateNode)}catch(x){rr(c,i,x)}break;case 18:fr!==null&&(Qn?(s=fr,Iy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Yu(s)):Iy(fr,c.stateNode));break;case 4:f=fr,v=Qn,fr=c.stateNode.containerInfo,Qn=!0,ti(s,i,c),fr=f,Qn=v;break;case 0:case 11:case 14:case 15:Ar||Di(2,c,i),Ar||Di(4,c,i),ti(s,i,c);break;case 1:Ar||(_s(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&F2(c,i,f)),ti(s,i,c);break;case 21:ti(s,i,c);break;case 22:Ar=(f=Ar)||c.memoizedState!==null,ti(s,i,c),Ar=f;break;default:ti(s,i,c)}}function G2(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Yu(s)}catch(c){rr(i,i.return,c)}}function _C(s){switch(s.tag){case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new V2),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new V2),i;default:throw Error(n(435,s.tag))}}function Kp(s,i){var c=_C(s);i.forEach(function(f){var v=NC.bind(null,s,f);c.has(f)||(c.add(f),f.then(v,v))})}function oa(s,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var v=c[f],x=s,I=i,B=I;e:for(;B!==null;){switch(B.tag){case 27:if(Vi(B.type)){fr=B.stateNode,Qn=!1;break e}break;case 5:fr=B.stateNode,Qn=!1;break e;case 3:case 4:fr=B.stateNode.containerInfo,Qn=!0;break e}B=B.return}if(fr===null)throw Error(n(160));H2(x,I,v),fr=null,Qn=!1,x=v.alternate,x!==null&&(x.return=null),v.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)q2(i,s),i=i.sibling}var Va=null;function q2(s,i){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:oa(i,s),la(s),f&4&&(Di(3,s,s.return),Ru(3,s),Di(5,s,s.return));break;case 1:oa(i,s),la(s),f&512&&(Ar||c===null||_s(c,c.return)),f&64&&ei&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var v=Va;if(oa(i,s),la(s),f&512&&(Ar||c===null||_s(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(f){case"title":x=v.getElementsByTagName("title")[0],(!x||x[Y]||x[Sr]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=v.createElement(f),v.head.insertBefore(x,v.querySelector("head > title"))),ln(x,f,c),x[Sr]=s,ce(x),f=x;break e;case"link":var I=By("link","href",v).get(f+(c.href||""));if(I){for(var B=0;B<I.length;B++)if(x=I[B],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){I.splice(B,1);break t}}x=v.createElement(f),ln(x,f,c),v.head.appendChild(x);break;case"meta":if(I=By("meta","content",v).get(f+(c.content||""))){for(B=0;B<I.length;B++)if(x=I[B],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){I.splice(B,1);break t}}x=v.createElement(f),ln(x,f,c),v.head.appendChild(x);break;default:throw Error(n(468,f))}x[Sr]=s,ce(x),f=x}s.stateNode=f}else Vy(v,s.type,s.stateNode);else s.stateNode=My(v,f,s.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?Vy(v,s.type,s.stateNode):My(v,f,s.memoizedProps)):f===null&&s.stateNode!==null&&qp(s,s.memoizedProps,c.memoizedProps)}break;case 27:oa(i,s),la(s),f&512&&(Ar||c===null||_s(c,c.return)),c!==null&&f&4&&qp(s,s.memoizedProps,c.memoizedProps);break;case 5:if(oa(i,s),la(s),f&512&&(Ar||c===null||_s(c,c.return)),s.flags&32){v=s.stateNode;try{_a(v,"")}catch(_e){rr(s,s.return,_e)}}f&4&&s.stateNode!=null&&(v=s.memoizedProps,qp(s,v,c!==null?c.memoizedProps:v)),f&1024&&(Wp=!0);break;case 6:if(oa(i,s),la(s),f&4){if(s.stateNode===null)throw Error(n(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(_e){rr(s,s.return,_e)}}break;case 3:if(Nd=null,v=Va,Va=Ad(i.containerInfo),oa(i,s),Va=v,la(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Yu(i.containerInfo)}catch(_e){rr(s,s.return,_e)}Wp&&(Wp=!1,$2(s));break;case 4:f=Va,Va=Ad(s.stateNode.containerInfo),oa(i,s),la(s),Va=f;break;case 12:oa(i,s),la(s);break;case 13:oa(i,s),la(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(t1=je()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Kp(s,f)));break;case 22:v=s.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,pe=ei,Ce=Ar;if(ei=pe||v,Ar=Ce||ae,oa(i,s),Ar=Ce,ei=pe,la(s),f&8192)e:for(i=s.stateNode,i._visibility=v?i._visibility&-2:i._visibility|1,v&&(c===null||ae||ei||Ar||Wo(s)),c=null,i=s;;){if(i.tag===5||i.tag===26){if(c===null){ae=c=i;try{if(x=ae.stateNode,v)I=x.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{B=ae.stateNode;var Ie=ae.memoizedProps.style,xe=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;B.style.display=xe==null||typeof xe=="boolean"?"":(""+xe).trim()}}catch(_e){rr(ae,ae.return,_e)}}}else if(i.tag===6){if(c===null){ae=i;try{ae.stateNode.nodeValue=v?"":ae.memoizedProps}catch(_e){rr(ae,ae.return,_e)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Kp(s,c))));break;case 19:oa(i,s),la(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Kp(s,f)));break;case 30:break;case 21:break;default:oa(i,s),la(s)}}function la(s){var i=s.flags;if(i&2){try{for(var c,f=s.return;f!==null;){if(M2(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,x=$p(s);dd(s,x,v);break;case 5:var I=c.stateNode;c.flags&32&&(_a(I,""),c.flags&=-33);var B=$p(s);dd(s,B,I);break;case 3:case 4:var ae=c.stateNode.containerInfo,pe=$p(s);Yp(s,pe,ae);break;default:throw Error(n(161))}}catch(Ce){rr(s,s.return,Ce)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function $2(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;$2(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Oi(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)U2(s,i.alternate,i),i=i.sibling}function Wo(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Di(4,i,i.return),Wo(i);break;case 1:_s(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&F2(i,i.return,c),Wo(i);break;case 27:Bu(i.stateNode);case 26:case 5:_s(i,i.return),Wo(i);break;case 22:i.memoizedState===null&&Wo(i);break;case 30:Wo(i);break;default:Wo(i)}s=s.sibling}}function ji(s,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,v=s,x=i,I=x.flags;switch(x.tag){case 0:case 11:case 15:ji(v,x,c),Ru(4,x);break;case 1:if(ji(v,x,c),f=x,v=f.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(pe){rr(f,f.return,pe)}if(f=x,v=f.updateQueue,v!==null){var B=f.stateNode;try{var ae=v.shared.hiddenCallbacks;if(ae!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ae.length;v++)E_(ae[v],B)}catch(pe){rr(f,f.return,pe)}}c&&I&64&&P2(x),ku(x,x.return);break;case 27:B2(x);case 26:case 5:ji(v,x,c),c&&f===null&&I&4&&L2(x),ku(x,x.return);break;case 12:ji(v,x,c);break;case 13:ji(v,x,c),c&&I&4&&G2(v,x);break;case 22:x.memoizedState===null&&ji(v,x,c),ku(x,x.return);break;case 30:break;default:ji(v,x,c)}i=i.sibling}}function Xp(s,i){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&pu(c))}function Qp(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&pu(s))}function ys(s,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Y2(s,i,c,f),i=i.sibling}function Y2(s,i,c,f){var v=i.flags;switch(i.tag){case 0:case 11:case 15:ys(s,i,c,f),v&2048&&Ru(9,i);break;case 1:ys(s,i,c,f);break;case 3:ys(s,i,c,f),v&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&pu(s)));break;case 12:if(v&2048){ys(s,i,c,f),s=i.stateNode;try{var x=i.memoizedProps,I=x.id,B=x.onPostCommit;typeof B=="function"&&B(I,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ae){rr(i,i.return,ae)}}else ys(s,i,c,f);break;case 13:ys(s,i,c,f);break;case 23:break;case 22:x=i.stateNode,I=i.alternate,i.memoizedState!==null?x._visibility&2?ys(s,i,c,f):Iu(s,i):x._visibility&2?ys(s,i,c,f):(x._visibility|=2,Xl(s,i,c,f,(i.subtreeFlags&10256)!==0)),v&2048&&Xp(I,i);break;case 24:ys(s,i,c,f),v&2048&&Qp(i.alternate,i);break;default:ys(s,i,c,f)}}function Xl(s,i,c,f,v){for(v=v&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var x=s,I=i,B=c,ae=f,pe=I.flags;switch(I.tag){case 0:case 11:case 15:Xl(x,I,B,ae,v),Ru(8,I);break;case 23:break;case 22:var Ce=I.stateNode;I.memoizedState!==null?Ce._visibility&2?Xl(x,I,B,ae,v):Iu(x,I):(Ce._visibility|=2,Xl(x,I,B,ae,v)),v&&pe&2048&&Xp(I.alternate,I);break;case 24:Xl(x,I,B,ae,v),v&&pe&2048&&Qp(I.alternate,I);break;default:Xl(x,I,B,ae,v)}i=i.sibling}}function Iu(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=s,f=i,v=f.flags;switch(f.tag){case 22:Iu(c,f),v&2048&&Xp(f.alternate,f);break;case 24:Iu(c,f),v&2048&&Qp(f.alternate,f);break;default:Iu(c,f)}i=i.sibling}}var Du=8192;function Ql(s){if(s.subtreeFlags&Du)for(s=s.child;s!==null;)W2(s),s=s.sibling}function W2(s){switch(s.tag){case 26:Ql(s),s.flags&Du&&s.memoizedState!==null&&aN(Va,s.memoizedState,s.memoizedProps);break;case 5:Ql(s);break;case 3:case 4:var i=Va;Va=Ad(s.stateNode.containerInfo),Ql(s),Va=i;break;case 22:s.memoizedState===null&&(i=s.alternate,i!==null&&i.memoizedState!==null?(i=Du,Du=16777216,Ql(s),Du=i):Ql(s));break;default:Ql(s)}}function K2(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Ou(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];Jr=f,Q2(f,s)}K2(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)X2(s),s=s.sibling}function X2(s){switch(s.tag){case 0:case 11:case 15:Ou(s),s.flags&2048&&Di(9,s,s.return);break;case 3:Ou(s);break;case 12:Ou(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,md(s)):Ou(s);break;default:Ou(s)}}function md(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];Jr=f,Q2(f,s)}K2(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Di(8,i,i.return),md(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,md(i));break;default:md(i)}s=s.sibling}}function Q2(s,i){for(;Jr!==null;){var c=Jr;switch(c.tag){case 0:case 11:case 15:Di(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:pu(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,Jr=f;else e:for(c=s;Jr!==null;){f=Jr;var v=f.sibling,x=f.return;if(z2(f),f===c){Jr=null;break e}if(v!==null){v.return=x,Jr=v;break e}Jr=x}}}var yC={getCacheForType:function(s){var i=_n(Ur),c=i.data.get(s);return c===void 0&&(c=s(),i.data.set(s,c)),c}},EC=typeof WeakMap=="function"?WeakMap:Map,Kt=0,sr=null,bt=null,Ft=0,Xt=0,ca=null,Pi=!1,Jl=!1,Jp=!1,ri=0,_r=0,Fi=0,Ko=0,Zp=0,Na=0,Zl=0,ju=null,Jn=null,e1=!1,t1=0,pd=1/0,gd=null,Li=null,on=0,Mi=null,ec=null,tc=0,r1=0,n1=null,J2=null,Pu=0,a1=null;function ua(){if((Kt&2)!==0&&Ft!==0)return Ft&-Ft;if(ie.T!==null){var s=zl;return s!==0?s:f1()}return os()}function Z2(){Na===0&&(Na=(Ft&536870912)===0||$t?jn():536870912);var s=Ca.current;return s!==null&&(s.flags|=32),Na}function fa(s,i,c){(s===sr&&(Xt===2||Xt===9)||s.cancelPendingCommit!==null)&&(rc(s,0),Bi(s,Ft,Na,!1)),La(s,c),((Kt&2)===0||s!==sr)&&(s===sr&&((Kt&2)===0&&(Ko|=c),_r===4&&Bi(s,Ft,Na,!1)),Es(s))}function ey(s,i,c){if((Kt&6)!==0)throw Error(n(327));var f=!c&&(i&124)===0&&(i&s.expiredLanes)===0||qt(s,i),v=f?SC(s,i):o1(s,i,!0),x=f;do{if(v===0){Jl&&!f&&Bi(s,i,0,!1);break}else{if(c=s.current.alternate,x&&!TC(c)){v=o1(s,i,!1),x=!1;continue}if(v===2){if(x=i,s.errorRecoveryDisabledLanes&x)var I=0;else I=s.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){i=I;e:{var B=s;v=ju;var ae=B.current.memoizedState.isDehydrated;if(ae&&(rc(B,I).flags|=256),I=o1(B,I,!1),I!==2){if(Jp&&!ae){B.errorRecoveryDisabledLanes|=x,Ko|=x,v=4;break e}x=Jn,Jn=v,x!==null&&(Jn===null?Jn=x:Jn.push.apply(Jn,x))}v=I}if(x=!1,v!==2)continue}}if(v===1){rc(s,0),Bi(s,i,0,!0);break}e:{switch(f=s,x=v,x){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:Bi(f,i,Na,!Pi);break e;case 2:Jn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(v=t1+300-je(),10<v)){if(Bi(f,i,Na,!Pi),xn(f,0,!0)!==0)break e;f.timeoutHandle=Ry(ty.bind(null,f,c,Jn,gd,e1,i,Na,Ko,Zl,Pi,x,2,-0,0),v);break e}ty(f,c,Jn,gd,e1,i,Na,Ko,Zl,Pi,x,0,-0,0)}}break}while(!0);Es(s)}function ty(s,i,c,f,v,x,I,B,ae,pe,Ce,Ie,xe,_e){if(s.timeoutHandle=-1,Ie=i.subtreeFlags,(Ie&8192||(Ie&16785408)===16785408)&&(zu={stylesheets:null,count:0,unsuspend:nN},W2(i),Ie=sN(),Ie!==null)){s.cancelPendingCommit=Ie(ly.bind(null,s,i,x,c,f,v,I,B,ae,Ce,1,xe,_e)),Bi(s,x,I,!pe);return}ly(s,i,x,c,f,v,I,B,ae)}function TC(s){for(var i=s;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var v=c[f],x=v.getSnapshot;v=v.value;try{if(!sa(x(),v))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Bi(s,i,c,f){i&=~Zp,i&=~Ko,s.suspendedLanes|=i,s.pingedLanes&=~i,f&&(s.warmLanes|=i),f=s.expirationTimes;for(var v=i;0<v;){var x=31-Je(v),I=1<<x;f[x]=-1,v&=~I}c!==0&&xa(s,c,i)}function vd(){return(Kt&6)===0?(Fu(0),!1):!0}function s1(){if(bt!==null){if(Xt===0)var s=bt.return;else s=bt,Ws=Ho=null,Tp(s),Wl=null,Au=0,s=bt;for(;s!==null;)j2(s.alternate,s),s=s.return;bt=null}}function rc(s,i){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,VC(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),s1(),sr=s,bt=c=qs(s.current,null),Ft=i,Xt=0,ca=null,Pi=!1,Jl=qt(s,i),Jp=!1,Zl=Na=Zp=Ko=Fi=_r=0,Jn=ju=null,e1=!1,(i&8)!==0&&(i|=i&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=i;0<f;){var v=31-Je(f),x=1<<v;i|=s[v],f&=~x}return ri=i,Bh(),c}function ry(s,i){yt=null,ie.H=ad,i===vu||i===Wh?(i=__(),Xt=3):i===g_?(i=__(),Xt=4):Xt=i===y2?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,ca=i,bt===null&&(_r=1,cd(s,wa(i,s.current)))}function ny(){var s=ie.H;return ie.H=ad,s===null?ad:s}function ay(){var s=ie.A;return ie.A=yC,s}function i1(){_r=4,Pi||(Ft&4194048)!==Ft&&Ca.current!==null||(Jl=!0),(Fi&134217727)===0&&(Ko&134217727)===0||sr===null||Bi(sr,Ft,Na,!1)}function o1(s,i,c){var f=Kt;Kt|=2;var v=ny(),x=ay();(sr!==s||Ft!==i)&&(gd=null,rc(s,i)),i=!1;var I=_r;e:do try{if(Xt!==0&&bt!==null){var B=bt,ae=ca;switch(Xt){case 8:s1(),I=6;break e;case 3:case 2:case 9:case 6:Ca.current===null&&(i=!0);var pe=Xt;if(Xt=0,ca=null,nc(s,B,ae,pe),c&&Jl){I=0;break e}break;default:pe=Xt,Xt=0,ca=null,nc(s,B,ae,pe)}}wC(),I=_r;break}catch(Ce){ry(s,Ce)}while(!0);return i&&s.shellSuspendCounter++,Ws=Ho=null,Kt=f,ie.H=v,ie.A=x,bt===null&&(sr=null,Ft=0,Bh()),I}function wC(){for(;bt!==null;)sy(bt)}function SC(s,i){var c=Kt;Kt|=2;var f=ny(),v=ay();sr!==s||Ft!==i?(gd=null,pd=je()+500,rc(s,i)):Jl=qt(s,i);e:do try{if(Xt!==0&&bt!==null){i=bt;var x=ca;t:switch(Xt){case 1:Xt=0,ca=null,nc(s,i,x,1);break;case 2:case 9:if(v_(x)){Xt=0,ca=null,iy(i);break}i=function(){Xt!==2&&Xt!==9||sr!==s||(Xt=7),Es(s)},x.then(i,i);break e;case 3:Xt=7;break e;case 4:Xt=5;break e;case 7:v_(x)?(Xt=0,ca=null,iy(i)):(Xt=0,ca=null,nc(s,i,x,7));break;case 5:var I=null;switch(bt.tag){case 26:I=bt.memoizedState;case 5:case 27:var B=bt;if(!I||Uy(I)){Xt=0,ca=null;var ae=B.sibling;if(ae!==null)bt=ae;else{var pe=B.return;pe!==null?(bt=pe,xd(pe)):bt=null}break t}}Xt=0,ca=null,nc(s,i,x,5);break;case 6:Xt=0,ca=null,nc(s,i,x,6);break;case 8:s1(),_r=6;break e;default:throw Error(n(462))}}bC();break}catch(Ce){ry(s,Ce)}while(!0);return Ws=Ho=null,ie.H=f,ie.A=v,Kt=c,bt!==null?0:(sr=null,Ft=0,Bh(),_r)}function bC(){for(;bt!==null&&!lt();)sy(bt)}function sy(s){var i=D2(s.alternate,s,ri);s.memoizedProps=s.pendingProps,i===null?xd(s):bt=i}function iy(s){var i=s,c=i.alternate;switch(i.tag){case 15:case 0:i=A2(c,i,i.pendingProps,i.type,void 0,Ft);break;case 11:i=A2(c,i,i.pendingProps,i.type.render,i.ref,Ft);break;case 5:Tp(i);default:j2(c,i),i=bt=o_(i,ri),i=D2(c,i,ri)}s.memoizedProps=s.pendingProps,i===null?xd(s):bt=i}function nc(s,i,c,f){Ws=Ho=null,Tp(i),Wl=null,Au=0;var v=i.return;try{if(mC(s,v,i,c,Ft)){_r=1,cd(s,wa(c,s.current)),bt=null;return}}catch(x){if(v!==null)throw bt=v,x;_r=1,cd(s,wa(c,s.current)),bt=null;return}i.flags&32768?($t||f===1?s=!0:Jl||(Ft&536870912)!==0?s=!1:(Pi=s=!0,(f===2||f===9||f===3||f===6)&&(f=Ca.current,f!==null&&f.tag===13&&(f.flags|=16384))),oy(i,s)):xd(i)}function xd(s){var i=s;do{if((i.flags&32768)!==0){oy(i,Pi);return}s=i.return;var c=gC(i.alternate,i,ri);if(c!==null){bt=c;return}if(i=i.sibling,i!==null){bt=i;return}bt=i=s}while(i!==null);_r===0&&(_r=5)}function oy(s,i){do{var c=vC(s.alternate,s);if(c!==null){c.flags&=32767,bt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(s=s.sibling,s!==null)){bt=s;return}bt=s=c}while(s!==null);_r=6,bt=null}function ly(s,i,c,f,v,x,I,B,ae){s.cancelPendingCommit=null;do _d();while(on!==0);if((Kt&6)!==0)throw Error(n(327));if(i!==null){if(i===s.current)throw Error(n(177));if(x=i.lanes|i.childLanes,x|=Qm,ss(s,c,x,I,B,ae),s===sr&&(bt=sr=null,Ft=0),ec=i,Mi=s,tc=c,r1=x,n1=v,J2=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,RC(tr,function(){return dy(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=ie.T,ie.T=null,v=me.p,me.p=2,I=Kt,Kt|=4;try{xC(s,i,c)}finally{Kt=I,me.p=v,ie.T=f}}on=1,cy(),uy(),fy()}}function cy(){if(on===1){on=0;var s=Mi,i=ec,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var f=me.p;me.p=2;var v=Kt;Kt|=4;try{q2(i,s);var x=_1,I=Qx(s.containerInfo),B=x.focusedElem,ae=x.selectionRange;if(I!==B&&B&&B.ownerDocument&&Xx(B.ownerDocument.documentElement,B)){if(ae!==null&&$m(B)){var pe=ae.start,Ce=ae.end;if(Ce===void 0&&(Ce=pe),"selectionStart"in B)B.selectionStart=pe,B.selectionEnd=Math.min(Ce,B.value.length);else{var Ie=B.ownerDocument||document,xe=Ie&&Ie.defaultView||window;if(xe.getSelection){var _e=xe.getSelection(),ut=B.textContent.length,at=Math.min(ae.start,ut),er=ae.end===void 0?at:Math.min(ae.end,ut);!_e.extend&&at>er&&(I=er,er=at,at=I);var le=Kx(B,at),se=Kx(B,er);if(le&&se&&(_e.rangeCount!==1||_e.anchorNode!==le.node||_e.anchorOffset!==le.offset||_e.focusNode!==se.node||_e.focusOffset!==se.offset)){var he=Ie.createRange();he.setStart(le.node,le.offset),_e.removeAllRanges(),at>er?(_e.addRange(he),_e.extend(se.node,se.offset)):(he.setEnd(se.node,se.offset),_e.addRange(he))}}}}for(Ie=[],_e=B;_e=_e.parentNode;)_e.nodeType===1&&Ie.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Ie.length;B++){var ke=Ie[B];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Id=!!x1,_1=x1=null}finally{Kt=v,me.p=f,ie.T=c}}s.current=i,on=2}}function uy(){if(on===2){on=0;var s=Mi,i=ec,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var f=me.p;me.p=2;var v=Kt;Kt|=4;try{U2(s,i.alternate,i)}finally{Kt=v,me.p=f,ie.T=c}}on=3}}function fy(){if(on===4||on===3){on=0,Fe();var s=Mi,i=ec,c=tc,f=J2;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?on=5:(on=0,ec=Mi=null,hy(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(Li=null),Ti(c),i=i.stateNode,Se&&typeof Se.onCommitFiberRoot=="function")try{Se.onCommitFiberRoot(It,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=ie.T,v=me.p,me.p=2,ie.T=null;try{for(var x=s.onRecoverableError,I=0;I<f.length;I++){var B=f[I];x(B.value,{componentStack:B.stack})}}finally{ie.T=i,me.p=v}}(tc&3)!==0&&_d(),Es(s),v=s.pendingLanes,(c&4194090)!==0&&(v&42)!==0?s===a1?Pu++:(Pu=0,a1=s):Pu=0,Fu(0)}}function hy(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,pu(i)))}function _d(s){return cy(),uy(),fy(),dy()}function dy(){if(on!==5)return!1;var s=Mi,i=r1;r1=0;var c=Ti(tc),f=ie.T,v=me.p;try{me.p=32>c?32:c,ie.T=null,c=n1,n1=null;var x=Mi,I=tc;if(on=0,ec=Mi=null,tc=0,(Kt&6)!==0)throw Error(n(331));var B=Kt;if(Kt|=4,X2(x.current),Y2(x,x.current,I,c),Kt=B,Fu(0,!1),Se&&typeof Se.onPostCommitFiberRoot=="function")try{Se.onPostCommitFiberRoot(It,x)}catch{}return!0}finally{me.p=v,ie.T=f,hy(s,i)}}function my(s,i,c){i=wa(c,i),i=Fp(s.stateNode,i,2),s=Ni(s,i,2),s!==null&&(La(s,2),Es(s))}function rr(s,i,c){if(s.tag===3)my(s,s,c);else for(;i!==null;){if(i.tag===3){my(i,s,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Li===null||!Li.has(f))){s=wa(c,s),c=x2(2),f=Ni(i,c,2),f!==null&&(_2(c,f,i,s),La(f,2),Es(f));break}}i=i.return}}function l1(s,i,c){var f=s.pingCache;if(f===null){f=s.pingCache=new EC;var v=new Set;f.set(i,v)}else v=f.get(i),v===void 0&&(v=new Set,f.set(i,v));v.has(c)||(Jp=!0,v.add(c),s=AC.bind(null,s,i,c),i.then(s,s))}function AC(s,i,c){var f=s.pingCache;f!==null&&f.delete(i),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,sr===s&&(Ft&c)===c&&(_r===4||_r===3&&(Ft&62914560)===Ft&&300>je()-t1?(Kt&2)===0&&rc(s,0):Zp|=c,Zl===Ft&&(Zl=0)),Es(s)}function py(s,i){i===0&&(i=Fa()),s=Ml(s,i),s!==null&&(La(s,i),Es(s))}function CC(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),py(s,c)}function NC(s,i){var c=0;switch(s.tag){case 13:var f=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(i),py(s,c)}function RC(s,i){return Ct(s,i)}var yd=null,ac=null,c1=!1,Ed=!1,u1=!1,Xo=0;function Es(s){s!==ac&&s.next===null&&(ac===null?yd=ac=s:ac=ac.next=s),Ed=!0,c1||(c1=!0,IC())}function Fu(s,i){if(!u1&&Ed){u1=!0;do for(var c=!1,f=yd;f!==null;){if(s!==0){var v=f.pendingLanes;if(v===0)var x=0;else{var I=f.suspendedLanes,B=f.pingedLanes;x=(1<<31-Je(42|s)+1)-1,x&=v&~(I&~B),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,_y(f,x))}else x=Ft,x=xn(f,f===sr?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||qt(f,x)||(c=!0,_y(f,x));f=f.next}while(c);u1=!1}}function kC(){gy()}function gy(){Ed=c1=!1;var s=0;Xo!==0&&(BC()&&(s=Xo),Xo=0);for(var i=je(),c=null,f=yd;f!==null;){var v=f.next,x=vy(f,i);x===0?(f.next=null,c===null?yd=v:c.next=v,v===null&&(ac=c)):(c=f,(s!==0||(x&3)!==0)&&(Ed=!0)),f=v}Fu(s)}function vy(s,i){for(var c=s.suspendedLanes,f=s.pingedLanes,v=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var I=31-Je(x),B=1<<I,ae=v[I];ae===-1?((B&c)===0||(B&f)!==0)&&(v[I]=ra(B,i)):ae<=i&&(s.expiredLanes|=B),x&=~B}if(i=sr,c=Ft,c=xn(s,s===i?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===i&&(Xt===2||Xt===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&We(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||qt(s,c)){if(i=c&-c,i===s.callbackPriority)return i;switch(f!==null&&We(f),Ti(c)){case 2:case 8:c=Rr;break;case 32:c=tr;break;case 268435456:c=lr;break;default:c=tr}return f=xy.bind(null,s),c=Ct(c,f),s.callbackPriority=i,s.callbackNode=c,i}return f!==null&&f!==null&&We(f),s.callbackPriority=2,s.callbackNode=null,2}function xy(s,i){if(on!==0&&on!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(_d()&&s.callbackNode!==c)return null;var f=Ft;return f=xn(s,s===sr?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(ey(s,f,i),vy(s,je()),s.callbackNode!=null&&s.callbackNode===c?xy.bind(null,s):null)}function _y(s,i){if(_d())return null;ey(s,i,!0)}function IC(){UC(function(){(Kt&6)!==0?Ct(Tr,kC):gy()})}function f1(){return Xo===0&&(Xo=jn()),Xo}function yy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Al(""+s)}function Ey(s,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,s.id&&c.setAttribute("form",s.id),i.parentNode.insertBefore(c,i),s=new FormData(s),c.parentNode.removeChild(c),s}function DC(s,i,c,f,v){if(i==="submit"&&c&&c.stateNode===v){var x=yy((v[ur]||null).action),I=f.submitter;I&&(i=(i=I[ur]||null)?yy(i.formAction):I.getAttribute("formAction"),i!==null&&(x=i,I=null));var B=new Cl("action","action",null,f,v);s.push({event:B,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Xo!==0){var ae=I?Ey(v,I):new FormData(v);Ip(c,{pending:!0,data:ae,method:v.method,action:x},null,ae)}}else typeof x=="function"&&(B.preventDefault(),ae=I?Ey(v,I):new FormData(v),Ip(c,{pending:!0,data:ae,method:v.method,action:x},x,ae))},currentTarget:v}]})}}for(var h1=0;h1<Xm.length;h1++){var d1=Xm[h1],OC=d1.toLowerCase(),jC=d1[0].toUpperCase()+d1.slice(1);Ba(OC,"on"+jC)}Ba(e_,"onAnimationEnd"),Ba(t_,"onAnimationIteration"),Ba(r_,"onAnimationStart"),Ba("dblclick","onDoubleClick"),Ba("focusin","onFocus"),Ba("focusout","onBlur"),Ba(Q3,"onTransitionRun"),Ba(J3,"onTransitionStart"),Ba(Z3,"onTransitionCancel"),Ba(n_,"onTransitionEnd"),Be("onMouseEnter",["mouseout","mouseover"]),Be("onMouseLeave",["mouseout","mouseover"]),Be("onPointerEnter",["pointerout","pointerover"]),Be("onPointerLeave",["pointerout","pointerover"]),Oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Lu));function Ty(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],v=f.event;f=f.listeners;e:{var x=void 0;if(i)for(var I=f.length-1;0<=I;I--){var B=f[I],ae=B.instance,pe=B.currentTarget;if(B=B.listener,ae!==x&&v.isPropagationStopped())break e;x=B,v.currentTarget=pe;try{x(v)}catch(Ce){ld(Ce)}v.currentTarget=null,x=ae}else for(I=0;I<f.length;I++){if(B=f[I],ae=B.instance,pe=B.currentTarget,B=B.listener,ae!==x&&v.isPropagationStopped())break e;x=B,v.currentTarget=pe;try{x(v)}catch(Ce){ld(Ce)}v.currentTarget=null,x=ae}}}}function At(s,i){var c=i[So];c===void 0&&(c=i[So]=new Set);var f=s+"__bubble";c.has(f)||(wy(i,s,2,!1),c.add(f))}function m1(s,i,c){var f=0;i&&(f|=4),wy(c,s,f,i)}var Td="_reactListening"+Math.random().toString(36).slice(2);function p1(s){if(!s[Td]){s[Td]=!0,ge.forEach(function(c){c!=="selectionchange"&&(PC.has(c)||m1(c,!1,s),m1(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Td]||(i[Td]=!0,m1("selectionchange",!1,i))}}function wy(s,i,c,f){switch(Yy(i)){case 2:var v=lN;break;case 8:v=cN;break;default:v=R1}c=v.bind(null,i,c,s),v=void 0,!Ea||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(v=!0),f?v!==void 0?s.addEventListener(i,c,{capture:!0,passive:v}):s.addEventListener(i,c,!0):v!==void 0?s.addEventListener(i,c,{passive:v}):s.addEventListener(i,c,!1)}function g1(s,i,c,f,v){var x=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var I=f.tag;if(I===3||I===4){var B=f.stateNode.containerInfo;if(B===v)break;if(I===4)for(I=f.return;I!==null;){var ae=I.tag;if((ae===3||ae===4)&&I.stateNode.containerInfo===v)return;I=I.return}for(;B!==null;){if(I=J(B),I===null)return;if(ae=I.tag,ae===5||ae===6||ae===26||ae===27){f=x=I;continue e}B=B.parentNode}}f=f.return}Sh(function(){var pe=x,Ce=ya(c),Ie=[];e:{var xe=a_.get(s);if(xe!==void 0){var _e=Cl,ut=s;switch(s){case"keypress":if(hs(c)===0)break e;case"keydown":case"keyup":_e=Ol;break;case"focusin":ut="focus",_e=kl;break;case"focusout":ut="blur",_e=kl;break;case"beforeblur":case"afterblur":_e=kl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Ta;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=zm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=Dh;break;case e_:case t_:case r_:_e=Il;break;case n_:_e=jh;break;case"scroll":case"scrollend":_e=bh;break;case"wheel":_e=jl;break;case"copy":case"cut":case"paste":_e=Dl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=ou;break;case"toggle":case"beforetoggle":_e=Fh}var at=(i&4)!==0,er=!at&&(s==="scroll"||s==="scrollend"),le=at?xe!==null?xe+"Capture":null:xe;at=[];for(var se=pe,he;se!==null;){var ke=se;if(he=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||he===null||le===null||(ke=Ro(se,le),ke!=null&&at.push(Mu(se,ke,he))),er)break;se=se.return}0<at.length&&(xe=new _e(xe,ut,null,c,Ce),Ie.push({event:xe,listeners:at}))}}if((i&7)===0){e:{if(xe=s==="mouseover"||s==="pointerover",_e=s==="mouseout"||s==="pointerout",xe&&c!==Bs&&(ut=c.relatedTarget||c.fromElement)&&(J(ut)||ut[Wn]))break e;if((_e||xe)&&(xe=Ce.window===Ce?Ce:(xe=Ce.ownerDocument)?xe.defaultView||xe.parentWindow:window,_e?(ut=c.relatedTarget||c.toElement,_e=pe,ut=ut?J(ut):null,ut!==null&&(er=o(ut),at=ut.tag,ut!==er||at!==5&&at!==27&&at!==6)&&(ut=null)):(_e=null,ut=pe),_e!==ut)){if(at=Ta,ke="onMouseLeave",le="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(at=ou,ke="onPointerLeave",le="onPointerEnter",se="pointer"),er=_e==null?xe:de(_e),he=ut==null?xe:de(ut),xe=new at(ke,se+"leave",_e,c,Ce),xe.target=er,xe.relatedTarget=he,ke=null,J(Ce)===pe&&(at=new at(le,se+"enter",ut,c,Ce),at.target=he,at.relatedTarget=er,ke=at),er=ke,_e&&ut)t:{for(at=_e,le=ut,se=0,he=at;he;he=sc(he))se++;for(he=0,ke=le;ke;ke=sc(ke))he++;for(;0<se-he;)at=sc(at),se--;for(;0<he-se;)le=sc(le),he--;for(;se--;){if(at===le||le!==null&&at===le.alternate)break t;at=sc(at),le=sc(le)}at=null}else at=null;_e!==null&&Sy(Ie,xe,_e,at,!1),ut!==null&&er!==null&&Sy(Ie,er,ut,at,!0)}}e:{if(xe=pe?de(pe):window,_e=xe.nodeName&&xe.nodeName.toLowerCase(),_e==="select"||_e==="input"&&xe.type==="file")var Xe=Hx;else if(Vr(xe))if(Gx)Xe=W3;else{Xe=$3;var Tt=q3}else _e=xe.nodeName,!_e||_e.toLowerCase()!=="input"||xe.type!=="checkbox"&&xe.type!=="radio"?pe&&eu(pe.elementType)&&(Xe=Hx):Xe=Y3;if(Xe&&(Xe=Xe(s,pe))){Gs(Ie,Xe,c,Ce);break e}Tt&&Tt(s,xe,pe),s==="focusout"&&pe&&xe.type==="number"&&pe.memoizedProps.value!=null&&wi(xe,"number",xe.value)}switch(Tt=pe?de(pe):window,s){case"focusin":(Vr(Tt)||Tt.contentEditable==="true")&&(Pl=Tt,Ym=pe,uu=null);break;case"focusout":uu=Ym=Pl=null;break;case"mousedown":Wm=!0;break;case"contextmenu":case"mouseup":case"dragend":Wm=!1,Jx(Ie,c,Ce);break;case"selectionchange":if(X3)break;case"keydown":case"keyup":Jx(Ie,c,Ce)}var et;if(ps)e:{switch(s){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else jt?we(s,c)&&(st="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(st="onCompositionStart");st&&(k&&c.locale!=="ko"&&(jt||st!=="onCompositionStart"?st==="onCompositionEnd"&&jt&&(et=ru()):(fs=Ce,Si="value"in fs?fs.value:fs.textContent,jt=!0)),Tt=wd(pe,st),0<Tt.length&&(st=new su(st,s,null,c,Ce),Ie.push({event:st,listeners:Tt}),et?st.data=et:(et=He(c),et!==null&&(st.data=et)))),(et=w?Br(s,c):Pt(s,c))&&(st=wd(pe,"onBeforeInput"),0<st.length&&(Tt=new su("onBeforeInput","beforeinput",null,c,Ce),Ie.push({event:Tt,listeners:st}),Tt.data=et)),DC(Ie,s,pe,c,Ce)}Ty(Ie,i)})}function Mu(s,i,c){return{instance:s,listener:i,currentTarget:c}}function wd(s,i){for(var c=i+"Capture",f=[];s!==null;){var v=s,x=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||x===null||(v=Ro(s,c),v!=null&&f.unshift(Mu(s,v,x)),v=Ro(s,i),v!=null&&f.push(Mu(s,v,x))),s.tag===3)return f;s=s.return}return[]}function sc(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Sy(s,i,c,f,v){for(var x=i._reactName,I=[];c!==null&&c!==f;){var B=c,ae=B.alternate,pe=B.stateNode;if(B=B.tag,ae!==null&&ae===f)break;B!==5&&B!==26&&B!==27||pe===null||(ae=pe,v?(pe=Ro(c,x),pe!=null&&I.unshift(Mu(c,pe,ae))):v||(pe=Ro(c,x),pe!=null&&I.push(Mu(c,pe,ae)))),c=c.return}I.length!==0&&s.push({event:i,listeners:I})}var FC=/\r\n?/g,LC=/\u0000|\uFFFD/g;function by(s){return(typeof s=="string"?s:""+s).replace(FC,`
`).replace(LC,"")}function Ay(s,i){return i=by(i),by(s)===i}function Sd(){}function Zt(s,i,c,f,v,x){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||_a(s,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&_a(s,""+f);break;case"className":Dt(s,"class",f);break;case"tabIndex":Dt(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Dt(s,c,f);break;case"style":Zc(s,f,x);break;case"data":if(i!=="object"){Dt(s,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=Al(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(i!=="input"&&Zt(s,i,"name",v.name,v,null),Zt(s,i,"formEncType",v.formEncType,v,null),Zt(s,i,"formMethod",v.formMethod,v,null),Zt(s,i,"formTarget",v.formTarget,v,null)):(Zt(s,i,"encType",v.encType,v,null),Zt(s,i,"method",v.method,v,null),Zt(s,i,"target",v.target,v,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=Al(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=Sd);break;case"onScroll":f!=null&&At("scroll",s);break;case"onScrollEnd":f!=null&&At("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=Al(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":At("beforetoggle",s),At("toggle",s),Ht(s,"popover",f);break;case"xlinkActuate":Ot(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ot(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ot(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ot(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ot(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ot(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ot(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Ht(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Vm.get(c)||c,Ht(s,c,f))}}function v1(s,i,c,f,v,x){switch(c){case"style":Zc(s,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof f=="string"?_a(s,f):(typeof f=="number"||typeof f=="bigint")&&_a(s,""+f);break;case"onScroll":f!=null&&At("scroll",s);break;case"onScrollEnd":f!=null&&At("scrollend",s);break;case"onClick":f!=null&&(s.onclick=Sd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ve.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),i=c.slice(2,v?c.length-7:void 0),x=s[ur]||null,x=x!=null?x[c]:null,typeof x=="function"&&s.removeEventListener(i,x,v),typeof f=="function")){typeof x!="function"&&x!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(i,f,v);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):Ht(s,c,f)}}}function ln(s,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":At("error",s),At("load",s);var f=!1,v=!1,x;for(x in c)if(c.hasOwnProperty(x)){var I=c[x];if(I!=null)switch(x){case"src":f=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Zt(s,i,x,I,c,null)}}v&&Zt(s,i,"srcSet",c.srcSet,c,null),f&&Zt(s,i,"src",c.src,c,null);return;case"input":At("invalid",s);var B=x=I=v=null,ae=null,pe=null;for(f in c)if(c.hasOwnProperty(f)){var Ce=c[f];if(Ce!=null)switch(f){case"name":v=Ce;break;case"type":I=Ce;break;case"checked":ae=Ce;break;case"defaultChecked":pe=Ce;break;case"value":x=Ce;break;case"defaultValue":B=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(n(137,i));break;default:Zt(s,i,f,Ce,c,null)}}Ao(s,x,B,ae,pe,I,v,!1),bl(s);return;case"select":At("invalid",s),f=I=x=null;for(v in c)if(c.hasOwnProperty(v)&&(B=c[v],B!=null))switch(v){case"value":x=B;break;case"defaultValue":I=B;break;case"multiple":f=B;default:Zt(s,i,v,B,c,null)}i=x,c=I,s.multiple=!!f,i!=null?Ms(s,!!f,i,!1):c!=null&&Ms(s,!!f,c,!0);return;case"textarea":At("invalid",s),x=v=f=null;for(I in c)if(c.hasOwnProperty(I)&&(B=c[I],B!=null))switch(I){case"value":f=B;break;case"defaultValue":v=B;break;case"children":x=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:Zt(s,i,I,B,c,null)}Co(s,f,v,x),bl(s);return;case"option":for(ae in c)if(c.hasOwnProperty(ae)&&(f=c[ae],f!=null))switch(ae){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Zt(s,i,ae,f,c,null)}return;case"dialog":At("beforetoggle",s),At("toggle",s),At("cancel",s),At("close",s);break;case"iframe":case"object":At("load",s);break;case"video":case"audio":for(f=0;f<Lu.length;f++)At(Lu[f],s);break;case"image":At("error",s),At("load",s);break;case"details":At("toggle",s);break;case"embed":case"source":case"link":At("error",s),At("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(f=c[pe],f!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Zt(s,i,pe,f,c,null)}return;default:if(eu(i)){for(Ce in c)c.hasOwnProperty(Ce)&&(f=c[Ce],f!==void 0&&v1(s,i,Ce,f,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(f=c[B],f!=null&&Zt(s,i,B,f,c,null))}function MC(s,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,x=null,I=null,B=null,ae=null,pe=null,Ce=null;for(_e in c){var Ie=c[_e];if(c.hasOwnProperty(_e)&&Ie!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":ae=Ie;default:f.hasOwnProperty(_e)||Zt(s,i,_e,null,f,Ie)}}for(var xe in f){var _e=f[xe];if(Ie=c[xe],f.hasOwnProperty(xe)&&(_e!=null||Ie!=null))switch(xe){case"type":x=_e;break;case"name":v=_e;break;case"checked":pe=_e;break;case"defaultChecked":Ce=_e;break;case"value":I=_e;break;case"defaultValue":B=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,i));break;default:_e!==Ie&&Zt(s,i,xe,_e,f,Ie)}}aa(s,I,B,ae,pe,Ce,x,v);return;case"select":_e=I=B=xe=null;for(x in c)if(ae=c[x],c.hasOwnProperty(x)&&ae!=null)switch(x){case"value":break;case"multiple":_e=ae;default:f.hasOwnProperty(x)||Zt(s,i,x,null,f,ae)}for(v in f)if(x=f[v],ae=c[v],f.hasOwnProperty(v)&&(x!=null||ae!=null))switch(v){case"value":xe=x;break;case"defaultValue":B=x;break;case"multiple":I=x;default:x!==ae&&Zt(s,i,v,x,f,ae)}i=B,c=I,f=_e,xe!=null?Ms(s,!!c,xe,!1):!!f!=!!c&&(i!=null?Ms(s,!!c,i,!0):Ms(s,!!c,c?[]:"",!1));return;case"textarea":_e=xe=null;for(B in c)if(v=c[B],c.hasOwnProperty(B)&&v!=null&&!f.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Zt(s,i,B,null,f,v)}for(I in f)if(v=f[I],x=c[I],f.hasOwnProperty(I)&&(v!=null||x!=null))switch(I){case"value":xe=v;break;case"defaultValue":_e=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==x&&Zt(s,i,I,v,f,x)}Qt(s,xe,_e);return;case"option":for(var ut in c)if(xe=c[ut],c.hasOwnProperty(ut)&&xe!=null&&!f.hasOwnProperty(ut))switch(ut){case"selected":s.selected=!1;break;default:Zt(s,i,ut,null,f,xe)}for(ae in f)if(xe=f[ae],_e=c[ae],f.hasOwnProperty(ae)&&xe!==_e&&(xe!=null||_e!=null))switch(ae){case"selected":s.selected=xe&&typeof xe!="function"&&typeof xe!="symbol";break;default:Zt(s,i,ae,xe,f,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var at in c)xe=c[at],c.hasOwnProperty(at)&&xe!=null&&!f.hasOwnProperty(at)&&Zt(s,i,at,null,f,xe);for(pe in f)if(xe=f[pe],_e=c[pe],f.hasOwnProperty(pe)&&xe!==_e&&(xe!=null||_e!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(n(137,i));break;default:Zt(s,i,pe,xe,f,_e)}return;default:if(eu(i)){for(var er in c)xe=c[er],c.hasOwnProperty(er)&&xe!==void 0&&!f.hasOwnProperty(er)&&v1(s,i,er,void 0,f,xe);for(Ce in f)xe=f[Ce],_e=c[Ce],!f.hasOwnProperty(Ce)||xe===_e||xe===void 0&&_e===void 0||v1(s,i,Ce,xe,f,_e);return}}for(var le in c)xe=c[le],c.hasOwnProperty(le)&&xe!=null&&!f.hasOwnProperty(le)&&Zt(s,i,le,null,f,xe);for(Ie in f)xe=f[Ie],_e=c[Ie],!f.hasOwnProperty(Ie)||xe===_e||xe==null&&_e==null||Zt(s,i,Ie,xe,f,_e)}var x1=null,_1=null;function bd(s){return s.nodeType===9?s:s.ownerDocument}function Cy(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ny(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function y1(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var E1=null;function BC(){var s=window.event;return s&&s.type==="popstate"?s===E1?!1:(E1=s,!0):(E1=null,!1)}var Ry=typeof setTimeout=="function"?setTimeout:void 0,VC=typeof clearTimeout=="function"?clearTimeout:void 0,ky=typeof Promise=="function"?Promise:void 0,UC=typeof queueMicrotask=="function"?queueMicrotask:typeof ky<"u"?function(s){return ky.resolve(null).then(s).catch(zC)}:Ry;function zC(s){setTimeout(function(){throw s})}function Vi(s){return s==="head"}function Iy(s,i){var c=i,f=0,v=0;do{var x=c.nextSibling;if(s.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<f&&8>f){c=f;var I=s.ownerDocument;if(c&1&&Bu(I.documentElement),c&2&&Bu(I.body),c&4)for(c=I.head,Bu(c),I=c.firstChild;I;){var B=I.nextSibling,ae=I.nodeName;I[Y]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&I.rel.toLowerCase()==="stylesheet"||c.removeChild(I),I=B}}if(v===0){s.removeChild(x),Yu(i);return}v--}else c==="$"||c==="$?"||c==="$!"?v++:f=c.charCodeAt(0)-48;else f=0;c=x}while(c);Yu(i)}function T1(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":T1(c),W(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function HC(s,i,c,f){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[Y])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var x=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=Ua(s.nextSibling),s===null)break}return null}function GC(s,i,c){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ua(s.nextSibling),s===null))return null;return s}function w1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function qC(s,i){var c=s.ownerDocument;if(s.data!=="$?"||c.readyState==="complete")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Ua(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return s}var S1=null;function Dy(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}function Oy(s,i,c){switch(i=bd(c),s){case"html":if(s=i.documentElement,!s)throw Error(n(452));return s;case"head":if(s=i.head,!s)throw Error(n(453));return s;case"body":if(s=i.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Bu(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);W(s)}var Ra=new Map,jy=new Set;function Ad(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ni=me.d;me.d={f:$C,r:YC,D:WC,C:KC,L:XC,m:QC,X:ZC,S:JC,M:eN};function $C(){var s=ni.f(),i=vd();return s||i}function YC(s){var i=te(s);i!==null&&i.tag===5&&i.type==="form"?e2(i):ni.r(s)}var ic=typeof document>"u"?null:document;function Py(s,i,c){var f=ic;if(f&&typeof i=="string"&&i){var v=kr(i);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),jy.has(v)||(jy.add(v),s={rel:s,crossOrigin:c,href:i},f.querySelector(v)===null&&(i=f.createElement("link"),ln(i,"link",s),ce(i),f.head.appendChild(i)))}}function WC(s){ni.D(s),Py("dns-prefetch",s,null)}function KC(s,i){ni.C(s,i),Py("preconnect",s,i)}function XC(s,i,c){ni.L(s,i,c);var f=ic;if(f&&s&&i){var v='link[rel="preload"][as="'+kr(i)+'"]';i==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+kr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+kr(c.imageSizes)+'"]')):v+='[href="'+kr(s)+'"]';var x=v;switch(i){case"style":x=oc(s);break;case"script":x=lc(s)}Ra.has(x)||(s=g({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:s,as:i},c),Ra.set(x,s),f.querySelector(v)!==null||i==="style"&&f.querySelector(Vu(x))||i==="script"&&f.querySelector(Uu(x))||(i=f.createElement("link"),ln(i,"link",s),ce(i),f.head.appendChild(i)))}}function QC(s,i){ni.m(s,i);var c=ic;if(c&&s){var f=i&&typeof i.as=="string"?i.as:"script",v='link[rel="modulepreload"][as="'+kr(f)+'"][href="'+kr(s)+'"]',x=v;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=lc(s)}if(!Ra.has(x)&&(s=g({rel:"modulepreload",href:s},i),Ra.set(x,s),c.querySelector(v)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Uu(x)))return}f=c.createElement("link"),ln(f,"link",s),ce(f),c.head.appendChild(f)}}}function JC(s,i,c){ni.S(s,i,c);var f=ic;if(f&&s){var v=Te(f).hoistableStyles,x=oc(s);i=i||"default";var I=v.get(x);if(!I){var B={loading:0,preload:null};if(I=f.querySelector(Vu(x)))B.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":i},c),(c=Ra.get(x))&&b1(s,c);var ae=I=f.createElement("link");ce(ae),ln(ae,"link",s),ae._p=new Promise(function(pe,Ce){ae.onload=pe,ae.onerror=Ce}),ae.addEventListener("load",function(){B.loading|=1}),ae.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Cd(I,i,f)}I={type:"stylesheet",instance:I,count:1,state:B},v.set(x,I)}}}function ZC(s,i){ni.X(s,i);var c=ic;if(c&&s){var f=Te(c).hoistableScripts,v=lc(s),x=f.get(v);x||(x=c.querySelector(Uu(v)),x||(s=g({src:s,async:!0},i),(i=Ra.get(v))&&A1(s,i),x=c.createElement("script"),ce(x),ln(x,"link",s),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(v,x))}}function eN(s,i){ni.M(s,i);var c=ic;if(c&&s){var f=Te(c).hoistableScripts,v=lc(s),x=f.get(v);x||(x=c.querySelector(Uu(v)),x||(s=g({src:s,async:!0,type:"module"},i),(i=Ra.get(v))&&A1(s,i),x=c.createElement("script"),ce(x),ln(x,"link",s),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(v,x))}}function Fy(s,i,c,f){var v=(v=Q.current)?Ad(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=oc(c.href),c=Te(v).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=oc(c.href);var x=Te(v).hoistableStyles,I=x.get(s);if(I||(v=v.ownerDocument||v,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,I),(x=v.querySelector(Vu(s)))&&!x._p&&(I.instance=x,I.state.loading=5),Ra.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ra.set(s,c),x||tN(v,s,c,I.state))),i&&f===null)throw Error(n(528,""));return I}if(i&&f!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=lc(c),c=Te(v).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function oc(s){return'href="'+kr(s)+'"'}function Vu(s){return'link[rel="stylesheet"]['+s+"]"}function Ly(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function tN(s,i,c,f){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=s.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),ln(i,"link",c),ce(i),s.head.appendChild(i))}function lc(s){return'[src="'+kr(s)+'"]'}function Uu(s){return"script[async]"+s}function My(s,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=s.querySelector('style[data-href~="'+kr(c.href)+'"]');if(f)return i.instance=f,ce(f),f;var v=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),ce(f),ln(f,"style",v),Cd(f,c.precedence,s),i.instance=f;case"stylesheet":v=oc(c.href);var x=s.querySelector(Vu(v));if(x)return i.state.loading|=4,i.instance=x,ce(x),x;f=Ly(c),(v=Ra.get(v))&&b1(f,v),x=(s.ownerDocument||s).createElement("link"),ce(x);var I=x;return I._p=new Promise(function(B,ae){I.onload=B,I.onerror=ae}),ln(x,"link",f),i.state.loading|=4,Cd(x,c.precedence,s),i.instance=x;case"script":return x=lc(c.src),(v=s.querySelector(Uu(x)))?(i.instance=v,ce(v),v):(f=c,(v=Ra.get(x))&&(f=g({},c),A1(f,v)),s=s.ownerDocument||s,v=s.createElement("script"),ce(v),ln(v,"link",f),s.head.appendChild(v),i.instance=v);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,Cd(f,c.precedence,s));return i.instance}function Cd(s,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=f.length?f[f.length-1]:null,x=v,I=0;I<f.length;I++){var B=f[I];if(B.dataset.precedence===i)x=B;else if(x!==v)break}x?x.parentNode.insertBefore(s,x.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(s,i.firstChild))}function b1(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function A1(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var Nd=null;function By(s,i,c){if(Nd===null){var f=new Map,v=Nd=new Map;v.set(c,f)}else v=Nd,f=v.get(c),f||(f=new Map,v.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var x=c[v];if(!(x[Y]||x[Sr]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var I=x.getAttribute(i)||"";I=s+I;var B=f.get(I);B?B.push(x):f.set(I,[x])}}return f}function Vy(s,i,c){s=s.ownerDocument||s,s.head.insertBefore(c,i==="title"?s.querySelector("head > title"):null)}function rN(s,i,c){if(c===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Uy(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var zu=null;function nN(){}function aN(s,i,c){if(zu===null)throw Error(n(475));var f=zu;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var v=oc(c.href),x=s.querySelector(Vu(v));if(x){s=x._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(f.count++,f=Rd.bind(f),s.then(f,f)),i.state.loading|=4,i.instance=x,ce(x);return}x=s.ownerDocument||s,c=Ly(c),(v=Ra.get(v))&&b1(c,v),x=x.createElement("link"),ce(x);var I=x;I._p=new Promise(function(B,ae){I.onload=B,I.onerror=ae}),ln(x,"link",c),i.instance=x}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(f.count++,i=Rd.bind(f),s.addEventListener("load",i),s.addEventListener("error",i))}}function sN(){if(zu===null)throw Error(n(475));var s=zu;return s.stylesheets&&s.count===0&&C1(s,s.stylesheets),0<s.count?function(i){var c=setTimeout(function(){if(s.stylesheets&&C1(s,s.stylesheets),s.unsuspend){var f=s.unsuspend;s.unsuspend=null,f()}},6e4);return s.unsuspend=i,function(){s.unsuspend=null,clearTimeout(c)}}:null}function Rd(){if(this.count--,this.count===0){if(this.stylesheets)C1(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var kd=null;function C1(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,kd=new Map,i.forEach(iN,s),kd=null,Rd.call(s))}function iN(s,i){if(!(i.state.loading&4)){var c=kd.get(s);if(c)var f=c.get(null);else{c=new Map,kd.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<v.length;x++){var I=v[x];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(c.set(I.dataset.precedence,I),f=I)}f&&c.set(null,f)}v=i.instance,I=v.getAttribute("data-precedence"),x=c.get(I)||f,x===f&&c.set(null,v),c.set(I,v),this.count++,f=Rd.bind(this),v.addEventListener("load",f),v.addEventListener("error",f),x?x.parentNode.insertBefore(v,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),i.state.loading|=4}}var Hu={$$typeof:A,Provider:null,Consumer:null,_currentValue:Pe,_currentValue2:Pe,_threadCount:0};function oN(s,i,c,f,v,x,I,B){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yn(0),this.hiddenUpdates=Yn(null),this.identifierPrefix=f,this.onUncaughtError=v,this.onCaughtError=x,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function zy(s,i,c,f,v,x,I,B,ae,pe,Ce,Ie){return s=new oN(s,i,c,I,B,ae,pe,Ie),i=1,x===!0&&(i|=24),x=ia(3,null,null,i),s.current=x,x.stateNode=s,i=lp(),i.refCount++,s.pooledCache=i,i.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:i},hp(x),s}function Hy(s){return s?(s=Bl,s):Bl}function Gy(s,i,c,f,v,x){v=Hy(v),f.context===null?f.context=v:f.pendingContext=v,f=Ci(i),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=Ni(s,f,i),c!==null&&(fa(c,s,i),_u(c,s,i))}function qy(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function N1(s,i){qy(s,i),(s=s.alternate)&&qy(s,i)}function $y(s){if(s.tag===13){var i=Ml(s,67108864);i!==null&&fa(i,s,67108864),N1(s,67108864)}}var Id=!0;function lN(s,i,c,f){var v=ie.T;ie.T=null;var x=me.p;try{me.p=2,R1(s,i,c,f)}finally{me.p=x,ie.T=v}}function cN(s,i,c,f){var v=ie.T;ie.T=null;var x=me.p;try{me.p=8,R1(s,i,c,f)}finally{me.p=x,ie.T=v}}function R1(s,i,c,f){if(Id){var v=k1(f);if(v===null)g1(s,i,f,Dd,c),Wy(s,f);else if(fN(v,s,i,c,f))f.stopPropagation();else if(Wy(s,f),i&4&&-1<uN.indexOf(s)){for(;v!==null;){var x=te(v);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var I=cr(x.pendingLanes);if(I!==0){var B=x;for(B.pendingLanes|=2,B.entangledLanes|=2;I;){var ae=1<<31-Je(I);B.entanglements[1]|=ae,I&=~ae}Es(x),(Kt&6)===0&&(pd=je()+500,Fu(0))}}break;case 13:B=Ml(x,2),B!==null&&fa(B,x,2),vd(),N1(x,2)}if(x=k1(f),x===null&&g1(s,i,f,Dd,c),x===v)break;v=x}v!==null&&f.stopPropagation()}else g1(s,i,f,null,c)}}function k1(s){return s=ya(s),I1(s)}var Dd=null;function I1(s){if(Dd=null,s=J(s),s!==null){var i=o(s);if(i===null)s=null;else{var c=i.tag;if(c===13){if(s=l(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return Dd=s,null}function Yy(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case Tr:return 2;case Rr:return 8;case tr:case On:return 32;case lr:return 268435456;default:return 32}default:return 32}}var D1=!1,Ui=null,zi=null,Hi=null,Gu=new Map,qu=new Map,Gi=[],uN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wy(s,i){switch(s){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":zi=null;break;case"mouseover":case"mouseout":Hi=null;break;case"pointerover":case"pointerout":Gu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":qu.delete(i.pointerId)}}function $u(s,i,c,f,v,x){return s===null||s.nativeEvent!==x?(s={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[v]},i!==null&&(i=te(i),i!==null&&$y(i)),s):(s.eventSystemFlags|=f,i=s.targetContainers,v!==null&&i.indexOf(v)===-1&&i.push(v),s)}function fN(s,i,c,f,v){switch(i){case"focusin":return Ui=$u(Ui,s,i,c,f,v),!0;case"dragenter":return zi=$u(zi,s,i,c,f,v),!0;case"mouseover":return Hi=$u(Hi,s,i,c,f,v),!0;case"pointerover":var x=v.pointerId;return Gu.set(x,$u(Gu.get(x)||null,s,i,c,f,v)),!0;case"gotpointercapture":return x=v.pointerId,qu.set(x,$u(qu.get(x)||null,s,i,c,f,v)),!0}return!1}function Ky(s){var i=J(s.target);if(i!==null){var c=o(i);if(c!==null){if(i=c.tag,i===13){if(i=l(c),i!==null){s.blockedOn=i,wl(s.priority,function(){if(c.tag===13){var f=ua();f=is(f);var v=Ml(c,f);v!==null&&fa(v,c,f),N1(c,f)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Od(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=k1(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);Bs=f,c.target.dispatchEvent(f),Bs=null}else return i=te(c),i!==null&&$y(i),s.blockedOn=c,!1;i.shift()}return!0}function Xy(s,i,c){Od(s)&&c.delete(i)}function hN(){D1=!1,Ui!==null&&Od(Ui)&&(Ui=null),zi!==null&&Od(zi)&&(zi=null),Hi!==null&&Od(Hi)&&(Hi=null),Gu.forEach(Xy),qu.forEach(Xy)}function jd(s,i){s.blockedOn===i&&(s.blockedOn=null,D1||(D1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,hN)))}var Pd=null;function Qy(s){Pd!==s&&(Pd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Pd===s&&(Pd=null);for(var i=0;i<s.length;i+=3){var c=s[i],f=s[i+1],v=s[i+2];if(typeof f!="function"){if(I1(f||c)===null)continue;break}var x=te(c);x!==null&&(s.splice(i,3),i-=3,Ip(x,{pending:!0,data:v,method:c.method,action:f},f,v))}}))}function Yu(s){function i(ae){return jd(ae,s)}Ui!==null&&jd(Ui,s),zi!==null&&jd(zi,s),Hi!==null&&jd(Hi,s),Gu.forEach(i),qu.forEach(i);for(var c=0;c<Gi.length;c++){var f=Gi[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<Gi.length&&(c=Gi[0],c.blockedOn===null);)Ky(c),c.blockedOn===null&&Gi.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var v=c[f],x=c[f+1],I=v[ur]||null;if(typeof x=="function")I||Qy(c);else if(I){var B=null;if(x&&x.hasAttribute("formAction")){if(v=x,I=x[ur]||null)B=I.formAction;else if(I1(v)!==null)continue}else B=I.action;typeof B=="function"?c[f+1]=B:(c.splice(f,3),f-=3),Qy(c)}}}function O1(s){this._internalRoot=s}Fd.prototype.render=O1.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,f=ua();Gy(c,f,s,i,null,null)},Fd.prototype.unmount=O1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Gy(s.current,2,null,s,null,null),vd(),i[Wn]=null}};function Fd(s){this._internalRoot=s}Fd.prototype.unstable_scheduleHydration=function(s){if(s){var i=os();s={blockedOn:null,target:s,priority:i};for(var c=0;c<Gi.length&&i!==0&&i<Gi[c].priority;c++);Gi.splice(c,0,s),c===0&&Ky(s)}};var Jy=e.version;if(Jy!=="19.1.0")throw Error(n(527,Jy,"19.1.0"));me.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(i),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var dN={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ld=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ld.isDisabled&&Ld.supportsFiber)try{It=Ld.inject(dN),Se=Ld}catch{}}return Xu.createRoot=function(s,i){if(!a(s))throw Error(n(299));var c=!1,f="",v=m2,x=p2,I=g2,B=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(v=i.onUncaughtError),i.onCaughtError!==void 0&&(x=i.onCaughtError),i.onRecoverableError!==void 0&&(I=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(B=i.unstable_transitionCallbacks)),i=zy(s,1,!1,null,null,c,f,v,x,I,B,null),s[Wn]=i.current,p1(s),new O1(i)},Xu.hydrateRoot=function(s,i,c){if(!a(s))throw Error(n(299));var f=!1,v="",x=m2,I=p2,B=g2,ae=null,pe=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(I=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ae=c.unstable_transitionCallbacks),c.formState!==void 0&&(pe=c.formState)),i=zy(s,1,!0,i,c??null,f,v,x,I,B,ae,pe),i.context=Hy(null),c=i.current,f=ua(),f=is(f),v=Ci(f),v.callback=null,Ni(c,v,f),c=f,i.current.lanes=c,La(i,c),Es(i),s[Wn]=i.current,p1(s),new Fd(i)},Xu.version="19.1.0",Xu}var lE;function AN(){if(lE)return F1.exports;lE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),F1.exports=bN(),F1.exports}var CN=AN(),Qu={},cE;function NN(){if(cE)return Qu;cE=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.parse=l,Qu.serialize=m;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function l(_,T){const E=new o,S=_.length;if(S<2)return E;const b=(T==null?void 0:T.decode)||g;let O=0;do{const L=_.indexOf("=",O);if(L===-1)break;const A=_.indexOf(";",O),D=A===-1?S:A;if(L>D){O=_.lastIndexOf(";",L-1)+1;continue}const V=u(_,O,L),H=d(_,L,V),C=_.slice(V,H);if(E[C]===void 0){let N=u(_,L+1,D),R=d(_,D,N);const F=b(_.slice(N,R));E[C]=F}O=D+1}while(O<S);return E}function u(_,T,E){do{const S=_.charCodeAt(T);if(S!==32&&S!==9)return T}while(++T<E);return E}function d(_,T,E){for(;T>E;){const S=_.charCodeAt(--T);if(S!==32&&S!==9)return T+1}return E}function m(_,T,E){const S=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const b=S(T);if(!e.test(b))throw new TypeError(`argument val is invalid: ${T}`);let O=_+"="+b;if(!E)return O;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);O+="; Max-Age="+E.maxAge}if(E.domain){if(!r.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);O+="; Domain="+E.domain}if(E.path){if(!n.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);O+="; Path="+E.path}if(E.expires){if(!y(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);O+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(O+="; HttpOnly"),E.secure&&(O+="; Secure"),E.partitioned&&(O+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":O+="; Priority=Low";break;case"medium":O+="; Priority=Medium";break;case"high":O+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":O+="; SameSite=Strict";break;case"lax":O+="; SameSite=Lax";break;case"none":O+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return O}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function y(_){return a.call(_)==="[object Date]"}return Qu}NN();/**
 * react-router v7.5.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var uE="popstate";function RN(t={}){function e(n,a){let{pathname:o,search:l,hash:u}=n.location;return dg("",{pathname:o,search:l,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Sf(a)}return IN(e,r,null,t)}function dr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Za(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kN(){return Math.random().toString(36).substring(2,10)}function fE(t,e){return{usr:t.state,key:t.key,idx:e}}function dg(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Oc(e):e,state:r,key:e&&e.key||n||kN()}}function Sf({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Oc(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function IN(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:o=!1}=n,l=a.history,u="POP",d=null,m=g();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function g(){return(l.state||{idx:null}).idx}function y(){u="POP";let b=g(),O=b==null?null:b-m;m=b,d&&d({action:u,location:S.location,delta:O})}function _(b,O){u="PUSH";let L=dg(S.location,b,O);m=g()+1;let A=fE(L,m),D=S.createHref(L);try{l.pushState(A,"",D)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;a.location.assign(D)}o&&d&&d({action:u,location:S.location,delta:1})}function T(b,O){u="REPLACE";let L=dg(S.location,b,O);m=g();let A=fE(L,m),D=S.createHref(L);l.replaceState(A,"",D),o&&d&&d({action:u,location:S.location,delta:0})}function E(b){let O=a.location.origin!=="null"?a.location.origin:a.location.href,L=typeof b=="string"?b:Sf(b);return L=L.replace(/ $/,"%20"),dr(O,`No window.location.(origin|href) available to create URL for href: ${L}`),new URL(L,O)}let S={get action(){return u},get location(){return t(a,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(uE,y),d=b,()=>{a.removeEventListener(uE,y),d=null}},createHref(b){return e(a,b)},createURL:E,encodeLocation(b){let O=E(b);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:_,replace:T,go(b){return l.go(b)}};return S}function cw(t,e,r="/"){return DN(t,e,r,!1)}function DN(t,e,r,n){let a=typeof e=="string"?Oc(e):e,o=di(a.pathname||"/",r);if(o==null)return null;let l=uw(t);ON(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let m=GN(o);u=zN(l[d],m,n)}return u}function uw(t,e=[],r=[],n=""){let a=(o,l,u)=>{let d={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};d.relativePath.startsWith("/")&&(dr(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length));let m=li([n,d.relativePath]),g=r.concat(d);o.children&&o.children.length>0&&(dr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),uw(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:VN(m,o.index),routesMeta:g})};return t.forEach((o,l)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))a(o,l);else for(let d of fw(o.path))a(o,l,d)}),e}function fw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let l=fw(n.join("/")),u=[];return u.push(...l.map(d=>d===""?o:[o,d].join("/"))),a&&u.push(...l),u.map(d=>t.startsWith("/")&&d===""?"/":d)}function ON(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:UN(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var jN=/^:[\w-]+$/,PN=3,FN=2,LN=1,MN=10,BN=-2,hE=t=>t==="*";function VN(t,e){let r=t.split("/"),n=r.length;return r.some(hE)&&(n+=BN),e&&(n+=FN),r.filter(a=>!hE(a)).reduce((a,o)=>a+(jN.test(o)?PN:o===""?LN:MN),n)}function UN(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function zN(t,e,r=!1){let{routesMeta:n}=t,a={},o="/",l=[];for(let u=0;u<n.length;++u){let d=n[u],m=u===n.length-1,g=o==="/"?e:e.slice(o.length)||"/",y=m0({path:d.relativePath,caseSensitive:d.caseSensitive,end:m},g),_=d.route;if(!y&&m&&r&&!n[n.length-1].route.index&&(y=m0({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!y)return null;Object.assign(a,y.params),l.push({params:a,pathname:li([o,y.pathname]),pathnameBase:WN(li([o,y.pathnameBase])),route:_}),y.pathnameBase!=="/"&&(o=li([o,y.pathnameBase]))}return l}function m0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=HN(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((m,{paramName:g,isOptional:y},_)=>{if(g==="*"){let E=u[_]||"";l=o.slice(0,o.length-E.length).replace(/(.)\/+$/,"$1")}const T=u[_];return y&&!T?m[g]=void 0:m[g]=(T||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:t}}function HN(t,e=!1,r=!0){Za(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(n.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function GN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Za(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function di(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function qN(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?Oc(t):t;return{pathname:r?r.startsWith("/")?r:$N(r,e):e,search:KN(n),hash:XN(a)}}function $N(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function V1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function YN(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function rv(t){let e=YN(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function nv(t,e,r,n=!1){let a;typeof t=="string"?a=Oc(t):(a={...t},dr(!a.pathname||!a.pathname.includes("?"),V1("?","pathname","search",a)),dr(!a.pathname||!a.pathname.includes("#"),V1("#","pathname","hash",a)),dr(!a.search||!a.search.includes("#"),V1("#","search","hash",a)));let o=t===""||a.pathname==="",l=o?"/":a.pathname,u;if(l==null)u=r;else{let y=e.length-1;if(!n&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),y-=1;a.pathname=_.join("/")}u=y>=0?e[y]:"/"}let d=qN(a,u),m=l&&l!=="/"&&l.endsWith("/"),g=(o||l===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(m||g)&&(d.pathname+="/"),d}var li=t=>t.join("/").replace(/\/\/+/g,"/"),WN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),KN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,XN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function QN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var hw=["POST","PUT","PATCH","DELETE"];new Set(hw);var JN=["GET",...hw];new Set(JN);var jc=ne.createContext(null);jc.displayName="DataRouter";var tm=ne.createContext(null);tm.displayName="DataRouterState";var dw=ne.createContext({isTransitioning:!1});dw.displayName="ViewTransition";var ZN=ne.createContext(new Map);ZN.displayName="Fetchers";var e6=ne.createContext(null);e6.displayName="Await";var ns=ne.createContext(null);ns.displayName="Navigation";var Gf=ne.createContext(null);Gf.displayName="Location";var as=ne.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var av=ne.createContext(null);av.displayName="RouteError";function t6(t,{relative:e}={}){dr(Pc(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ne.useContext(ns),{hash:a,pathname:o,search:l}=$f(t,{relative:e}),u=o;return r!=="/"&&(u=o==="/"?r:li([r,o])),n.createHref({pathname:u,search:l,hash:a})}function Pc(){return ne.useContext(Gf)!=null}function Os(){return dr(Pc(),"useLocation() may be used only in the context of a <Router> component."),ne.useContext(Gf).location}var mw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pw(t){ne.useContext(ns).static||ne.useLayoutEffect(t)}function qf(){let{isDataRoute:t}=ne.useContext(as);return t?g6():r6()}function r6(){dr(Pc(),"useNavigate() may be used only in the context of a <Router> component.");let t=ne.useContext(jc),{basename:e,navigator:r}=ne.useContext(ns),{matches:n}=ne.useContext(as),{pathname:a}=Os(),o=JSON.stringify(rv(n)),l=ne.useRef(!1);return pw(()=>{l.current=!0}),ne.useCallback((d,m={})=>{if(Za(l.current,mw),!l.current)return;if(typeof d=="number"){r.go(d);return}let g=nv(d,JSON.parse(o),a,m.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:li([e,g.pathname])),(m.replace?r.replace:r.push)(g,m.state,m)},[e,r,o,a,t])}var n6=ne.createContext(null);function a6(t){let e=ne.useContext(as).outlet;return e&&ne.createElement(n6.Provider,{value:t},e)}function $f(t,{relative:e}={}){let{matches:r}=ne.useContext(as),{pathname:n}=Os(),a=JSON.stringify(rv(r));return ne.useMemo(()=>nv(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function s6(t,e){return gw(t,e)}function gw(t,e,r,n){var L;dr(Pc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a,static:o}=ne.useContext(ns),{matches:l}=ne.useContext(as),u=l[l.length-1],d=u?u.params:{},m=u?u.pathname:"/",g=u?u.pathnameBase:"/",y=u&&u.route;{let A=y&&y.path||"";vw(m,!y||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let _=Os(),T;if(e){let A=typeof e=="string"?Oc(e):e;dr(g==="/"||((L=A.pathname)==null?void 0:L.startsWith(g)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${g}" but pathname "${A.pathname}" was given in the \`location\` prop.`),T=A}else T=_;let E=T.pathname||"/",S=E;if(g!=="/"){let A=g.replace(/^\//,"").split("/");S="/"+E.replace(/^\//,"").split("/").slice(A.length).join("/")}let b=!o&&r&&r.matches&&r.matches.length>0?r.matches:cw(t,{pathname:S});Za(y||b!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),Za(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let O=u6(b&&b.map(A=>Object.assign({},A,{params:Object.assign({},d,A.params),pathname:li([g,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?g:li([g,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),l,r,n);return e&&O?ne.createElement(Gf.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},O):O}function i6(){let t=p6(),e=QN(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=ne.createElement(ne.Fragment,null,ne.createElement("p",null,"💿 Hey developer 👋"),ne.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ne.createElement("code",{style:o},"ErrorBoundary")," or"," ",ne.createElement("code",{style:o},"errorElement")," prop on your route.")),ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),r?ne.createElement("pre",{style:a},r):null,l)}var o6=ne.createElement(i6,null),l6=class extends ne.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?ne.createElement(as.Provider,{value:this.props.routeContext},ne.createElement(av.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function c6({routeContext:t,match:e,children:r}){let n=ne.useContext(jc);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ne.createElement(as.Provider,{value:t},r)}function u6(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r==null?void 0:r.errors;if(o!=null){let d=a.findIndex(m=>m.route.id&&(o==null?void 0:o[m.route.id])!==void 0);dr(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,u=-1;if(r)for(let d=0;d<a.length;d++){let m=a[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:g,errors:y}=r,_=m.route.loader&&!g.hasOwnProperty(m.route.id)&&(!y||y[m.route.id]===void 0);if(m.route.lazy||_){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((d,m,g)=>{let y,_=!1,T=null,E=null;r&&(y=o&&m.route.id?o[m.route.id]:void 0,T=m.route.errorElement||o6,l&&(u<0&&g===0?(vw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):u===g&&(_=!0,E=m.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,g+1)),b=()=>{let O;return y?O=T:_?O=E:m.route.Component?O=ne.createElement(m.route.Component,null):m.route.element?O=m.route.element:O=d,ne.createElement(c6,{match:m,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:O})};return r&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?ne.createElement(l6,{location:r.location,revalidation:r.revalidation,component:T,error:y,children:b(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):b()},null)}function sv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function f6(t){let e=ne.useContext(jc);return dr(e,sv(t)),e}function h6(t){let e=ne.useContext(tm);return dr(e,sv(t)),e}function d6(t){let e=ne.useContext(as);return dr(e,sv(t)),e}function iv(t){let e=d6(t),r=e.matches[e.matches.length-1];return dr(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function m6(){return iv("useRouteId")}function p6(){var n;let t=ne.useContext(av),e=h6("useRouteError"),r=iv("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function g6(){let{router:t}=f6("useNavigate"),e=iv("useNavigate"),r=ne.useRef(!1);return pw(()=>{r.current=!0}),ne.useCallback(async(a,o={})=>{Za(r.current,mw),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var dE={};function vw(t,e,r){!e&&!dE[t]&&(dE[t]=!0,Za(!1,r))}ne.memo(v6);function v6({routes:t,future:e,state:r}){return gw(t,void 0,r,e)}function mg({to:t,replace:e,state:r,relative:n}){dr(Pc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=ne.useContext(ns);Za(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=ne.useContext(as),{pathname:l}=Os(),u=qf(),d=nv(t,rv(o),l,n==="path"),m=JSON.stringify(d);return ne.useEffect(()=>{u(JSON.parse(m),{replace:e,state:r,relative:n})},[u,m,n,e,r]),null}function x6(t){return a6(t.context)}function Zn(t){dr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function _6({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:o=!1}){dr(!Pc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=ne.useMemo(()=>({basename:l,navigator:a,static:o,future:{}}),[l,a,o]);typeof r=="string"&&(r=Oc(r));let{pathname:d="/",search:m="",hash:g="",state:y=null,key:_="default"}=r,T=ne.useMemo(()=>{let E=di(d,l);return E==null?null:{location:{pathname:E,search:m,hash:g,state:y,key:_},navigationType:n}},[l,d,m,g,y,_,n]);return Za(T!=null,`<Router basename="${l}"> is not able to match the URL "${d}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:ne.createElement(ns.Provider,{value:u},ne.createElement(Gf.Provider,{children:e,value:T}))}function y6({children:t,location:e}){return s6(pg(t),e)}function pg(t,e=[]){let r=[];return ne.Children.forEach(t,(n,a)=>{if(!ne.isValidElement(n))return;let o=[...e,a];if(n.type===ne.Fragment){r.push.apply(r,pg(n.props.children,o));return}dr(n.type===Zn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),dr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=pg(n.props.children,o)),r.push(l)}),r}var r0="get",n0="application/x-www-form-urlencoded";function rm(t){return t!=null&&typeof t.tagName=="string"}function E6(t){return rm(t)&&t.tagName.toLowerCase()==="button"}function T6(t){return rm(t)&&t.tagName.toLowerCase()==="form"}function w6(t){return rm(t)&&t.tagName.toLowerCase()==="input"}function S6(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function b6(t,e){return t.button===0&&(!e||e==="_self")&&!S6(t)}var Md=null;function A6(){if(Md===null)try{new FormData(document.createElement("form"),0),Md=!1}catch{Md=!0}return Md}var C6=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function U1(t){return t!=null&&!C6.has(t)?(Za(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${n0}"`),null):t}function N6(t,e){let r,n,a,o,l;if(T6(t)){let u=t.getAttribute("action");n=u?di(u,e):null,r=t.getAttribute("method")||r0,a=U1(t.getAttribute("enctype"))||n0,o=new FormData(t)}else if(E6(t)||w6(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||u.getAttribute("action");if(n=d?di(d,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||r0,a=U1(t.getAttribute("formenctype"))||U1(u.getAttribute("enctype"))||n0,o=new FormData(u,t),!A6()){let{name:m,type:g,value:y}=t;if(g==="image"){let _=m?`${m}.`:"";o.append(`${_}x`,"0"),o.append(`${_}y`,"0")}else m&&o.append(m,y)}}else{if(rm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=r0,n=null,a=n0,l=t}return o&&a==="text/plain"&&(l=o,o=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:o,body:l}}function ov(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function R6(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function k6(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function I6(t,e,r){let n=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let l=await R6(o,r);return l.links?l.links():[]}return[]}));return P6(n.flat(1).filter(k6).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function mE(t,e,r,n,a,o){let l=(d,m)=>r[m]?d.route.id!==r[m].route.id:!0,u=(d,m)=>{var g;return r[m].pathname!==d.pathname||((g=r[m].route.path)==null?void 0:g.endsWith("*"))&&r[m].params["*"]!==d.params["*"]};return o==="assets"?e.filter((d,m)=>l(d,m)||u(d,m)):o==="data"?e.filter((d,m)=>{var y;let g=n.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(l(d,m)||u(d,m))return!0;if(d.route.shouldRevalidate){let _=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((y=r[0])==null?void 0:y.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function D6(t,e,{includeHydrateFallback:r}={}){return O6(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function O6(t){return[...new Set(t)]}function j6(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function P6(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let o=JSON.stringify(j6(a));return r.has(o)||(r.add(o),n.push({key:o,link:a})),n},[])}var F6=new Set([100,101,204,205]);function L6(t,e){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname="_root.data":e&&di(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function xw(){let t=ne.useContext(jc);return ov(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function M6(){let t=ne.useContext(tm);return ov(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var lv=ne.createContext(void 0);lv.displayName="FrameworkContext";function _w(){let t=ne.useContext(lv);return ov(t,"You must render this element inside a <HydratedRouter> element"),t}function B6(t,e){let r=ne.useContext(lv),[n,a]=ne.useState(!1),[o,l]=ne.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:m,onMouseLeave:g,onTouchStart:y}=e,_=ne.useRef(null);ne.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let S=O=>{O.forEach(L=>{l(L.isIntersecting)})},b=new IntersectionObserver(S,{threshold:.5});return _.current&&b.observe(_.current),()=>{b.disconnect()}}},[t]),ne.useEffect(()=>{if(n){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[n]);let T=()=>{a(!0)},E=()=>{a(!1),l(!1)};return r?t!=="intent"?[o,_,{}]:[o,_,{onFocus:Ju(u,T),onBlur:Ju(d,E),onMouseEnter:Ju(m,T),onMouseLeave:Ju(g,E),onTouchStart:Ju(y,T)}]:[!1,_,{}]}function Ju(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function V6({page:t,...e}){let{router:r}=xw(),n=ne.useMemo(()=>cw(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?ne.createElement(z6,{page:t,matches:n,...e}):null}function U6(t){let{manifest:e,routeModules:r}=_w(),[n,a]=ne.useState([]);return ne.useEffect(()=>{let o=!1;return I6(t,e,r).then(l=>{o||a(l)}),()=>{o=!0}},[t,e,r]),n}function z6({page:t,matches:e,...r}){let n=Os(),{manifest:a,routeModules:o}=_w(),{basename:l}=xw(),{loaderData:u,matches:d}=M6(),m=ne.useMemo(()=>mE(t,e,d,a,n,"data"),[t,e,d,a,n]),g=ne.useMemo(()=>mE(t,e,d,a,n,"assets"),[t,e,d,a,n]),y=ne.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let E=new Set,S=!1;if(e.forEach(O=>{var A;let L=a.routes[O.route.id];!L||!L.hasLoader||(!m.some(D=>D.route.id===O.route.id)&&O.route.id in u&&((A=o[O.route.id])!=null&&A.shouldRevalidate)||L.hasClientLoader?S=!0:E.add(O.route.id))}),E.size===0)return[];let b=L6(t,l);return S&&E.size>0&&b.searchParams.set("_routes",e.filter(O=>E.has(O.route.id)).map(O=>O.route.id).join(",")),[b.pathname+b.search]},[l,u,n,a,m,e,t,o]),_=ne.useMemo(()=>D6(g,a),[g,a]),T=U6(g);return ne.createElement(ne.Fragment,null,y.map(E=>ne.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...r})),_.map(E=>ne.createElement("link",{key:E,rel:"modulepreload",href:E,...r})),T.map(({key:E,link:S})=>ne.createElement("link",{key:E,...S})))}function H6(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var yw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{yw&&(window.__reactRouterVersion="7.5.1")}catch{}function G6({basename:t,children:e,window:r}){let n=ne.useRef();n.current==null&&(n.current=RN({window:r,v5Compat:!0}));let a=n.current,[o,l]=ne.useState({action:a.action,location:a.location}),u=ne.useCallback(d=>{ne.startTransition(()=>l(d))},[l]);return ne.useLayoutEffect(()=>a.listen(u),[a,u]),ne.createElement(_6,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}var Ew=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cv=ne.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:o,replace:l,state:u,target:d,to:m,preventScrollReset:g,viewTransition:y,..._},T){let{basename:E}=ne.useContext(ns),S=typeof m=="string"&&Ew.test(m),b,O=!1;if(typeof m=="string"&&S&&(b=m,yw))try{let R=new URL(window.location.href),F=m.startsWith("//")?new URL(R.protocol+m):new URL(m),P=di(F.pathname,E);F.origin===R.origin&&P!=null?m=P+F.search+F.hash:O=!0}catch{Za(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let L=t6(m,{relative:a}),[A,D,V]=B6(n,_),H=W6(m,{replace:l,state:u,target:d,preventScrollReset:g,relative:a,viewTransition:y});function C(R){e&&e(R),R.defaultPrevented||H(R)}let N=ne.createElement("a",{..._,...V,href:b||L,onClick:O||o?e:C,ref:H6(T,D),target:d,"data-discover":!S&&r==="render"?"true":void 0});return A&&!S?ne.createElement(ne.Fragment,null,N,ne.createElement(V6,{page:L})):N});cv.displayName="Link";var q6=ne.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:o,to:l,viewTransition:u,children:d,...m},g){let y=$f(l,{relative:m.relative}),_=Os(),T=ne.useContext(tm),{navigator:E,basename:S}=ne.useContext(ns),b=T!=null&&Z6(y)&&u===!0,O=E.encodeLocation?E.encodeLocation(y).pathname:y.pathname,L=_.pathname,A=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;r||(L=L.toLowerCase(),A=A?A.toLowerCase():null,O=O.toLowerCase()),A&&S&&(A=di(A,S)||A);const D=O!=="/"&&O.endsWith("/")?O.length-1:O.length;let V=L===O||!a&&L.startsWith(O)&&L.charAt(D)==="/",H=A!=null&&(A===O||!a&&A.startsWith(O)&&A.charAt(O.length)==="/"),C={isActive:V,isPending:H,isTransitioning:b},N=V?e:void 0,R;typeof n=="function"?R=n(C):R=[n,V?"active":null,H?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let F=typeof o=="function"?o(C):o;return ne.createElement(cv,{...m,"aria-current":N,className:R,ref:g,style:F,to:l,viewTransition:u},typeof d=="function"?d(C):d)});q6.displayName="NavLink";var $6=ne.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:o,method:l=r0,action:u,onSubmit:d,relative:m,preventScrollReset:g,viewTransition:y,..._},T)=>{let E=Q6(),S=J6(u,{relative:m}),b=l.toLowerCase()==="get"?"get":"post",O=typeof u=="string"&&Ew.test(u),L=A=>{if(d&&d(A),A.defaultPrevented)return;A.preventDefault();let D=A.nativeEvent.submitter,V=(D==null?void 0:D.getAttribute("formmethod"))||l;E(D||A.currentTarget,{fetcherKey:e,method:V,navigate:r,replace:a,state:o,relative:m,preventScrollReset:g,viewTransition:y})};return ne.createElement("form",{ref:T,method:b,action:S,onSubmit:n?d:L,..._,"data-discover":!O&&t==="render"?"true":void 0})});$6.displayName="Form";function Y6(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tw(t){let e=ne.useContext(jc);return dr(e,Y6(t)),e}function W6(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:o,viewTransition:l}={}){let u=qf(),d=Os(),m=$f(t,{relative:o});return ne.useCallback(g=>{if(b6(g,e)){g.preventDefault();let y=r!==void 0?r:Sf(d)===Sf(m);u(t,{replace:y,state:n,preventScrollReset:a,relative:o,viewTransition:l})}},[d,u,m,r,n,e,t,a,o,l])}var K6=0,X6=()=>`__${String(++K6)}__`;function Q6(){let{router:t}=Tw("useSubmit"),{basename:e}=ne.useContext(ns),r=m6();return ne.useCallback(async(n,a={})=>{let{action:o,method:l,encType:u,formData:d,body:m}=N6(n,e);if(a.navigate===!1){let g=a.fetcherKey||X6();await t.fetch(g,r,a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:m,formMethod:a.method||l,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:m,formMethod:a.method||l,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function J6(t,{relative:e}={}){let{basename:r}=ne.useContext(ns),n=ne.useContext(as);dr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),o={...$f(t||".",{relative:e})},l=Os();if(t==null){o.search=l.search;let u=new URLSearchParams(o.search),d=u.getAll("index");if(d.some(g=>g==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let g=u.toString();o.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:li([r,o.pathname])),Sf(o)}function Z6(t,e={}){let r=ne.useContext(dw);dr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Tw("useViewTransitionState"),a=$f(t,{relative:e.relative});if(!r.isTransitioning)return!1;let o=di(r.currentLocation.pathname,n)||r.currentLocation.pathname,l=di(r.nextLocation.pathname,n)||r.nextLocation.pathname;return m0(a.pathname,l)!=null||m0(a.pathname,o)!=null}new TextEncoder;[...F6];const eR=()=>{};var pE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},tR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],d=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},Sw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,d=a+2<t.length,m=d?t[a+2]:0,g=o>>2,y=(o&3)<<4|u>>4;let _=(u&15)<<2|m>>6,T=m&63;d||(T=64,l||(_=64)),n.push(r[g],r[y],r[_],r[T])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ww(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):tR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const m=a<t.length?r[t.charAt(a)]:64;++a;const y=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||m==null||y==null)throw new rR;const _=o<<2|u>>4;if(n.push(_),m!==64){const T=u<<4&240|m>>2;if(n.push(T),y!==64){const E=m<<6&192|y;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const nR=function(t){const e=ww(t);return Sw.encodeByteArray(e,!0)},p0=function(t){return nR(t).replace(/\./g,"")},bw=function(t){try{return Sw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=()=>aR().__FIREBASE_DEFAULTS__,iR=()=>{if(typeof process>"u"||typeof pE>"u")return;const t=pE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},oR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&bw(t[1]);return e&&JSON.parse(e)},nm=()=>{try{return eR()||sR()||iR()||oR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Aw=t=>{var e,r;return(r=(e=nm())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Cw=t=>{const e=Aw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Nw=()=>{var t;return(t=nm())===null||t===void 0?void 0:t.config},Rw=t=>{var e;return(e=nm())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[p0(JSON.stringify(r)),p0(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rn())}function uR(){var t;const e=(t=nm())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function dR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mR(){const t=Rn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function pR(){return!uR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gR(){try{return typeof indexedDB=="object"}catch{return!1}}function vR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR="FirebaseError";class js extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=xR,Object.setPrototypeOf(this,js.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yf.prototype.create)}}class Yf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?_R(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new js(a,u,n)}}function _R(t,e){return t.replace(yR,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const yR=/\{\$([^}]+)}/g;function ER(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function nl(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(gE(o)&&gE(l)){if(!nl(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function gE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Zu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[a,o]=n.split("=");e[decodeURIComponent(a)]=decodeURIComponent(o)}}),e}function ef(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function TR(t,e){const r=new wR(t,e);return r.subscribe.bind(r)}class wR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");SR(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=z1),a.error===void 0&&(a.error=z1),a.complete===void 0&&(a.complete=z1);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function z1(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gr(t){return t&&t._delegate?t._delegate:t}class lo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new lR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CR(e))try{this.getOrInitializeService({instanceIdentifier:Qo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=Qo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qo){return this.instances.has(e)}getOptions(e=Qo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){var n;const a=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(a))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:AR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Qo){return this.component?this.component.multipleInstances?e:Qo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function AR(t){return t===Qo?void 0:t}function CR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new bR(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Nt||(Nt={}));const RR={debug:Nt.DEBUG,verbose:Nt.VERBOSE,info:Nt.INFO,warn:Nt.WARN,error:Nt.ERROR,silent:Nt.SILENT},kR=Nt.INFO,IR={[Nt.DEBUG]:"log",[Nt.VERBOSE]:"log",[Nt.INFO]:"info",[Nt.WARN]:"warn",[Nt.ERROR]:"error"},DR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=IR[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uv{constructor(e){this.name=e,this._logLevel=kR,this._logHandler=DR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Nt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Nt.DEBUG,...e),this._logHandler(this,Nt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Nt.VERBOSE,...e),this._logHandler(this,Nt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Nt.INFO,...e),this._logHandler(this,Nt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Nt.WARN,...e),this._logHandler(this,Nt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Nt.ERROR,...e),this._logHandler(this,Nt.ERROR,...e)}}const OR=(t,e)=>e.some(r=>t instanceof r);let vE,xE;function jR(){return vE||(vE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PR(){return xE||(xE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Iw=new WeakMap,gg=new WeakMap,Dw=new WeakMap,H1=new WeakMap,fv=new WeakMap;function FR(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(no(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&Iw.set(r,t)}).catch(()=>{}),fv.set(e,t),e}function LR(t){if(gg.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});gg.set(t,e)}let vg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return gg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Dw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return no(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function MR(t){vg=t(vg)}function BR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(G1(this),e,...r);return Dw.set(n,e.sort?e.sort():[e]),no(n)}:PR().includes(t)?function(...e){return t.apply(G1(this),e),no(Iw.get(this))}:function(...e){return no(t.apply(G1(this),e))}}function VR(t){return typeof t=="function"?BR(t):(t instanceof IDBTransaction&&LR(t),OR(t,jR())?new Proxy(t,vg):t)}function no(t){if(t instanceof IDBRequest)return FR(t);if(H1.has(t))return H1.get(t);const e=VR(t);return e!==t&&(H1.set(t,e),fv.set(e,t)),e}const G1=t=>fv.get(t);function UR(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=no(l);return n&&l.addEventListener("upgradeneeded",d=>{n(no(l.result),d.oldVersion,d.newVersion,no(l.transaction),d)}),r&&l.addEventListener("blocked",d=>r(d.oldVersion,d.newVersion,d)),u.then(d=>{o&&d.addEventListener("close",()=>o()),a&&d.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),u}const zR=["get","getKey","getAll","getAllKeys","count"],HR=["put","add","delete","clear"],q1=new Map;function _E(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(q1.get(e))return q1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=HR.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||zR.includes(r)))return;const o=async function(l,...u){const d=this.transaction(l,a?"readwrite":"readonly");let m=d.store;return n&&(m=m.index(u.shift())),(await Promise.all([m[r](...u),a&&d.done]))[0]};return q1.set(e,o),o}MR(t=>({...t,get:(e,r,n)=>_E(e,r)||t.get(e,r,n),has:(e,r)=>!!_E(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(qR(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function qR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xg="@firebase/app",yE="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi=new uv("@firebase/app"),$R="@firebase/app-compat",YR="@firebase/analytics-compat",WR="@firebase/analytics",KR="@firebase/app-check-compat",XR="@firebase/app-check",QR="@firebase/auth",JR="@firebase/auth-compat",ZR="@firebase/database",ek="@firebase/data-connect",tk="@firebase/database-compat",rk="@firebase/functions",nk="@firebase/functions-compat",ak="@firebase/installations",sk="@firebase/installations-compat",ik="@firebase/messaging",ok="@firebase/messaging-compat",lk="@firebase/performance",ck="@firebase/performance-compat",uk="@firebase/remote-config",fk="@firebase/remote-config-compat",hk="@firebase/storage",dk="@firebase/storage-compat",mk="@firebase/firestore",pk="@firebase/vertexai",gk="@firebase/firestore-compat",vk="firebase",xk="11.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g="[DEFAULT]",_k={[xg]:"fire-core",[$R]:"fire-core-compat",[WR]:"fire-analytics",[YR]:"fire-analytics-compat",[XR]:"fire-app-check",[KR]:"fire-app-check-compat",[QR]:"fire-auth",[JR]:"fire-auth-compat",[ZR]:"fire-rtdb",[ek]:"fire-data-connect",[tk]:"fire-rtdb-compat",[rk]:"fire-fn",[nk]:"fire-fn-compat",[ak]:"fire-iid",[sk]:"fire-iid-compat",[ik]:"fire-fcm",[ok]:"fire-fcm-compat",[lk]:"fire-perf",[ck]:"fire-perf-compat",[uk]:"fire-rc",[fk]:"fire-rc-compat",[hk]:"fire-gcs",[dk]:"fire-gcs-compat",[mk]:"fire-fst",[gk]:"fire-fst-compat",[pk]:"fire-vertex","fire-js":"fire-js",[vk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0=new Map,yk=new Map,yg=new Map;function EE(t,e){try{t.container.addComponent(e)}catch(r){mi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function al(t){const e=t.name;if(yg.has(e))return mi.debug(`There were multiple attempts to register component ${e}.`),!1;yg.set(e,t);for(const r of g0.values())EE(r,t);for(const r of yk.values())EE(r,t);return!0}function am(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function da(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ao=new Yf("app","Firebase",Ek);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ao.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=xk;function Ow(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:_g,automaticDataCollectionEnabled:!1},e),a=n.name;if(typeof a!="string"||!a)throw ao.create("bad-app-name",{appName:String(a)});if(r||(r=Nw()),!r)throw ao.create("no-options");const o=g0.get(a);if(o){if(nl(r,o.options)&&nl(n,o.config))return o;throw ao.create("duplicate-app",{appName:a})}const l=new NR(a);for(const d of yg.values())l.addComponent(d);const u=new Tk(r,n,l);return g0.set(a,u),u}function hv(t=_g){const e=g0.get(t);if(!e&&t===_g&&Nw())return Ow();if(!e)throw ao.create("no-app",{appName:t});return e}function bs(t,e,r){var n;let a=(n=_k[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const u=[`Unable to register library "${a}" with version "${e}":`];o&&u.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mi.warn(u.join(" "));return}al(new lo(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk="firebase-heartbeat-database",Sk=1,bf="firebase-heartbeat-store";let $1=null;function jw(){return $1||($1=UR(wk,Sk,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bf)}catch(r){console.warn(r)}}}}).catch(t=>{throw ao.create("idb-open",{originalErrorMessage:t.message})})),$1}async function bk(t){try{const r=(await jw()).transaction(bf),n=await r.objectStore(bf).get(Pw(t));return await r.done,n}catch(e){if(e instanceof js)mi.warn(e.message);else{const r=ao.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mi.warn(r.message)}}}async function TE(t,e){try{const n=(await jw()).transaction(bf,"readwrite");await n.objectStore(bf).put(e,Pw(t)),await n.done}catch(r){if(r instanceof js)mi.warn(r.message);else{const n=ao.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});mi.warn(n.message)}}}function Pw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=1024,Ck=30;class Nk{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new kk(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=wE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>Ck){const l=Ik(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){mi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=wE(),{heartbeatsToSend:n,unsentEntries:a}=Rk(this._heartbeatsCache.heartbeats),o=p0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return mi.warn(r),""}}}function wE(){return new Date().toISOString().substring(0,10)}function Rk(t,e=Ak){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),SE(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),SE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class kk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gR()?vR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await bk(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return TE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return TE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function SE(t){return p0(JSON.stringify({version:2,heartbeats:t})).length}function Ik(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){al(new lo("platform-logger",e=>new GR(e),"PRIVATE")),al(new lo("heartbeat",e=>new Nk(e),"PRIVATE")),bs(xg,yE,t),bs(xg,yE,"esm2017"),bs("fire-js","")}Dk("");var Ok="firebase",jk="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bs(Ok,jk,"app");function dv(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Fw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Pk=Fw,Lw=new Yf("auth","Firebase",Fw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0=new uv("@firebase/auth");function Fk(t,...e){v0.logLevel<=Nt.WARN&&v0.warn(`Auth (${ml}): ${t}`,...e)}function a0(t,...e){v0.logLevel<=Nt.ERROR&&v0.error(`Auth (${ml}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t,...e){throw mv(t,...e)}function As(t,...e){return mv(t,...e)}function Mw(t,e,r){const n=Object.assign(Object.assign({},Pk()),{[e]:r});return new Yf("auth","Firebase",n).create(e,{appName:t.name})}function ci(t){return Mw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Lw.create(t,...e)}function ot(t,e,...r){if(!t)throw mv(e,...r)}function ai(t){const e="INTERNAL ASSERTION FAILED: "+t;throw a0(e),new Error(e)}function pi(t,e){t||ai(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Lk(){return bE()==="http:"||bE()==="https:"}function bE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Lk()||hR()||"connection"in navigator)?navigator.onLine:!0}function Bk(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,r){this.shortDelay=e,this.longDelay=r,pi(r>e,"Short delay should be less than long delay!"),this.isMobile=cR()||dR()}get(){return Mk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv(t,e){pi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ai("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ai("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ai("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],zk=new Kf(3e4,6e4);function _i(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function yi(t,e,r,n,a={}){return Vw(t,a,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const u=Wf(Object.assign({key:t.config.apiKey},l)).slice(1),d=await t._getAdditionalHeaders();d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode);const m=Object.assign({method:e,headers:d},o);return fR()||(m.referrerPolicy="no-referrer"),Bw.fetch()(await Uw(t,t.config.apiHost,r,u),m)})}async function Vw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Vk),e);try{const a=new Gk(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Bd(t,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const u=o.ok?l.errorMessage:l.error.message,[d,m]=u.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Bd(t,"credential-already-in-use",l);if(d==="EMAIL_EXISTS")throw Bd(t,"email-already-in-use",l);if(d==="USER_DISABLED")throw Bd(t,"user-disabled",l);const g=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Mw(t,g,m);es(t,g)}}catch(a){if(a instanceof js)throw a;es(t,"network-request-failed",{message:String(a)})}}async function Xf(t,e,r,n,a={}){const o=await yi(t,e,r,n,a);return"mfaPendingCredential"in o&&es(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function Uw(t,e,r,n){const a=`${e}${r}?${n}`,o=t,l=o.config.emulator?pv(t.config,a):`${t.config.apiScheme}://${a}`;return Uk.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}function Hk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Gk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(As(this.auth,"network-request-failed")),zk.get())})}}function Bd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=As(t,e,n);return a.customData._tokenResponse=r,a}function AE(t){return t!==void 0&&t.enterprise!==void 0}class qk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return Hk(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function $k(t,e){return yi(t,"GET","/v2/recaptchaConfig",_i(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yk(t,e){return yi(t,"POST","/v1/accounts:delete",e)}async function x0(t,e){return yi(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Wk(t,e=!1){const r=gr(t),n=await r.getIdToken(e),a=gv(n);ot(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:a,token:n,authTime:cf(Y1(a.auth_time)),issuedAtTime:cf(Y1(a.iat)),expirationTime:cf(Y1(a.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Y1(t){return Number(t)*1e3}function gv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return a0("JWT malformed, contained fewer than 3 sections"),null;try{const a=bw(r);return a?JSON.parse(a):(a0("Failed to decode base64 JWT payload"),null)}catch(a){return a0("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function CE(t){const e=gv(t);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Af(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof js&&Kk(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Kk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=cf(this.lastLoginAt),this.creationTime=cf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _0(t){var e;const r=t.auth,n=await t.getIdToken(),a=await Af(t,x0(r,{idToken:n}));ot(a==null?void 0:a.users.length,r,"internal-error");const o=a.users[0];t._notifyReloadListener(o);const l=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?zw(o.providerUserInfo):[],u=Jk(t.providerData,l),d=t.isAnonymous,m=!(t.email&&o.passwordHash)&&!(u!=null&&u.length),g=d?m:!1,y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Tg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,y)}async function Qk(t){const e=gr(t);await _0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Jk(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function zw(t){return t.map(e=>{var{providerId:r}=e,n=dv(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zk(t,e){const r=await Vw(t,{},async()=>{const n=Wf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,l=await Uw(t,a,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",Bw.fetch()(l,{method:"POST",headers:u,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function eI(t,e){return yi(t,"POST","/v2/accounts:revokeToken",_i(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):CE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const r=CE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await Zk(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,l=new xc;return n&&(ot(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(ot(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),o&&(ot(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new xc,this.toJSON())}_performRefresh(){return ai("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(t,e){ot(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $a{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,o=dv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Tg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await Af(this,this.stsTokenManager.getToken(this.auth,e));return ot(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Wk(this,e)}reload(){return Qk(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new $a(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(da(this.auth.app))return Promise.reject(ci(this.auth));const e=await this.getIdToken();return await Af(this,Yk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,o,l,u,d,m,g;const y=(n=r.displayName)!==null&&n!==void 0?n:void 0,_=(a=r.email)!==null&&a!==void 0?a:void 0,T=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,E=(l=r.photoURL)!==null&&l!==void 0?l:void 0,S=(u=r.tenantId)!==null&&u!==void 0?u:void 0,b=(d=r._redirectEventId)!==null&&d!==void 0?d:void 0,O=(m=r.createdAt)!==null&&m!==void 0?m:void 0,L=(g=r.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:A,emailVerified:D,isAnonymous:V,providerData:H,stsTokenManager:C}=r;ot(A&&C,e,"internal-error");const N=xc.fromJSON(this.name,C);ot(typeof A=="string",e,"internal-error"),$i(y,e.name),$i(_,e.name),ot(typeof D=="boolean",e,"internal-error"),ot(typeof V=="boolean",e,"internal-error"),$i(T,e.name),$i(E,e.name),$i(S,e.name),$i(b,e.name),$i(O,e.name),$i(L,e.name);const R=new $a({uid:A,auth:e,email:_,emailVerified:D,displayName:y,isAnonymous:V,photoURL:E,phoneNumber:T,tenantId:S,stsTokenManager:N,createdAt:O,lastLoginAt:L});return H&&Array.isArray(H)&&(R.providerData=H.map(F=>Object.assign({},F))),b&&(R._redirectEventId=b),R}static async _fromIdTokenResponse(e,r,n=!1){const a=new xc;a.updateFromServerResponse(r);const o=new $a({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await _0(o),o}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ot(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?zw(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(o!=null&&o.length),u=new xc;u.updateFromIdToken(n);const d=new $a({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Tg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(o!=null&&o.length)};return Object.assign(d,m),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE=new Map;function si(t){pi(t instanceof Function,"Expected a class definition");let e=NE.get(t);return e?(pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,NE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Hw.type="NONE";const RE=Hw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(t,e,r){return`firebase:${t}:${e}:${r}`}class _c{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=s0(this.userKey,a.apiKey,o),this.fullPersistenceKey=s0("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await x0(this.auth,{idToken:e}).catch(()=>{});return r?$a._fromGetAccountInfoResponse(this.auth,r,e):null}return $a._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new _c(si(RE),e,n);const a=(await Promise.all(r.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let o=a[0]||si(RE);const l=s0(n,e.config.apiKey,e.name);let u=null;for(const m of r)try{const g=await m._get(l);if(g){let y;if(typeof g=="string"){const _=await x0(e,{idToken:g}).catch(()=>{});if(!_)break;y=await $a._fromGetAccountInfoResponse(e,_,g)}else y=$a._fromJSON(e,g);m!==o&&(u=y),o=m;break}}catch{}const d=a.filter(m=>m._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new _c(o,e,n):(o=d[0],u&&await o._set(l,u.toJSON()),await Promise.all(r.map(async m=>{if(m!==o)try{await m._remove(l)}catch{}})),new _c(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Yw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Gw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Kw(e))return"Blackberry";if(Xw(e))return"Webos";if(qw(e))return"Safari";if((e.includes("chrome/")||$w(e))&&!e.includes("edge/"))return"Chrome";if(Ww(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Gw(t=Rn()){return/firefox\//i.test(t)}function qw(t=Rn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $w(t=Rn()){return/crios\//i.test(t)}function Yw(t=Rn()){return/iemobile/i.test(t)}function Ww(t=Rn()){return/android/i.test(t)}function Kw(t=Rn()){return/blackberry/i.test(t)}function Xw(t=Rn()){return/webos/i.test(t)}function vv(t=Rn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tI(t=Rn()){var e;return vv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function rI(){return mR()&&document.documentMode===10}function Qw(t=Rn()){return vv(t)||Ww(t)||Xw(t)||Kw(t)||/windows phone/i.test(t)||Yw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jw(t,e=[]){let r;switch(t){case"Browser":r=kE(Rn());break;case"Worker":r=`${kE(Rn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ml}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((l,u)=>{try{const d=e(o);l(d)}catch(d){u(d)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aI(t,e={}){return yi(t,"GET","/v2/passwordPolicy",_i(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sI=6;class iI{constructor(e){var r,n,a,o;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=l.minPasswordLength)!==null&&r!==void 0?r:sI,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,a,o,l,u;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(r=d.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(n=d.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(a=d.containsLowercaseLetter)!==null&&a!==void 0?a:!0),d.isValid&&(d.isValid=(o=d.containsUppercaseLetter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNumericCharacter)!==null&&l!==void 0?l:!0),d.isValid&&(d.isValid=(u=d.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),d}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IE(this),this.idTokenSubscription=new IE(this),this.beforeStateQueue=new nI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Lw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=si(r)),this._initializationPromise=this.queue(async()=>{var n,a,o;if(!this._deleted&&(this.persistenceManager=await _c.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await x0(this,{idToken:e}),n=await $a._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(da(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let a=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=a==null?void 0:a._redirectEventId,d=await this.tryRedirectSignIn(e);(!l||l===u)&&(d!=null&&d.user)&&(a=d.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(l){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _0(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Bk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(da(this.app))return Promise.reject(ci(this));const r=e?gr(e):null;return r&&ot(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return da(this.app)?Promise.reject(ci(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return da(this.app)?Promise.reject(ci(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aI(this),r=new iI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Yf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await eI(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&si(e)||this._popupRedirectResolver;ot(r,this,"argument-error"),this.redirectPersistenceManager=await _c.create(this,[si(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(u,this,"internal-error"),u.then(()=>{l||o(this.currentUser)}),typeof r=="function"){const d=e.addObserver(r,n,a);return()=>{l=!0,d()}}else{const d=e.addObserver(r);return()=>{l=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Jw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(r["X-Firebase-AppCheck"]=a),r}async _getAppCheckToken(){var e;if(da(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Fk(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function xo(t){return gr(t)}class IE{constructor(e){this.auth=e,this.observer=null,this.addObserver=TR(r=>this.observer=r)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lI(t){sm=t}function Zw(t){return sm.loadJS(t)}function cI(){return sm.recaptchaEnterpriseScript}function uI(){return sm.gapiScript}function fI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class hI{constructor(){this.enterprise=new dI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class dI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const mI="recaptcha-enterprise",eS="NO_RECAPTCHA";class pI{constructor(e){this.type=mI,this.auth=xo(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(l,u)=>{$k(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const m=new qk(d);return o.tenantId==null?o._agentRecaptchaConfig=m:o._tenantRecaptchaConfigs[o.tenantId]=m,l(m.siteKey)}}).catch(d=>{u(d)})})}function a(o,l,u){const d=window.grecaptcha;AE(d)?d.enterprise.ready(()=>{d.enterprise.execute(o,{action:e}).then(m=>{l(m)}).catch(()=>{l(eS)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new hI().execute("siteKey",{action:"verify"}):new Promise((o,l)=>{n(this.auth).then(u=>{if(!r&&AE(window.grecaptcha))a(u,o,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let d=cI();d.length!==0&&(d+=u),Zw(d).then(()=>{a(u,o,l)}).catch(m=>{l(m)})}}).catch(u=>{l(u)})})}}async function DE(t,e,r,n=!1,a=!1){const o=new pI(t);let l;if(a)l=eS;else try{l=await o.verify(r)}catch{l=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const d=u.phoneEnrollmentInfo.phoneNumber,m=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:m,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const d=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:l}):Object.assign(u,{captchaResponse:l}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function y0(t,e,r,n,a){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await DE(t,e,r,r==="getOobCode");return n(t,l)}else return n(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await DE(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(t,e){const r=am(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(nl(o,e??{}))return a;es(a,"already-initialized")}return r.initialize({options:e})}function vI(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(si);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function xI(t,e,r){const n=xo(t);ot(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,o=tS(e),{host:l,port:u}=_I(e),d=u===null?"":`:${u}`,m={url:`${o}//${l}${d}/`},g=Object.freeze({host:l,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ot(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ot(nl(m,n.config.emulator)&&nl(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=m,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,yI()}function tS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function _I(t){const e=tS(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const o=a[1];return{host:o,port:OE(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:OE(l)}}}function OE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function yI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ai("not implemented")}_getIdTokenResponse(e){return ai("not implemented")}_linkToIdToken(e,r){return ai("not implemented")}_getReauthenticationResolver(e){return ai("not implemented")}}async function EI(t,e){return yi(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TI(t,e){return Xf(t,"POST","/v1/accounts:signInWithPassword",_i(t,e))}async function wI(t,e){return yi(t,"POST","/v1/accounts:sendOobCode",_i(t,e))}async function SI(t,e){return wI(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bI(t,e){return Xf(t,"POST","/v1/accounts:signInWithEmailLink",_i(t,e))}async function AI(t,e){return Xf(t,"POST","/v1/accounts:signInWithEmailLink",_i(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf extends xv{constructor(e,r,n,a=null){super("password",n),this._email=e,this._password=r,this._tenantId=a}static _fromEmailAndPassword(e,r){return new Cf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Cf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return y0(e,r,"signInWithPassword",TI);case"emailLink":return bI(e,{email:this._email,oobCode:this._password});default:es(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return y0(e,n,"signUpPassword",EI);case"emailLink":return AI(e,{idToken:r,email:this._email,oobCode:this._password});default:es(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(t,e){return Xf(t,"POST","/v1/accounts:signInWithIdp",_i(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI="http://localhost";class sl extends xv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new sl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):es("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,o=dv(r,["providerId","signInMethod"]);if(!n||!a)return null;const l=new sl(n,a);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return yc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,yc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,yc(e,r)}buildRequest(){const e={requestUri:CI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Wf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RI(t){const e=Zu(ef(t)).link,r=e?Zu(ef(e)).deep_link_id:null,n=Zu(ef(t)).deep_link_id;return(n?Zu(ef(n)).link:null)||n||r||e||t}class _v{constructor(e){var r,n,a,o,l,u;const d=Zu(ef(e)),m=(r=d.apiKey)!==null&&r!==void 0?r:null,g=(n=d.oobCode)!==null&&n!==void 0?n:null,y=NI((a=d.mode)!==null&&a!==void 0?a:null);ot(m&&g&&y,"argument-error"),this.apiKey=m,this.operation=y,this.code=g,this.continueUrl=(o=d.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(l=d.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(u=d.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=RI(e);try{return new _v(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){this.providerId=Fc.PROVIDER_ID}static credential(e,r){return Cf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=_v.parseLink(r);return ot(n,"argument-error"),Cf._fromEmailAndCode(e,n.code,n.tenantId)}}Fc.PROVIDER_ID="password";Fc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Fc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf extends rS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Qf{constructor(){super("facebook.com")}static credential(e){return sl._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wi.credential(e.oauthAccessToken)}catch{return null}}}Wi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends Qf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return sl._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ki.credential(r,n)}catch{return null}}}Ki.GOOGLE_SIGN_IN_METHOD="google.com";Ki.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends Qf{constructor(){super("github.com")}static credential(e){return sl._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Qf{constructor(){super("twitter.com")}static credential(e,r){return sl._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Qi.credential(r,n)}catch{return null}}}Qi.TWITTER_SIGN_IN_METHOD="twitter.com";Qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kI(t,e){return Xf(t,"POST","/v1/accounts:signUp",_i(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await $a._fromIdTokenResponse(e,n,a),l=jE(n);return new il({user:o,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=jE(n);return new il({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function jE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0 extends js{constructor(e,r,n,a){var o;super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,E0.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new E0(e,r,n,a)}}function nS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?E0._fromErrorAndOperation(t,o,e,n):o})}async function II(t,e,r=!1){const n=await Af(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return il._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(t,e,r=!1){const{auth:n}=t;if(da(n.app))return Promise.reject(ci(n));const a="reauthenticate";try{const o=await Af(t,nS(n,a,e,t),r);ot(o.idToken,n,"internal-error");const l=gv(o.idToken);ot(l,n,"internal-error");const{sub:u}=l;return ot(t.uid===u,n,"user-mismatch"),il._forOperation(t,a,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&es(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aS(t,e,r=!1){if(da(t.app))return Promise.reject(ci(t));const n="signIn",a=await nS(t,n,e),o=await il._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}async function OI(t,e){return aS(xo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sS(t){const e=xo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function jI(t,e,r){const n=xo(t);await y0(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",SI)}async function PI(t,e,r){if(da(t.app))return Promise.reject(ci(t));const n=xo(t),l=await y0(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kI).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&sS(t),d}),u=await il._fromIdTokenResponse(n,"signIn",l);return await n._updateCurrentUser(u.user),u}function FI(t,e,r){return da(t.app)?Promise.reject(ci(t)):OI(gr(t),Fc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&sS(t),n})}function LI(t,e,r,n){return gr(t).onIdTokenChanged(e,r,n)}function MI(t,e,r){return gr(t).beforeAuthStateChanged(e,r)}function iS(t,e,r,n){return gr(t).onAuthStateChanged(e,r,n)}function BI(t){return gr(t).signOut()}const T0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(T0,"1"),this.storage.removeItem(T0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI=1e3,UI=10;class lS extends oS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Qw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,d)=>{this.notifyListeners(l,d)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);rI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,UI):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},VI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}lS.type="LOCAL";const zI=lS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS extends oS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}cS.type="SESSION";const uS=cS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new im(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async m=>m(r.origin,o)),d=await HI(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}im.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,l;return new Promise((u,d)=>{const m=yv("",20);a.port1.start();const g=setTimeout(()=>{d(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(y){const _=y;if(_.data.eventId===m)switch(_.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(_.data.response);break;default:clearTimeout(g),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(){return window}function qI(t){Cs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(){return typeof Cs().WorkerGlobalScope<"u"&&typeof Cs().importScripts=="function"}async function $I(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YI(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function WI(){return fS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="firebaseLocalStorageDb",KI=1,w0="firebaseLocalStorage",dS="fbase_key";class Jf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function om(t,e){return t.transaction([w0],e?"readwrite":"readonly").objectStore(w0)}function XI(){const t=indexedDB.deleteDatabase(hS);return new Jf(t).toPromise()}function wg(){const t=indexedDB.open(hS,KI);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(w0,{keyPath:dS})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(w0)?e(n):(n.close(),await XI(),e(await wg()))})})}async function PE(t,e,r){const n=om(t,!0).put({[dS]:e,value:r});return new Jf(n).toPromise()}async function QI(t,e){const r=om(t,!1).get(e),n=await new Jf(r).toPromise();return n===void 0?null:n.value}function FE(t,e){const r=om(t,!0).delete(e);return new Jf(r).toPromise()}const JI=800,ZI=3;class mS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>ZI)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=im._getInstance(WI()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await $I(),!this.activeServiceWorker)return;this.sender=new GI(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wg();return await PE(e,T0,"1"),await FE(e,T0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>PE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>QI(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>FE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=om(a,!1).getAll();return new Jf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mS.type="LOCAL";const e8=mS;new Kf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t8(t,e){return e?si(e):(ot(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev extends xv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return yc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return yc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return yc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function r8(t){return aS(t.auth,new Ev(t),t.bypassAuthState)}function n8(t){const{auth:e,user:r}=t;return ot(r,e,"internal-error"),DI(r,new Ev(t),t.bypassAuthState)}async function a8(t){const{auth:e,user:r}=t;return ot(r,e,"internal-error"),II(r,new Ev(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:l,type:u}=e;if(l){this.reject(l);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(d))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return r8;case"linkViaPopup":case"linkViaRedirect":return a8;case"reauthViaPopup":case"reauthViaRedirect":return n8;default:es(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=new Kf(2e3,1e4);class pc extends pS{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,pc.currentPopupAction&&pc.currentPopupAction.cancel(),pc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=yv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(As(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(As(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(As(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,s8.get())};e()}}pc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i8="pendingRedirect",i0=new Map;class o8 extends pS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=i0.get(this.auth._key());if(!e){try{const n=await l8(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}i0.set(this.auth._key(),e)}return this.bypassAuthState||i0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function l8(t,e){const r=f8(e),n=u8(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function c8(t,e){i0.set(t._key(),e)}function u8(t){return si(t._redirectPersistence)}function f8(t){return s0(i8,t.config.apiKey,t.name)}async function h8(t,e,r=!1){if(da(t.app))return Promise.reject(ci(t));const n=xo(t),a=t8(n,e),l=await new o8(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d8=10*60*1e3;class m8{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!p8(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!gS(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(As(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=d8&&this.cachedEventUids.clear(),this.cachedEventUids.has(LE(e))}saveEventToCache(e){this.cachedEventUids.add(LE(e)),this.lastProcessedEventTime=Date.now()}}function LE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function gS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function p8(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g8(t,e={}){return yi(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,x8=/^https?/;async function _8(t){if(t.config.emulator)return;const{authorizedDomains:e}=await g8(t);for(const r of e)try{if(y8(r))return}catch{}es(t,"unauthorized-domain")}function y8(t){const e=Eg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!x8.test(r))return!1;if(v8.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E8=new Kf(3e4,6e4);function ME(){const t=Cs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function T8(t){return new Promise((e,r)=>{var n,a,o;function l(){ME(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ME(),r(As(t,"network-request-failed"))},timeout:E8.get()})}if(!((a=(n=Cs().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=Cs().gapi)===null||o===void 0)&&o.load)l();else{const u=fI("iframefcb");return Cs()[u]=()=>{gapi.load?l():r(As(t,"network-request-failed"))},Zw(`${uI()}?onload=${u}`).catch(d=>r(d))}}).catch(e=>{throw o0=null,e})}let o0=null;function w8(t){return o0=o0||T8(t),o0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8=new Kf(5e3,15e3),b8="__/auth/iframe",A8="emulator/auth/iframe",C8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},N8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R8(t){const e=t.config;ot(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?pv(e,A8):`https://${t.config.authDomain}/${b8}`,n={apiKey:e.apiKey,appName:t.name,v:ml},a=N8.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${Wf(n).slice(1)}`}async function k8(t){const e=await w8(t),r=Cs().gapi;return ot(r,t,"internal-error"),e.open({where:document.body,url:R8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C8,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const l=As(t,"network-request-failed"),u=Cs().setTimeout(()=>{o(l)},S8.get());function d(){Cs().clearTimeout(u),a(n)}n.ping(d).then(d,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D8=500,O8=600,j8="_blank",P8="http://localhost";class BE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function F8(t,e,r,n=D8,a=O8){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const d=Object.assign(Object.assign({},I8),{width:n.toString(),height:a.toString(),top:o,left:l}),m=Rn().toLowerCase();r&&(u=$w(m)?j8:r),Gw(m)&&(e=e||P8,d.scrollbars="yes");const g=Object.entries(d).reduce((_,[T,E])=>`${_}${T}=${E},`,"");if(tI(m)&&u!=="_self")return L8(e||"",u),new BE(null);const y=window.open(e||"",u,g);ot(y,t,"popup-blocked");try{y.focus()}catch{}return new BE(y)}function L8(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M8="__/auth/handler",B8="emulator/auth/handler",V8=encodeURIComponent("fac");async function VE(t,e,r,n,a,o){ot(t.config.authDomain,t,"auth-domain-config-required"),ot(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ml,eventId:a};if(e instanceof rS){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",ER(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,y]of Object.entries({}))l[g]=y}if(e instanceof Qf){const g=e.getScopes().filter(y=>y!=="");g.length>0&&(l.scopes=g.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const d=await t._getAppCheckToken(),m=d?`#${V8}=${encodeURIComponent(d)}`:"";return`${U8(t)}?${Wf(u).slice(1)}${m}`}function U8({config:t}){return t.emulator?pv(t,B8):`https://${t.authDomain}/${M8}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1="webStorageSupport";class z8{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uS,this._completeRedirectFn=h8,this._overrideRedirectResult=c8}async _openPopup(e,r,n,a){var o;pi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const l=await VE(e,r,n,Eg(),a);return F8(e,l,yv())}async _openRedirect(e,r,n,a){await this._originValidation(e);const o=await VE(e,r,n,Eg(),a);return qI(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(pi(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await k8(e),n=new m8(e);return r.register("authEvent",a=>(ot(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(W1,{type:W1},a=>{var o;const l=(o=a==null?void 0:a[0])===null||o===void 0?void 0:o[W1];l!==void 0&&r(!!l),es(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_8(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Qw()||qw()||vv()}}const H8=z8;var UE="@firebase/auth",zE="1.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q8(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $8(t){al(new lo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;ot(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Jw(t)},m=new oI(n,a,o,d);return vI(m,r),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),al(new lo("auth-internal",e=>{const r=xo(e.getProvider("auth").getImmediate());return(n=>new G8(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),bs(UE,zE,q8(t)),bs(UE,zE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y8=5*60,W8=Rw("authIdTokenMaxAge")||Y8;let HE=null;const K8=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>W8)return;const a=r==null?void 0:r.token;HE!==a&&(HE=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function X8(t=hv()){const e=am(t,"auth");if(e.isInitialized())return e.getImmediate();const r=gI(t,{popupRedirectResolver:H8,persistence:[e8,zI,uS]}),n=Rw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=K8(o.toString());MI(r,l,()=>l(r.currentUser)),LI(r,u=>l(u))}}const a=Aw("auth");return a&&xI(r,`http://${a}`),r}function Q8(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}lI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=As("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",Q8().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$8("Browser");var GE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var so,vS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,N){function R(){}R.prototype=N.prototype,C.D=N.prototype,C.prototype=new R,C.prototype.constructor=C,C.C=function(F,P,M){for(var U=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)U[Me-2]=arguments[Me];return N.prototype[P].apply(F,U)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,N,R){R||(R=0);var F=Array(16);if(typeof N=="string")for(var P=0;16>P;++P)F[P]=N.charCodeAt(R++)|N.charCodeAt(R++)<<8|N.charCodeAt(R++)<<16|N.charCodeAt(R++)<<24;else for(P=0;16>P;++P)F[P]=N[R++]|N[R++]<<8|N[R++]<<16|N[R++]<<24;N=C.g[0],R=C.g[1],P=C.g[2];var M=C.g[3],U=N+(M^R&(P^M))+F[0]+3614090360&4294967295;N=R+(U<<7&4294967295|U>>>25),U=M+(P^N&(R^P))+F[1]+3905402710&4294967295,M=N+(U<<12&4294967295|U>>>20),U=P+(R^M&(N^R))+F[2]+606105819&4294967295,P=M+(U<<17&4294967295|U>>>15),U=R+(N^P&(M^N))+F[3]+3250441966&4294967295,R=P+(U<<22&4294967295|U>>>10),U=N+(M^R&(P^M))+F[4]+4118548399&4294967295,N=R+(U<<7&4294967295|U>>>25),U=M+(P^N&(R^P))+F[5]+1200080426&4294967295,M=N+(U<<12&4294967295|U>>>20),U=P+(R^M&(N^R))+F[6]+2821735955&4294967295,P=M+(U<<17&4294967295|U>>>15),U=R+(N^P&(M^N))+F[7]+4249261313&4294967295,R=P+(U<<22&4294967295|U>>>10),U=N+(M^R&(P^M))+F[8]+1770035416&4294967295,N=R+(U<<7&4294967295|U>>>25),U=M+(P^N&(R^P))+F[9]+2336552879&4294967295,M=N+(U<<12&4294967295|U>>>20),U=P+(R^M&(N^R))+F[10]+4294925233&4294967295,P=M+(U<<17&4294967295|U>>>15),U=R+(N^P&(M^N))+F[11]+2304563134&4294967295,R=P+(U<<22&4294967295|U>>>10),U=N+(M^R&(P^M))+F[12]+1804603682&4294967295,N=R+(U<<7&4294967295|U>>>25),U=M+(P^N&(R^P))+F[13]+4254626195&4294967295,M=N+(U<<12&4294967295|U>>>20),U=P+(R^M&(N^R))+F[14]+2792965006&4294967295,P=M+(U<<17&4294967295|U>>>15),U=R+(N^P&(M^N))+F[15]+1236535329&4294967295,R=P+(U<<22&4294967295|U>>>10),U=N+(P^M&(R^P))+F[1]+4129170786&4294967295,N=R+(U<<5&4294967295|U>>>27),U=M+(R^P&(N^R))+F[6]+3225465664&4294967295,M=N+(U<<9&4294967295|U>>>23),U=P+(N^R&(M^N))+F[11]+643717713&4294967295,P=M+(U<<14&4294967295|U>>>18),U=R+(M^N&(P^M))+F[0]+3921069994&4294967295,R=P+(U<<20&4294967295|U>>>12),U=N+(P^M&(R^P))+F[5]+3593408605&4294967295,N=R+(U<<5&4294967295|U>>>27),U=M+(R^P&(N^R))+F[10]+38016083&4294967295,M=N+(U<<9&4294967295|U>>>23),U=P+(N^R&(M^N))+F[15]+3634488961&4294967295,P=M+(U<<14&4294967295|U>>>18),U=R+(M^N&(P^M))+F[4]+3889429448&4294967295,R=P+(U<<20&4294967295|U>>>12),U=N+(P^M&(R^P))+F[9]+568446438&4294967295,N=R+(U<<5&4294967295|U>>>27),U=M+(R^P&(N^R))+F[14]+3275163606&4294967295,M=N+(U<<9&4294967295|U>>>23),U=P+(N^R&(M^N))+F[3]+4107603335&4294967295,P=M+(U<<14&4294967295|U>>>18),U=R+(M^N&(P^M))+F[8]+1163531501&4294967295,R=P+(U<<20&4294967295|U>>>12),U=N+(P^M&(R^P))+F[13]+2850285829&4294967295,N=R+(U<<5&4294967295|U>>>27),U=M+(R^P&(N^R))+F[2]+4243563512&4294967295,M=N+(U<<9&4294967295|U>>>23),U=P+(N^R&(M^N))+F[7]+1735328473&4294967295,P=M+(U<<14&4294967295|U>>>18),U=R+(M^N&(P^M))+F[12]+2368359562&4294967295,R=P+(U<<20&4294967295|U>>>12),U=N+(R^P^M)+F[5]+4294588738&4294967295,N=R+(U<<4&4294967295|U>>>28),U=M+(N^R^P)+F[8]+2272392833&4294967295,M=N+(U<<11&4294967295|U>>>21),U=P+(M^N^R)+F[11]+1839030562&4294967295,P=M+(U<<16&4294967295|U>>>16),U=R+(P^M^N)+F[14]+4259657740&4294967295,R=P+(U<<23&4294967295|U>>>9),U=N+(R^P^M)+F[1]+2763975236&4294967295,N=R+(U<<4&4294967295|U>>>28),U=M+(N^R^P)+F[4]+1272893353&4294967295,M=N+(U<<11&4294967295|U>>>21),U=P+(M^N^R)+F[7]+4139469664&4294967295,P=M+(U<<16&4294967295|U>>>16),U=R+(P^M^N)+F[10]+3200236656&4294967295,R=P+(U<<23&4294967295|U>>>9),U=N+(R^P^M)+F[13]+681279174&4294967295,N=R+(U<<4&4294967295|U>>>28),U=M+(N^R^P)+F[0]+3936430074&4294967295,M=N+(U<<11&4294967295|U>>>21),U=P+(M^N^R)+F[3]+3572445317&4294967295,P=M+(U<<16&4294967295|U>>>16),U=R+(P^M^N)+F[6]+76029189&4294967295,R=P+(U<<23&4294967295|U>>>9),U=N+(R^P^M)+F[9]+3654602809&4294967295,N=R+(U<<4&4294967295|U>>>28),U=M+(N^R^P)+F[12]+3873151461&4294967295,M=N+(U<<11&4294967295|U>>>21),U=P+(M^N^R)+F[15]+530742520&4294967295,P=M+(U<<16&4294967295|U>>>16),U=R+(P^M^N)+F[2]+3299628645&4294967295,R=P+(U<<23&4294967295|U>>>9),U=N+(P^(R|~M))+F[0]+4096336452&4294967295,N=R+(U<<6&4294967295|U>>>26),U=M+(R^(N|~P))+F[7]+1126891415&4294967295,M=N+(U<<10&4294967295|U>>>22),U=P+(N^(M|~R))+F[14]+2878612391&4294967295,P=M+(U<<15&4294967295|U>>>17),U=R+(M^(P|~N))+F[5]+4237533241&4294967295,R=P+(U<<21&4294967295|U>>>11),U=N+(P^(R|~M))+F[12]+1700485571&4294967295,N=R+(U<<6&4294967295|U>>>26),U=M+(R^(N|~P))+F[3]+2399980690&4294967295,M=N+(U<<10&4294967295|U>>>22),U=P+(N^(M|~R))+F[10]+4293915773&4294967295,P=M+(U<<15&4294967295|U>>>17),U=R+(M^(P|~N))+F[1]+2240044497&4294967295,R=P+(U<<21&4294967295|U>>>11),U=N+(P^(R|~M))+F[8]+1873313359&4294967295,N=R+(U<<6&4294967295|U>>>26),U=M+(R^(N|~P))+F[15]+4264355552&4294967295,M=N+(U<<10&4294967295|U>>>22),U=P+(N^(M|~R))+F[6]+2734768916&4294967295,P=M+(U<<15&4294967295|U>>>17),U=R+(M^(P|~N))+F[13]+1309151649&4294967295,R=P+(U<<21&4294967295|U>>>11),U=N+(P^(R|~M))+F[4]+4149444226&4294967295,N=R+(U<<6&4294967295|U>>>26),U=M+(R^(N|~P))+F[11]+3174756917&4294967295,M=N+(U<<10&4294967295|U>>>22),U=P+(N^(M|~R))+F[2]+718787259&4294967295,P=M+(U<<15&4294967295|U>>>17),U=R+(M^(P|~N))+F[9]+3951481745&4294967295,C.g[0]=C.g[0]+N&4294967295,C.g[1]=C.g[1]+(P+(U<<21&4294967295|U>>>11))&4294967295,C.g[2]=C.g[2]+P&4294967295,C.g[3]=C.g[3]+M&4294967295}n.prototype.u=function(C,N){N===void 0&&(N=C.length);for(var R=N-this.blockSize,F=this.B,P=this.h,M=0;M<N;){if(P==0)for(;M<=R;)a(this,C,M),M+=this.blockSize;if(typeof C=="string"){for(;M<N;)if(F[P++]=C.charCodeAt(M++),P==this.blockSize){a(this,F),P=0;break}}else for(;M<N;)if(F[P++]=C[M++],P==this.blockSize){a(this,F),P=0;break}}this.h=P,this.o+=N},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var N=1;N<C.length-8;++N)C[N]=0;var R=8*this.o;for(N=C.length-8;N<C.length;++N)C[N]=R&255,R/=256;for(this.u(C),C=Array(16),N=R=0;4>N;++N)for(var F=0;32>F;F+=8)C[R++]=this.g[N]>>>F&255;return C};function o(C,N){var R=u;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=N(C)}function l(C,N){this.h=N;for(var R=[],F=!0,P=C.length-1;0<=P;P--){var M=C[P]|0;F&&M==N||(R[P]=M,F=!1)}this.g=R}var u={};function d(C){return-128<=C&&128>C?o(C,function(N){return new l([N|0],0>N?-1:0)}):new l([C|0],0>C?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return y;if(0>C)return b(m(-C));for(var N=[],R=1,F=0;C>=R;F++)N[F]=C/R|0,R*=4294967296;return new l(N,0)}function g(C,N){if(C.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(C.charAt(0)=="-")return b(g(C.substring(1),N));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(N,8)),F=y,P=0;P<C.length;P+=8){var M=Math.min(8,C.length-P),U=parseInt(C.substring(P,P+M),N);8>M?(M=m(Math.pow(N,M)),F=F.j(M).add(m(U))):(F=F.j(R),F=F.add(m(U)))}return F}var y=d(0),_=d(1),T=d(16777216);t=l.prototype,t.m=function(){if(S(this))return-b(this).m();for(var C=0,N=1,R=0;R<this.g.length;R++){var F=this.i(R);C+=(0<=F?F:4294967296+F)*N,N*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(E(this))return"0";if(S(this))return"-"+b(this).toString(C);for(var N=m(Math.pow(C,6)),R=this,F="";;){var P=D(R,N).g;R=O(R,P.j(N));var M=((0<R.g.length?R.g[0]:R.h)>>>0).toString(C);if(R=P,E(R))return M+F;for(;6>M.length;)M="0"+M;F=M+F}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function E(C){if(C.h!=0)return!1;for(var N=0;N<C.g.length;N++)if(C.g[N]!=0)return!1;return!0}function S(C){return C.h==-1}t.l=function(C){return C=O(this,C),S(C)?-1:E(C)?0:1};function b(C){for(var N=C.g.length,R=[],F=0;F<N;F++)R[F]=~C.g[F];return new l(R,~C.h).add(_)}t.abs=function(){return S(this)?b(this):this},t.add=function(C){for(var N=Math.max(this.g.length,C.g.length),R=[],F=0,P=0;P<=N;P++){var M=F+(this.i(P)&65535)+(C.i(P)&65535),U=(M>>>16)+(this.i(P)>>>16)+(C.i(P)>>>16);F=U>>>16,M&=65535,U&=65535,R[P]=U<<16|M}return new l(R,R[R.length-1]&-2147483648?-1:0)};function O(C,N){return C.add(b(N))}t.j=function(C){if(E(this)||E(C))return y;if(S(this))return S(C)?b(this).j(b(C)):b(b(this).j(C));if(S(C))return b(this.j(b(C)));if(0>this.l(T)&&0>C.l(T))return m(this.m()*C.m());for(var N=this.g.length+C.g.length,R=[],F=0;F<2*N;F++)R[F]=0;for(F=0;F<this.g.length;F++)for(var P=0;P<C.g.length;P++){var M=this.i(F)>>>16,U=this.i(F)&65535,Me=C.i(P)>>>16,Ne=C.i(P)&65535;R[2*F+2*P]+=U*Ne,L(R,2*F+2*P),R[2*F+2*P+1]+=M*Ne,L(R,2*F+2*P+1),R[2*F+2*P+1]+=U*Me,L(R,2*F+2*P+1),R[2*F+2*P+2]+=M*Me,L(R,2*F+2*P+2)}for(F=0;F<N;F++)R[F]=R[2*F+1]<<16|R[2*F];for(F=N;F<2*N;F++)R[F]=0;return new l(R,0)};function L(C,N){for(;(C[N]&65535)!=C[N];)C[N+1]+=C[N]>>>16,C[N]&=65535,N++}function A(C,N){this.g=C,this.h=N}function D(C,N){if(E(N))throw Error("division by zero");if(E(C))return new A(y,y);if(S(C))return N=D(b(C),N),new A(b(N.g),b(N.h));if(S(N))return N=D(C,b(N)),new A(b(N.g),N.h);if(30<C.g.length){if(S(C)||S(N))throw Error("slowDivide_ only works with positive integers.");for(var R=_,F=N;0>=F.l(C);)R=V(R),F=V(F);var P=H(R,1),M=H(F,1);for(F=H(F,2),R=H(R,2);!E(F);){var U=M.add(F);0>=U.l(C)&&(P=P.add(R),M=U),F=H(F,1),R=H(R,1)}return N=O(C,P.j(N)),new A(P,N)}for(P=y;0<=C.l(N);){for(R=Math.max(1,Math.floor(C.m()/N.m())),F=Math.ceil(Math.log(R)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),M=m(R),U=M.j(N);S(U)||0<U.l(C);)R-=F,M=m(R),U=M.j(N);E(M)&&(M=_),P=P.add(M),C=O(C,U)}return new A(P,C)}t.A=function(C){return D(this,C).h},t.and=function(C){for(var N=Math.max(this.g.length,C.g.length),R=[],F=0;F<N;F++)R[F]=this.i(F)&C.i(F);return new l(R,this.h&C.h)},t.or=function(C){for(var N=Math.max(this.g.length,C.g.length),R=[],F=0;F<N;F++)R[F]=this.i(F)|C.i(F);return new l(R,this.h|C.h)},t.xor=function(C){for(var N=Math.max(this.g.length,C.g.length),R=[],F=0;F<N;F++)R[F]=this.i(F)^C.i(F);return new l(R,this.h^C.h)};function V(C){for(var N=C.g.length+1,R=[],F=0;F<N;F++)R[F]=C.i(F)<<1|C.i(F-1)>>>31;return new l(R,C.h)}function H(C,N){var R=N>>5;N%=32;for(var F=C.g.length-R,P=[],M=0;M<F;M++)P[M]=0<N?C.i(M+R)>>>N|C.i(M+R+1)<<32-N:C.i(M+R);return new l(P,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,vS=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=g,so=l}).apply(typeof GE<"u"?GE:typeof self<"u"?self:typeof window<"u"?window:{});var Vd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xS,tf,_S,l0,Sg,yS,ES,TS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,w,k){return p==Array.prototype||p==Object.prototype||(p[w]=k.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vd=="object"&&Vd];for(var w=0;w<p.length;++w){var k=p[w];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function a(p,w){if(w)e:{var k=n;p=p.split(".");for(var q=0;q<p.length-1;q++){var fe=p[q];if(!(fe in k))break e;k=k[fe]}p=p[p.length-1],q=k[p],w=w(q),w!=q&&w!=null&&e(k,p,{configurable:!0,writable:!0,value:w})}}function o(p,w){p instanceof String&&(p+="");var k=0,q=!1,fe={next:function(){if(!q&&k<p.length){var we=k++;return{value:w(we,p[we]),done:!1}}return q=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}a("Array.prototype.values",function(p){return p||function(){return o(this,function(w,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function d(p){var w=typeof p;return w=w!="object"?w:p?Array.isArray(p)?"array":w:"null",w=="array"||w=="object"&&typeof p.length=="number"}function m(p){var w=typeof p;return w=="object"&&p!=null||w=="function"}function g(p,w,k){return p.call.apply(p.bind,arguments)}function y(p,w,k){if(!p)throw Error();if(2<arguments.length){var q=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,q),p.apply(w,fe)}}return function(){return p.apply(w,arguments)}}function _(p,w,k){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:y,_.apply(null,arguments)}function T(p,w){var k=Array.prototype.slice.call(arguments,1);return function(){var q=k.slice();return q.push.apply(q,arguments),p.apply(this,q)}}function E(p,w){function k(){}k.prototype=w.prototype,p.aa=w.prototype,p.prototype=new k,p.prototype.constructor=p,p.Qb=function(q,fe,we){for(var He=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)He[jt-2]=arguments[jt];return w.prototype[fe].apply(q,He)}}function S(p){const w=p.length;if(0<w){const k=Array(w);for(let q=0;q<w;q++)k[q]=p[q];return k}return[]}function b(p,w){for(let k=1;k<arguments.length;k++){const q=arguments[k];if(d(q)){const fe=p.length||0,we=q.length||0;p.length=fe+we;for(let He=0;He<we;He++)p[fe+He]=q[He]}else p.push(q)}}class O{constructor(w,k){this.i=w,this.j=k,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function L(p){return/^[\s\xa0]*$/.test(p)}function A(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function D(p){return D[" "](p),p}D[" "]=function(){};var V=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function H(p,w,k){for(const q in p)w.call(k,p[q],q,p)}function C(p,w){for(const k in p)w.call(void 0,p[k],k,p)}function N(p){const w={};for(const k in p)w[k]=p[k];return w}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(p,w){let k,q;for(let fe=1;fe<arguments.length;fe++){q=arguments[fe];for(k in q)p[k]=q[k];for(let we=0;we<R.length;we++)k=R[we],Object.prototype.hasOwnProperty.call(q,k)&&(p[k]=q[k])}}function P(p){var w=1;p=p.split(":");const k=[];for(;0<w&&p.length;)k.push(p.shift()),w--;return p.length&&k.push(p.join(":")),k}function M(p){u.setTimeout(()=>{throw p},0)}function U(){var p=oe;let w=null;return p.g&&(w=p.g,p.g=p.g.next,p.g||(p.h=null),w.next=null),w}class Me{constructor(){this.h=this.g=null}add(w,k){const q=Ne.get();q.set(w,k),this.h?this.h.next=q:this.g=q,this.h=q}}var Ne=new O(()=>new ie,p=>p.reset());class ie{constructor(){this.next=this.g=this.h=null}set(w,k){this.h=w,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let me,Pe=!1,oe=new Me,ee=()=>{const p=u.Promise.resolve(void 0);me=()=>{p.then(ue)}};var ue=()=>{for(var p;p=U();){try{p.h.call(p.g)}catch(k){M(k)}var w=Ne;w.j(p),100>w.h&&(w.h++,p.next=w.g,w.g=p)}Pe=!1};function z(){this.s=this.s,this.C=this.C}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(p,w){this.type=p,this.g=this.target=w,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,w=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};u.addEventListener("test",k,w),u.removeEventListener("test",k,w)}catch{}return p}();function K(p,w){if(X.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var k=this.type=p.type,q=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=w,w=p.relatedTarget){if(V){e:{try{D(w.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(w=null)}}else k=="mouseover"?w=p.fromElement:k=="mouseout"&&(w=p.toElement);this.relatedTarget=w,q?(this.clientX=q.clientX!==void 0?q.clientX:q.pageX,this.clientY=q.clientY!==void 0?q.clientY:q.pageY,this.screenX=q.screenX||0,this.screenY=q.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:Q[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&K.aa.h.call(this)}}E(K,X);var Q={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function Ae(p,w,k,q,fe){this.listener=p,this.proxy=null,this.src=w,this.type=k,this.capture=!!q,this.ha=fe,this.key=++Ee,this.da=this.fa=!1}function be(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Ze(p){this.src=p,this.g={},this.h=0}Ze.prototype.add=function(p,w,k,q,fe){var we=p.toString();p=this.g[we],p||(p=this.g[we]=[],this.h++);var He=Ct(p,w,q,fe);return-1<He?(w=p[He],k||(w.fa=!1)):(w=new Ae(w,this.src,we,!!q,fe),w.fa=k,p.push(w)),w};function re(p,w){var k=w.type;if(k in p.g){var q=p.g[k],fe=Array.prototype.indexOf.call(q,w,void 0),we;(we=0<=fe)&&Array.prototype.splice.call(q,fe,1),we&&(be(w),p.g[k].length==0&&(delete p.g[k],p.h--))}}function Ct(p,w,k,q){for(var fe=0;fe<p.length;++fe){var we=p[fe];if(!we.da&&we.listener==w&&we.capture==!!k&&we.ha==q)return fe}return-1}var We="closure_lm_"+(1e6*Math.random()|0),lt={};function Fe(p,w,k,q,fe){if(Array.isArray(w)){for(var we=0;we<w.length;we++)Fe(p,w[we],k,q,fe);return null}return k=Wr(k),p&&p[ye]?p.K(w,k,m(q)?!!q.capture:!1,fe):je(p,w,k,!1,q,fe)}function je(p,w,k,q,fe,we){if(!w)throw Error("Invalid event type");var He=m(fe)?!!fe.capture:!!fe,jt=lr(p);if(jt||(p[We]=jt=new Ze(p)),k=jt.add(w,k,q,He,we),k.proxy)return k;if(q=Wt(),k.proxy=q,q.src=p,q.listener=k,p.addEventListener)G||(fe=He),fe===void 0&&(fe=!1),p.addEventListener(w.toString(),q,fe);else if(p.attachEvent)p.attachEvent(tr(w.toString()),q);else if(p.addListener&&p.removeListener)p.addListener(q);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Wt(){function p(k){return w.call(p.src,p.listener,k)}const w=On;return p}function Tr(p,w,k,q,fe){if(Array.isArray(w))for(var we=0;we<w.length;we++)Tr(p,w[we],k,q,fe);else q=m(q)?!!q.capture:!!q,k=Wr(k),p&&p[ye]?(p=p.i,w=String(w).toString(),w in p.g&&(we=p.g[w],k=Ct(we,k,q,fe),-1<k&&(be(we[k]),Array.prototype.splice.call(we,k,1),we.length==0&&(delete p.g[w],p.h--)))):p&&(p=lr(p))&&(w=p.g[w.toString()],p=-1,w&&(p=Ct(w,k,q,fe)),(k=-1<p?w[p]:null)&&Rr(k))}function Rr(p){if(typeof p!="number"&&p&&!p.da){var w=p.src;if(w&&w[ye])re(w.i,p);else{var k=p.type,q=p.proxy;w.removeEventListener?w.removeEventListener(k,q,p.capture):w.detachEvent?w.detachEvent(tr(k),q):w.addListener&&w.removeListener&&w.removeListener(q),(k=lr(w))?(re(k,p),k.h==0&&(k.src=null,w[We]=null)):be(p)}}}function tr(p){return p in lt?lt[p]:lt[p]="on"+p}function On(p,w){if(p.da)p=!0;else{w=new K(w,this);var k=p.listener,q=p.ha||p.src;p.fa&&Rr(p),p=k.call(q,w)}return p}function lr(p){return p=p[We],p instanceof Ze?p:null}var wr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Wr(p){return typeof p=="function"?p:(p[wr]||(p[wr]=function(w){return p.handleEvent(w)}),p[wr])}function It(){z.call(this),this.i=new Ze(this),this.M=this,this.F=null}E(It,z),It.prototype[ye]=!0,It.prototype.removeEventListener=function(p,w,k,q){Tr(this,p,w,k,q)};function Se(p,w){var k,q=p.F;if(q)for(k=[];q;q=q.F)k.push(q);if(p=p.M,q=w.type||w,typeof w=="string")w=new X(w,p);else if(w instanceof X)w.target=w.target||p;else{var fe=w;w=new X(q,p),F(w,fe)}if(fe=!0,k)for(var we=k.length-1;0<=we;we--){var He=w.g=k[we];fe=Ke(He,q,!0,w)&&fe}if(He=w.g=p,fe=Ke(He,q,!0,w)&&fe,fe=Ke(He,q,!1,w)&&fe,k)for(we=0;we<k.length;we++)He=w.g=k[we],fe=Ke(He,q,!1,w)&&fe}It.prototype.N=function(){if(It.aa.N.call(this),this.i){var p=this.i,w;for(w in p.g){for(var k=p.g[w],q=0;q<k.length;q++)be(k[q]);delete p.g[w],p.h--}}this.F=null},It.prototype.K=function(p,w,k,q){return this.i.add(String(p),w,!1,k,q)},It.prototype.L=function(p,w,k,q){return this.i.add(String(p),w,!0,k,q)};function Ke(p,w,k,q){if(w=p.i.g[String(w)],!w)return!0;w=w.concat();for(var fe=!0,we=0;we<w.length;++we){var He=w[we];if(He&&!He.da&&He.capture==k){var jt=He.listener,Br=He.ha||He.src;He.fa&&re(p.i,He),fe=jt.call(Br,q)!==!1&&fe}}return fe&&!q.defaultPrevented}function Je(p,w,k){if(typeof p=="function")k&&(p=_(p,k));else if(p&&typeof p.handleEvent=="function")p=_(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:u.setTimeout(p,w||0)}function tt(p){p.g=Je(()=>{p.g=null,p.i&&(p.i=!1,tt(p))},p.l);const w=p.h;p.h=null,p.m.apply(null,w)}class wt extends z{constructor(w,k){super(),this.m=w,this.l=k,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:tt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function St(p){z.call(this),this.h=p,this.g={}}E(St,z);var gt=[];function or(p){H(p.g,function(w,k){this.g.hasOwnProperty(k)&&Rr(w)},p),p.g={}}St.prototype.N=function(){St.aa.N.call(this),or(this)},St.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=u.JSON.stringify,xn=u.JSON.parse,qt=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function ra(){}ra.prototype.h=null;function jn(p){return p.h||(p.h=p.i())}function Fa(){}var Yn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function La(){X.call(this,"d")}E(La,X);function ss(){X.call(this,"c")}E(ss,X);var xa={},wo=null;function is(){return wo=wo||new It}xa.La="serverreachability";function Ti(p){X.call(this,xa.La,p)}E(Ti,X);function os(p){const w=is();Se(w,new Ti(w))}xa.STAT_EVENT="statevent";function wl(p,w){X.call(this,xa.STAT_EVENT,p),this.stat=w}E(wl,X);function ar(p){const w=is();Se(w,new wl(w,p))}xa.Ma="timingevent";function Sr(p,w){X.call(this,xa.Ma,p),this.size=w}E(Sr,X);function ur(p,w){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},w)}function Wn(){this.g=!0}Wn.prototype.xa=function(){this.g=!1};function So(p,w,k,q,fe,we){p.info(function(){if(p.g)if(we)for(var He="",jt=we.split("&"),Br=0;Br<jt.length;Br++){var Pt=jt[Br].split("=");if(1<Pt.length){var Xr=Pt[0];Pt=Pt[1];var Vr=Xr.split("_");He=2<=Vr.length&&Vr[1]=="type"?He+(Xr+"="+Pt+"&"):He+(Xr+"=redacted&")}}else He=null;else He=we;return"XMLHTTP REQ ("+q+") [attempt "+fe+"]: "+w+`
`+k+`
`+He})}function Xc(p,w,k,q,fe,we,He){p.info(function(){return"XMLHTTP RESP ("+q+") [ attempt "+fe+"]: "+w+`
`+k+`
`+we+" "+He})}function j(p,w,k,q){p.info(function(){return"XMLHTTP TEXT ("+w+"): "+Y(p,k)+(q?" "+q:"")})}function Z(p,w){p.info(function(){return"TIMEOUT: "+w})}Wn.prototype.info=function(){};function Y(p,w){if(!p.g)return w;if(!w)return null;try{var k=JSON.parse(w);if(k){for(p=0;p<k.length;p++)if(Array.isArray(k[p])){var q=k[p];if(!(2>q.length)){var fe=q[1];if(Array.isArray(fe)&&!(1>fe.length)){var we=fe[0];if(we!="noop"&&we!="stop"&&we!="close")for(var He=1;He<fe.length;He++)fe[He]=""}}}}return cr(k)}catch{return w}}var W={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},J={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},te;function de(){}E(de,ra),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},te=new de;function Te(p,w,k,q){this.j=p,this.i=w,this.l=k,this.R=q||1,this.U=new St(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var ge={},ve={};function Oe(p,w,k){p.L=1,p.v=Co(aa(w)),p.m=k,p.P=!0,Be(p,null)}function Be(p,w){p.F=Date.now(),Ge(p),p.A=aa(p.v);var k=p.A,q=p.R;Array.isArray(q)||(q=[String(q)]),tu(k.i,"t",q),p.C=0,k=p.j.J,p.h=new ce,p.g=jh(p.j,k?w:null,!p.m),0<p.O&&(p.M=new wt(_(p.Y,p,p.g),p.O)),w=p.U,k=p.g,q=p.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(gt[0]=fe.toString()),fe=gt);for(var we=0;we<fe.length;we++){var He=Fe(k,fe[we],q||w.handleEvent,!1,w.h||w);if(!He)break;w.g[He.key]=He}w=p.H?N(p.H):{},p.m?(p.u||(p.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,w)):(p.u="GET",p.g.ea(p.A,p.u,null,w)),os(),So(p.i,p.u,p.A,p.l,p.R,p.m)}Te.prototype.ca=function(p){p=p.target;const w=this.M;w&&Ta(p)==3?w.j():this.Y(p)},Te.prototype.Y=function(p){try{if(p==this.g)e:{const Vr=Ta(this.g);var w=this.g.Ba();const Gs=this.g.Z();if(!(3>Vr)&&(Vr!=3||this.g&&(this.h.h||this.g.oa()||Ah(this.g)))){this.J||Vr!=4||w==7||(w==8||0>=Gs?os(3):os(2)),Ht(this);var k=this.g.Z();this.X=k;t:if($e(this)){var q=Ah(this.g);p="";var fe=q.length,we=Ta(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ot(this),Dt(this);var He="";break t}this.h.i=new u.TextDecoder}for(w=0;w<fe;w++)this.h.h=!0,p+=this.h.i.decode(q[w],{stream:!(we&&w==fe-1)});q.length=0,this.h.g+=p,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=k==200,Xc(this.i,this.u,this.A,this.l,this.R,Vr,k),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,Br=this.g;if((jt=Br.g?Br.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(jt)){var Pt=jt;break t}}Pt=null}if(k=Pt)j(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,na(this,k);else{this.o=!1,this.s=3,ar(12),Ot(this),Dt(this);break e}}if(this.P){k=!0;let an;for(;!this.J&&this.C<He.length;)if(an=Le(this,He),an==ve){Vr==4&&(this.s=4,ar(14),k=!1),j(this.i,this.l,null,"[Incomplete Response]");break}else if(an==ge){this.s=4,ar(15),j(this.i,this.l,He,"[Invalid Chunk]"),k=!1;break}else j(this.i,this.l,an,null),na(this,an);if($e(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vr!=4||He.length!=0||this.h.h||(this.s=1,ar(16),k=!1),this.o=this.o&&k,!k)j(this.i,this.l,He,"[Invalid Chunked Response]"),Ot(this),Dt(this);else if(0<He.length&&!this.W){this.W=!0;var Xr=this.j;Xr.g==this&&Xr.ba&&!Xr.M&&(Xr.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),Po(Xr),Xr.M=!0,ar(11))}}else j(this.i,this.l,He,null),na(this,He);Vr==4&&Ot(this),this.o&&!this.J&&(Vr==4?Ih(this.j,this):(this.o=!1,Ge(this)))}else zm(this.g),k==400&&0<He.indexOf("Unknown SID")?(this.s=3,ar(12)):(this.s=0,ar(13)),Ot(this),Dt(this)}}}catch{}finally{}};function $e(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Le(p,w){var k=p.C,q=w.indexOf(`
`,k);return q==-1?ve:(k=Number(w.substring(k,q)),isNaN(k)?ge:(q+=1,q+k>w.length?ve:(w=w.slice(q,q+k),p.C=q+k,w)))}Te.prototype.cancel=function(){this.J=!0,Ot(this)};function Ge(p){p.S=Date.now()+p.I,ct(p,p.I)}function ct(p,w){if(p.B!=null)throw Error("WatchDog timer not null");p.B=ur(_(p.ba,p),w)}function Ht(p){p.B&&(u.clearTimeout(p.B),p.B=null)}Te.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Z(this.i,this.A),this.L!=2&&(os(),ar(17)),Ot(this),this.s=2,Dt(this)):ct(this,this.S-p)};function Dt(p){p.j.G==0||p.J||Ih(p.j,p)}function Ot(p){Ht(p);var w=p.M;w&&typeof w.ma=="function"&&w.ma(),p.M=null,or(p.U),p.g&&(w=p.g,p.g=null,w.abort(),w.ma())}function na(p,w){try{var k=p.j;if(k.G!=0&&(k.g==p||Fn(k.h,p))){if(!p.K&&Fn(k.h,p)&&k.G==3){try{var q=k.Da.g.parse(w)}catch{q=null}if(Array.isArray(q)&&q.length==3){var fe=q;if(fe[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<p.F)Ol(k),Il(k);else break e;iu(k),ar(18)}}else k.za=fe[1],0<k.za-k.T&&37500>fe[2]&&k.F&&k.v==0&&!k.C&&(k.C=ur(_(k.Za,k),6e3));if(1>=cs(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Hs(k,11)}else if((p.K||k.g==p)&&Ol(k),!L(w))for(fe=k.Da.g.parse(w),w=0;w<fe.length;w++){let Pt=fe[w];if(k.T=Pt[0],Pt=Pt[1],k.G==2)if(Pt[0]=="c"){k.K=Pt[1],k.ia=Pt[2];const Xr=Pt[3];Xr!=null&&(k.la=Xr,k.j.info("VER="+k.la));const Vr=Pt[4];Vr!=null&&(k.Aa=Vr,k.j.info("SVER="+k.Aa));const Gs=Pt[5];Gs!=null&&typeof Gs=="number"&&0<Gs&&(q=1.5*Gs,k.L=q,k.j.info("backChannelRequestTimeoutMs_="+q)),q=k;const an=p.g;if(an){const gs=an.g?an.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gs){var we=q.h;we.g||gs.indexOf("spdy")==-1&&gs.indexOf("quic")==-1&&gs.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(Sl(we,we.h),we.h=null))}if(q.D){const lu=an.g?an.g.getResponseHeader("X-HTTP-Session-Id"):null;lu&&(q.ya=lu,Qt(q.I,q.D,lu))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-p.F,k.j.info("Handshake RTT: "+k.R+"ms")),q=k;var He=p;if(q.qa=Oh(q,q.J?q.ia:null,q.W),He.K){Ln(q.h,He);var jt=He,Br=q.L;Br&&(jt.I=Br),jt.B&&(Ht(jt),Ge(jt)),q.g=He}else Rh(q);0<k.i.length&&Dl(k)}else Pt[0]!="stop"&&Pt[0]!="close"||Hs(k,7);else k.G==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?Hs(k,7):au(k):Pt[0]!="noop"&&k.l&&k.l.ta(Pt),k.v=0)}}os(4)}catch{}}var ls=class{constructor(p,w){this.g=p,this.map=w}};function Pn(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kn(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function cs(p){return p.h?1:p.g?p.g.size:0}function Fn(p,w){return p.h?p.h==w:p.g?p.g.has(w):!1}function Sl(p,w){p.g?p.g.add(w):p.h=w}function Ln(p,w){p.h&&p.h==w?p.h=null:p.g&&p.g.has(w)&&p.g.delete(w)}Pn.prototype.cancel=function(){if(this.i=Qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Qc(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let w=p.i;for(const k of p.g.values())w=w.concat(k.D);return w}return S(p.i)}function Mm(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(d(p)){for(var w=[],k=p.length,q=0;q<k;q++)w.push(p[q]);return w}w=[],k=0;for(q in p)w[k++]=p[q];return w}function bl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(d(p)||typeof p=="string"){var w=[];p=p.length;for(var k=0;k<p;k++)w.push(k);return w}w=[],k=0;for(const q in p)w[k++]=q;return w}}}function Jc(p,w){if(p.forEach&&typeof p.forEach=="function")p.forEach(w,void 0);else if(d(p)||typeof p=="string")Array.prototype.forEach.call(p,w,void 0);else for(var k=bl(p),q=Mm(p),fe=q.length,we=0;we<fe;we++)w.call(void 0,q[we],k&&k[we],p)}var bo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Bm(p,w){if(p){p=p.split("&");for(var k=0;k<p.length;k++){var q=p[k].indexOf("="),fe=null;if(0<=q){var we=p[k].substring(0,q);fe=p[k].substring(q+1)}else we=p[k];w(we,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function kr(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof kr){this.h=p.h,Ao(this,p.j),this.o=p.o,this.g=p.g,wi(this,p.s),this.l=p.l;var w=p.i,k=new Bs;k.i=w.i,w.g&&(k.g=new Map(w.g),k.h=w.h),Ms(this,k),this.m=p.m}else p&&(w=String(p).match(bo))?(this.h=!1,Ao(this,w[1]||"",!0),this.o=_a(w[2]||""),this.g=_a(w[3]||"",!0),wi(this,w[4]),this.l=_a(w[5]||"",!0),Ms(this,w[6]||"",!0),this.m=_a(w[7]||"")):(this.h=!1,this.i=new Bs(null,this.h))}kr.prototype.toString=function(){var p=[],w=this.j;w&&p.push(No(w,Zc,!0),":");var k=this.g;return(k||w=="file")&&(p.push("//"),(w=this.o)&&p.push(No(w,Zc,!0),"@"),p.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&p.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(No(k,k.charAt(0)=="/"?Vm:eu,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",No(k,Al)),p.join("")};function aa(p){return new kr(p)}function Ao(p,w,k){p.j=k?_a(w,!0):w,p.j&&(p.j=p.j.replace(/:$/,""))}function wi(p,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);p.s=w}else p.s=null}function Ms(p,w,k){w instanceof Bs?(p.i=w,Sh(p.i,p.h)):(k||(w=No(w,Um)),p.i=new Bs(w,p.h))}function Qt(p,w,k){p.i.set(w,k)}function Co(p){return Qt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function _a(p,w){return p?w?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function No(p,w,k){return typeof p=="string"?(p=encodeURI(p).replace(w,wh),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function wh(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Zc=/[#\/\?@]/g,eu=/[#\?:]/g,Vm=/[#\?]/g,Um=/[#\?@]/g,Al=/#/g;function Bs(p,w){this.h=this.g=null,this.i=p||null,this.j=!!w}function ya(p){p.g||(p.g=new Map,p.h=0,p.i&&Bm(p.i,function(w,k){p.add(decodeURIComponent(w.replace(/\+/g," ")),k)}))}t=Bs.prototype,t.add=function(p,w){ya(this),this.i=null,p=us(this,p);var k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(w),this.h+=1,this};function Vs(p,w){ya(p),w=us(p,w),p.g.has(w)&&(p.i=null,p.h-=p.g.get(w).length,p.g.delete(w))}function Us(p,w){return ya(p),w=us(p,w),p.g.has(w)}t.forEach=function(p,w){ya(this),this.g.forEach(function(k,q){k.forEach(function(fe){p.call(w,fe,q,this)},this)},this)},t.na=function(){ya(this);const p=Array.from(this.g.values()),w=Array.from(this.g.keys()),k=[];for(let q=0;q<w.length;q++){const fe=p[q];for(let we=0;we<fe.length;we++)k.push(w[q])}return k},t.V=function(p){ya(this);let w=[];if(typeof p=="string")Us(this,p)&&(w=w.concat(this.g.get(us(this,p))));else{p=Array.from(this.g.values());for(let k=0;k<p.length;k++)w=w.concat(p[k])}return w},t.set=function(p,w){return ya(this),this.i=null,p=us(this,p),Us(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[w]),this.h+=1,this},t.get=function(p,w){return p?(p=this.V(p),0<p.length?String(p[0]):w):w};function tu(p,w,k){Vs(p,w),0<k.length&&(p.i=null,p.g.set(us(p,w),S(k)),p.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],w=Array.from(this.g.keys());for(var k=0;k<w.length;k++){var q=w[k];const we=encodeURIComponent(String(q)),He=this.V(q);for(q=0;q<He.length;q++){var fe=we;He[q]!==""&&(fe+="="+encodeURIComponent(String(He[q]))),p.push(fe)}}return this.i=p.join("&")};function us(p,w){return w=String(w),p.j&&(w=w.toLowerCase()),w}function Sh(p,w){w&&!p.j&&(ya(p),p.i=null,p.g.forEach(function(k,q){var fe=q.toLowerCase();q!=fe&&(Vs(this,q),tu(this,fe,k))},p)),p.j=w}function Ro(p,w){const k=new Wn;if(u.Image){const q=new Image;q.onload=T(Ea,k,"TestLoadImage: loaded",!0,w,q),q.onerror=T(Ea,k,"TestLoadImage: error",!1,w,q),q.onabort=T(Ea,k,"TestLoadImage: abort",!1,w,q),q.ontimeout=T(Ea,k,"TestLoadImage: timeout",!1,w,q),u.setTimeout(function(){q.ontimeout&&q.ontimeout()},1e4),q.src=p}else w(!1)}function Ma(p,w){const k=new Wn,q=new AbortController,fe=setTimeout(()=>{q.abort(),Ea(k,"TestPingServer: timeout",!1,w)},1e4);fetch(p,{signal:q.signal}).then(we=>{clearTimeout(fe),we.ok?Ea(k,"TestPingServer: ok",!0,w):Ea(k,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(fe),Ea(k,"TestPingServer: error",!1,w)})}function Ea(p,w,k,q,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),q(k)}catch{}}function ko(){this.g=new qt}function fs(p,w,k){const q=k||"";try{Jc(p,function(fe,we){let He=fe;m(fe)&&(He=cr(fe)),w.push(q+we+"="+encodeURIComponent(He))})}catch(fe){throw w.push(q+"type="+encodeURIComponent("_badmap")),fe}}function Si(p){this.l=p.Ub||null,this.j=p.eb||!1}E(Si,ra),Si.prototype.g=function(){return new zs(this.l,this.j)},Si.prototype.i=function(p){return function(){return p}}({});function zs(p,w){It.call(this),this.D=p,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(zs,It),t=zs.prototype,t.open=function(p,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=w,this.readyState=1,ds(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(w.body=p),(this.D||u).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hs(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ds(this)),this.g&&(this.readyState=3,ds(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ru(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function ru(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var w=p.value?p.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!p.done}))&&(this.response=this.responseText+=w)}p.done?hs(this):ds(this),this.readyState==3&&ru(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,hs(this))},t.Qa=function(p){this.g&&(this.response=p,hs(this))},t.ga=function(){this.g&&hs(this)};function hs(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ds(p)}t.setRequestHeader=function(p,w){this.u.append(p,w)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],w=this.h.entries();for(var k=w.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=w.next();return p.join(`\r
`)};function ds(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function nu(p){let w="";return H(p,function(k,q){w+=q,w+=":",w+=k,w+=`\r
`}),w}function Kr(p,w,k){e:{for(q in k){var q=!1;break e}q=!0}q||(k=nu(k),typeof p=="string"?k!=null&&encodeURIComponent(String(k)):Qt(p,w,k))}function Yt(p){It.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Yt,It);var Cl=/^https?$/i,Io=["POST","PUT"];t=Yt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,w,k,q){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);w=w?w.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():te.g(),this.v=this.o?jn(this.o):jn(te),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(w,String(p),!0),this.B=!1}catch(we){bh(this,we);return}if(p=k||"",k=new Map(this.headers),q)if(Object.getPrototypeOf(q)===Object.prototype)for(var fe in q)k.set(fe,q[fe]);else if(typeof q.keys=="function"&&typeof q.get=="function")for(const we of q.keys())k.set(we,q.get(we));else throw Error("Unknown input type for opt_headers: "+String(q));q=Array.from(k.keys()).find(we=>we.toLowerCase()=="content-type"),fe=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Io,w,void 0))||q||fe||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,He]of k)this.g.setRequestHeader(we,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Do(this),this.u=!0,this.g.send(p),this.u=!1}catch(we){bh(this,we)}};function bh(p,w){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=w,p.m=5,Nl(p),ms(p)}function Nl(p){p.A||(p.A=!0,Se(p,"complete"),Se(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Se(this,"complete"),Se(this,"abort"),ms(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ms(this,!0)),Yt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rl(this):this.bb())},t.bb=function(){Rl(this)};function Rl(p){if(p.h&&typeof l<"u"&&(!p.v[1]||Ta(p)!=4||p.Z()!=2)){if(p.u&&Ta(p)==4)Je(p.Ea,0,p);else if(Se(p,"readystatechange"),Ta(p)==4){p.h=!1;try{const He=p.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var k;if(!(k=w)){var q;if(q=He===0){var fe=String(p.D).match(bo)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),q=!Cl.test(fe?fe.toLowerCase():"")}k=q}if(k)Se(p,"complete"),Se(p,"success");else{p.m=6;try{var we=2<Ta(p)?p.g.statusText:""}catch{we=""}p.l=we+" ["+p.Z()+"]",Nl(p)}}finally{ms(p)}}}}function ms(p,w){if(p.g){Do(p);const k=p.g,q=p.v[0]?()=>{}:null;p.g=null,p.v=null,w||Se(p,"ready");try{k.onreadystatechange=q}catch{}}}function Do(p){p.I&&(u.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function Ta(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<Ta(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var w=this.g.responseText;return p&&w.indexOf(p)==0&&(w=w.substring(p.length)),xn(w)}};function Ah(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function zm(p){const w={};p=(p.g&&2<=Ta(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let q=0;q<p.length;q++){if(L(p[q]))continue;var k=P(p[q]);const fe=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const we=w[fe]||[];w[fe]=we,we.push(k)}C(w,function(q){return q.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Oo(p,w,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||w}function kl(p){this.Aa=0,this.i=[],this.j=new Wn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Oo("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Oo("baseRetryDelayMs",5e3,p),this.cb=Oo("retryDelaySeedMs",1e4,p),this.Wa=Oo("forwardChannelMaxRetries",2,p),this.wa=Oo("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Pn(p&&p.concurrentRequestLimit),this.Da=new ko,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=kl.prototype,t.la=8,t.G=1,t.connect=function(p,w,k,q){ar(0),this.W=p,this.H=w||{},k&&q!==void 0&&(this.H.OSID=k,this.H.OAID=q),this.F=this.X,this.I=Oh(this,null,this.W),Dl(this)};function au(p){if(Ch(p),p.G==3){var w=p.U++,k=aa(p.I);if(Qt(k,"SID",p.K),Qt(k,"RID",w),Qt(k,"TYPE","terminate"),jo(p,k),w=new Te(p,p.j,w),w.L=2,w.v=Co(aa(k)),k=!1,u.navigator&&u.navigator.sendBeacon)try{k=u.navigator.sendBeacon(w.v.toString(),"")}catch{}!k&&u.Image&&(new Image().src=w.v,k=!0),k||(w.g=jh(w.j,null),w.g.ea(w.v)),w.F=Date.now(),Ge(w)}Dh(p)}function Il(p){p.g&&(Po(p),p.g.cancel(),p.g=null)}function Ch(p){Il(p),p.u&&(u.clearTimeout(p.u),p.u=null),Ol(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function Dl(p){if(!Kn(p.h)&&!p.s){p.s=!0;var w=p.Ga;me||ee(),Pe||(me(),Pe=!0),oe.add(w,p),p.B=0}}function Hm(p,w){return cs(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=w.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=ur(_(p.Ga,p,w),ou(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const fe=new Te(this,this.j,p);let we=this.o;if(this.S&&(we?(we=N(we),F(we,this.S)):we=this.S),this.m!==null||this.O||(fe.H=we,we=null),this.P)e:{for(var w=0,k=0;k<this.i.length;k++){t:{var q=this.i[k];if("__data__"in q.map&&(q=q.map.__data__,typeof q=="string")){q=q.length;break t}q=void 0}if(q===void 0)break;if(w+=q,4096<w){w=k;break e}if(w===4096||k===this.i.length-1){w=k+1;break e}}w=1e3}else w=1e3;w=Nh(this,fe,w),k=aa(this.I),Qt(k,"RID",p),Qt(k,"CVER",22),this.D&&Qt(k,"X-HTTP-Session-Id",this.D),jo(this,k),we&&(this.O?w="headers="+encodeURIComponent(String(nu(we)))+"&"+w:this.m&&Kr(k,this.m,we)),Sl(this.h,fe),this.Ua&&Qt(k,"TYPE","init"),this.P?(Qt(k,"$req",w),Qt(k,"SID","null"),fe.T=!0,Oe(fe,k,null)):Oe(fe,k,w),this.G=2}}else this.G==3&&(p?su(this,p):this.i.length==0||Kn(this.h)||su(this))};function su(p,w){var k;w?k=w.l:k=p.U++;const q=aa(p.I);Qt(q,"SID",p.K),Qt(q,"RID",k),Qt(q,"AID",p.T),jo(p,q),p.m&&p.o&&Kr(q,p.m,p.o),k=new Te(p,p.j,k,p.B+1),p.m===null&&(k.H=p.o),w&&(p.i=w.D.concat(p.i)),w=Nh(p,k,1e3),k.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Sl(p.h,k),Oe(k,q,w)}function jo(p,w){p.H&&H(p.H,function(k,q){Qt(w,q,k)}),p.l&&Jc({},function(k,q){Qt(w,q,k)})}function Nh(p,w,k){k=Math.min(p.i.length,k);var q=p.l?_(p.l.Na,p.l,p):null;e:{var fe=p.i;let we=-1;for(;;){const He=["count="+k];we==-1?0<k?(we=fe[0].g,He.push("ofs="+we)):we=0:He.push("ofs="+we);let jt=!0;for(let Br=0;Br<k;Br++){let Pt=fe[Br].g;const Xr=fe[Br].map;if(Pt-=we,0>Pt)we=Math.max(0,fe[Br].g-100),jt=!1;else try{fs(Xr,He,"req"+Pt+"_")}catch{q&&q(Xr)}}if(jt){q=He.join("&");break e}}}return p=p.i.splice(0,k),w.D=p,q}function Rh(p){if(!p.g&&!p.u){p.Y=1;var w=p.Fa;me||ee(),Pe||(me(),Pe=!0),oe.add(w,p),p.v=0}}function iu(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=ur(_(p.Fa,p),ou(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,kh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=ur(_(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ar(10),Il(this),kh(this))};function Po(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function kh(p){p.g=new Te(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var w=aa(p.qa);Qt(w,"RID","rpc"),Qt(w,"SID",p.K),Qt(w,"AID",p.T),Qt(w,"CI",p.F?"0":"1"),!p.F&&p.ja&&Qt(w,"TO",p.ja),Qt(w,"TYPE","xmlhttp"),jo(p,w),p.m&&p.o&&Kr(w,p.m,p.o),p.L&&(p.g.I=p.L);var k=p.g;p=p.ia,k.L=1,k.v=Co(aa(w)),k.m=null,k.P=!0,Be(k,p)}t.Za=function(){this.C!=null&&(this.C=null,Il(this),iu(this),ar(19))};function Ol(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Ih(p,w){var k=null;if(p.g==w){Ol(p),Po(p),p.g=null;var q=2}else if(Fn(p.h,w))k=w.D,Ln(p.h,w),q=1;else return;if(p.G!=0){if(w.o)if(q==1){k=w.m?w.m.length:0,w=Date.now()-w.F;var fe=p.B;q=is(),Se(q,new Sr(q,k)),Dl(p)}else Rh(p);else if(fe=w.s,fe==3||fe==0&&0<w.X||!(q==1&&Hm(p,w)||q==2&&iu(p)))switch(k&&0<k.length&&(w=p.h,w.i=w.i.concat(k)),fe){case 1:Hs(p,5);break;case 4:Hs(p,10);break;case 3:Hs(p,6);break;default:Hs(p,2)}}}function ou(p,w){let k=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(k*=2),k*w}function Hs(p,w){if(p.j.info("Error code "+w),w==2){var k=_(p.fb,p),q=p.Xa;const fe=!q;q=new kr(q||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Ao(q,"https"),Co(q),fe?Ro(q.toString(),k):Ma(q.toString(),k)}else ar(2);p.G=0,p.l&&p.l.sa(w),Dh(p),Ch(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),ar(2)):(this.j.info("Failed to ping google.com"),ar(1))};function Dh(p){if(p.G=0,p.ka=[],p.l){const w=Qc(p.h);(w.length!=0||p.i.length!=0)&&(b(p.ka,w),b(p.ka,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.ra()}}function Oh(p,w,k){var q=k instanceof kr?aa(k):new kr(k);if(q.g!="")w&&(q.g=w+"."+q.g),wi(q,q.s);else{var fe=u.location;q=fe.protocol,w=w?w+"."+fe.hostname:fe.hostname,fe=+fe.port;var we=new kr(null);q&&Ao(we,q),w&&(we.g=w),fe&&wi(we,fe),k&&(we.l=k),q=we}return k=p.D,w=p.ya,k&&w&&Qt(q,k,w),Qt(q,"VER",p.la),jo(p,q),q}function jh(p,w,k){if(w&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=p.Ca&&!p.pa?new Yt(new Si({eb:k})):new Yt(p.pa),w.Ha(p.J),w}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ph(){}t=Ph.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function jl(){}jl.prototype.g=function(p,w){return new Mn(p,w)};function Mn(p,w){It.call(this),this.g=new kl(w),this.l=p,this.h=w&&w.messageUrlParams||null,p=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(p?p["X-WebChannel-Content-Type"]=w.messageContentType:p={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(p?p["X-WebChannel-Client-Profile"]=w.va:p={"X-WebChannel-Client-Profile":w.va}),this.g.S=p,(p=w&&w.Sb)&&!L(p)&&(this.g.m=p),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!L(w)&&(this.g.D=w,p=this.h,p!==null&&w in p&&(p=this.h,w in p&&delete p[w])),this.j=new ps(this)}E(Mn,It),Mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mn.prototype.close=function(){au(this.g)},Mn.prototype.o=function(p){var w=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.u&&(k={},k.__data__=cr(p),p=k);w.i.push(new ls(w.Ya++,p)),w.G==3&&Dl(w)},Mn.prototype.N=function(){this.g.l=null,delete this.j,au(this.g),delete this.g,Mn.aa.N.call(this)};function Fh(p){La.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var w=p.__sm__;if(w){e:{for(const k in w){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,w=w!==null&&p in w?w[p]:void 0),this.data=w}else this.data=p}E(Fh,La);function Lh(){ss.call(this),this.status=1}E(Lh,ss);function ps(p){this.g=p}E(ps,Ph),ps.prototype.ua=function(){Se(this.g,"a")},ps.prototype.ta=function(p){Se(this.g,new Fh(p))},ps.prototype.sa=function(p){Se(this.g,new Lh)},ps.prototype.ra=function(){Se(this.g,"b")},jl.prototype.createWebChannel=jl.prototype.g,Mn.prototype.send=Mn.prototype.o,Mn.prototype.open=Mn.prototype.m,Mn.prototype.close=Mn.prototype.close,TS=function(){return new jl},ES=function(){return is()},yS=xa,Sg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},W.NO_ERROR=0,W.TIMEOUT=8,W.HTTP_ERROR=6,l0=W,J.COMPLETE="complete",_S=J,Fa.EventType=Yn,Yn.OPEN="a",Yn.CLOSE="b",Yn.ERROR="c",Yn.MESSAGE="d",It.prototype.listen=It.prototype.K,tf=Fa,Yt.prototype.listenOnce=Yt.prototype.L,Yt.prototype.getLastError=Yt.prototype.Ka,Yt.prototype.getLastErrorCode=Yt.prototype.Ba,Yt.prototype.getStatus=Yt.prototype.Z,Yt.prototype.getResponseJson=Yt.prototype.Oa,Yt.prototype.getResponseText=Yt.prototype.oa,Yt.prototype.send=Yt.prototype.ea,Yt.prototype.setWithCredentials=Yt.prototype.Ha,xS=Yt}).apply(typeof Vd<"u"?Vd:typeof self<"u"?self:typeof window<"u"?window:{});const qE="@firebase/firestore",$E="4.7.10";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wn.UNAUTHENTICATED=new wn(null),wn.GOOGLE_CREDENTIALS=new wn("google-credentials-uid"),wn.FIRST_PARTY=new wn("first-party-uid"),wn.MOCK_USER=new wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lc="11.5.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ol=new uv("@firebase/firestore");function uc(){return ol.logLevel}function Ye(t,...e){if(ol.logLevel<=Nt.DEBUG){const r=e.map(Tv);ol.debug(`Firestore (${Lc}): ${t}`,...r)}}function gi(t,...e){if(ol.logLevel<=Nt.ERROR){const r=e.map(Tv);ol.error(`Firestore (${Lc}): ${t}`,...r)}}function bc(t,...e){if(ol.logLevel<=Nt.WARN){const r=e.map(Tv);ol.warn(`Firestore (${Lc}): ${t}`,...r)}}function Tv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(t="Unexpected state"){const e=`FIRESTORE (${Lc}) INTERNAL ASSERTION FAILED: `+t;throw gi(e),new Error(e)}function Vt(t,e){t||nt()}function dt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends js{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class J8{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(wn.UNAUTHENTICATED))}shutdown(){}}class Z8{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class eD{constructor(e){this.t=e,this.currentUser=wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Vt(this.o===void 0);let n=this.i;const a=d=>this.i!==n?(n=this.i,r(d)):Promise.resolve();let o=new Ns;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ns,e.enqueueRetryable(()=>a(this.currentUser))};const l=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await a(this.currentUser)})},u=d=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ns)}},0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Vt(typeof n.accessToken=="string"),new wS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Vt(e===null||typeof e=="string"),new wn(e)}}class tD{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=wn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class rD{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new tD(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class YE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nD{constructor(e,r){this.A=r,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,da(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,r){Vt(this.o===void 0);const n=o=>{o.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.R;return this.R=o.token,Ye("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const a=o=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?a(o):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new YE(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Vt(typeof r.token=="string"),this.R=r.token,new YE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=aD(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function Et(t,e){return t<e?-1:t>e?1:0}function bg(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),a=e.codePointAt(r);if(n!==a){if(n<128&&a<128)return Et(n,a);{const o=SS(),l=sD(o.encode(WE(t,r)),o.encode(WE(e,r)));return l!==0?l:Et(n,a)}}r+=n>65535?2:1}return Et(t.length,e.length)}function WE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function sD(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Et(t[r],e[r]);return Et(t.length,e.length)}function Ac(t,e,r){return t.length===e.length&&t.every((n,a)=>r(n,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE=-62135596800,XE=1e6;class qr{static now(){return qr.fromMillis(Date.now())}static fromDate(e){return qr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*XE);return new qr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new qe(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new qe(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<KE)throw new qe(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/XE}_compareTo(e){return this.seconds===e.seconds?Et(this.nanoseconds,e.nanoseconds):Et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-KE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{static fromTimestamp(e){return new it(e)}static min(){return new it(new qr(0,0))}static max(){return new it(new qr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE="__name__";class Ss{constructor(e,r,n){r===void 0?r=0:r>e.length&&nt(),n===void 0?n=e.length-r:n>e.length-r&&nt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ss.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ss?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=Ss.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return Et(e.length,r.length)}static compareSegments(e,r){const n=Ss.isNumericId(e),a=Ss.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Ss.extractNumericId(e).compare(Ss.extractNumericId(r)):bg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return so.fromString(e.substring(4,e.length-2))}}class nr extends Ss{construct(e,r,n){return new nr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new qe(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(a=>a.length>0))}return new nr(r)}static emptyPath(){return new nr([])}}const iD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hn extends Ss{construct(e,r,n){return new hn(e,r,n)}static isValidIdentifier(e){return iD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===QE}static keyField(){return new hn([QE])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new qe(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new qe(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[a+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new qe(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new qe(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hn(r)}static emptyPath(){return new hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.path=e}static fromPath(e){return new rt(nr.fromString(e))}static fromName(e){return new rt(nr.fromString(e).popFirst(5))}static empty(){return new rt(nr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return nr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rt(new nr(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=-1;function oD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=it.fromTimestamp(n===1e9?new qr(r+1,0):new qr(r,n));return new co(a,rt.empty(),e)}function lD(t){return new co(t.readTime,t.key,Nf)}class co{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new co(it.min(),rt.empty(),Nf)}static max(){return new co(it.max(),rt.empty(),Nf)}}function cD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=rt.comparator(t.documentKey,e.documentKey),r!==0?r:Et(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class fD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mc(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==uD)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&nt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new De((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof De?r:De.resolve(r)}catch(r){return De.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):De.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):De.reject(r)}static resolve(e){return new De((r,n)=>{r(e)})}static reject(e){return new De((r,n)=>{n(e)})}static waitFor(e){return new De((r,n)=>{let a=0,o=0,l=!1;e.forEach(u=>{++a,u.next(()=>{++o,l&&o===a&&r()},d=>n(d))}),l=!0,o===a&&r()})}static or(e){let r=De.resolve(!1);for(const n of e)r=r.next(a=>a?De.resolve(a):n());return r}static forEach(e,r){const n=[];return e.forEach((a,o)=>{n.push(r.call(this,a,o))}),this.waitFor(n)}static mapArray(e,r){return new De((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let d=0;d<o;d++){const m=d;r(e[m]).next(g=>{l[m]=g,++u,u===o&&n(l)},g=>a(g))}})}static doWhile(e,r){return new De((n,a)=>{const o=()=>{e()===!0?r().next(()=>{o()},a):n()};o()})}}function hD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Bc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.oe(n),this._e=n=>r.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}lm.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=-1;function Zf(t){return t==null}function S0(t){return t===0&&1/t==-1/0}function dD(t){return typeof t=="number"&&Number.isInteger(t)&&!S0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="";function mD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=JE(e)),e=pD(t.get(r),e);return JE(e)}function pD(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case AS:r+="";break;default:r+=o}}return r}function JE(t){return t+AS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function _o(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function CS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,r){this.comparator=e,this.root=r||un.EMPTY}insert(e,r){return new vr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,un.BLACK,null,null))}remove(e){return new vr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,un.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ud(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ud(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ud(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ud(this.root,e,this.comparator,!0)}}class Ud{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class un{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??un.RED,this.left=a??un.EMPTY,this.right=o??un.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new un(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return un.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return un.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,un.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,un.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw nt();const e=this.left.check();if(e!==this.right.check())throw nt();return e+(this.isRed()?0:1)}}un.EMPTY=null,un.RED=!0,un.BLACK=!1;un.EMPTY=new class{constructor(){this.size=0}get key(){throw nt()}get value(){throw nt()}get color(){throw nt()}get left(){throw nt()}get right(){throw nt()}copy(e,r,n,a,o){return this}insert(e,r,n){return new un(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.comparator=e,this.data=new vr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new eT(this.data.getIterator())}getIteratorFrom(e){return new eT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof $r)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new $r(this.comparator);return r.data=e,r}}class eT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e){this.fields=e,e.sort(hn.comparator)}static empty(){return new pa([])}unionWith(e){let r=new $r(hn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new pa(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Ac(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new NS("Invalid base64 string: "+o):o}}(e);return new vn(r)}static fromUint8Array(e){const r=function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o}(e);return new vn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vn.EMPTY_BYTE_STRING=new vn("");const gD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){if(Vt(!!t),typeof t=="string"){let e=0;const r=gD.exec(t);if(Vt(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Nr(t.seconds),nanos:Nr(t.nanos)}}function Nr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function fo(t){return typeof t=="string"?vn.fromBase64String(t):vn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS="server_timestamp",kS="__type__",IS="__previous_value__",DS="__local_write_time__";function Sv(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[kS])===null||r===void 0?void 0:r.stringValue)===RS}function cm(t){const e=t.mapValue.fields[IS];return Sv(e)?cm(e):e}function Rf(t){const e=uo(t.mapValue.fields[DS].timestampValue);return new qr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e,r,n,a,o,l,u,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=d,this.useFetchStreams=m}}const b0="(default)";class kf{constructor(e,r){this.projectId=e,this.database=r||b0}static empty(){return new kf("","")}get isDefaultDatabase(){return this.database===b0}isEqual(e){return e instanceof kf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="__type__",xD="__max__",zd={mapValue:{}},jS="__vector__",A0="value";function ho(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sv(t)?4:yD(t)?9007199254740991:_D(t)?10:11:nt()}function ks(t,e){if(t===e)return!0;const r=ho(t);if(r!==ho(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Rf(t).isEqual(Rf(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=uo(a.timestampValue),u=uo(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return fo(a.bytesValue).isEqual(fo(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return Nr(a.geoPointValue.latitude)===Nr(o.geoPointValue.latitude)&&Nr(a.geoPointValue.longitude)===Nr(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return Nr(a.integerValue)===Nr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Nr(a.doubleValue),u=Nr(o.doubleValue);return l===u?S0(l)===S0(u):isNaN(l)&&isNaN(u)}return!1}(t,e);case 9:return Ac(t.arrayValue.values||[],e.arrayValue.values||[],ks);case 10:case 11:return function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(ZE(l)!==ZE(u))return!1;for(const d in l)if(l.hasOwnProperty(d)&&(u[d]===void 0||!ks(l[d],u[d])))return!1;return!0}(t,e);default:return nt()}}function If(t,e){return(t.values||[]).find(r=>ks(r,e))!==void 0}function Cc(t,e){if(t===e)return 0;const r=ho(t),n=ho(e);if(r!==n)return Et(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Et(t.booleanValue,e.booleanValue);case 2:return function(o,l){const u=Nr(o.integerValue||o.doubleValue),d=Nr(l.integerValue||l.doubleValue);return u<d?-1:u>d?1:u===d?0:isNaN(u)?isNaN(d)?0:-1:1}(t,e);case 3:return tT(t.timestampValue,e.timestampValue);case 4:return tT(Rf(t),Rf(e));case 5:return bg(t.stringValue,e.stringValue);case 6:return function(o,l){const u=fo(o),d=fo(l);return u.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,l){const u=o.split("/"),d=l.split("/");for(let m=0;m<u.length&&m<d.length;m++){const g=Et(u[m],d[m]);if(g!==0)return g}return Et(u.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,l){const u=Et(Nr(o.latitude),Nr(l.latitude));return u!==0?u:Et(Nr(o.longitude),Nr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return rT(t.arrayValue,e.arrayValue);case 10:return function(o,l){var u,d,m,g;const y=o.fields||{},_=l.fields||{},T=(u=y[A0])===null||u===void 0?void 0:u.arrayValue,E=(d=_[A0])===null||d===void 0?void 0:d.arrayValue,S=Et(((m=T==null?void 0:T.values)===null||m===void 0?void 0:m.length)||0,((g=E==null?void 0:E.values)===null||g===void 0?void 0:g.length)||0);return S!==0?S:rT(T,E)}(t.mapValue,e.mapValue);case 11:return function(o,l){if(o===zd.mapValue&&l===zd.mapValue)return 0;if(o===zd.mapValue)return 1;if(l===zd.mapValue)return-1;const u=o.fields||{},d=Object.keys(u),m=l.fields||{},g=Object.keys(m);d.sort(),g.sort();for(let y=0;y<d.length&&y<g.length;++y){const _=bg(d[y],g[y]);if(_!==0)return _;const T=Cc(u[d[y]],m[g[y]]);if(T!==0)return T}return Et(d.length,g.length)}(t.mapValue,e.mapValue);default:throw nt()}}function tT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Et(t,e);const r=uo(t),n=uo(e),a=Et(r.seconds,n.seconds);return a!==0?a:Et(r.nanos,n.nanos)}function rT(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=Cc(r[a],n[a]);if(o)return o}return Et(r.length,n.length)}function Nc(t){return Ag(t)}function Ag(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=uo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return fo(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return rt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=Ag(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${Ag(r.fields[l])}`;return a+"}"}(t.mapValue):nt()}function c0(t){switch(ho(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=cm(t);return e?16+c0(e):16;case 5:return 2*t.stringValue.length;case 6:return fo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((a,o)=>a+c0(o),0)}(t.arrayValue);case 10:case 11:return function(n){let a=0;return _o(n.fields,(o,l)=>{a+=o.length+c0(l)}),a}(t.mapValue);default:throw nt()}}function nT(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Cg(t){return!!t&&"integerValue"in t}function bv(t){return!!t&&"arrayValue"in t}function aT(t){return!!t&&"nullValue"in t}function sT(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function u0(t){return!!t&&"mapValue"in t}function _D(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[OS])===null||r===void 0?void 0:r.stringValue)===jS}function uf(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return _o(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=uf(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=uf(t.arrayValue.values[r]);return e}return Object.assign({},t)}function yD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===xD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.value=e}static empty(){return new Hn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!u0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=uf(r)}setAll(e){let r=hn.emptyPath(),n={},a=[];e.forEach((l,u)=>{if(!r.isImmediateParentOf(u)){const d=this.getFieldsMap(r);this.applyChanges(d,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=uf(l):a.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());u0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ks(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];u0(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){_o(r,(a,o)=>e[a]=o);for(const a of n)delete e[a]}clone(){return new Hn(uf(this.value))}}function PS(t){const e=[];return _o(t.fields,(r,n)=>{const a=new hn([r]);if(u0(n)){const o=PS(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)}),new pa(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new rn(e,0,it.min(),it.min(),it.min(),Hn.empty(),0)}static newFoundDocument(e,r,n,a){return new rn(e,1,r,it.min(),n,a,0)}static newNoDocument(e,r){return new rn(e,2,r,it.min(),it.min(),Hn.empty(),0)}static newUnknownDocument(e,r){return new rn(e,3,r,it.min(),it.min(),Hn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(it.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=it.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,r){this.position=e,this.inclusive=r}}function iT(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=rt.comparator(rt.fromName(l.referenceValue),r.key):n=Cc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function oT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ks(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,r="asc"){this.field=e,this.dir=r}}function ED(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{}class Lr extends FS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new wD(e,r,n):r==="array-contains"?new AD(e,n):r==="in"?new CD(e,n):r==="not-in"?new ND(e,n):r==="array-contains-any"?new RD(e,n):new Lr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new SD(e,n):new bD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Cc(r,this.value)):r!==null&&ho(this.value)===ho(r)&&this.matchesComparison(Cc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return nt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ts extends FS{constructor(e,r){super(),this.filters=e,this.op=r,this.ce=null}static create(e,r){return new ts(e,r)}matches(e){return LS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function LS(t){return t.op==="and"}function MS(t){return TD(t)&&LS(t)}function TD(t){for(const e of t.filters)if(e instanceof ts)return!1;return!0}function Ng(t){if(t instanceof Lr)return t.field.canonicalString()+t.op.toString()+Nc(t.value);if(MS(t))return t.filters.map(e=>Ng(e)).join(",");{const e=t.filters.map(r=>Ng(r)).join(",");return`${t.op}(${e})`}}function BS(t,e){return t instanceof Lr?function(n,a){return a instanceof Lr&&n.op===a.op&&n.field.isEqual(a.field)&&ks(n.value,a.value)}(t,e):t instanceof ts?function(n,a){return a instanceof ts&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce((o,l,u)=>o&&BS(l,a.filters[u]),!0):!1}(t,e):void nt()}function VS(t){return t instanceof Lr?function(r){return`${r.field.canonicalString()} ${r.op} ${Nc(r.value)}`}(t):t instanceof ts?function(r){return r.op.toString()+" {"+r.getFilters().map(VS).join(" ,")+"}"}(t):"Filter"}class wD extends Lr{constructor(e,r,n){super(e,r,n),this.key=rt.fromName(n.referenceValue)}matches(e){const r=rt.comparator(e.key,this.key);return this.matchesComparison(r)}}class SD extends Lr{constructor(e,r){super(e,"in",r),this.keys=US("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class bD extends Lr{constructor(e,r){super(e,"not-in",r),this.keys=US("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function US(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>rt.fromName(n.referenceValue))}class AD extends Lr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return bv(r)&&If(r.arrayValue,this.value)}}class CD extends Lr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&If(this.value.arrayValue,r)}}class ND extends Lr{constructor(e,r){super(e,"not-in",r)}matches(e){if(If(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!If(this.value.arrayValue,r)}}class RD extends Lr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!bv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>If(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.le=null}}function lT(t,e=null,r=[],n=[],a=null,o=null,l=null){return new kD(t,e,r,n,a,o,l)}function Av(t){const e=dt(t);if(e.le===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>Ng(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),Zf(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Nc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Nc(n)).join(",")),e.le=r}return e.le}function Cv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!ED(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!BS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!oT(t.startAt,e.startAt)&&oT(t.endAt,e.endAt)}function Rg(t){return rt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,d=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function ID(t,e,r,n,a,o,l,u){return new Vc(t,e,r,n,a,o,l,u)}function um(t){return new Vc(t)}function cT(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function zS(t){return t.collectionGroup!==null}function ff(t){const e=dt(t);if(e.he===null){e.he=[];const r=new Set;for(const o of e.explicitOrderBy)e.he.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new $r(hn.comparator);return l.filters.forEach(d=>{d.getFlattenedFilters().forEach(m=>{m.isInequality()&&(u=u.add(m.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.he.push(new Df(o,n))}),r.has(hn.keyField().canonicalString())||e.he.push(new Df(hn.keyField(),n))}return e.he}function Rs(t){const e=dt(t);return e.Pe||(e.Pe=DD(e,ff(t))),e.Pe}function DD(t,e){if(t.limitType==="F")return lT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Df(a.field,o)});const r=t.endAt?new C0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new C0(t.startAt.position,t.startAt.inclusive):null;return lT(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function kg(t,e){const r=t.filters.concat([e]);return new Vc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Ig(t,e,r){return new Vc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function fm(t,e){return Cv(Rs(t),Rs(e))&&t.limitType===e.limitType}function HS(t){return`${Av(Rs(t))}|lt:${t.limitType}`}function fc(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(a=>VS(a)).join(", ")}]`),Zf(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(a=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(a)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(a=>Nc(a)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(a=>Nc(a)).join(",")),`Target(${n})`}(Rs(t))}; limitType=${t.limitType})`}function hm(t,e){return e.isFoundDocument()&&function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):rt.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,a){for(const o of ff(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(n,a){return!(n.startAt&&!function(l,u,d){const m=iT(l,u,d);return l.inclusive?m<=0:m<0}(n.startAt,ff(n),a)||n.endAt&&!function(l,u,d){const m=iT(l,u,d);return l.inclusive?m>=0:m>0}(n.endAt,ff(n),a))}(t,e)}function OD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function GS(t){return(e,r)=>{let n=!1;for(const a of ff(t)){const o=jD(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function jD(t,e,r){const n=t.field.isKeyField()?rt.comparator(e.key,r.key):function(o,l,u){const d=l.data.field(o),m=u.data.field(o);return d!==null&&m!==null?Cc(d,m):nt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return nt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){_o(this.inner,(r,n)=>{for(const[a,o]of n)e(a,o)})}isEmpty(){return CS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new vr(rt.comparator);function vi(){return PD}const qS=new vr(rt.comparator);function rf(...t){let e=qS;for(const r of t)e=e.insert(r.key,r);return e}function $S(t){let e=qS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Zo(){return hf()}function YS(){return hf()}function hf(){return new pl(t=>t.toString(),(t,e)=>t.isEqual(e))}const FD=new vr(rt.comparator),LD=new $r(rt.comparator);function Rt(...t){let e=LD;for(const r of t)e=e.add(r);return e}const MD=new $r(Et);function BD(){return MD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:S0(e)?"-0":e}}function WS(t){return{integerValue:""+t}}function VD(t,e){return dD(e)?WS(e):Nv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(){this._=void 0}}function UD(t,e,r){return t instanceof Of?function(a,o){const l={fields:{[kS]:{stringValue:RS},[DS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&Sv(o)&&(o=cm(o)),o&&(l.fields[IS]=o),{mapValue:l}}(r,e):t instanceof jf?XS(t,e):t instanceof Pf?QS(t,e):function(a,o){const l=KS(a,o),u=uT(l)+uT(a.Ie);return Cg(l)&&Cg(a.Ie)?WS(u):Nv(a.serializer,u)}(t,e)}function zD(t,e,r){return t instanceof jf?XS(t,e):t instanceof Pf?QS(t,e):r}function KS(t,e){return t instanceof N0?function(n){return Cg(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class Of extends dm{}class jf extends dm{constructor(e){super(),this.elements=e}}function XS(t,e){const r=JS(e);for(const n of t.elements)r.some(a=>ks(a,n))||r.push(n);return{arrayValue:{values:r}}}class Pf extends dm{constructor(e){super(),this.elements=e}}function QS(t,e){let r=JS(e);for(const n of t.elements)r=r.filter(a=>!ks(a,n));return{arrayValue:{values:r}}}class N0 extends dm{constructor(e,r){super(),this.serializer=e,this.Ie=r}}function uT(t){return Nr(t.integerValue||t.doubleValue)}function JS(t){return bv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,r){this.field=e,this.transform=r}}function GD(t,e){return t.field.isEqual(e.field)&&function(n,a){return n instanceof jf&&a instanceof jf||n instanceof Pf&&a instanceof Pf?Ac(n.elements,a.elements,ks):n instanceof N0&&a instanceof N0?ks(n.Ie,a.Ie):n instanceof Of&&a instanceof Of}(t.transform,e.transform)}class qD{constructor(e,r){this.version=e,this.transformResults=r}}class Mr{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Mr}static exists(e){return new Mr(void 0,e)}static updateTime(e){return new Mr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function f0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class mm{}function ZS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new th(t.key,Mr.none()):new eh(t.key,t.data,Mr.none());{const r=t.data,n=Hn.empty();let a=new $r(hn.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new yo(t.key,n,new pa(a.toArray()),Mr.none())}}function $D(t,e,r){t instanceof eh?function(a,o,l){const u=a.value.clone(),d=hT(a.fieldTransforms,o,l.transformResults);u.setAll(d),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()}(t,e,r):t instanceof yo?function(a,o,l){if(!f0(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=hT(a.fieldTransforms,o,l.transformResults),d=o.data;d.setAll(eb(a)),d.setAll(u),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()}(t,e,r):function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,r)}function df(t,e,r,n){return t instanceof eh?function(o,l,u,d){if(!f0(o.precondition,l))return u;const m=o.value.clone(),g=dT(o.fieldTransforms,d,l);return m.setAll(g),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null}(t,e,r,n):t instanceof yo?function(o,l,u,d){if(!f0(o.precondition,l))return u;const m=dT(o.fieldTransforms,d,l),g=l.data;return g.setAll(eb(o)),g.setAll(m),l.convertToFoundDocument(l.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,r,n):function(o,l,u){return f0(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u}(t,e,r)}function YD(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=KS(n.transform,a||null);o!=null&&(r===null&&(r=Hn.empty()),r.set(n.field,o))}return r||null}function fT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Ac(n,a,(o,l)=>GD(o,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class eh extends mm{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class yo extends mm{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function eb(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function hT(t,e,r){const n=new Map;Vt(t.length===r.length);for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,zD(l,u,r[a]))}return n}function dT(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,UD(o,l,e))}return n}class th extends mm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tb extends mm{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&$D(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=df(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=df(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YS();return this.mutations.forEach(a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const d=ZS(l,u);d!==null&&n.set(a.key,d),l.isValidDocument()||l.convertToNoDocument(it.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Rt())}isEqual(e){return this.batchId===e.batchId&&Ac(this.mutations,e.mutations,(r,n)=>fT(r,n))&&Ac(this.baseMutations,e.baseMutations,(r,n)=>fT(r,n))}}class Rv{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Vt(e.mutations.length===n.length);let a=function(){return FD}();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new Rv(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jr,Lt;function rb(t){switch(t){case Re.OK:return nt();case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return nt()}}function nb(t){if(t===void 0)return gi("GRPC error has no .code"),Re.UNKNOWN;switch(t){case jr.OK:return Re.OK;case jr.CANCELLED:return Re.CANCELLED;case jr.UNKNOWN:return Re.UNKNOWN;case jr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case jr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case jr.INTERNAL:return Re.INTERNAL;case jr.UNAVAILABLE:return Re.UNAVAILABLE;case jr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case jr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case jr.NOT_FOUND:return Re.NOT_FOUND;case jr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case jr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case jr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case jr.ABORTED:return Re.ABORTED;case jr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case jr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case jr.DATA_LOSS:return Re.DATA_LOSS;default:return nt()}}(Lt=jr||(jr={}))[Lt.OK=0]="OK",Lt[Lt.CANCELLED=1]="CANCELLED",Lt[Lt.UNKNOWN=2]="UNKNOWN",Lt[Lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Lt[Lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Lt[Lt.NOT_FOUND=5]="NOT_FOUND",Lt[Lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Lt[Lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Lt[Lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Lt[Lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Lt[Lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Lt[Lt.ABORTED=10]="ABORTED",Lt[Lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Lt[Lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Lt[Lt.INTERNAL=13]="INTERNAL",Lt[Lt.UNAVAILABLE=14]="UNAVAILABLE",Lt[Lt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QD=new so([4294967295,4294967295],0);function mT(t){const e=SS().encode(t),r=new vS;return r.update(e),new Uint8Array(r.digest())}function pT(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new so([r,n],0),new so([a,o],0)]}class kv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new nf(`Invalid padding: ${r}`);if(n<0)throw new nf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new nf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new nf(`Invalid padding when bitmap length is 0: ${r}`);this.Ee=8*e.length-r,this.de=so.fromNumber(this.Ee)}Ae(e,r,n){let a=e.add(r.multiply(so.fromNumber(n)));return a.compare(QD)===1&&(a=new so([a.getBits(0),a.getBits(1)],0)),a.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const r=mT(e),[n,a]=pT(r);for(let o=0;o<this.hashCount;o++){const l=this.Ae(n,a,o);if(!this.Re(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new kv(o,a,r);return n.forEach(u=>l.insert(u)),l}insert(e){if(this.Ee===0)return;const r=mT(e),[n,a]=pT(r);for(let o=0;o<this.hashCount;o++){const l=this.Ae(n,a,o);this.Ve(l)}}Ve(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class nf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,rh.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pm(it.min(),a,new vr(Et),vi(),Rt())}}class rh{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new rh(n,r,Rt(),Rt(),Rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,r,n,a){this.me=e,this.removedTargetIds=r,this.key=n,this.fe=a}}class ab{constructor(e,r){this.targetId=e,this.ge=r}}class sb{constructor(e,r,n=vn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class gT{constructor(){this.pe=0,this.ye=vT(),this.we=vn.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=Rt(),r=Rt(),n=Rt();return this.ye.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:nt()}}),new rh(this.we,this.Se,e,r,n)}Me(){this.be=!1,this.ye=vT()}xe(e,r){this.be=!0,this.ye=this.ye.insert(e,r)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Vt(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class JD{constructor(e){this.ke=e,this.qe=new Map,this.Qe=vi(),this.$e=Hd(),this.Ue=Hd(),this.Ke=new vr(Et)}We(e){for(const r of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(r,e.fe):this.ze(r,e.key,e.fe);for(const r of e.removedTargetIds)this.ze(r,e.key,e.fe)}je(e){this.forEachTarget(e,r=>{const n=this.He(r);switch(e.state){case 0:this.Je(r)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(r);break;case 3:this.Je(r)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(r)&&(this.Ye(r),n.Ce(e.resumeToken));break;default:nt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.qe.forEach((n,a)=>{this.Je(a)&&r(a)})}Ze(e){const r=e.targetId,n=e.ge.count,a=this.Xe(r);if(a){const o=a.target;if(Rg(o))if(n===0){const l=new rt(o.path);this.ze(r,l,rn.newNoDocument(l,it.min()))}else Vt(n===1);else{const l=this.et(r);if(l!==n){const u=this.tt(e),d=u?this.nt(u,e,l):1;if(d!==0){this.Ye(r);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(r,m)}}}}}tt(e){const r=e.ge.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=fo(n).toUint8Array()}catch(d){if(d instanceof NS)return bc("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{u=new kv(l,a,o)}catch(d){return bc(d instanceof nf?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return u.Ee===0?null:u}nt(e,r,n){return r.ge.count===n-this.st(e,r.targetId)?0:2}st(e,r){const n=this.ke.getRemoteKeysForTarget(r);let a=0;return n.forEach(o=>{const l=this.ke.it(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.ze(r,o,null),a++)}),a}ot(e){const r=new Map;this.qe.forEach((o,l)=>{const u=this.Xe(l);if(u){if(o.current&&Rg(u.target)){const d=new rt(u.target.path);this._t(d).has(l)||this.ut(l,d)||this.ze(l,d,rn.newNoDocument(d,e))}o.ve&&(r.set(l,o.Fe()),o.Me())}});let n=Rt();this.Ue.forEach((o,l)=>{let u=!0;l.forEachWhile(d=>{const m=this.Xe(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.Qe.forEach((o,l)=>l.setReadTime(e));const a=new pm(e,r,this.Ke,this.Qe,n);return this.Qe=vi(),this.$e=Hd(),this.Ue=Hd(),this.Ke=new vr(Et),a}Ge(e,r){if(!this.Je(e))return;const n=this.ut(e,r.key)?2:0;this.He(e).xe(r.key,n),this.Qe=this.Qe.insert(r.key,r),this.$e=this.$e.insert(r.key,this._t(r.key).add(e)),this.Ue=this.Ue.insert(r.key,this.ct(r.key).add(e))}ze(e,r,n){if(!this.Je(e))return;const a=this.He(e);this.ut(e,r)?a.xe(r,1):a.Oe(r),this.Ue=this.Ue.insert(r,this.ct(r).delete(e)),this.Ue=this.Ue.insert(r,this.ct(r).add(e)),n&&(this.Qe=this.Qe.insert(r,n))}removeTarget(e){this.qe.delete(e)}et(e){const r=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let r=this.qe.get(e);return r||(r=new gT,this.qe.set(e,r)),r}ct(e){let r=this.Ue.get(e);return r||(r=new $r(Et),this.Ue=this.Ue.insert(e,r)),r}_t(e){let r=this.$e.get(e);return r||(r=new $r(Et),this.$e=this.$e.insert(e,r)),r}Je(e){const r=this.Xe(e)!==null;return r||Ye("WatchChangeAggregator","Detected inactive target",e),r}Xe(e){const r=this.qe.get(e);return r&&r.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new gT),this.ke.getRemoteKeysForTarget(e).forEach(r=>{this.ze(e,r,null)})}ut(e,r){return this.ke.getRemoteKeysForTarget(e).has(r)}}function Hd(){return new vr(rt.comparator)}function vT(){return new vr(rt.comparator)}const ZD={asc:"ASCENDING",desc:"DESCENDING"},e5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t5={and:"AND",or:"OR"};class r5{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Dg(t,e){return t.useProto3Json||Zf(e)?e:{value:e}}function R0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ib(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function n5(t,e){return R0(t,e.toTimestamp())}function ga(t){return Vt(!!t),it.fromTimestamp(function(r){const n=uo(r);return new qr(n.seconds,n.nanos)}(t))}function Iv(t,e){return Og(t,e).canonicalString()}function Og(t,e){const r=function(a){return new nr(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?r:r.child(e)}function ob(t){const e=nr.fromString(t);return Vt(db(e)),e}function k0(t,e){return Iv(t.databaseId,e.path)}function mf(t,e){const r=ob(e);if(r.get(1)!==t.databaseId.projectId)throw new qe(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new qe(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new rt(cb(r))}function lb(t,e){return Iv(t.databaseId,e)}function a5(t){const e=ob(t);return e.length===4?nr.emptyPath():cb(e)}function jg(t){return new nr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cb(t){return Vt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function xT(t,e,r){return{name:k0(t,e),fields:r.value.mapValue.fields}}function s5(t,e){return"found"in e?function(n,a){Vt(!!a.found),a.found.name,a.found.updateTime;const o=mf(n,a.found.name),l=ga(a.found.updateTime),u=a.found.createTime?ga(a.found.createTime):it.min(),d=new Hn({mapValue:{fields:a.found.fields}});return rn.newFoundDocument(o,l,u,d)}(t,e):"missing"in e?function(n,a){Vt(!!a.missing),Vt(!!a.readTime);const o=mf(n,a.missing),l=ga(a.readTime);return rn.newNoDocument(o,l)}(t,e):nt()}function i5(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:nt()}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(m,g){return m.useProto3Json?(Vt(g===void 0||typeof g=="string"),vn.fromBase64String(g||"")):(Vt(g===void 0||g instanceof Buffer||g instanceof Uint8Array),vn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&function(m){const g=m.code===void 0?Re.UNKNOWN:nb(m.code);return new qe(g,m.message||"")}(l);r=new sb(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=mf(t,n.document.name),o=ga(n.document.updateTime),l=n.document.createTime?ga(n.document.createTime):it.min(),u=new Hn({mapValue:{fields:n.document.fields}}),d=rn.newFoundDocument(a,o,l,u),m=n.targetIds||[],g=n.removedTargetIds||[];r=new h0(m,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=mf(t,n.document),o=n.readTime?ga(n.readTime):it.min(),l=rn.newNoDocument(a,o),u=n.removedTargetIds||[];r=new h0([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=mf(t,n.document),o=n.removedTargetIds||[];r=new h0([],o,a,null)}else{if(!("filter"in e))return nt();{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new XD(a,o),u=n.targetId;r=new ab(u,l)}}return r}function ub(t,e){let r;if(e instanceof eh)r={update:xT(t,e.key,e.value)};else if(e instanceof th)r={delete:k0(t,e.key)};else if(e instanceof yo)r={update:xT(t,e.key,e.data),updateMask:p5(e.fieldMask)};else{if(!(e instanceof tb))return nt();r={verify:k0(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,l){const u=l.transform;if(u instanceof Of)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof jf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Pf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof N0)return{fieldPath:l.field.canonicalString(),increment:u.Ie};throw nt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:n5(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:nt()}(t,e.precondition)),r}function o5(t,e){return t&&t.length>0?(Vt(e!==void 0),t.map(r=>function(a,o){let l=a.updateTime?ga(a.updateTime):ga(o);return l.isEqual(it.min())&&(l=ga(o)),new qD(l,a.transformResults||[])}(r,e))):[]}function l5(t,e){return{documents:[lb(t,e.path)]}}function c5(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=lb(t,a);const o=function(m){if(m.length!==0)return hb(ts.create(m,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const l=function(m){if(m.length!==0)return m.map(g=>function(_){return{field:hc(_.field),direction:h5(_.dir)}}(g))}(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=Dg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ht:r,parent:a}}function u5(t){let e=a5(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Vt(n===1);const g=r.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let o=[];r.where&&(o=function(y){const _=fb(y);return _ instanceof ts&&MS(_)?_.getFilters():[_]}(r.where));let l=[];r.orderBy&&(l=function(y){return y.map(_=>function(E){return new Df(dc(E.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(_))}(r.orderBy));let u=null;r.limit&&(u=function(y){let _;return _=typeof y=="object"?y.value:y,Zf(_)?null:_}(r.limit));let d=null;r.startAt&&(d=function(y){const _=!!y.before,T=y.values||[];return new C0(T,_)}(r.startAt));let m=null;return r.endAt&&(m=function(y){const _=!y.before,T=y.values||[];return new C0(T,_)}(r.endAt)),ID(e,a,l,o,u,"F",d,m)}function f5(t,e){const r=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return nt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function fb(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=dc(r.unaryFilter.field);return Lr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=dc(r.unaryFilter.field);return Lr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=dc(r.unaryFilter.field);return Lr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=dc(r.unaryFilter.field);return Lr.create(l,"!=",{nullValue:"NULL_VALUE"});default:return nt()}}(t):t.fieldFilter!==void 0?function(r){return Lr.create(dc(r.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return nt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ts.create(r.compositeFilter.filters.map(n=>fb(n)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return nt()}}(r.compositeFilter.op))}(t):nt()}function h5(t){return ZD[t]}function d5(t){return e5[t]}function m5(t){return t5[t]}function hc(t){return{fieldPath:t.canonicalString()}}function dc(t){return hn.fromServerFormat(t.fieldPath)}function hb(t){return t instanceof Lr?function(r){if(r.op==="=="){if(sT(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NAN"}};if(aT(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(sT(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NOT_NAN"}};if(aT(r.value))return{unaryFilter:{field:hc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hc(r.field),op:d5(r.op),value:r.value}}}(t):t instanceof ts?function(r){const n=r.getFilters().map(a=>hb(a));return n.length===1?n[0]:{compositeFilter:{op:m5(r.op),filters:n}}}(t):nt()}function p5(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function db(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,r,n,a,o=it.min(),l=it.min(),u=vn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=d}withSequenceNumber(e){return new Zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e){this.Tt=e}}function v5(t){const e=u5({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ig(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(){this.Tn=new _5}addToCollectionParentIndex(e,r){return this.Tn.add(r),De.resolve()}getCollectionParents(e,r){return De.resolve(this.Tn.getEntries(r))}addFieldIndex(e,r){return De.resolve()}deleteFieldIndex(e,r){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,r){return De.resolve()}getDocumentsMatchingTarget(e,r){return De.resolve(null)}getIndexType(e,r){return De.resolve(0)}getFieldIndexes(e,r){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,r){return De.resolve(co.min())}getMinOffsetFromCollectionGroup(e,r){return De.resolve(co.min())}updateCollectionGroup(e,r,n){return De.resolve()}updateIndexEntries(e,r){return De.resolve()}}class _5{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new $r(nr.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new $r(nr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mb=41943040;class ta{static withCacheSize(e){return new ta(e,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ta.DEFAULT_COLLECTION_PERCENTILE=10,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ta.DEFAULT=new ta(mb,ta.DEFAULT_COLLECTION_PERCENTILE,ta.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ta.DISABLED=new ta(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new Rc(0)}static Kn(){return new Rc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT="LruGarbageCollector",y5=1048576;function ET([t,e],[r,n]){const a=Et(t,r);return a===0?Et(e,n):a}class E5{constructor(e){this.Hn=e,this.buffer=new $r(ET),this.Jn=0}Yn(){return++this.Jn}Zn(e){const r=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();ET(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class T5{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){Ye(yT,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Bc(r)?Ye(yT,"Ignoring IndexedDB error during garbage collection: ",r):await Mc(r)}await this.er(3e5)})}}class w5{constructor(e,r){this.tr=e,this.params=r}calculateTargetCount(e,r){return this.tr.nr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return De.resolve(lm.ae);const n=new E5(r);return this.tr.forEachTarget(e,a=>n.Zn(a.sequenceNumber)).next(()=>this.tr.rr(e,a=>n.Zn(a))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.tr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.tr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),De.resolve(_T)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_T):this.ir(e,r))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,r){let n,a,o,l,u,d,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),a=this.params.maximumSequenceNumbersToCollect):a=y,l=Date.now(),this.nthSequenceNumber(e,a))).next(y=>(n=y,u=Date.now(),this.removeTargets(e,n,r))).next(y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(m=Date.now(),uc()<=Nt.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-g}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(d-u)+`ms
	Removed ${y} documents in `+(m-d)+`ms
Total Duration: ${m-g}ms`),De.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:y})))}}function S5(t,e){return new w5(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(){this.changes=new pl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,rn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?De.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,r))).next(a=>(n!==null&&df(n.mutation,a,pa.empty(),qr.now()),a))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Rt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Rt()){const a=Zo();return this.populateOverlays(e,a,r).next(()=>this.computeViews(e,r,a,n).next(o=>{let l=rf();return o.forEach((u,d)=>{l=l.insert(u,d.overlayedDocument)}),l}))}getOverlayedDocuments(e,r){const n=Zo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Rt()))}populateOverlays(e,r,n){const a=[];return n.forEach(o=>{r.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((l,u)=>{r.set(l,u)})})}computeViews(e,r,n,a){let o=vi();const l=hf(),u=function(){return hf()}();return r.forEach((d,m)=>{const g=n.get(m.key);a.has(m.key)&&(g===void 0||g.mutation instanceof yo)?o=o.insert(m.key,m):g!==void 0?(l.set(m.key,g.mutation.getFieldMask()),df(g.mutation,m,g.mutation.getFieldMask(),qr.now())):l.set(m.key,pa.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((m,g)=>l.set(m,g)),r.forEach((m,g)=>{var y;return u.set(m,new A5(g,(y=l.get(m))!==null&&y!==void 0?y:null))}),u))}recalculateAndSaveOverlays(e,r){const n=hf();let a=new vr((l,u)=>l-u),o=Rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(l=>{for(const u of l)u.keys().forEach(d=>{const m=r.get(d);if(m===null)return;let g=n.get(d)||pa.empty();g=u.applyToLocalView(m,g),n.set(d,g);const y=(a.get(u.batchId)||Rt()).add(d);a=a.insert(u.batchId,y)})}).next(()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const d=u.getNext(),m=d.key,g=d.value,y=YS();g.forEach(_=>{if(!o.has(_)){const T=ZS(r.get(_),n.get(_));T!==null&&y.set(_,T),o=o.add(_)}}),l.push(this.documentOverlayCache.saveOverlays(e,m,y))}return De.waitFor(l)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,a){return function(l){return rt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):zS(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next(o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):De.resolve(Zo());let u=Nf,d=o;return l.next(m=>De.forEach(m,(g,y)=>(u<y.largestBatchId&&(u=y.largestBatchId),o.get(g)?De.resolve():this.remoteDocumentCache.getEntry(e,g).next(_=>{d=d.insert(g,_)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,d,m,Rt())).next(g=>({batchId:u,changes:$S(g)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new rt(r)).next(n=>{let a=rf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a})}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=rf();return this.indexManager.getCollectionParents(e,o).next(u=>De.forEach(u,d=>{const m=function(y,_){return new Vc(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(r,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,n,a).next(g=>{g.forEach((y,_)=>{l=l.insert(y,_)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a))).next(l=>{o.forEach((d,m)=>{const g=m.getKey();l.get(g)===null&&(l=l.insert(g,rn.newInvalidDocument(g)))});let u=rf();return l.forEach((d,m)=>{const g=o.get(d);g!==void 0&&df(g.mutation,m,pa.empty(),qr.now()),hm(r,m)&&(u=u.insert(d,m))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,r){return De.resolve(this.dr.get(r))}saveBundleMetadata(e,r){return this.dr.set(r.id,function(a){return{id:a.id,version:a.version,createTime:ga(a.createTime)}}(r)),De.resolve()}getNamedQuery(e,r){return De.resolve(this.Ar.get(r))}saveNamedQuery(e,r){return this.Ar.set(r.name,function(a){return{name:a.name,query:v5(a.bundledQuery),readTime:ga(a.readTime)}}(r)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(){this.overlays=new vr(rt.comparator),this.Rr=new Map}getOverlay(e,r){return De.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Zo();return De.forEach(r,a=>this.getOverlay(e,a).next(o=>{o!==null&&n.set(a,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((a,o)=>{this.Et(e,r,o)}),De.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.Rr.get(n);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.Rr.delete(n)),De.resolve()}getOverlaysForCollection(e,r,n){const a=Zo(),o=r.length+1,l=new rt(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const d=u.getNext().value,m=d.getKey();if(!r.isPrefixOf(m.path))break;m.path.length===o&&d.largestBatchId>n&&a.set(d.getKey(),d)}return De.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new vr((m,g)=>m-g);const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===r&&m.largestBatchId>n){let g=o.get(m.largestBatchId);g===null&&(g=Zo(),o=o.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const u=Zo(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((m,g)=>u.set(m,g)),!(u.size()>=a)););return De.resolve(u)}Et(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.Rr.get(a.largestBatchId).delete(n.key);this.Rr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new KD(r,n));let o=this.Rr.get(r);o===void 0&&(o=Rt(),this.Rr.set(r,o)),this.Rr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(){this.sessionToken=vn.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(){this.Vr=new $r(en.mr),this.gr=new $r(en.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,r){const n=new en(e,r);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.wr(new en(e,r))}Sr(e,r){e.forEach(n=>this.removeReference(n,r))}br(e){const r=new rt(new nr([])),n=new en(r,e),a=new en(r,e+1),o=[];return this.gr.forEachInRange([n,a],l=>{this.wr(l),o.push(l.key)}),o}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const r=new rt(new nr([])),n=new en(r,e),a=new en(r,e+1);let o=Rt();return this.gr.forEachInRange([n,a],l=>{o=o.add(l.key)}),o}containsKey(e){const r=new en(e,0),n=this.Vr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class en{constructor(e,r){this.key=e,this.Cr=r}static mr(e,r){return rt.comparator(e.key,r.key)||Et(e.Cr,r.Cr)}static pr(e,r){return Et(e.Cr,r.Cr)||rt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I5{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Fr=1,this.Mr=new $r(en.mr)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new WD(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Mr=this.Mr.add(new en(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return De.resolve(l)}lookupMutationBatch(e,r){return De.resolve(this.Or(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.Nr(n),o=a<0?0:a;return De.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?wv:this.Fr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new en(r,0),a=new en(r,Number.POSITIVE_INFINITY),o=[];return this.Mr.forEachInRange([n,a],l=>{const u=this.Or(l.Cr);o.push(u)}),De.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new $r(Et);return r.forEach(a=>{const o=new en(a,0),l=new en(a,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([o,l],u=>{n=n.add(u.Cr)})}),De.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;rt.isDocumentKey(o)||(o=o.child(""));const l=new en(new rt(o),0);let u=new $r(Et);return this.Mr.forEachWhile(d=>{const m=d.key.path;return!!n.isPrefixOf(m)&&(m.length===a&&(u=u.add(d.Cr)),!0)},l),De.resolve(this.Br(u))}Br(e){const r=[];return e.forEach(n=>{const a=this.Or(n);a!==null&&r.push(a)}),r}removeMutationBatch(e,r){Vt(this.Lr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return De.forEach(r.mutations,a=>{const o=new en(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,r){const n=new en(r,0),a=this.Mr.firstAfterOrEqual(n);return De.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}Lr(e,r){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const r=this.Nr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e){this.kr=e,this.docs=function(){return new vr(rt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.kr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return De.resolve(n?n.document.mutableCopy():rn.newInvalidDocument(r))}getEntries(e,r){let n=vi();return r.forEach(a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():rn.newInvalidDocument(a))}),De.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=vi();const l=r.path,u=new rt(l.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(u);for(;d.hasNext();){const{key:m,value:{document:g}}=d.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||cD(lD(g),n)<=0||(a.has(g.key)||hm(r,g))&&(o=o.insert(g.key,g.mutableCopy()))}return De.resolve(o)}getAllFromCollectionGroup(e,r,n,a){nt()}qr(e,r){return De.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new O5(this)}getSize(e){return De.resolve(this.size)}}class O5 extends b5{constructor(e){super(),this.Ir=e}applyChanges(e){const r=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?r.push(this.Ir.addEntry(e,a)):this.Ir.removeEntry(n)}),De.waitFor(r)}getFromCache(e,r){return this.Ir.getEntry(e,r)}getAllFromCache(e,r){return this.Ir.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(e){this.persistence=e,this.Qr=new pl(r=>Av(r),Cv),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this.$r=0,this.Ur=new Dv,this.targetCount=0,this.Kr=Rc.Un()}forEachTarget(e,r){return this.Qr.forEach((n,a)=>r(a)),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.$r&&(this.$r=r),De.resolve()}zn(e){this.Qr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.Kr=new Rc(r),this.highestTargetId=r),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,r){return this.zn(r),this.targetCount+=1,De.resolve()}updateTargetData(e,r){return this.zn(r),De.resolve()}removeTargetData(e,r){return this.Qr.delete(r.target),this.Ur.br(r.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.Qr.forEach((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.Qr.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)}),De.waitFor(o).next(()=>a)}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,r){const n=this.Qr.get(r)||null;return De.resolve(n)}addMatchingKeys(e,r,n){return this.Ur.yr(r,n),De.resolve()}removeMatchingKeys(e,r,n){this.Ur.Sr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach(l=>{o.push(a.markPotentiallyOrphaned(e,l))}),De.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.Ur.br(r),De.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Ur.vr(r);return De.resolve(n)}containsKey(e,r){return De.resolve(this.Ur.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e,r){this.Wr={},this.overlays={},this.Gr=new lm(0),this.zr=!1,this.zr=!0,this.jr=new k5,this.referenceDelegate=e(this),this.Hr=new j5(this),this.indexManager=new x5,this.remoteDocumentCache=function(a){return new D5(a)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new g5(r),this.Yr=new N5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new R5,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.Wr[e.toKey()];return n||(n=new I5(r,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,r,n){Ye("MemoryPersistence","Starting transaction:",e);const a=new P5(this.Gr.next());return this.referenceDelegate.Zr(),n(a).next(o=>this.referenceDelegate.Xr(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}ei(e,r){return De.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,r)))}}class P5 extends fD{constructor(e){super(),this.currentSequenceNumber=e}}class Ov{constructor(e){this.persistence=e,this.ti=new Dv,this.ni=null}static ri(e){return new Ov(e)}get ii(){if(this.ni)return this.ni;throw nt()}addReference(e,r,n){return this.ti.addReference(n,r),this.ii.delete(n.toString()),De.resolve()}removeReference(e,r,n){return this.ti.removeReference(n,r),this.ii.add(n.toString()),De.resolve()}markPotentiallyOrphaned(e,r){return this.ii.add(r.toString()),De.resolve()}removeTarget(e,r){this.ti.br(r.targetId).forEach(a=>this.ii.add(a.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(a=>{a.forEach(o=>this.ii.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Zr(){this.ni=new Set}Xr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.ii,n=>{const a=rt.fromPath(n);return this.si(e,a).next(o=>{o||r.removeEntry(a,it.min())})}).next(()=>(this.ni=null,r.apply(e)))}updateLimboDocument(e,r){return this.si(e,r).next(n=>{n?this.ii.delete(r.toString()):this.ii.add(r.toString())})}Jr(e){return 0}si(e,r){return De.or([()=>De.resolve(this.ti.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.ei(e,r)])}}class I0{constructor(e,r){this.persistence=e,this.oi=new pl(n=>mD(n.path),(n,a)=>n.isEqual(a)),this.garbageCollector=S5(this,r)}static ri(e,r){return new I0(e,r)}Zr(){}Xr(e){return De.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}nr(e){const r=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(a=>n+a))}sr(e){let r=0;return this.rr(e,n=>{r++}).next(()=>r)}rr(e,r){return De.forEach(this.oi,(n,a)=>this.ar(e,n,a).next(o=>o?De.resolve():r(a)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.qr(e,l=>this.ar(e,l,r).next(u=>{u||(n++,o.removeEntry(l,it.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.oi.set(r,e.currentSequenceNumber),De.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.oi.set(n,e.currentSequenceNumber),De.resolve()}removeReference(e,r,n){return this.oi.set(n,e.currentSequenceNumber),De.resolve()}updateLimboDocument(e,r){return this.oi.set(r,e.currentSequenceNumber),De.resolve()}Jr(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=c0(e.data.value)),r}ar(e,r,n){return De.or([()=>this.persistence.ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.oi.get(r);return De.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Hi=n,this.Ji=a}static Yi(e,r){let n=Rt(),a=Rt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new jv(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return pR()?8:hD(Rn())>0?6:4}()}initialize(e,r){this.ns=e,this.indexManager=r,this.Zi=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.rs(e,r).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.ss(e,r,a,n).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new F5;return this._s(e,r,l).next(u=>{if(o.result=u,this.Xi)return this.us(e,r,l,u.size)})}).next(()=>o.result)}us(e,r,n,a){return n.documentReadCount<this.es?(uc()<=Nt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",fc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),De.resolve()):(uc()<=Nt.DEBUG&&Ye("QueryEngine","Query:",fc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.ts*a?(uc()<=Nt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",fc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Rs(r))):De.resolve())}rs(e,r){if(cT(r))return De.resolve(null);let n=Rs(r);return this.indexManager.getIndexType(e,n).next(a=>a===0?null:(r.limit!==null&&a===1&&(r=Ig(r,null,"F"),n=Rs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const l=Rt(...o);return this.ns.getDocuments(e,l).next(u=>this.indexManager.getMinOffset(e,n).next(d=>{const m=this.cs(r,u);return this.ls(r,m,l,d.readTime)?this.rs(e,Ig(r,null,"F")):this.hs(e,m,r,d)}))})))}ss(e,r,n,a){return cT(r)||a.isEqual(it.min())?De.resolve(null):this.ns.getDocuments(e,n).next(o=>{const l=this.cs(r,o);return this.ls(r,l,n,a)?De.resolve(null):(uc()<=Nt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),fc(r)),this.hs(e,l,r,oD(a,Nf)).next(u=>u))})}cs(e,r){let n=new $r(GS(e));return r.forEach((a,o)=>{hm(e,o)&&(n=n.add(o))}),n}ls(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}_s(e,r,n){return uc()<=Nt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",fc(r)),this.ns.getDocumentsMatchingQuery(e,r,co.min(),n)}hs(e,r,n,a){return this.ns.getDocumentsMatchingQuery(e,n,a).next(o=>(r.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="LocalStore",M5=3e8;class B5{constructor(e,r,n,a){this.persistence=e,this.Ps=r,this.serializer=a,this.Ts=new vr(Et),this.Is=new pl(o=>Av(o),Cv),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new C5(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Ts))}}function V5(t,e,r,n){return new B5(t,e,r,n)}async function gb(t,e){const r=dt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next(o=>(a=o,r.As(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const l=[],u=[];let d=Rt();for(const m of a){l.push(m.batchId);for(const g of m.mutations)d=d.add(g.key)}for(const m of o){u.push(m.batchId);for(const g of m.mutations)d=d.add(g.key)}return r.localDocuments.getDocuments(n,d).next(m=>({Rs:m,removedBatchIds:l,addedBatchIds:u}))})})}function U5(t,e){const r=dt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const a=e.batch.keys(),o=r.ds.newChangeBuffer({trackRemovals:!0});return function(u,d,m,g){const y=m.batch,_=y.keys();let T=De.resolve();return _.forEach(E=>{T=T.next(()=>g.getEntry(d,E)).next(S=>{const b=m.docVersions.get(E);Vt(b!==null),S.version.compareTo(b)<0&&(y.applyToRemoteDocument(S,m),S.isValidDocument()&&(S.setReadTime(m.commitVersion),g.addEntry(S)))})}),T.next(()=>u.mutationQueue.removeMutationBatch(d,y))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let d=Rt();for(let m=0;m<u.mutationResults.length;++m)u.mutationResults[m].transformResults.length>0&&(d=d.add(u.batch.mutations[m].key));return d}(e))).next(()=>r.localDocuments.getDocuments(n,a))})}function vb(t){const e=dt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Hr.getLastRemoteSnapshotVersion(r))}function z5(t,e){const r=dt(t),n=e.snapshotVersion;let a=r.Ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const l=r.ds.newChangeBuffer({trackRemovals:!0});a=r.Ts;const u=[];e.targetChanges.forEach((g,y)=>{const _=a.get(y);if(!_)return;u.push(r.Hr.removeMatchingKeys(o,g.removedDocuments,y).next(()=>r.Hr.addMatchingKeys(o,g.addedDocuments,y)));let T=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?T=T.withResumeToken(vn.EMPTY_BYTE_STRING,it.min()).withLastLimboFreeSnapshotVersion(it.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,n)),a=a.insert(y,T),function(S,b,O){return S.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=M5?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(_,T,g)&&u.push(r.Hr.updateTargetData(o,T))});let d=vi(),m=Rt();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(H5(o,l,e.documentUpdates).next(g=>{d=g.Vs,m=g.fs})),!n.isEqual(it.min())){const g=r.Hr.getLastRemoteSnapshotVersion(o).next(y=>r.Hr.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(g)}return De.waitFor(u).next(()=>l.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,d,m)).next(()=>d)}).then(o=>(r.Ts=a,o))}function H5(t,e,r){let n=Rt(),a=Rt();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let l=vi();return r.forEach((u,d)=>{const m=o.get(u);d.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(u)),d.isNoDocument()&&d.version.isEqual(it.min())?(e.removeEntry(u,d.readTime),l=l.insert(u,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),l=l.insert(u,d)):Ye(Pv,"Ignoring outdated watch update for ",u,". Current version:",m.version," Watch version:",d.version)}),{Vs:l,fs:a}})}function G5(t,e){const r=dt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=wv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function q5(t,e){const r=dt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let a;return r.Hr.getTargetData(n,e).next(o=>o?(a=o,De.resolve(a)):r.Hr.allocateTargetId(n).next(l=>(a=new Zi(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.Hr.addTargetData(n,a).next(()=>a))))}).then(n=>{const a=r.Ts.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ts=r.Ts.insert(n.targetId,n),r.Is.set(e,n.targetId)),n})}async function Pg(t,e,r){const n=dt(t),a=n.Ts.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,l=>n.persistence.referenceDelegate.removeTarget(l,a))}catch(l){if(!Bc(l))throw l;Ye(Pv,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ts=n.Ts.remove(e),n.Is.delete(a.target)}function TT(t,e,r){const n=dt(t);let a=it.min(),o=Rt();return n.persistence.runTransaction("Execute query","readwrite",l=>function(d,m,g){const y=dt(d),_=y.Is.get(g);return _!==void 0?De.resolve(y.Ts.get(_)):y.Hr.getTargetData(m,g)}(n,l,Rs(e)).next(u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(l,u.targetId).next(d=>{o=d})}).next(()=>n.Ps.getDocumentsMatchingQuery(l,e,r?a:it.min(),r?o:Rt())).next(u=>($5(n,OD(e),u),{documents:u,gs:o})))}function $5(t,e,r){let n=t.Es.get(e)||it.min();r.forEach((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.Es.set(e,n)}class wT{constructor(){this.activeTargetIds=BD()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Y5{constructor(){this.ho=new wT,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,r,n){this.Po[e]=r}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new wT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST="ConnectivityMonitor";class bT{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ye(ST,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){Ye(ST,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gd=null;function Fg(){return Gd===null?Gd=function(){return 268435456+Math.round(2147483648*Math.random())}():Gd++,"0x"+Gd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1="RestConnection",K5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class X5{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.po=r+"://"+e.host,this.yo=`projects/${n}/databases/${a}`,this.wo=this.databaseId.database===b0?`project_id=${n}`:`project_id=${n}&database_id=${a}`}So(e,r,n,a,o){const l=Fg(),u=this.bo(e,r.toUriEncodedString());Ye(K1,`Sending RPC '${e}' ${l}:`,u,n);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,a,o),this.vo(e,u,d,n).then(m=>(Ye(K1,`Received RPC '${e}' ${l}: `,m),m),m=>{throw bc(K1,`RPC '${e}' ${l} failed with error: `,m,"url: ",u,"request:",n),m})}Co(e,r,n,a,o,l){return this.So(e,r,n,a,o)}Do(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Lc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((a,o)=>e[o]=a),n&&n.headers.forEach((a,o)=>e[o]=a)}bo(e,r){const n=K5[e];return`${this.po}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En="WebChannelConnection";class J5 extends X5{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,r,n,a){const o=Fg();return new Promise((l,u)=>{const d=new xS;d.setWithCredentials(!0),d.listenOnce(_S.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case l0.NO_ERROR:const g=d.getResponseJson();Ye(En,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),l(g);break;case l0.TIMEOUT:Ye(En,`RPC '${e}' ${o} timed out`),u(new qe(Re.DEADLINE_EXCEEDED,"Request time out"));break;case l0.HTTP_ERROR:const y=d.getStatus();if(Ye(En,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const T=_==null?void 0:_.error;if(T&&T.status&&T.message){const E=function(b){const O=b.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(O)>=0?O:Re.UNKNOWN}(T.status);u(new qe(E,T.message))}else u(new qe(Re.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new qe(Re.UNAVAILABLE,"Connection failed."));break;default:nt()}}finally{Ye(En,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(a);Ye(En,`RPC '${e}' ${o} sending request:`,a),d.send(r,"POST",m,n,15)})}Wo(e,r,n){const a=Fg(),o=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=TS(),u=ES(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(d.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,r,n),d.encodeInitMessageHeaders=!0;const g=o.join("");Ye(En,`Creating RPC '${e}' stream ${a}: ${g}`,d);const y=l.createWebChannel(g,d);let _=!1,T=!1;const E=new Q5({Fo:b=>{T?Ye(En,`Not sending because RPC '${e}' stream ${a} is closed:`,b):(_||(Ye(En,`Opening RPC '${e}' stream ${a} transport.`),y.open(),_=!0),Ye(En,`RPC '${e}' stream ${a} sending:`,b),y.send(b))},Mo:()=>y.close()}),S=(b,O,L)=>{b.listen(O,A=>{try{L(A)}catch(D){setTimeout(()=>{throw D},0)}})};return S(y,tf.EventType.OPEN,()=>{T||(Ye(En,`RPC '${e}' stream ${a} transport opened.`),E.Qo())}),S(y,tf.EventType.CLOSE,()=>{T||(T=!0,Ye(En,`RPC '${e}' stream ${a} transport closed`),E.Uo())}),S(y,tf.EventType.ERROR,b=>{T||(T=!0,bc(En,`RPC '${e}' stream ${a} transport errored:`,b),E.Uo(new qe(Re.UNAVAILABLE,"The operation could not be completed")))}),S(y,tf.EventType.MESSAGE,b=>{var O;if(!T){const L=b.data[0];Vt(!!L);const A=L,D=(A==null?void 0:A.error)||((O=A[0])===null||O===void 0?void 0:O.error);if(D){Ye(En,`RPC '${e}' stream ${a} received error:`,D);const V=D.status;let H=function(R){const F=jr[R];if(F!==void 0)return nb(F)}(V),C=D.message;H===void 0&&(H=Re.INTERNAL,C="Unknown error status: "+V+" with message "+D.message),T=!0,E.Uo(new qe(H,C)),y.close()}else Ye(En,`RPC '${e}' stream ${a} received:`,L),E.Ko(L)}}),S(u,yS.STAT_EVENT,b=>{b.stat===Sg.PROXY?Ye(En,`RPC '${e}' stream ${a} detected buffering proxy`):b.stat===Sg.NOPROXY&&Ye(En,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{E.$o()},0),E}}function X1(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gm(t){return new r5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Ti=e,this.timerId=r,this.Go=n,this.zo=a,this.jo=o,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const r=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),a=Math.max(0,r-n);a>0&&Ye("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ho} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,a,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AT="PersistentStream";class xb{constructor(e,r,n,a,o,l,u,d){this.Ti=e,this.n_=n,this.r_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new Fv(e,r)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,r){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(gi(r.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(r)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),r=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,a])=>{this.i_===r&&this.V_(n,a)},n=>{e(()=>{const a=new qe(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(a)})})}V_(e,r){const n=this.R_(this.i_);this.stream=this.f_(e,r),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(a=>{n(()=>this.m_(a))}),this.stream.onMessage(a=>{n(()=>++this.__==1?this.g_(a):this.onNext(a))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return Ye(AT,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return r=>{this.Ti.enqueueAndForget(()=>this.i_===e?r():(Ye(AT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Z5 extends xb{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}f_(e,r){return this.connection.Wo("Listen",e,r)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const r=i5(this.serializer,e),n=function(o){if(!("targetChange"in o))return it.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?it.min():l.readTime?ga(l.readTime):it.min()}(e);return this.listener.p_(r,n)}y_(e){const r={};r.database=jg(this.serializer),r.addTarget=function(o,l){let u;const d=l.target;if(u=Rg(d)?{documents:l5(o,d)}:{query:c5(o,d).ht},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=ib(o,l.resumeToken);const m=Dg(o,l.expectedCount);m!==null&&(u.expectedCount=m)}else if(l.snapshotVersion.compareTo(it.min())>0){u.readTime=R0(o,l.snapshotVersion.toTimestamp());const m=Dg(o,l.expectedCount);m!==null&&(u.expectedCount=m)}return u}(this.serializer,e);const n=f5(this.serializer,e);n&&(r.labels=n),this.I_(r)}w_(e){const r={};r.database=jg(this.serializer),r.removeTarget=e,this.I_(r)}}class eO extends xb{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,r){return this.connection.Wo("Write",e,r)}g_(e){return Vt(!!e.streamToken),this.lastStreamToken=e.streamToken,Vt(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Vt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const r=o5(e.writeResults,e.commitTime),n=ga(e.commitTime);return this.listener.v_(n,r)}C_(){const e={};e.database=jg(this.serializer),this.I_(e)}b_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>ub(this.serializer,n))};this.I_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{}class rO extends tO{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.F_=!1}M_(){if(this.F_)throw new qe(Re.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,r,n,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.So(e,Og(r,n),a,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qe(Re.UNKNOWN,o.toString())})}Co(e,r,n,a,o){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,u])=>this.connection.Co(e,Og(r,n),a,l,u,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new qe(Re.UNKNOWN,l.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class nO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(gi(r),this.N_=!1):Ye("OnlineStateTracker",r)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll="RemoteStore";class aO{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=o,this.z_.To(l=>{n.enqueueAndForget(async()=>{gl(this)&&(Ye(ll,"Restarting streams for network reachability change."),await async function(d){const m=dt(d);m.W_.add(4),await nh(m),m.j_.set("Unknown"),m.W_.delete(4),await vm(m)}(this))})}),this.j_=new nO(n,a)}}async function vm(t){if(gl(t))for(const e of t.G_)await e(!0)}async function nh(t){for(const e of t.G_)await e(!1)}function _b(t,e){const r=dt(t);r.K_.has(e.targetId)||(r.K_.set(e.targetId,e),Vv(r)?Bv(r):Uc(r).c_()&&Mv(r,e))}function Lv(t,e){const r=dt(t),n=Uc(r);r.K_.delete(e),n.c_()&&yb(r,e),r.K_.size===0&&(n.c_()?n.P_():gl(r)&&r.j_.set("Unknown"))}function Mv(t,e){if(t.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(it.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Uc(t).y_(e)}function yb(t,e){t.H_.Ne(e),Uc(t).w_(e)}function Bv(t){t.H_=new JD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.K_.get(e)||null,it:()=>t.datastore.serializer.databaseId}),Uc(t).start(),t.j_.B_()}function Vv(t){return gl(t)&&!Uc(t).u_()&&t.K_.size>0}function gl(t){return dt(t).W_.size===0}function Eb(t){t.H_=void 0}async function sO(t){t.j_.set("Online")}async function iO(t){t.K_.forEach((e,r)=>{Mv(t,e)})}async function oO(t,e){Eb(t),Vv(t)?(t.j_.q_(e),Bv(t)):t.j_.set("Unknown")}async function lO(t,e,r){if(t.j_.set("Online"),e instanceof sb&&e.state===2&&e.cause)try{await async function(a,o){const l=o.cause;for(const u of o.targetIds)a.K_.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.K_.delete(u),a.H_.removeTarget(u))}(t,e)}catch(n){Ye(ll,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await D0(t,n)}else if(e instanceof h0?t.H_.We(e):e instanceof ab?t.H_.Ze(e):t.H_.je(e),!r.isEqual(it.min()))try{const n=await vb(t.localStore);r.compareTo(n)>=0&&await function(o,l){const u=o.H_.ot(l);return u.targetChanges.forEach((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.K_.get(m);g&&o.K_.set(m,g.withResumeToken(d.resumeToken,l))}}),u.targetMismatches.forEach((d,m)=>{const g=o.K_.get(d);if(!g)return;o.K_.set(d,g.withResumeToken(vn.EMPTY_BYTE_STRING,g.snapshotVersion)),yb(o,d);const y=new Zi(g.target,d,m,g.sequenceNumber);Mv(o,y)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){Ye(ll,"Failed to raise snapshot:",n),await D0(t,n)}}async function D0(t,e,r){if(!Bc(e))throw e;t.W_.add(1),await nh(t),t.j_.set("Offline"),r||(r=()=>vb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(ll,"Retrying IndexedDB access"),await r(),t.W_.delete(1),await vm(t)})}function Tb(t,e){return e().catch(r=>D0(t,r,e))}async function xm(t){const e=dt(t),r=mo(e);let n=e.U_.length>0?e.U_[e.U_.length-1].batchId:wv;for(;cO(e);)try{const a=await G5(e.localStore,n);if(a===null){e.U_.length===0&&r.P_();break}n=a.batchId,uO(e,a)}catch(a){await D0(e,a)}wb(e)&&Sb(e)}function cO(t){return gl(t)&&t.U_.length<10}function uO(t,e){t.U_.push(e);const r=mo(t);r.c_()&&r.S_&&r.b_(e.mutations)}function wb(t){return gl(t)&&!mo(t).u_()&&t.U_.length>0}function Sb(t){mo(t).start()}async function fO(t){mo(t).C_()}async function hO(t){const e=mo(t);for(const r of t.U_)e.b_(r.mutations)}async function dO(t,e,r){const n=t.U_.shift(),a=Rv.from(n,e,r);await Tb(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await xm(t)}async function mO(t,e){e&&mo(t).S_&&await async function(n,a){if(function(l){return rb(l)&&l!==Re.ABORTED}(a.code)){const o=n.U_.shift();mo(n).h_(),await Tb(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a)),await xm(n)}}(t,e),wb(t)&&Sb(t)}async function CT(t,e){const r=dt(t);r.asyncQueue.verifyOperationInProgress(),Ye(ll,"RemoteStore received new credentials");const n=gl(r);r.W_.add(3),await nh(r),n&&r.j_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.W_.delete(3),await vm(r)}async function pO(t,e){const r=dt(t);e?(r.W_.delete(2),await vm(r)):e||(r.W_.add(2),await nh(r),r.j_.set("Unknown"))}function Uc(t){return t.J_||(t.J_=function(r,n,a){const o=dt(r);return o.M_(),new Z5(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{xo:sO.bind(null,t),No:iO.bind(null,t),Lo:oO.bind(null,t),p_:lO.bind(null,t)}),t.G_.push(async e=>{e?(t.J_.h_(),Vv(t)?Bv(t):t.j_.set("Unknown")):(await t.J_.stop(),Eb(t))})),t.J_}function mo(t){return t.Y_||(t.Y_=function(r,n,a){const o=dt(r);return o.M_(),new eO(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{xo:()=>Promise.resolve(),No:fO.bind(null,t),Lo:mO.bind(null,t),D_:hO.bind(null,t),v_:dO.bind(null,t)}),t.G_.push(async e=>{e?(t.Y_.h_(),await xm(t)):(await t.Y_.stop(),t.U_.length>0&&(Ye(ll,`Stopping write stream with ${t.U_.length} pending writes`),t.U_=[]))})),t.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new Ns,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new Uv(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zv(t,e){if(gi("AsyncQueue",`${e}: ${t}`),Bc(t))return new qe(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{static emptySet(e){return new Ec(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||rt.comparator(r.key,n.key):(r,n)=>rt.comparator(r.key,n.key),this.keyedMap=rf(),this.sortedSet=new vr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ec)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ec;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(){this.Z_=new vr(rt.comparator)}track(e){const r=e.doc.key,n=this.Z_.get(r);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(r,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(r):e.type===1&&n.type===2?this.Z_=this.Z_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(r,{type:2,doc:e.doc}):nt():this.Z_=this.Z_.insert(r,e)}X_(){const e=[];return this.Z_.inorderTraversal((r,n)=>{e.push(n)}),e}}class kc{constructor(e,r,n,a,o,l,u,d,m){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach(u=>{l.push({type:0,doc:u})}),new kc(e,r,Ec.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class vO{constructor(){this.queries=RT(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(r,n){const a=dt(r),o=a.queries;a.queries=RT(),o.forEach((l,u)=>{for(const d of u.ta)d.onError(n)})})(this,new qe(Re.ABORTED,"Firestore shutting down"))}}function RT(){return new pl(t=>HS(t),fm)}async function Hv(t,e){const r=dt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.na()&&e.ra()&&(n=2):(o=new gO,n=e.ra()?0:1);try{switch(n){case 0:o.ea=await r.onListen(a,!0);break;case 1:o.ea=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=zv(l,`Initialization of query '${fc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.ta.push(e),e.sa(r.onlineState),o.ea&&e.oa(o.ea)&&qv(r)}async function Gv(t,e){const r=dt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.ta.indexOf(e);l>=0&&(o.ta.splice(l,1),o.ta.length===0?a=e.ra()?0:1:!o.na()&&e.ra()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function xO(t,e){const r=dt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.ta)u.oa(a)&&(n=!0);l.ea=a}}n&&qv(r)}function _O(t,e,r){const n=dt(t),a=n.queries.get(e);if(a)for(const o of a.ta)o.onError(r);n.queries.delete(e)}function qv(t){t.ia.forEach(e=>{e.next()})}var Lg,kT;(kT=Lg||(Lg={}))._a="default",kT.Cache="cache";class $v{constructor(e,r,n){this.query=e,this.aa=r,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new kc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.ua?this.la(e)&&(this.aa.next(e),r=!0):this.ha(e,this.onlineState)&&(this.Pa(e),r=!0),this.ca=e,r}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let r=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),r=!0),r}ha(e,r){if(!e.fromCache||!this.ra())return!0;const n=r!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}la(e){if(e.docChanges.length>0)return!0;const r=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}Pa(e){e=kc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Lg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e){this.key=e}}class Ab{constructor(e){this.key=e}}class yO{constructor(e,r){this.query=e,this.fa=r,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Rt(),this.mutatedKeys=Rt(),this.ya=GS(e),this.wa=new Ec(this.ya)}get Sa(){return this.fa}ba(e,r){const n=r?r.Da:new NT,a=r?r.wa:this.wa;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const d=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((g,y)=>{const _=a.get(g),T=hm(this.query,y)?y:null,E=!!_&&this.mutatedKeys.has(_.key),S=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let b=!1;_&&T?_.data.isEqual(T.data)?E!==S&&(n.track({type:3,doc:T}),b=!0):this.va(_,T)||(n.track({type:2,doc:T}),b=!0,(d&&this.ya(T,d)>0||m&&this.ya(T,m)<0)&&(u=!0)):!_&&T?(n.track({type:0,doc:T}),b=!0):_&&!T&&(n.track({type:1,doc:_}),b=!0,(d||m)&&(u=!0)),b&&(T?(l=l.add(T),o=S?o.add(g):o.delete(g)):(l=l.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const g=this.query.limitType==="F"?l.last():l.first();l=l.delete(g.key),o=o.delete(g.key),n.track({type:1,doc:g})}return{wa:l,Da:n,ls:u,mutatedKeys:o}}va(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const l=e.Da.X_();l.sort((g,y)=>function(T,E){const S=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return nt()}};return S(T)-S(E)}(g.type,y.type)||this.ya(g.doc,y.doc)),this.Ca(n),a=a!=null&&a;const u=r&&!a?this.Fa():[],d=this.pa.size===0&&this.current&&!a?1:0,m=d!==this.ga;return this.ga=d,l.length!==0||m?{snapshot:new kc(this.query,e.wa,o,l,e.mutatedKeys,d===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:u}:{Ma:u}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new NT,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(r=>this.fa=this.fa.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.fa=this.fa.delete(r)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Rt(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const r=[];return e.forEach(n=>{this.pa.has(n)||r.push(new Ab(n))}),this.pa.forEach(n=>{e.has(n)||r.push(new bb(n))}),r}Oa(e){this.fa=e.gs,this.pa=Rt();const r=this.ba(e.documents);return this.applyChanges(r,!0)}Na(){return kc.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Yv="SyncEngine";class EO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class TO{constructor(e){this.key=e,this.Ba=!1}}class wO{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.La={},this.ka=new pl(u=>HS(u),fm),this.qa=new Map,this.Qa=new Set,this.$a=new vr(rt.comparator),this.Ua=new Map,this.Ka=new Dv,this.Wa={},this.Ga=new Map,this.za=Rc.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function SO(t,e,r=!0){const n=Db(t);let a;const o=n.ka.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.Na()):a=await Cb(n,e,r,!0),a}async function bO(t,e){const r=Db(t);await Cb(r,e,!0,!1)}async function Cb(t,e,r,n){const a=await q5(t.localStore,Rs(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await AO(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&_b(t.remoteStore,a),u}async function AO(t,e,r,n,a){t.Ha=(y,_,T)=>async function(S,b,O,L){let A=b.view.ba(O);A.ls&&(A=await TT(S.localStore,b.query,!1).then(({documents:C})=>b.view.ba(C,A)));const D=L&&L.targetChanges.get(b.targetId),V=L&&L.targetMismatches.get(b.targetId)!=null,H=b.view.applyChanges(A,S.isPrimaryClient,D,V);return DT(S,b.targetId,H.Ma),H.snapshot}(t,y,_,T);const o=await TT(t.localStore,e,!0),l=new yO(e,o.gs),u=l.ba(o.documents),d=rh.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),m=l.applyChanges(u,t.isPrimaryClient,d);DT(t,r,m.Ma);const g=new EO(e,r,l);return t.ka.set(e,g),t.qa.has(r)?t.qa.get(r).push(e):t.qa.set(r,[e]),m.snapshot}async function CO(t,e,r){const n=dt(t),a=n.ka.get(e),o=n.qa.get(a.targetId);if(o.length>1)return n.qa.set(a.targetId,o.filter(l=>!fm(l,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Pg(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Lv(n.remoteStore,a.targetId),Mg(n,a.targetId)}).catch(Mc)):(Mg(n,a.targetId),await Pg(n.localStore,a.targetId,!0))}async function NO(t,e){const r=dt(t),n=r.ka.get(e),a=r.qa.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Lv(r.remoteStore,n.targetId))}async function RO(t,e,r){const n=FO(t);try{const a=await function(l,u){const d=dt(l),m=qr.now(),g=u.reduce((T,E)=>T.add(E.key),Rt());let y,_;return d.persistence.runTransaction("Locally write mutations","readwrite",T=>{let E=vi(),S=Rt();return d.ds.getEntries(T,g).next(b=>{E=b,E.forEach((O,L)=>{L.isValidDocument()||(S=S.add(O))})}).next(()=>d.localDocuments.getOverlayedDocuments(T,E)).next(b=>{y=b;const O=[];for(const L of u){const A=YD(L,y.get(L.key).overlayedDocument);A!=null&&O.push(new yo(L.key,A,PS(A.value.mapValue),Mr.exists(!0)))}return d.mutationQueue.addMutationBatch(T,m,O,u)}).next(b=>{_=b;const O=b.applyToLocalDocumentSet(y,S);return d.documentOverlayCache.saveOverlays(T,b.batchId,O)})}).then(()=>({batchId:_.batchId,changes:$S(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),function(l,u,d){let m=l.Wa[l.currentUser.toKey()];m||(m=new vr(Et)),m=m.insert(u,d),l.Wa[l.currentUser.toKey()]=m}(n,a.batchId,r),await ah(n,a.changes),await xm(n.remoteStore)}catch(a){const o=zv(a,"Failed to persist write");r.reject(o)}}async function Nb(t,e){const r=dt(t);try{const n=await z5(r.localStore,e);e.targetChanges.forEach((a,o)=>{const l=r.Ua.get(o);l&&(Vt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?l.Ba=!0:a.modifiedDocuments.size>0?Vt(l.Ba):a.removedDocuments.size>0&&(Vt(l.Ba),l.Ba=!1))}),await ah(r,n,e)}catch(n){await Mc(n)}}function IT(t,e,r){const n=dt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.ka.forEach((o,l)=>{const u=l.view.sa(e);u.snapshot&&a.push(u.snapshot)}),function(l,u){const d=dt(l);d.onlineState=u;let m=!1;d.queries.forEach((g,y)=>{for(const _ of y.ta)_.sa(u)&&(m=!0)}),m&&qv(d)}(n.eventManager,e),a.length&&n.La.p_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function kO(t,e,r){const n=dt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Ua.get(e),o=a&&a.key;if(o){let l=new vr(rt.comparator);l=l.insert(o,rn.newNoDocument(o,it.min()));const u=Rt().add(o),d=new pm(it.min(),new Map,new vr(Et),l,u);await Nb(n,d),n.$a=n.$a.remove(o),n.Ua.delete(e),Wv(n)}else await Pg(n.localStore,e,!1).then(()=>Mg(n,e,r)).catch(Mc)}async function IO(t,e){const r=dt(t),n=e.batch.batchId;try{const a=await U5(r.localStore,e);kb(r,n,null),Rb(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await ah(r,a)}catch(a){await Mc(a)}}async function DO(t,e,r){const n=dt(t);try{const a=await function(l,u){const d=dt(l);return d.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return d.mutationQueue.lookupMutationBatch(m,u).next(y=>(Vt(y!==null),g=y.keys(),d.mutationQueue.removeMutationBatch(m,y))).next(()=>d.mutationQueue.performConsistencyCheck(m)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(m,g,u)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>d.localDocuments.getDocuments(m,g))})}(n.localStore,e);kb(n,e,r),Rb(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await ah(n,a)}catch(a){await Mc(a)}}function Rb(t,e){(t.Ga.get(e)||[]).forEach(r=>{r.resolve()}),t.Ga.delete(e)}function kb(t,e,r){const n=dt(t);let a=n.Wa[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Wa[n.currentUser.toKey()]=a}}function Mg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.qa.get(e))t.ka.delete(n),r&&t.La.Ja(n,r);t.qa.delete(e),t.isPrimaryClient&&t.Ka.br(e).forEach(n=>{t.Ka.containsKey(n)||Ib(t,n)})}function Ib(t,e){t.Qa.delete(e.path.canonicalString());const r=t.$a.get(e);r!==null&&(Lv(t.remoteStore,r),t.$a=t.$a.remove(e),t.Ua.delete(r),Wv(t))}function DT(t,e,r){for(const n of r)n instanceof bb?(t.Ka.addReference(n.key,e),OO(t,n)):n instanceof Ab?(Ye(Yv,"Document no longer in limbo: "+n.key),t.Ka.removeReference(n.key,e),t.Ka.containsKey(n.key)||Ib(t,n.key)):nt()}function OO(t,e){const r=e.key,n=r.path.canonicalString();t.$a.get(r)||t.Qa.has(n)||(Ye(Yv,"New document in limbo: "+r),t.Qa.add(n),Wv(t))}function Wv(t){for(;t.Qa.size>0&&t.$a.size<t.maxConcurrentLimboResolutions;){const e=t.Qa.values().next().value;t.Qa.delete(e);const r=new rt(nr.fromString(e)),n=t.za.next();t.Ua.set(n,new TO(r)),t.$a=t.$a.insert(r,n),_b(t.remoteStore,new Zi(Rs(um(r.path)),n,"TargetPurposeLimboResolution",lm.ae))}}async function ah(t,e,r){const n=dt(t),a=[],o=[],l=[];n.ka.isEmpty()||(n.ka.forEach((u,d)=>{l.push(n.Ha(d,e,r).then(m=>{var g;if((m||r)&&n.isPrimaryClient){const y=m?!m.fromCache:(g=r==null?void 0:r.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(m){a.push(m);const y=jv.Yi(d.targetId,m);o.push(y)}}))}),await Promise.all(l),n.La.p_(a),await async function(d,m){const g=dt(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>De.forEach(m,_=>De.forEach(_.Hi,T=>g.persistence.referenceDelegate.addReference(y,_.targetId,T)).next(()=>De.forEach(_.Ji,T=>g.persistence.referenceDelegate.removeReference(y,_.targetId,T)))))}catch(y){if(!Bc(y))throw y;Ye(Pv,"Failed to update sequence numbers: "+y)}for(const y of m){const _=y.targetId;if(!y.fromCache){const T=g.Ts.get(_),E=T.snapshotVersion,S=T.withLastLimboFreeSnapshotVersion(E);g.Ts=g.Ts.insert(_,S)}}}(n.localStore,o))}async function jO(t,e){const r=dt(t);if(!r.currentUser.isEqual(e)){Ye(Yv,"User change. New user:",e.toKey());const n=await gb(r.localStore,e);r.currentUser=e,function(o,l){o.Ga.forEach(u=>{u.forEach(d=>{d.reject(new qe(Re.CANCELLED,l))})}),o.Ga.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ah(r,n.Rs)}}function PO(t,e){const r=dt(t),n=r.Ua.get(e);if(n&&n.Ba)return Rt().add(n.key);{let a=Rt();const o=r.qa.get(e);if(!o)return a;for(const l of o){const u=r.ka.get(l);a=a.unionWith(u.view.Sa)}return a}}function Db(t){const e=dt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kO.bind(null,e),e.La.p_=xO.bind(null,e.eventManager),e.La.Ja=_O.bind(null,e.eventManager),e}function FO(t){const e=dt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DO.bind(null,e),e}class O0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=gm(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,r){return null}nu(e,r){return null}eu(e){return V5(this.persistence,new L5,e.initialUser,this.serializer)}Xa(e){return new pb(Ov.ri,this.serializer)}Za(e){return new Y5}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}O0.provider={build:()=>new O0};class LO extends O0{constructor(e){super(),this.cacheSizeBytes=e}tu(e,r){Vt(this.persistence.referenceDelegate instanceof I0);const n=this.persistence.referenceDelegate.garbageCollector;return new T5(n,e.asyncQueue,r)}Xa(e){const r=this.cacheSizeBytes!==void 0?ta.withCacheSize(this.cacheSizeBytes):ta.DEFAULT;return new pb(n=>I0.ri(n,r),this.serializer)}}class Bg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>IT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=jO.bind(null,this.syncEngine),await pO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vO}()}createDatastore(e){const r=gm(e.databaseInfo.databaseId),n=function(o){return new J5(o)}(e.databaseInfo);return function(o,l,u,d){return new rO(o,l,u,d)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,a,o,l,u){return new aO(n,a,o,l,u)}(this.localStore,this.datastore,e.asyncQueue,r=>IT(this.syncEngine,r,0),function(){return bT.D()?new bT:new W5}())}createSyncEngine(e,r){return function(a,o,l,u,d,m,g){const y=new wO(a,o,l,u,d,m);return g&&(y.ja=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(a){const o=dt(a);Ye(ll,"RemoteStore shutting down."),o.W_.add(5),await nh(o),o.z_.shutdown(),o.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Bg.provider={build:()=>new Bg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):gi("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new qe(Re.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const r=await async function(a,o){const l=dt(a),u={documents:o.map(y=>k0(l.serializer,y))},d=await l.Co("BatchGetDocuments",l.serializer.databaseId,nr.emptyPath(),u,o.length),m=new Map;d.forEach(y=>{const _=s5(l.serializer,y);m.set(_.key.toString(),_)});const g=[];return o.forEach(y=>{const _=m.get(y.toString());Vt(!!_),g.push(_)}),g}(this.datastore,e);return r.forEach(n=>this.recordVersion(n)),r}set(e,r){this.write(r.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,r){try{this.write(r.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new th(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(r=>{e.delete(r.key.toString())}),e.forEach((r,n)=>{const a=rt.fromPath(n);this.mutations.push(new tb(a,this.precondition(a)))}),await async function(n,a){const o=dt(n),l={writes:a.map(u=>ub(o.serializer,u))};await o.So("Commit",o.serializer.databaseId,nr.emptyPath(),l)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let r;if(e.isFoundDocument())r=e.version;else{if(!e.isNoDocument())throw nt();r=it.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!r.isEqual(n))throw new qe(Re.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),r)}precondition(e){const r=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&r?r.isEqual(it.min())?Mr.exists(!1):Mr.updateTime(r):Mr.none()}preconditionForUpdate(e){const r=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&r){if(r.isEqual(it.min()))throw new qe(Re.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mr.updateTime(r)}return Mr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e,r,n,a,o){this.asyncQueue=e,this.datastore=r,this.options=n,this.updateFunction=a,this.deferred=o,this.Tu=n.maxAttempts,this.a_=new Fv(this.asyncQueue,"transaction_retry")}Iu(){this.Tu-=1,this.Eu()}Eu(){this.a_.Xo(async()=>{const e=new MO(this.datastore),r=this.du(e);r&&r.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(a=>{this.Au(a)}))}).catch(n=>{this.Au(n)})})}du(e){try{const r=this.updateFunction(e);return!Zf(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}Au(e){this.Tu>0&&this.Ru(e)?(this.Tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Eu(),Promise.resolve()))):this.deferred.reject(e)}Ru(e){if(e.name==="FirebaseError"){const r=e.code;return r==="aborted"||r==="failed-precondition"||r==="already-exists"||!rb(r)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po="FirestoreClient";class VO{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=wn.UNAUTHENTICATED,this.clientId=bS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async l=>{Ye(po,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(n,l=>(Ye(po,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ns;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=zv(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Q1(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(po,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async a=>{n.isEqual(a)||(await gb(e.localStore,a),n=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function OT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await UO(t);Ye(po,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>CT(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,a)=>CT(e.remoteStore,a)),t._onlineComponents=e}async function UO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(po,"Using user provided OfflineComponentProvider");try{await Q1(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(a){return a.name==="FirebaseError"?a.code===Re.FAILED_PRECONDITION||a.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(r))throw r;bc("Error using user provided cache. Falling back to memory cache: "+r),await Q1(t,new O0)}}else Ye(po,"Using default OfflineComponentProvider"),await Q1(t,new LO(void 0));return t._offlineComponents}async function Xv(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(po,"Using user provided OnlineComponentProvider"),await OT(t,t._uninitializedComponentsProvider._online)):(Ye(po,"Using default OnlineComponentProvider"),await OT(t,new Bg))),t._onlineComponents}function zO(t){return Xv(t).then(e=>e.syncEngine)}function HO(t){return Xv(t).then(e=>e.datastore)}async function j0(t){const e=await Xv(t),r=e.eventManager;return r.onListen=SO.bind(null,e.syncEngine),r.onUnlisten=CO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=bO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=NO.bind(null,e.syncEngine),r}function GO(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,u,d,m){const g=new Kv({next:_=>{g.su(),l.enqueueAndForget(()=>Gv(o,y));const T=_.docs.has(u);!T&&_.fromCache?m.reject(new qe(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&_.fromCache&&d&&d.source==="server"?m.reject(new qe(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(_)},error:_=>m.reject(_)}),y=new $v(um(u.path),g,{includeMetadataChanges:!0,Ta:!0});return Hv(o,y)}(await j0(t),t.asyncQueue,e,r,n)),n.promise}function qO(t,e,r={}){const n=new Ns;return t.asyncQueue.enqueueAndForget(async()=>function(o,l,u,d,m){const g=new Kv({next:_=>{g.su(),l.enqueueAndForget(()=>Gv(o,y)),_.fromCache&&d.source==="server"?m.reject(new qe(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(_)},error:_=>m.reject(_)}),y=new $v(u,g,{includeMetadataChanges:!0,Ta:!0});return Hv(o,y)}(await j0(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(t,e,r){if(!r)throw new qe(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $O(t,e,r,n){if(e===!0&&n===!0)throw new qe(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function PT(t){if(!rt.isDocumentKey(t))throw new qe(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function FT(t){if(rt.isDocumentKey(t))throw new qe(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function _m(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":nt()}function Cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qe(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=_m(t);throw new qe(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb="firestore.googleapis.com",LT=!0;class MT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Pb,this.ssl=LT}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:LT;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<y5)throw new qe(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$O("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ob((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,a){return n.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ym{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new MT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new qe(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new qe(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new MT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new J8;switch(n.type){case"firstParty":return new rD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new qe(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=jT.get(r);n&&(Ye("ComponentProvider","Removing Datastore"),jT.delete(r),n.terminate())}(this),Promise.resolve()}}function YO(t,e,r,n={}){var a;const o=(t=Cn(t,ym))._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${r}`;o.host!==Pb&&o.host!==u&&bc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},o),{host:u,ssl:!1,emulatorOptions:n});if(!nl(d,l)&&(t._setSettings(d),n.mockUserToken)){let m,g;if(typeof n.mockUserToken=="string")m=n.mockUserToken,g=wn.MOCK_USER;else{m=kw(n.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const y=n.mockUserToken.sub||n.mockUserToken.user_id;if(!y)throw new qe(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new wn(y)}t._authCredentials=new Z8(new wS(m,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Eo(this.firestore,e,this._query)}}class dn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new io(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dn(this.firestore,e,this._key)}}class io extends Eo{constructor(e,r,n){super(e,r,um(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dn(this.firestore,null,new rt(e))}withConverter(e){return new io(this.firestore,e,this._path)}}function mn(t,e,...r){if(t=gr(t),jb("collection","path",e),t instanceof ym){const n=nr.fromString(e,...r);return FT(n),new io(t,null,n)}{if(!(t instanceof dn||t instanceof io))throw new qe(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(nr.fromString(e,...r));return FT(n),new io(t.firestore,null,n)}}function kn(t,e,...r){if(t=gr(t),arguments.length===1&&(e=bS.newId()),jb("doc","path",e),t instanceof ym){const n=nr.fromString(e,...r);return PT(n),new dn(t,null,new rt(n))}{if(!(t instanceof dn||t instanceof io))throw new qe(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(nr.fromString(e,...r));return PT(n),new dn(t.firestore,t instanceof io?t.converter:null,new rt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="AsyncQueue";class VT{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new Fv(this,"async_queue_retry"),this.Su=()=>{const n=X1();n&&Ye(BT,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.bu=e;const r=X1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const r=X1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const r=new Ns;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Bc(e))throw e;Ye(BT,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const r=this.bu.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const a=function(l){let u=l.message||"";return l.stack&&(u=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),u}(n);throw gi("INTERNAL UNHANDLED ERROR: ",a),n}).then(n=>(this.pu=!1,n))));return this.bu=r,r}enqueueAfterDelay(e,r,n){this.Du(),this.wu.indexOf(e)>-1&&(r=0);const a=Uv.createAndSchedule(this,e,r,n,o=>this.Fu(o));return this.fu.push(a),a}Du(){this.gu&&nt()}verifyOperationInProgress(){}async Mu(){let e;do e=this.bu,await e;while(e!==this.bu)}xu(e){for(const r of this.fu)if(r.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.fu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const r=this.fu.indexOf(e);this.fu.splice(r,1)}}function UT(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const o of n)if(o in a&&typeof a[o]=="function")return!0;return!1}(t,["next","error","complete"])}class rs extends ym{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new VT,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new VT(e),this._firestoreClient=void 0,await e}}}function WO(t,e){const r=typeof t=="object"?t:hv(),n=typeof t=="string"?t:b0,a=am(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=Cw("firestore");o&&YO(a,...o)}return a}function zc(t){if(t._terminated)throw new qe(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||KO(t),t._firestoreClient}function KO(t){var e,r,n;const a=t._freezeSettings(),o=function(u,d,m,g){return new vD(u,d,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Ob(g.experimentalLongPollingOptions),g.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((r=a.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=a.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new VO(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const d=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cl(vn.fromBase64String(e))}catch(r){throw new qe(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new cl(vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new qe(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new qe(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new qe(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Et(this._lat,e._lat)||Et(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=/^__.*__$/;class QO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,r,this.fieldTransforms):new eh(e,this.data,r,this.fieldTransforms)}}class Fb{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new yo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Lb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw nt()}}class Zv{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Bu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Zv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.ku({path:n,Qu:!1});return a.$u(e),a}Uu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),a=this.ku({path:n,Qu:!1});return a.Bu(),a}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return P0(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(Lb(this.Lu)&&XO.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class JO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||gm(e)}ju(e,r,n,a=!1){return new Zv({Lu:e,methodName:r,zu:n,path:hn.emptyPath(),Qu:!1,Gu:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gc(t){const e=t._freezeSettings(),r=gm(t._databaseId);return new JO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Tm(t,e,r,n,a,o={}){const l=t.ju(o.merge||o.mergeFields?2:0,e,r,a);nx("Data must be an object, but it was:",l,n);const u=Mb(n,l);let d,m;if(o.merge)d=new pa(l.fieldMask),m=l.fieldTransforms;else if(o.mergeFields){const g=[];for(const y of o.mergeFields){const _=Vg(e,y,r);if(!l.contains(_))throw new qe(Re.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Vb(g,_)||g.push(_)}d=new pa(g),m=l.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,m=l.fieldTransforms;return new QO(new Hn(u),d,m)}class wm extends Em{_toFieldTransform(e){if(e.Lu!==2)throw e.Lu===1?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wm}}class ex extends Em{_toFieldTransform(e){return new HD(e.path,new Of)}isEqual(e){return e instanceof ex}}function tx(t,e,r,n){const a=t.ju(1,e,r);nx("Data must be an object, but it was:",a,n);const o=[],l=Hn.empty();_o(n,(d,m)=>{const g=ax(e,d,r);m=gr(m);const y=a.Uu(g);if(m instanceof wm)o.push(g);else{const _=sh(m,y);_!=null&&(o.push(g),l.set(g,_))}});const u=new pa(o);return new Fb(l,u,a.fieldTransforms)}function rx(t,e,r,n,a,o){const l=t.ju(1,e,r),u=[Vg(e,n,r)],d=[a];if(o.length%2!=0)throw new qe(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<o.length;_+=2)u.push(Vg(e,o[_])),d.push(o[_+1]);const m=[],g=Hn.empty();for(let _=u.length-1;_>=0;--_)if(!Vb(m,u[_])){const T=u[_];let E=d[_];E=gr(E);const S=l.Uu(T);if(E instanceof wm)m.push(T);else{const b=sh(E,S);b!=null&&(m.push(T),g.set(T,b))}}const y=new pa(m);return new Fb(g,y,l.fieldTransforms)}function ZO(t,e,r,n=!1){return sh(r,t.ju(n?4:3,e))}function sh(t,e){if(Bb(t=gr(t)))return nx("Unsupported field value:",e,t),Mb(t,e);if(t instanceof Em)return function(n,a){if(!Lb(a.Lu))throw a.Wu(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Wu(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(n,a){const o=[];let l=0;for(const u of n){let d=sh(u,a.Ku(l));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),l++}return{arrayValue:{values:o}}}(t,e)}return function(n,a){if((n=gr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return VD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=qr.fromDate(n);return{timestampValue:R0(a.serializer,o)}}if(n instanceof qr){const o=new qr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:R0(a.serializer,o)}}if(n instanceof Qv)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof cl)return{bytesValue:ib(a.serializer,n._byteString)};if(n instanceof dn){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.Wu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Iv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Jv)return function(l,u){return{mapValue:{fields:{[OS]:{stringValue:jS},[A0]:{arrayValue:{values:l.toArray().map(m=>{if(typeof m!="number")throw u.Wu("VectorValues must only contain numeric values.");return Nv(u.serializer,m)})}}}}}}(n,a);throw a.Wu(`Unsupported field value: ${_m(n)}`)}(t,e)}function Mb(t,e){const r={};return CS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_o(t,(n,a)=>{const o=sh(a,e.qu(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function Bb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qr||t instanceof Qv||t instanceof cl||t instanceof dn||t instanceof Em||t instanceof Jv)}function nx(t,e,r){if(!Bb(r)||!function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)}(r)){const n=_m(r);throw n==="an object"?e.Wu(t+" a custom object"):e.Wu(t+" "+n)}}function Vg(t,e,r){if((e=gr(e))instanceof Hc)return e._internalPath;if(typeof e=="string")return ax(t,e);throw P0("Field path arguments must be of type string or ",t,!1,void 0,r)}const e9=new RegExp("[~\\*/\\[\\]]");function ax(t,e,r){if(e.search(e9)>=0)throw P0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Hc(...e.split("."))._internalPath}catch{throw P0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function P0(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let d="";return(o||l)&&(d+=" (found",o&&(d+=` in field ${n}`),l&&(d+=` in document ${a}`),d+=")"),new qe(Re.INVALID_ARGUMENT,u+t+d)}function Vb(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new t9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Sm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class t9 extends F0{data(){return super.data()}}function Sm(t,e){return typeof e=="string"?ax(t,e):e instanceof Hc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ub(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new qe(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sx{}class zb extends sx{}function Ya(t,e,...r){let n=[];e instanceof sx&&n.push(e),n=n.concat(r),function(o){const l=o.filter(d=>d instanceof ix).length,u=o.filter(d=>d instanceof bm).length;if(l>1||l>0&&u>0)throw new qe(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)t=a._apply(t);return t}class bm extends zb{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new bm(e,r,n)}_apply(e){const r=this._parse(e);return Hb(e._query,r),new Eo(e.firestore,e.converter,kg(e._query,r))}_parse(e){const r=Gc(e.firestore);return function(o,l,u,d,m,g,y){let _;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new qe(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){HT(y,g);const E=[];for(const S of y)E.push(zT(d,o,S));_={arrayValue:{values:E}}}else _=zT(d,o,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||HT(y,g),_=ZO(u,l,y,g==="in"||g==="not-in");return Lr.create(m,g,_)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Un(t,e,r){const n=e,a=Sm("where",t);return bm._create(a,n,r)}class ix extends sx{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new ix(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ts.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(a,o){let l=a;const u=o.getFlattenedFilters();for(const d of u)Hb(l,d),l=kg(l,d)}(e._query,r),new Eo(e.firestore,e.converter,kg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ox extends zb{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new ox(e,r)}_apply(e){const r=function(a,o,l){if(a.startAt!==null)throw new qe(Re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new qe(Re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Df(o,l)}(e._query,this._field,this._direction);return new Eo(e.firestore,e.converter,function(a,o){const l=a.explicitOrderBy.concat([o]);return new Vc(a.path,a.collectionGroup,l,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,r))}}function Ug(t,e="asc"){const r=e,n=Sm("orderBy",t);return ox._create(n,r)}function zT(t,e,r){if(typeof(r=gr(r))=="string"){if(r==="")throw new qe(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!zS(e)&&r.indexOf("/")!==-1)throw new qe(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(nr.fromString(r));if(!rt.isDocumentKey(n))throw new qe(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return nT(t,new rt(n))}if(r instanceof dn)return nT(t,r._key);throw new qe(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_m(r)}.`)}function HT(t,e){if(!Array.isArray(t)||t.length===0)throw new qe(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Hb(t,e){const r=function(a,o){for(const l of a)for(const u of l.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new qe(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class Gb{convertValue(e,r="none"){switch(ho(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(fo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw nt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return _o(e,(a,o)=>{n[a]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,a;const o=(a=(n=(r=e.fields)===null||r===void 0?void 0:r[A0].arrayValue)===null||n===void 0?void 0:n.values)===null||a===void 0?void 0:a.map(l=>Nr(l.doubleValue));return new Jv(o)}convertGeoPoint(e){return new Qv(Nr(e.latitude),Nr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=cm(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Rf(e));default:return null}}convertTimestamp(e){const r=uo(e);return new qr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=nr.fromString(e);Vt(db(n));const a=new kf(n.get(1),n.get(3)),o=new rt(n.popFirst(5));return a.isEqual(r)||gi(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class r9 extends Gb{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,r)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class lx extends F0{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new d0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Sm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class d0 extends lx{data(e={}){return super.data(e)}}class qb{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new gc(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new d0(this._firestore,this._userDataWriter,n.key,n,new gc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new qe(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map(u=>{const d=new d0(a._firestore,a._userDataWriter,u.doc.key,u.doc,new gc(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:d,oldIndex:-1,newIndex:l++}})}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const d=new d0(a._firestore,a._userDataWriter,u.doc.key,u.doc,new gc(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,g=-1;return u.type!==0&&(m=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),g=l.indexOf(u.doc.key)),{type:n9(u.type),doc:d,oldIndex:m,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function n9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return nt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(t){t=Cn(t,dn);const e=Cn(t.firestore,rs);return GO(zc(e),t._key).then(r=>Yb(e,t,r))}class Cm extends Gb{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,r)}}function Qa(t){t=Cn(t,Eo);const e=Cn(t.firestore,rs),r=zc(e),n=new Cm(e);return Ub(t._query),qO(r,t._query).then(a=>new qb(e,n,t,a))}function a9(t,e,r){t=Cn(t,dn);const n=Cn(t.firestore,rs),a=Am(t.converter,e,r);return ih(n,[Tm(Gc(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Mr.none())])}function ul(t,e,r,...n){t=Cn(t,dn);const a=Cn(t.firestore,rs),o=Gc(a);let l;return l=typeof(e=gr(e))=="string"||e instanceof Hc?rx(o,"updateDoc",t._key,e,r,n):tx(o,"updateDoc",t._key,e),ih(a,[l.toMutation(t._key,Mr.exists(!0))])}function $b(t){return ih(Cn(t.firestore,rs),[new th(t._key,Mr.none())])}function Nm(t,e){const r=Cn(t.firestore,rs),n=kn(t),a=Am(t.converter,e);return ih(r,[Tm(Gc(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Mr.exists(!1))]).then(()=>n)}function s9(t,...e){var r,n,a;t=gr(t);let o={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||UT(e[l])||(o=e[l],l++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(UT(e[l])){const y=e[l];e[l]=(r=y.next)===null||r===void 0?void 0:r.bind(y),e[l+1]=(n=y.error)===null||n===void 0?void 0:n.bind(y),e[l+2]=(a=y.complete)===null||a===void 0?void 0:a.bind(y)}let d,m,g;if(t instanceof dn)m=Cn(t.firestore,rs),g=um(t._key.path),d={next:y=>{e[l]&&e[l](Yb(m,t,y))},error:e[l+1],complete:e[l+2]};else{const y=Cn(t,Eo);m=Cn(y.firestore,rs),g=y._query;const _=new Cm(m);d={next:T=>{e[l]&&e[l](new qb(m,_,y,T))},error:e[l+1],complete:e[l+2]},Ub(t._query)}return function(_,T,E,S){const b=new Kv(S),O=new $v(T,b,E);return _.asyncQueue.enqueueAndForget(async()=>Hv(await j0(_),O)),()=>{b.su(),_.asyncQueue.enqueueAndForget(async()=>Gv(await j0(_),O))}}(zc(m),g,u,d)}function ih(t,e){return function(n,a){const o=new Ns;return n.asyncQueue.enqueueAndForget(async()=>RO(await zO(n),a,o)),o.promise}(zc(t),e)}function Yb(t,e,r){const n=r.docs.get(e._key),a=new Cm(t);return new lx(t,a,e._key,n,new gc(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o9{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Gc(e)}set(e,r,n){this._verifyNotCommitted();const a=eo(e,this._firestore),o=Am(a.converter,r,n),l=Tm(this._dataReader,"WriteBatch.set",a._key,o,a.converter!==null,n);return this._mutations.push(l.toMutation(a._key,Mr.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const o=eo(e,this._firestore);let l;return l=typeof(r=gr(r))=="string"||r instanceof Hc?rx(this._dataReader,"WriteBatch.update",o._key,r,n,a):tx(this._dataReader,"WriteBatch.update",o._key,r),this._mutations.push(l.toMutation(o._key,Mr.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=eo(e,this._firestore);return this._mutations=this._mutations.concat(new th(r._key,Mr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new qe(Re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function eo(t,e){if((t=gr(t)).firestore!==e)throw new qe(Re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,r){this._firestore=e,this._transaction=r,this._dataReader=Gc(e)}get(e){const r=eo(e,this._firestore),n=new r9(this._firestore);return this._transaction.lookup([r._key]).then(a=>{if(!a||a.length!==1)return nt();const o=a[0];if(o.isFoundDocument())return new F0(this._firestore,n,o.key,o,r.converter);if(o.isNoDocument())return new F0(this._firestore,n,r._key,null,r.converter);throw nt()})}set(e,r,n){const a=eo(e,this._firestore),o=Am(a.converter,r,n),l=Tm(this._dataReader,"Transaction.set",a._key,o,a.converter!==null,n);return this._transaction.set(a._key,l),this}update(e,r,n,...a){const o=eo(e,this._firestore);let l;return l=typeof(r=gr(r))=="string"||r instanceof Hc?rx(this._dataReader,"Transaction.update",o._key,r,n,a):tx(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(e){const r=eo(e,this._firestore);return this._transaction.delete(r._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c9 extends l9{constructor(e,r){super(e,r),this._firestore=e}get(e){const r=eo(e,this._firestore),n=new Cm(this._firestore);return super.get(e).then(a=>new lx(this._firestore,n,r._key,a._document,new gc(!1,!1),r.converter))}}function u9(t,e,r){t=Cn(t,rs);const n=Object.assign(Object.assign({},i9),r);return function(o){if(o.maxAttempts<1)throw new qe(Re.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(o,l,u){const d=new Ns;return o.asyncQueue.enqueueAndForget(async()=>{const m=await HO(o);new BO(o.asyncQueue,m,u,l,d).Iu()}),d.promise}(zc(t),a=>e(new c9(t,a)),n)}function M0(){return new ex("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f9(t){return zc(t=Cn(t,rs)),new o9(t,e=>ih(t,e))}(function(e,r=!0){(function(a){Lc=a})(ml),al(new lo("firestore",(n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new rs(new eD(n.getProvider("auth-internal")),new nD(l,n.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new qe(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kf(m.options.projectId,g)}(l,a),l);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),bs(qE,$E,e),bs(qE,$E,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="firebasestorage.googleapis.com",h9="storageBucket",d9=2*60*1e3,m9=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps extends js{constructor(e,r,n=0){super(J1(e),`Firebase Storage: ${r} (${J1(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ps.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return J1(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Is;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Is||(Is={}));function J1(t){return"storage/"+t}function p9(){const t="An unknown error occurred, please check the error payload for server response.";return new Ps(Is.UNKNOWN,t)}function g9(){return new Ps(Is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function v9(){return new Ps(Is.CANCELED,"User canceled the upload/download.")}function x9(t){return new Ps(Is.INVALID_URL,"Invalid URL '"+t+"'.")}function _9(t){return new Ps(Is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function GT(t){return new Ps(Is.INVALID_ARGUMENT,t)}function Kb(){return new Ps(Is.APP_DELETED,"The Firebase app was deleted.")}function y9(t){return new Ps(Is.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Wa.makeFromUrl(e,r)}catch{return new Wa(e,"")}if(n.path==="")return n;throw _9(e)}static makeFromUrl(e,r){let n=null;const a="([A-Za-z0-9.\\-_]+)";function o(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const l="(/(.*))?$",u=new RegExp("^gs://"+a+l,"i"),d={bucket:1,path:3};function m(D){D.path_=decodeURIComponent(D.path)}const g="v[A-Za-z0-9_]+",y=r.replace(/[.]/g,"\\."),_="(/([^?#]*).*)?$",T=new RegExp(`^https?://${y}/${g}/b/${a}/o${_}`,"i"),E={bucket:1,path:3},S=r===Wb?"(?:storage.googleapis.com|storage.cloud.google.com)":r,b="([^?#]*)",O=new RegExp(`^https?://${S}/${a}/${b}`,"i"),A=[{regex:u,indices:d,postModify:o},{regex:T,indices:E,postModify:m},{regex:O,indices:{bucket:1,path:2},postModify:m}];for(let D=0;D<A.length;D++){const V=A[D],H=V.regex.exec(e);if(H){const C=H[V.indices.bucket];let N=H[V.indices.path];N||(N=""),n=new Wa(C,N),V.postModify(n);break}}if(n==null)throw x9(e);return n}}class E9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T9(t,e,r){let n=1,a=null,o=null,l=!1,u=0;function d(){return u===2}let m=!1;function g(...b){m||(m=!0,e.apply(null,b))}function y(b){a=setTimeout(()=>{a=null,t(T,d())},b)}function _(){o&&clearTimeout(o)}function T(b,...O){if(m){_();return}if(b){_(),g.call(null,b,...O);return}if(d()||l){_(),g.call(null,b,...O);return}n<64&&(n*=2);let A;u===1?(u=2,A=0):A=(n+Math.random())*1e3,y(A)}let E=!1;function S(b){E||(E=!0,_(),!m&&(a!==null?(b||(u=2),clearTimeout(a),y(0)):b||(u=1)))}return y(0),o=setTimeout(()=>{l=!0,S(!0)},r),S}function w9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S9(t){return t!==void 0}function qT(t,e,r,n){if(n<e)throw GT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw GT(`Invalid value for '${t}'. Expected ${r} or less.`)}function b9(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const a=e(n)+"="+e(t[n]);r=r+a+"&"}return r=r.slice(0,-1),r}var B0;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(B0||(B0={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A9(t,e){const r=t>=500&&t<600,a=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return r||a||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C9{constructor(e,r,n,a,o,l,u,d,m,g,y,_=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=a,this.successCodes_=o,this.additionalRetryCodes_=l,this.callback_=u,this.errorCallback_=d,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=y,this.retry=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,E)=>{this.resolve_=T,this.reject_=E,this.start_()})}start_(){const e=(n,a)=>{if(a){n(!1,new qd(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const l=u=>{const d=u.loaded,m=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,m)};this.progressCallback_!==null&&o.addUploadProgressListener(l),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(l),this.pendingConnection_=null;const u=o.getErrorCode()===B0.NO_ERROR,d=o.getStatus();if(!u||A9(d,this.additionalRetryCodes_)&&this.retry){const g=o.getErrorCode()===B0.ABORT;n(!1,new qd(!1,null,g));return}const m=this.successCodes_.indexOf(d)!==-1;n(!0,new qd(m,o))})},r=(n,a)=>{const o=this.resolve_,l=this.reject_,u=a.connection;if(a.wasSuccessCode)try{const d=this.callback_(u,u.getResponse());S9(d)?o(d):o()}catch(d){l(d)}else if(u!==null){const d=p9();d.serverResponse=u.getErrorText(),this.errorCallback_?l(this.errorCallback_(u,d)):l(d)}else if(a.canceled){const d=this.appDelete_?Kb():v9();l(d)}else{const d=g9();l(d)}};this.canceled_?r(!1,new qd(!1,null,!0)):this.backoffId_=T9(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&w9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class qd{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function N9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function R9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function k9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function I9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function D9(t,e,r,n,a,o,l=!0){const u=b9(t.urlParams),d=t.url+u,m=Object.assign({},t.headers);return k9(m,e),N9(m,r),R9(m,o),I9(m,n),new C9(d,t.method,m,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,a,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O9(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function j9(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,r){this._service=e,r instanceof Wa?this._location=r:this._location=Wa.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new V0(e,r)}get root(){const e=new Wa(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return j9(this._location.path)}get storage(){return this._service}get parent(){const e=O9(this._location.path);if(e===null)return null;const r=new Wa(this._location.bucket,e);return new V0(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw y9(e)}}function $T(t,e){const r=e==null?void 0:e[h9];return r==null?null:Wa.makeFromBucketSpec(r,t)}function P9(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:a}=n;a&&(t._overrideAuthToken=typeof a=="string"?a:kw(a,t.app.options.projectId))}class F9{constructor(e,r,n,a,o){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=a,this._firebaseVersion=o,this._bucket=null,this._host=Wb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=d9,this._maxUploadRetryTime=m9,this._requests=new Set,a!=null?this._bucket=Wa.makeFromBucketSpec(a,this._host):this._bucket=$T(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wa.makeFromBucketSpec(this._url,e):this._bucket=$T(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){qT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){qT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(da(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new V0(this,e)}_makeRequest(e,r,n,a,o=!0){if(this._deleted)return new E9(Kb());{const l=D9(e,this._appId,n,a,r,this._firebaseVersion,o);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,r){const[n,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,a).getPromise()}}const YT="@firebase/storage",WT="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb="storage";function L9(t=hv(),e){t=gr(t);const n=am(t,Xb).getImmediate({identifier:e}),a=Cw("storage");return a&&M9(n,...a),n}function M9(t,e,r,n={}){P9(t,e,r,n)}function B9(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new F9(r,n,a,e,ml)}function V9(){al(new lo(Xb,B9,"PUBLIC").setMultipleInstances(!0)),bs(YT,WT,""),bs(YT,WT,"esm2017")}V9();const U9={apiKey:"AIzaSyCJBgFNOHpNfUfQIXuCSgQWRz_VCtJYWfA",authDomain:"school-system-4cf7a.firebaseapp.com",projectId:"school-system-4cf7a",storageBucket:"school-system-4cf7a.appspot.com",messagingSenderId:"859013819023",appId:"1:859013819023:web:850f11f2e26533dc0e9efa",measurementId:"G-5472FCP294"},cx=Ow(U9),ui=X8(cx),Ut=WO(cx);L9(cx);const Qb=ne.createContext(),Jb=({children:t})=>{const[e,r]=ne.useState(null),[n,a]=ne.useState(null),[o,l]=ne.useState(!0);ne.useEffect(()=>iS(ui,async m=>{if(m)try{const g=await L0(kn(Ut,"users",m.uid));g.exists()&&a({...g.data(),id:g.id})}catch(g){console.error("Error fetching user data:",g)}else a(null);r(m),l(!1)}),[]);const u={currentUser:e,userData:n,loading:o,hasPermission:d=>n!=null&&n.permissions?n.permissions.includes(d):!1};return h.jsx(Qb.Provider,{value:u,children:t})},ux=()=>{const t=ne.useContext(Qb);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t};var Zb={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},KT=oi.createContext&&oi.createContext(Zb),z9=["attr","size","title"];function H9(t,e){if(t==null)return{};var r=G9(t,e),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function G9(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function U0(){return U0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},U0.apply(this,arguments)}function XT(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function z0(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?XT(Object(r),!0).forEach(function(n){q9(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):XT(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function q9(t,e,r){return e=$9(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $9(t){var e=Y9(t,"string");return typeof e=="symbol"?e:e+""}function Y9(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eA(t){return t&&t.map((e,r)=>oi.createElement(e.tag,z0({key:r},e.attr),eA(e.child)))}function vt(t){return e=>oi.createElement(W9,U0({attr:z0({},t.attr)},e),eA(t.child))}function W9(t){var e=r=>{var{attr:n,size:a,title:o}=t,l=H9(t,z9),u=a||r.size||"1em",d;return r.className&&(d=r.className),t.className&&(d=(d?d+" ":"")+t.className),oi.createElement("svg",U0({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,l,{className:d,style:z0(z0({color:t.color||r.color},r.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&oi.createElement("title",null,o),t.children)};return KT!==void 0?oi.createElement(KT.Consumer,null,r=>e(r)):e(Zb)}function K9(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"},child:[]}]})(t)}function oh(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(t)}function lh(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"},child:[]}]})(t)}function ch(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 480h-20V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v456H12c-6.627 0-12 5.373-12 12v20h448v-20c0-6.627-5.373-12-12-12zM128 76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76zm0 96c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40zm52 148h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40c0 6.627-5.373 12-12 12zm76 160h-64v-84c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v84zm64-172c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12v-40c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40zm0-96c0 6.627-5.373 12-12 12h-40c-6.627 0-12-5.373-12-12V76c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v40z"},child:[]}]})(t)}function uh(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(t)}function X9(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function fh(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(t)}function Q9(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 480H48c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h352c26.51 0 48 21.49 48 48v352c0 26.51-21.49 48-48 48zm-204.686-98.059l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.248-16.379-6.249-22.628 0L184 302.745l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.25 16.379 6.25 22.628.001z"},child:[]}]})(t)}function J9(t){return vt({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM192 40c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm121.2 231.8l-143 141.8c-4.7 4.7-12.3 4.6-17-.1l-82.6-83.3c-4.7-4.7-4.6-12.3.1-17L99.1 285c4.7-4.7 12.3-4.6 17 .1l46 46.4 106-105.2c4.7-4.7 12.3-4.6 17 .1l28.2 28.4c4.7 4.8 4.6 12.3-.1 17z"},child:[]}]})(t)}function hh(t){return vt({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"},child:[]}]})(t)}function dh(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"},child:[]}]})(t)}function Rm(t){return vt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(t)}function QT(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(t)}function fx(t){return vt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(t)}function H0(t){return vt({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function Z9(t){return vt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 121.9c0-6.3-2.5-12.4-7-16.9L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128zM571 308l-95.7-96.4c-10.1-10.1-27.4-3-27.4 11.3V288h-64v64h64v65.2c0 14.3 17.3 21.4 27.4 11.3L571 332c6.6-6.6 6.6-17.4 0-24zm-379 28v-32c0-8.8 7.2-16 16-16h176V160H248c-13.2 0-24-10.8-24-24V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V352H208c-8.8 0-16-7.2-16-16z"},child:[]}]})(t)}function ej(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M16 288c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h112v-64zm489-183L407.1 7c-4.5-4.5-10.6-7-17-7H384v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H152c-13.3 0-24 10.7-24 24v264h128v-65.2c0-14.3 17.3-21.4 27.4-11.3L379 308c6.6 6.7 6.6 17.4 0 24l-95.7 96.4c-10.1 10.1-27.4 3-27.4-11.3V352H128v136c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H376c-13.2 0-24-10.8-24-24z"},child:[]}]})(t)}function hx(t){return vt({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(t)}function tj(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(t)}function qc(t){return vt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(t)}function mh(t){return vt({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(t)}function rj(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(t)}function $c(t){return vt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M621.16 54.46C582.37 38.19 543.55 32 504.75 32c-123.17-.01-246.33 62.34-369.5 62.34-30.89 0-61.76-3.92-92.65-13.72-3.47-1.1-6.95-1.62-10.35-1.62C15.04 79 0 92.32 0 110.81v317.26c0 12.63 7.23 24.6 18.84 29.46C57.63 473.81 96.45 480 135.25 480c123.17 0 246.34-62.35 369.51-62.35 30.89 0 61.76 3.92 92.65 13.72 3.47 1.1 6.95 1.62 10.35 1.62 17.21 0 32.25-13.32 32.25-31.81V83.93c-.01-12.64-7.24-24.6-18.85-29.47zM48 132.22c20.12 5.04 41.12 7.57 62.72 8.93C104.84 170.54 79 192.69 48 192.69v-60.47zm0 285v-47.78c34.37 0 62.18 27.27 63.71 61.4-22.53-1.81-43.59-6.31-63.71-13.62zM320 352c-44.19 0-80-42.99-80-96 0-53.02 35.82-96 80-96s80 42.98 80 96c0 53.03-35.83 96-80 96zm272 27.78c-17.52-4.39-35.71-6.85-54.32-8.44 5.87-26.08 27.5-45.88 54.32-49.28v57.72zm0-236.11c-30.89-3.91-54.86-29.7-55.81-61.55 19.54 2.17 38.09 6.23 55.81 12.66v48.89z"},child:[]}]})(t)}function dx(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(t)}function km(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 192V77.25c0-8.49-3.37-16.62-9.37-22.63L393.37 9.37c-6-6-14.14-9.37-22.63-9.37H96C78.33 0 64 14.33 64 32v160c-35.35 0-64 28.65-64 64v112c0 8.84 7.16 16 16 16h48v96c0 17.67 14.33 32 32 32h320c17.67 0 32-14.33 32-32v-96h48c8.84 0 16-7.16 16-16V256c0-35.35-28.65-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.84 7.16 16 16 16h48v96zm48 72c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"},child:[]}]})(t)}function nj(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"},child:[]}]})(t)}function aj(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"},child:[]}]})(t)}function Im(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}function ph(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(t)}function sj(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(t)}function tA(t){return vt({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z"},child:[]}]})(t)}function rA(t){return vt({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279 224H41c-21.4 0-32.1-25.9-17-41L143 64c9.4-9.4 24.6-9.4 33.9 0l119 119c15.2 15.1 4.5 41-16.9 41z"},child:[]}]})(t)}function nA(t){return vt({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.9 17-41z"},child:[]}]})(t)}function JT(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(t)}function gh(t){return vt({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(t)}function Dm(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(t)}function aA(t){return vt({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(t)}function mx(t){return vt({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(t)}function ZT(t){return vt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h274.9c-2.4-6.8-3.4-14-2.6-21.3l6.8-60.9 1.2-11.1 7.9-7.9 77.3-77.3c-24.5-27.7-60-45.5-99.9-45.5zm45.3 145.3l-6.8 61c-1.1 10.2 7.5 18.8 17.6 17.6l60.9-6.8 137.9-137.9-71.7-71.7-137.9 137.8zM633 268.9L595.1 231c-9.3-9.3-24.5-9.3-33.8 0l-37.8 37.8-4.1 4.1 71.8 71.7 41.8-41.8c9.3-9.4 9.3-24.5 0-33.9z"},child:[]}]})(t)}function ij(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M319.4 320.6L224 416l-95.4-95.4C57.1 323.7 0 382.2 0 454.4v9.6c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-9.6c0-72.2-57.1-130.7-128.6-133.8zM13.6 79.8l6.4 1.5v58.4c-7 4.2-12 11.5-12 20.3 0 8.4 4.6 15.4 11.1 19.7L3.5 242c-1.7 6.9 2.1 14 7.6 14h41.8c5.5 0 9.3-7.1 7.6-14l-15.6-62.3C51.4 175.4 56 168.4 56 160c0-8.8-5-16.1-12-20.3V87.1l66 15.9c-8.6 17.2-14 36.4-14 57 0 70.7 57.3 128 128 128s128-57.3 128-128c0-20.6-5.3-39.8-14-57l96.3-23.2c18.2-4.4 18.2-27.1 0-31.5l-190.4-46c-13-3.1-26.7-3.1-39.7 0L13.6 48.2c-18.1 4.4-18.1 27.2 0 31.6z"},child:[]}]})(t)}function zg(t){return vt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(t)}function oj(t){return vt({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.3 271.1l-115.2-45c-4.1-1.6-12.6-3.7-22.2 0l-115.2 45c-10.7 4.2-17.7 14-17.7 24.9 0 111.6 68.7 188.8 132.9 213.9 9.6 3.7 18 1.6 22.2 0C558.4 489.9 640 420.5 640 296c0-10.9-7-20.7-17.7-24.9zM496 462.4V273.3l95.5 37.3c-5.6 87.1-60.9 135.4-95.5 151.8zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm96 40c0-2.5.8-4.8 1.1-7.2-2.5-.1-4.9-.8-7.5-.8h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c6.8 0 13.3-1.5 19.2-4-54-42.9-99.2-116.7-99.2-212z"},child:[]}]})(t)}function e4(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(t)}const lj=()=>{const[t,e]=ne.useState(!1),[r,n]=ne.useState({email:"",password:"",rememberMe:!1}),[a,o]=ne.useState(!1),[l,u]=ne.useState(""),[d,m]=ne.useState("");qf(),ne.useEffect(()=>{const S=localStorage.getItem("rememberedEmail");S&&n(b=>({...b,email:S,rememberMe:!0}))},[]);const g=S=>{const{name:b,value:O,type:L,checked:A}=S.target;n(D=>({...D,[b]:L==="checkbox"?A:O}))},y=async S=>{S.preventDefault(),u(""),o(!0);const{email:b,password:O,rememberMe:L}=r;if(!b||!O){u("Please enter both email and password"),o(!1);return}try{await ui.signOut();const D=(await FI(ui,b,O)).user;L?localStorage.setItem("rememberedEmail",b):localStorage.removeItem("rememberedEmail"),window.location.href="/dashboard"}catch(A){console.error("Login error:",A);let D="Login failed. Please try again.";switch(A.code){case"auth/invalid-email":D="Invalid email address";break;case"auth/user-disabled":D="Account disabled";break;case"auth/user-not-found":D="No account found";break;case"auth/wrong-password":D="Incorrect password";break;case"auth/too-many-requests":D="Account temporarily locked due to too many attempts";break;default:D="Login failed. Please try again."}u(D),o(!1)}},_=async S=>{S.preventDefault(),u(""),o(!0);try{await jI(ui,r.email),m(`Password reset sent to ${r.email}`),u("")}catch(b){console.error("Recovery error:",b),u(b.message||"Failed to send reset email"),m("")}finally{o(!1)}},T=()=>{e(!0),u(""),m("")},E=()=>{e(!1),u(""),m("")};return h.jsxs("div",{className:"spcd-login-container",children:[h.jsxs("div",{className:"login-page-header",children:[h.jsx("img",{src:"school-logo.png",alt:"School Logo",className:"spcd-school-logo"}),h.jsx("h1",{children:"Samson Polytechnic College of Davao - Admin Login"})]}),h.jsxs("div",{className:"spcd-login-card",children:[t?h.jsx("div",{className:"spcd-login-form-section",children:h.jsxs("form",{className:"spcd-recovery-form",onSubmit:_,children:[h.jsx("h2",{children:"Account Recovery"}),h.jsx("p",{children:"Enter your email address to recover your account."}),l&&h.jsxs("div",{className:"spcd-error-message",children:[h.jsx(QT,{})," ",l]}),d&&h.jsx("div",{className:"spcd-success-message",children:d}),h.jsx("div",{className:"spcd-form-group",children:h.jsxs("div",{className:"spcd-input-with-icon",children:[h.jsx(e4,{className:"input-icon"}),h.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:r.email,onChange:g,required:!0})]})}),h.jsx("button",{type:"submit",className:"spcd-login-button",disabled:a,children:a?h.jsxs(h.Fragment,{children:[h.jsx(JT,{className:"spinner"})," Sending..."]}):"Submit"}),h.jsx("p",{className:"spcd-back-to-login",onClick:E,children:"Back to Login"})]})}):h.jsx("div",{className:"spcd-login-form-section",children:h.jsxs("form",{className:"spcd-login-form",onSubmit:y,children:[l&&h.jsxs("div",{className:"spcd-error-message",children:[h.jsx(QT,{})," ",l]}),h.jsx("div",{className:"spcd-form-group",children:h.jsxs("div",{className:"spcd-input-with-icon",children:[h.jsx(e4,{className:"input-icon"}),h.jsx("input",{type:"email",name:"email",placeholder:"Email Address",value:r.email,onChange:g,autoComplete:"username",required:!0})]})}),h.jsx("div",{className:"spcd-form-group",children:h.jsxs("div",{className:"spcd-input-with-icon",children:[h.jsx(rj,{className:"input-icon"}),h.jsx("input",{type:"password",name:"password",placeholder:"Password",value:r.password,onChange:g,autoComplete:r.rememberMe?"current-password":"off",required:!0})]})}),h.jsx("div",{className:"spcd-remember-me",children:h.jsxs("label",{children:[h.jsx("input",{type:"checkbox",name:"rememberMe",checked:r.rememberMe,onChange:g}),h.jsx("span",{className:"checkmark",children:h.jsx(Q9,{})}),"Remember me"]})}),h.jsx("button",{type:"submit",className:"spcd-login-button",disabled:a,children:a?h.jsxs(h.Fragment,{children:[h.jsx(JT,{className:"spinner"})," Logging in..."]}):"Log in"}),h.jsx("p",{className:"spcd-forgot-password",onClick:T,children:"Forgot Password?"})]})}),!t&&h.jsxs("div",{className:"spcd-features-section",children:[h.jsx("div",{className:"spcd-features-header",children:h.jsx("h2",{children:"School Management System"})}),h.jsxs("ul",{className:"spcd-features-list",children:[h.jsxs("li",{children:[h.jsx(ij,{className:"feature-icon"}),h.jsx("div",{children:h.jsx("strong",{children:"Student Enrollment"})})]}),h.jsxs("li",{children:[h.jsx(J9,{className:"feature-icon"}),h.jsx("div",{children:h.jsx("strong",{children:"Attendance Management"})})]}),h.jsxs("li",{children:[h.jsx(X9,{className:"feature-icon"}),h.jsx("div",{children:h.jsx("strong",{children:"Grading System"})})]}),h.jsxs("li",{children:[h.jsx($c,{className:"feature-icon"}),h.jsx("div",{children:h.jsx("strong",{children:"Payment Management"})})]})]})]})]})]})},cj=()=>{qf();const t=Os(),{userData:e,setUserData:r}=ux(),[n,a]=ne.useState(!1),[o,l]=ne.useState(!1),[u,d]=ne.useState({terminateAllSessions:!1,clearCache:!0}),m=[{path:"/dashboard",icon:h.jsx(mh,{}),label:"Dashboard",permission:"dashboard"},{path:"/dashboard/manage-student",icon:h.jsx(qc,{}),label:"Student Management",permission:"manageStudent"},{path:"/dashboard/department",icon:h.jsx(ch,{}),label:"Department",permission:"department"},{path:"/dashboard/course",icon:h.jsx(lh,{}),label:"Course",permission:"course"},{path:"/dashboard/subjects",icon:h.jsx(hh,{}),label:"Subjects",permission:"subjects"},{path:"/dashboard/payment",icon:h.jsx($c,{}),label:"Payment Management",permission:"payment"},{path:"/dashboard/grading-system",icon:h.jsx(fh,{}),label:"Grading System",permission:"gradingSystem"},{path:"/dashboard/attendance",icon:h.jsx(uh,{}),label:"Student Attendance",permission:"attendance"},{path:"/dashboard/announcement",icon:h.jsx(oh,{}),label:"Announcement",permission:"announcement"},{path:"/dashboard/permission",icon:h.jsx(ph,{}),label:"Account Permissions",permission:"accountPermission"},{path:"/dashboard/account-user-settings",icon:h.jsx(dh,{}),label:"Account & User Settings",permission:"accountSettings"}],g=async()=>{l(!0);try{if(await BI(ui),r(null),u.clearCache){if("caches"in window){const E=await caches.keys();await Promise.all(E.map(S=>caches.delete(S)))}localStorage.clear(),sessionStorage.clear()}u.terminateAllSessions&&console.log("Terminating all active sessions"),await new Promise(E=>setTimeout(E,1e3)),window.location.href=`/login?cache=${Date.now()}`}catch(E){console.error("Logout error:",E),l(!1),a(!1)}},y=E=>e!=null&&e.permissions?e.permissions.includes(E):!1,T=m.find(S=>t.pathname===S.path||S.path!=="/dashboard"&&t.pathname.startsWith(S.path))||m[0];return o?h.jsx("div",{className:"loading-overlay",children:h.jsx("div",{className:"loading-spinner"})}):h.jsxs("div",{className:"left-sidebar",children:[h.jsx("div",{className:"sidebar-header",children:h.jsx("h2",{className:"sidebar-title",children:T.label})}),h.jsxs("nav",{className:"sidebar-nav",children:[h.jsxs("div",{className:"sidebar-section",children:[h.jsx("h3",{className:"sidebar-section-title",children:"Businesses"}),h.jsx("ul",{className:"nav-menu",children:m.map(E=>y(E.permission)&&h.jsx("li",{className:"nav-item",children:h.jsxs(cv,{to:E.path,className:`nav-link ${t.pathname===E.path||E.path!=="/dashboard"&&t.pathname.startsWith(E.path)?"active":""}`,children:[E.icon,h.jsx("span",{children:E.label})]})},E.path))})]}),h.jsx("div",{className:"sidebar-section logout-section",children:h.jsx("ul",{className:"nav-menu",children:h.jsx("li",{className:"nav-item",children:h.jsxs("button",{onClick:()=>a(!0),className:"nav-link logout-btn",children:[h.jsx(sj,{className:"nav-icon"}),h.jsx("span",{children:"Log Out"})]})})})})]}),n&&h.jsx("div",{className:"logout-modal-overlay",children:h.jsxs("div",{className:"logout-modal",children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h3",{children:"Confirm Logout"}),h.jsx("button",{className:"close-btn",onClick:()=>a(!1),"aria-label":"Close modal",children:h.jsx(gh,{})})]}),h.jsxs("div",{className:"modal-body",children:[h.jsx("p",{children:"Are you sure you want to log out?"}),h.jsxs("div",{className:"logout-options",children:[h.jsxs("label",{children:[h.jsx("input",{type:"checkbox",checked:u.terminateAllSessions,onChange:E=>d({...u,terminateAllSessions:E.target.checked})}),"Terminate all active sessions"]}),h.jsxs("label",{children:[h.jsx("input",{type:"checkbox",checked:u.clearCache,onChange:E=>d({...u,clearCache:E.target.checked})}),"Clear cached data"]})]})]}),h.jsxs("div",{className:"modal-footer",children:[h.jsx("button",{className:"cancel-btn",onClick:()=>a(!1),children:"Cancel"}),h.jsx("button",{className:"confirm-btn",onClick:g,autoFocus:!0,children:"Log Out"})]})]})})]})},uj=()=>h.jsx("div",{className:"center-content",children:h.jsxs("div",{className:"center-header-container",children:[h.jsx("h1",{className:"dashboard-title",children:"Student Management System"}),h.jsxs("div",{className:"stats-grid",children:[h.jsxs("div",{className:"stat-card",children:[h.jsx("h3",{className:"stat-title",children:"Total Students"}),h.jsx("p",{className:"stat-value",children:"1,250"})]}),h.jsxs("div",{className:"stat-card",children:[h.jsx("h3",{className:"stat-title",children:"Total Teachers"}),h.jsx("p",{className:"stat-value",children:"1,000"})]}),h.jsxs("div",{className:"stat-card",children:[h.jsx("h3",{className:"stat-title",children:"Total Courses"}),h.jsx("p",{className:"stat-value",children:"25"})]}),h.jsxs("div",{className:"stat-card",children:[h.jsx("h3",{className:"stat-title",children:"Total Department"}),h.jsx("p",{className:"stat-value",children:"5"})]})]})]})}),fj=()=>h.jsxs("div",{className:"right-sidebar",children:[h.jsxs("div",{className:"calendar-section",children:[h.jsx("h2",{className:"sidebar-section-title",children:"School Calendar"}),h.jsx("div",{className:"calendar-placeholder",children:"[Calendar will be displayed here]"})]}),h.jsxs("div",{className:"announcements-section",children:[h.jsx("h2",{className:"sidebar-section-title",children:"Announcements"}),h.jsxs("ul",{className:"announcements-list",children:[h.jsxs("li",{className:"announcement-item",children:[h.jsx("h3",{className:"announcement-title",children:"Parent-Teacher Meeting"}),h.jsx("p",{className:"announcement-date",children:"Friday, June 10"}),h.jsx("p",{className:"announcement-text",children:"All teachers are required to attend the meeting at 2 PM in the auditorium."})]}),h.jsxs("li",{className:"announcement-item",children:[h.jsx("h3",{className:"announcement-title",children:"Sports Day"}),h.jsx("p",{className:"announcement-date",children:"Monday, June 13"}),h.jsx("p",{className:"announcement-text",children:"Annual sports day event. All students must participate."})]})]})]}),h.jsxs("div",{className:"quick-links-section",children:[h.jsx("h2",{className:"sidebar-section-title",children:"Quick Links"}),h.jsxs("div",{className:"quick-links",children:[h.jsx("a",{href:"#timetable",className:"quick-link",children:"Timetable"}),h.jsx("a",{href:"#syllabus",className:"quick-link",children:"Syllabus"}),h.jsx("a",{href:"#grades",className:"quick-link",children:"Grades"}),h.jsx("a",{href:"#resources",className:"quick-link",children:"Resources"})]})]})]}),hj=()=>{const t=Os(),e=qf(),{currentUser:r,userData:n,loading:a}=ux(),o=t.pathname.includes("account-user-settings"),l=t.pathname.includes("manage-student"),u=t.pathname.includes("department"),d=t.pathname.includes("course"),m=t.pathname.includes("subjects"),g=t.pathname.includes("payment"),y=t.pathname.includes("grading-system"),_=t.pathname.includes("attendance"),T=t.pathname.includes("announcement"),E=t.pathname.includes("permission");if(ne.useEffect(()=>{!a&&!r&&e("/")},[r,a,e]),a)return h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:1e3},children:h.jsx("div",{style:{width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite"}})});if(!r)return null;const S=n?`${n.firstName} ${n.middleName} ${n.lastName}`:r.displayName||"User",b=(n==null?void 0:n.role)||"admin",O=(n==null?void 0:n.photoURL)||r.photoURL||"/Profile-image.gif";return h.jsxs("div",{className:"dashboard-container",children:[h.jsxs("header",{className:"dashboard-header",children:[h.jsxs("div",{className:"header-left",children:[h.jsx("div",{className:"logo-container",children:h.jsx("img",{src:"/school-logo.png",alt:"School Logo",className:"school-logo"})}),h.jsx("span",{className:"header-title",children:"Samson Admin"}),h.jsx("button",{className:"menu-toggle",children:h.jsx(K9,{})})]}),h.jsxs("div",{className:"header-right",children:[h.jsx("div",{className:"user-profile",children:h.jsx("img",{src:O,alt:"User Profile",className:"profile-image"})}),h.jsxs("div",{className:"name-access",children:[h.jsx("p",{className:"user-name",children:S}),h.jsx("span",{className:"user-role",children:b})]})]})]}),h.jsxs("div",{className:"dashboard-content",children:[h.jsx(cj,{}),!o&&!l&&!u&&!d&&!m&&!g&&!y&&!_&&!T&&!E&&h.jsx(uj,{}),h.jsx(x6,{}),!o&&!l&&!u&&!d&&!m&&!g&&!y&&!_&&!T&&!E&&h.jsx(fj,{})]})]})},cn=[];for(let t=0;t<256;++t)cn.push((t+256).toString(16).slice(1));function dj(t,e=0){return(cn[t[e+0]]+cn[t[e+1]]+cn[t[e+2]]+cn[t[e+3]]+"-"+cn[t[e+4]]+cn[t[e+5]]+"-"+cn[t[e+6]]+cn[t[e+7]]+"-"+cn[t[e+8]]+cn[t[e+9]]+"-"+cn[t[e+10]]+cn[t[e+11]]+cn[t[e+12]]+cn[t[e+13]]+cn[t[e+14]]+cn[t[e+15]]).toLowerCase()}let Z1;const mj=new Uint8Array(16);function pj(){if(!Z1){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Z1=crypto.getRandomValues.bind(crypto)}return Z1(mj)}const gj=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),t4={randomUUID:gj};function vj(t,e,r){var a;if(t4.randomUUID&&!t)return t4.randomUUID();t=t||{};const n=t.random??((a=t.rng)==null?void 0:a.call(t))??pj();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,dj(n)}const xj=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),sA=t=>Array.isArray(t)&&t.every(e=>typeof e=="object"&&!(e instanceof Array)),_j=t=>Array.isArray(t)&&t.every(e=>Array.isArray(e)),yj=t=>Array.from(t.map(e=>Object.keys(e)).reduce((e,r)=>new Set([...e,...r]),[])),Ej=(t,e)=>{e=e||yj(t);let r=e,n=e;sA(e)&&(r=e.map(o=>o.label),n=e.map(o=>o.key));const a=t.map(o=>n.map(l=>Tj(l,o)));return[r,...a]},Tj=(t,e)=>{const r=t.replace(/\[([^\]]+)]/g,".$1").split(".").reduce(function(n,a,o,l){const u=n[a];if(u==null)l.splice(1);else return u},e);return r===void 0?t in e?e[t]:"":r},wj=t=>typeof t>"u"||t===null?"":t,iA=(t,e=",",r='"')=>t.filter(n=>n).map(n=>n.map(a=>wj(a)).map(a=>`${r}${a}${r}`).join(e)).join(`
`),Sj=(t,e,r,n)=>iA(e?[e,...t]:t,r,n),bj=(t,e,r,n)=>iA(Ej(t,e),r,n),Aj=(t,e,r,n)=>e?`${e.join(r)}
${t}`:t.replace(/"/g,'""'),oA=(t,e,r,n)=>{if(sA(t))return bj(t,e,r,n);if(_j(t))return Sj(t,e,r,n);if(typeof t=="string")return Aj(t,e,r);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')},lA=(t,e,r,n,a)=>{const o=oA(t,r,n,a),l=xj()?"application/csv":"text/csv",u=new Blob([e?"\uFEFF":"",o],{type:l}),d=`data:${l};charset=utf-8,${e?"\uFEFF":""}${o}`,m=window.URL||window.webkitURL;return typeof m.createObjectURL>"u"?d:m.createObjectURL(u)};var eg={exports:{}},tg,r4;function Cj(){if(r4)return tg;r4=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return tg=t,tg}var rg,n4;function Nj(){if(n4)return rg;n4=1;var t=Cj();function e(){}function r(){}return r.resetWarningCache=e,rg=function(){function n(l,u,d,m,g,y){if(y!==t){var _=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw _.name="Invariant Violation",_}}n.isRequired=n;function a(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},rg}var a4;function Rj(){return a4||(a4=1,eg.exports=Nj()()),eg.exports}var ka=Rj();const cA={data:ka.oneOfType([ka.string,ka.array,ka.func]).isRequired,headers:ka.array,target:ka.string,separator:ka.string,filename:ka.string,uFEFF:ka.bool,onClick:ka.func,asyncOnClick:ka.bool,enclosingCharacter:ka.string},uA={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},kj={target:"_blank"};class s4 extends oi.Component{constructor(e){super(e),this.state={}}buildURI(){return lA(...arguments)}componentDidMount(){const{data:e,headers:r,separator:n,enclosingCharacter:a,uFEFF:o,target:l,specs:u,replace:d}=this.props;this.state.page=window.open(this.buildURI(e,o,r,n,a),l,u,d)}getWindow(){return this.state.page}render(){return null}}Wu(s4,"defaultProps",Object.assign(uA,kj)),Wu(s4,"propTypes",cA);var t0;let Ij=(t0=class extends oi.Component{constructor(e){super(e),this.buildURI=this.buildURI.bind(this)}buildURI(){return lA(...arguments)}handleLegacy(e,r=!1){if(window.navigator.msSaveOrOpenBlob){e.preventDefault();const{data:n,headers:a,separator:o,filename:l,enclosingCharacter:u,uFEFF:d}=this.props,m=r&&typeof n=="function"?n():n;let g=new Blob([d?"\uFEFF":"",oA(m,a,o,u)]);return window.navigator.msSaveBlob(g,l),!1}}handleAsyncClick(e){const r=n=>{if(n===!1){e.preventDefault();return}this.handleLegacy(e,!0)};this.props.onClick(e,r)}handleSyncClick(e){if(this.props.onClick(e)===!1){e.preventDefault();return}this.handleLegacy(e)}handleClick(){return e=>{if(typeof this.props.onClick=="function")return this.props.asyncOnClick?this.handleAsyncClick(e):this.handleSyncClick(e);this.handleLegacy(e)}}render(){const{data:e,headers:r,separator:n,filename:a,uFEFF:o,children:l,onClick:u,asyncOnClick:d,enclosingCharacter:m,...g}=this.props,_=typeof window>"u"?"":this.buildURI(e,o,r,n,m);return h.jsx("a",{download:a,...g,ref:T=>this.link=T,target:"_self",href:_,onClick:this.handleClick(),children:l})}},Wu(t0,"defaultProps",uA),Wu(t0,"propTypes",cA),t0);const Om=Ij;async function Dj(t,e){try{return(await PI(ui,t,e)).user}catch(r){throw console.error("Error creating auth user:",r),r}}async function Oj(t,e={}){try{const r=kn(Ut,"users",t.uid);return await a9(r,{uid:t.uid,email:t.email,createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString(),role:e.role||"user",status:e.status||"active",...e}),r}catch(r){throw console.error("Error creating user document:",r),r}}async function px(t){var a;const e="dtebf3uea",r="lp_upload_preset",n=new FormData;n.append("file",t),n.append("upload_preset",r),n.append("folder","student-profile-photos");try{const o=await fetch(`https://api.cloudinary.com/v1_1/${e}/image/upload`,{method:"POST",body:n});if(!o.ok){const l=await o.json();throw new Error(((a=l.error)==null?void 0:a.message)||"Upload failed")}return await o.json()}catch(o){throw console.error("Upload error:",o),o}}const jj=({isOpen:t,onClose:e,onCreate:r})=>{const[n,a]=ne.useState({profile:null,firstName:"",middleName:"",lastName:"",email:"",role:"admin",status:"active",permissions:[],password:"",confirmPassword:""}),[o,l]=ne.useState(null),[u,d]=ne.useState(""),[m,g]=ne.useState(!1),[y,_]=ne.useState(""),T=ne.useRef(null),E=[{key:"dashboard",label:"Dashboard",icon:h.jsx(mh,{})},{key:"manageStudent",label:"Student Management",icon:h.jsx(qc,{})},{key:"department",label:"Department",icon:h.jsx(ch,{})},{key:"course",label:"Course",icon:h.jsx(lh,{})},{key:"subjects",label:"Subjects",icon:h.jsx(hh,{})},{key:"payment",label:"Payment Management",icon:h.jsx($c,{})},{key:"gradingSystem",label:"Grading System",icon:h.jsx(fh,{})},{key:"attendance",label:"Student Attendance",icon:h.jsx(uh,{})},{key:"announcement",label:"Announcement",icon:h.jsx(oh,{})},{key:"accountPermission",label:"Account Permissions",icon:h.jsx(ph,{})},{key:"accountSettings",label:"Account & User Settings",icon:h.jsx(dh,{})}],S=A=>{const D=A.target.files[0];if(D){if(!D.type.match("image.*")){_("Please select an image file");return}if(D.size>5*1024*1024){_("Image size should be less than 5MB");return}const V=new FileReader;V.onloadend=()=>{l(V.result),a(H=>({...H,profile:D}))},V.readAsDataURL(D)}},b=A=>{const{name:D,value:V}=A.target;a(H=>({...H,[D]:V})),D==="confirmPassword"&&d(V!==n.password?"Passwords don't match!":"")},O=A=>{a(D=>({...D,permissions:D.permissions.includes(A)?D.permissions.filter(V=>V!==A):[...D.permissions,A]}))},L=async A=>{if(A.preventDefault(),_(""),d(""),n.password!==n.confirmPassword){d("Passwords don't match!");return}if(n.password.length<8){d("Password must be at least 8 characters");return}if(!n.firstName||!n.lastName||!n.email){_("Please fill all required fields");return}g(!0);try{let D=null;if(n.profile)try{const C=await px(n.profile);if(!C.secure_url)throw new Error("No URL returned from Cloudinary");D=C.secure_url}catch(C){throw console.error("Cloudinary upload error:",C),new Error(`Profile image upload failed: ${C.message}`)}const V=await Dj(n.email,n.password),H={firstName:n.firstName,middleName:n.middleName||null,lastName:n.lastName,email:n.email,role:n.role,status:n.status,permissions:n.permissions,photoURL:D,createdAt:new Date().toISOString(),lastUpdated:new Date().toISOString()};await Oj(V,H),r(),e()}catch(D){console.error("Error in user creation process:",D);let V="Failed to complete account creation";if(D.code)switch(D.code){case"auth/email-already-in-use":V="This email is already registered";break;case"auth/invalid-email":V="Please enter a valid email address";break;case"auth/weak-password":V="Password should be at least 8 characters";break;case"auth/operation-not-allowed":V="Account creation is currently disabled";break;default:V=`Authentication error: ${D.code}`}else D.message.includes("Cloudinary")&&(V=D.message);_(V)}finally{g(!1)}};return t?h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-container",children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h3",{children:"Create New User"}),h.jsx("button",{className:"close-btn",onClick:e,disabled:m,children:h.jsx(gh,{})})]}),y&&h.jsx("div",{className:"error-message",children:y}),h.jsxs("form",{onSubmit:L,children:[h.jsxs("div",{className:"profile-upload-container",children:[h.jsx("div",{className:"profile-image-preview",children:o?h.jsx("img",{src:o,alt:"Profile Preview",className:"profile-preview"}):h.jsx(mx,{className:"default-profile-icon"})}),h.jsxs("div",{className:"upload-controls",children:[h.jsxs("button",{type:"button",className:"upload-btn",onClick:()=>T.current.click(),disabled:m,children:[h.jsx(aA,{})," ",o?"Change Photo":"Upload Photo"]}),h.jsx("input",{type:"file",ref:T,onChange:S,accept:"image/*",style:{display:"none"},disabled:m}),o&&h.jsx("button",{type:"button",className:"remove-btn",onClick:()=>{l(null),a(A=>({...A,profile:null}))},disabled:m,children:"Remove"})]})]}),h.jsxs("div",{className:"form-row",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"First Name *"}),h.jsx("input",{type:"text",name:"firstName",value:n.firstName,onChange:b,required:!0,disabled:m})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Middle Name"}),h.jsx("input",{type:"text",name:"middleName",value:n.middleName,onChange:b,disabled:m})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Last Name *"}),h.jsx("input",{type:"text",name:"lastName",value:n.lastName,onChange:b,required:!0,disabled:m})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Email *"}),h.jsx("input",{type:"email",name:"email",value:n.email,onChange:b,required:!0,disabled:m})]}),h.jsxs("div",{className:"form-row",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Role *"}),h.jsxs("select",{name:"role",value:n.role,onChange:b,required:!0,disabled:m,children:[h.jsx("option",{value:"admin",children:"Admin"}),h.jsx("option",{value:"teacher",children:"Teacher"}),h.jsx("option",{value:"student",children:"Student"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Status *"}),h.jsxs("select",{name:"status",value:n.status,onChange:b,required:!0,disabled:m,children:[h.jsx("option",{value:"active",children:"Active"}),h.jsx("option",{value:"inactive",children:"Inactive"})]})]})]}),h.jsxs("div",{className:"form-row",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Password *"}),h.jsx("input",{type:"password",name:"password",value:n.password,onChange:b,required:!0,minLength:"8",placeholder:"At least 8 characters",disabled:m})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Confirm Password *"}),h.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:b,required:!0,minLength:"8",disabled:m}),u&&h.jsx("div",{className:"error-message",children:u})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Menu Permissions"}),h.jsx("div",{className:"permissions-grid",children:E.map(({key:A,label:D,icon:V})=>h.jsxs("label",{className:`permission-item ${n.permissions.includes(A)?"selected":""}`,children:[h.jsx("input",{type:"checkbox",checked:n.permissions.includes(A),onChange:()=>O(A),className:"permission-checkbox",disabled:m}),h.jsx("span",{className:"permission-icon",children:V}),h.jsx("span",{className:"permission-label",children:D})]},A))})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",className:"cancel-btn",onClick:e,disabled:m,children:"Cancel"}),h.jsx("button",{type:"submit",className:"submit-btn",disabled:m,children:m?"Creating...":"Create User"})]})]})]})}):null},Pj=({isOpen:t,onClose:e,user:r,onSave:n})=>{const[a,o]=ne.useState({id:"",firstName:"",middleName:"",lastName:"",email:"",status:"active",permissions:[],profile:null}),[l,u]=ne.useState(null),[d,m]=ne.useState(!1),[g,y]=ne.useState(""),_=ne.useRef(null),T=[{key:"dashboard",label:"Dashboard",icon:h.jsx(mh,{})},{key:"manageStudent",label:"Student Management",icon:h.jsx(qc,{})},{key:"department",label:"Department",icon:h.jsx(ch,{})},{key:"course",label:"Course",icon:h.jsx(lh,{})},{key:"subjects",label:"Subjects",icon:h.jsx(hh,{})},{key:"payment",label:"Payment Management",icon:h.jsx($c,{})},{key:"gradingSystem",label:"Grading System",icon:h.jsx(fh,{})},{key:"attendance",label:"Student Attendance",icon:h.jsx(uh,{})},{key:"announcement",label:"Announcement",icon:h.jsx(oh,{})},{key:"accountPermission",label:"Account Permissions",icon:h.jsx(ph,{})},{key:"accountSettings",label:"Account & User Settings",icon:h.jsx(dh,{})}];ne.useEffect(()=>{r&&(o({id:r.id,firstName:r.firstName||"",middleName:r.middleName||"",lastName:r.lastName||"",email:r.email||"",status:r.status||"active",permissions:r.permissions||[],profile:r.photoURL||null}),u(r.photoURL||null))},[r]);const E=L=>{const A=L.target.files[0];if(A){if(!A.type.match("image.*")){y("Please select an image file (JPEG, PNG)");return}if(A.size>5*1024*1024){y("Image size should be less than 5MB");return}const D=new FileReader;D.onloadend=()=>{u(D.result),o(V=>({...V,profile:A}))},D.readAsDataURL(A)}},S=L=>{const{name:A,value:D}=L.target;o(V=>({...V,[A]:D}))},b=L=>{o(A=>({...A,permissions:A.permissions.includes(L)?A.permissions.filter(D=>D!==L):[...A.permissions,L]}))},O=async L=>{L.preventDefault(),m(!0),y("");try{if(!a.firstName||!a.lastName)throw new Error("First name and last name are required");if(a.permissions.length===0)throw new Error("At least one permission must be selected");const A={id:a.id,firstName:a.firstName,middleName:a.middleName,lastName:a.lastName,status:a.status,permissions:a.permissions};typeof a.profile=="object"?A.profileImageFile=a.profile:a.profile&&(A.photoURL=a.profile),await n(A),e()}catch(A){y(A.message||"Failed to update user")}finally{m(!1)}};return!t||!r?null:h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-container",children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h3",{children:"Edit User Profile"}),h.jsx("button",{className:"close-btn",onClick:e,disabled:d,children:h.jsx(gh,{})})]}),g&&h.jsx("div",{className:"error-message",children:g}),h.jsxs("form",{onSubmit:O,children:[h.jsxs("div",{className:"profile-upload-container",children:[h.jsx("div",{className:"profile-image-preview",children:l?h.jsx("img",{src:l,alt:"Profile Preview",className:"profile-preview"}):h.jsx(mx,{className:"default-profile-icon"})}),h.jsxs("div",{className:"upload-controls",children:[h.jsxs("button",{type:"button",className:"upload-btn",onClick:()=>_.current.click(),disabled:d,children:[h.jsx(aA,{})," ",l?"Change Photo":"Upload Photo"]}),h.jsx("input",{type:"file",ref:_,onChange:E,accept:"image/*",style:{display:"none"},disabled:d}),l&&h.jsx("button",{type:"button",className:"remove-btn",onClick:()=>{u(null),o(L=>({...L,profile:null}))},disabled:d,children:"Remove"})]})]}),h.jsxs("div",{className:"form-row",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"First Name *"}),h.jsx("input",{type:"text",name:"firstName",value:a.firstName,onChange:S,required:!0,disabled:d})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Middle Name"}),h.jsx("input",{type:"text",name:"middleName",value:a.middleName,onChange:S,disabled:d})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Last Name *"}),h.jsx("input",{type:"text",name:"lastName",value:a.lastName,onChange:S,required:!0,disabled:d})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Email"}),h.jsx("input",{type:"email",name:"email",value:a.email,onChange:S,disabled:!0,className:"disabled-input"})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Status *"}),h.jsxs("select",{name:"status",value:a.status,onChange:S,required:!0,disabled:d,children:[h.jsx("option",{value:"active",children:"Active"}),h.jsx("option",{value:"inactive",children:"Inactive"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Menu Permissions *"}),h.jsx("div",{className:"permissions-grid",children:T.map(({key:L,label:A,icon:D})=>h.jsxs("label",{className:`permission-item ${a.permissions.includes(L)?"selected":""}`,children:[h.jsx("input",{type:"checkbox",checked:a.permissions.includes(L),onChange:()=>b(L),className:"permission-checkbox",disabled:d}),h.jsx("span",{className:"permission-icon",children:D}),h.jsx("span",{className:"permission-label",children:A})]},L))})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",className:"cancel-btn",onClick:e,disabled:d,children:"Cancel"}),h.jsx("button",{type:"submit",className:"submit-btn",disabled:d,children:d?"Saving...":"Save Changes"})]})]})]})})},Fj=({isOpen:t,onClose:e,user:r})=>{var a;const n=[{key:"dashboard",label:"Dashboard",icon:h.jsx(mh,{})},{key:"manageStudent",label:"Student Management",icon:h.jsx(qc,{})},{key:"department",label:"Department",icon:h.jsx(ch,{})},{key:"course",label:"Course",icon:h.jsx(lh,{})},{key:"subjects",label:"Subjects",icon:h.jsx(hh,{})},{key:"payment",label:"Payment Management",icon:h.jsx($c,{})},{key:"gradingSystem",label:"Grading System",icon:h.jsx(fh,{})},{key:"attendance",label:"Student Attendance",icon:h.jsx(uh,{})},{key:"announcement",label:"Announcement",icon:h.jsx(oh,{})},{key:"accountPermission",label:"Account Permissions",icon:h.jsx(ph,{})},{key:"accountSettings",label:"Account & User Settings",icon:h.jsx(dh,{})}];return!t||!r?null:h.jsx("div",{className:"view-modal-overlay",children:h.jsxs("div",{className:"view-modal-container",children:[h.jsxs("div",{className:"view-modal-header",children:[h.jsx("h3",{className:"view-modal-title",children:"User Profile Details"}),h.jsx("button",{className:"view-close-btn",onClick:e,children:h.jsx(gh,{})})]}),h.jsxs("div",{className:"view-user-content",children:[h.jsx("div",{className:"view-profile-section",children:r.photoURL?h.jsx("img",{src:r.photoURL,alt:"Profile",className:"view-profile-image"}):h.jsx("div",{className:"view-profile-placeholder",children:h.jsx(mx,{})})}),h.jsxs("div",{className:"view-details-grid",children:[h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"User ID:"}),h.jsx("span",{className:"view-detail-value",children:r.id})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Full Name:"}),h.jsxs("span",{className:"view-detail-value",children:[r.firstName," ",r.middleName," ",r.lastName]})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Email:"}),h.jsx("span",{className:"view-detail-value",children:r.email})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Role:"}),h.jsx("span",{className:"view-detail-value view-role-badge",children:r.role})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Status:"}),h.jsx("span",{className:`view-detail-value view-status-badge view-status-${r.status}`,children:r.status})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Permissions:"}),h.jsxs("div",{className:"view-permissions-grid",children:[n.map(({key:o,label:l,icon:u})=>{var d;return((d=r.permissions)==null?void 0:d.includes(o))&&h.jsxs("div",{className:"view-permission-item",title:l,children:[h.jsx("span",{className:"view-permission-icon",children:u}),h.jsx("span",{className:"view-permission-label",children:l})]},o)}),((a=r.permissions)==null?void 0:a.length)===0&&h.jsx("span",{className:"view-no-permissions",children:"No permissions assigned"})]})]}),h.jsxs("div",{className:"view-detail-item",children:[h.jsx("span",{className:"view-detail-label",children:"Last Login:"}),h.jsx("span",{className:"view-detail-value",children:r.lastLogin||"Never logged in"})]})]})]}),h.jsx("div",{className:"view-modal-footer",children:h.jsx("button",{className:"view-close-button",onClick:e,children:"Close"})})]})})},Lj=()=>{const[t,e]=ne.useState([]),[r,n]=ne.useState(null),[a,o]=ne.useState("admin","teacher"),[l,u]=ne.useState(""),[d,m]=ne.useState(!1),[g,y]=ne.useState(!1),[_,T]=ne.useState(!1),[E,S]=ne.useState(null),[b,O]=ne.useState(1),[L,A]=ne.useState(10),[D,V]=ne.useState(null),[H,C]=ne.useState(!0),[N,R]=ne.useState(null),[F,P]=ne.useState(""),M={dashboard:h.jsx(mh,{}),manageStudent:h.jsx(qc,{}),department:h.jsx(ch,{}),course:h.jsx(lh,{}),subjects:h.jsx(hh,{}),payment:h.jsx($c,{}),gradingSystem:h.jsx(fh,{}),attendance:h.jsx(uh,{}),announcement:h.jsx(oh,{}),accountPermission:h.jsx(ph,{}),accountSettings:h.jsx(dh,{})},U={dashboard:"Dashboard",manageStudent:"Student Management",department:"Department",course:"Course",subjects:"Subjects",payment:"Payment Management",gradingSystem:"Grading System",attendance:"Attendance",announcement:"Announcement",accountPermission:"Account Permission",accountSettings:"Account & User Settings"};ne.useEffect(()=>{const G=iS(ui,K=>{if(n(K),!K){C(!1),R("Authentication required");return}try{const Q=(r==null?void 0:r.role)==="admin"?Ya(mn(Ut,"users")):Ya(mn(Ut,"users"),Un("role","==",a)),ye=s9(Q,Ee=>{const Ae=Ee.docs.map(be=>({id:be.id,...be.data()}));e(Ae),C(!1),R(null)},Ee=>{console.error("Firestore error:",Ee),R("Failed to load users"),C(!1)});return()=>ye()}catch(Q){console.error("Error setting up listener:",Q),R("Error initializing data"),C(!1)}});return()=>G()},[a,r==null?void 0:r.role]);const Me=t.filter(G=>G.role===a&&(G.email.toLowerCase().includes(l.toLowerCase())||`${G.firstName} ${G.lastName}`.toLowerCase().includes(l.toLowerCase()))),Ne=b*L,ie=Ne-L,me=Me.slice(ie,Ne),Pe=Math.ceil(Me.length/L),oe=G=>{O(G),window.scrollTo({top:0,behavior:"smooth"})},ee=()=>{m(!1)},ue=async G=>{try{if(!(G!=null&&G.id))throw new Error("Invalid user data: Missing ID");const K=kn(Ut,"users",G.id),Q={firstName:G.firstName,middleName:G.middleName||null,lastName:G.lastName,status:G.status,permissions:G.permissions||[],lastUpdated:new Date().toISOString()};if(G.profileImageFile)try{const ye=new FormData;ye.append("file",G.profileImageFile),ye.append("upload_preset","lp_upload_preset"),ye.append("public_id",`user_profile_${G.id}_${vj()}`);const Ee=await fetch("https://api.cloudinary.com/v1_1/dtebf3uea/image/upload",{method:"POST",body:ye});if(!Ee.ok)throw new Error("Failed to upload profile image to Cloudinary");const Ae=await Ee.json();Q.photoURL=Ae.secure_url}catch(ye){throw console.error("Cloudinary upload error:",ye),new Error("Failed to upload profile image")}else G.photoURL&&(Q.photoURL=G.photoURL);await ul(K,Q),P("User updated successfully!"),setTimeout(()=>P(""),3e3)}catch(K){console.error("Detailed error:",K),R(`Update failed: ${K.message}`)}},z=async(G,K)=>{try{const Q=kn(Ut,"users",G);await ul(Q,{status:K})}catch(Q){console.error("Error updating status:",Q),R("Failed to update user status")}},X=()=>{if(!D)return;const G=new FileReader;G.onload=K=>{try{const Ee=K.target.result.split(`
`).slice(1).map(Ae=>{const be=Ae.split(",");return{id:be[0]||Math.random().toString(36).substring(2,9),firstName:be[1]||"",lastName:be[2]||"",email:be[3]||"",role:be[4]||"admin",status:be[5]||"active",permissions:be[6]?be[6].split(","):[],lastLogin:be[7]||new Date().toISOString(),profile:be[8]||"/default-profile.png"}});e(Ae=>[...Ae,...Ee])}catch(Q){console.error("Error parsing CSV:",Q),R("Invalid CSV format")}finally{V(null)}},G.readAsText(D)};return H?h.jsx("div",{className:"loading",children:"Loading users..."}):N?h.jsx("div",{className:"error",children:N}):r?h.jsxs("div",{className:"account-user-settings",children:[h.jsx("h2",{className:"settings-header",children:"Account & User Management"}),F&&h.jsx("div",{className:"success-message",children:F}),N&&h.jsx("div",{className:"error-message",children:N}),h.jsxs("div",{className:"settings-tabs",children:[h.jsxs("button",{className:`tab-btn ${a==="admin"?"active":""}`,onClick:()=>{o("admin"),O(1)},children:[h.jsx(oj,{})," Admin Accounts"]}),h.jsxs("button",{className:`tab-btn ${a==="teacher"?"active":""}`,onClick:()=>{o("teacher"),O(1)},children:[h.jsx(ZT,{})," Teacher Accounts"]})]}),h.jsxs("div",{className:"table-controls",children:[h.jsxs("div",{className:"left-controls",children:[h.jsxs("div",{className:"search-bar",children:[h.jsx(Im,{className:"search-icon"}),h.jsx("input",{type:"text",placeholder:"Search users...",value:l,onChange:G=>u(G.target.value)})]}),h.jsxs("button",{className:"create-btn",onClick:()=>m(!0),children:[h.jsx(zg,{})," Create New User"]})]}),h.jsxs("div",{className:"right-controls",children:[h.jsxs("div",{className:"items-per-page",children:[h.jsx("span",{children:"Show:"}),h.jsx("select",{value:L,onChange:G=>{A(Number(G.target.value)),O(1)},children:[5,10,20,50,100].map(G=>h.jsx("option",{value:G,children:G},G))}),h.jsx("span",{children:"entries"})]}),h.jsxs("div",{className:"import-export-buttons",children:[h.jsxs("label",{className:"import-btn",children:[h.jsx(ej,{}),h.jsx("span",{children:"Import"}),h.jsx("input",{type:"file",accept:".csv",onChange:G=>V(G.target.files[0]),style:{display:"none"}})]}),D&&h.jsx("button",{className:"confirm-import-btn",onClick:X,children:"Confirm Import"}),h.jsxs(Om,{data:t.map(G=>{var K;return{...G,permissions:((K=G.permissions)==null?void 0:K.join(", "))||""}}),headers:[{label:"ID",key:"id"},{label:"First Name",key:"firstName"},{label:"Last Name",key:"lastName"},{label:"Email",key:"email"},{label:"Role",key:"role"},{label:"Status",key:"status"},{label:"Permissions",key:"permissions"}],filename:"users-export.csv",className:"export-btn",children:[h.jsx(Z9,{}),h.jsx("span",{children:"Export"})]})]})]})]}),h.jsx("div",{className:"users-table",children:h.jsxs("table",{children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"ID"}),h.jsx("th",{children:"Profile"}),h.jsx("th",{children:"Name"}),h.jsx("th",{children:"Email"}),h.jsx("th",{children:"Role"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Permissions"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:me.map(G=>{var K;return h.jsxs("tr",{children:[h.jsx("td",{children:G.id}),h.jsx("td",{children:h.jsx("img",{src:G.photoURL||"/default-profile.png",alt:"Profile",className:"profile-image"})}),h.jsxs("td",{children:[G.firstName," ",G.middleName," ",G.lastName]}),h.jsx("td",{children:G.email}),h.jsx("td",{children:G.role}),h.jsx("td",{children:h.jsxs("select",{value:G.status||"active",onChange:Q=>z(G.id,Q.target.value),className:"status-select",disabled:!r||r.role!=="admin",children:[h.jsx("option",{value:"active",children:"Active"}),h.jsx("option",{value:"inactive",children:"Inactive"})]})}),h.jsx("td",{children:h.jsx("div",{className:"permission-icons-container",children:(K=G.permissions)==null?void 0:K.reduce((Q,ye,Ee)=>{const Ae=Math.floor(Ee/6);return Q[Ae]||(Q[Ae]=[]),Q[Ae].push(ye),Q},[]).map((Q,ye)=>h.jsx("div",{className:"permission-icons-row",children:Q.map(Ee=>h.jsx("div",{className:"permission-icon",title:U[Ee]||Ee,children:M[Ee]||h.jsx(nj,{})},Ee))},ye))})}),h.jsx("td",{children:h.jsxs("div",{className:"action-buttons",children:[h.jsx("button",{onClick:()=>{S(G),T(!0)},className:"view-btn",children:h.jsx(fx,{})}),h.jsx("button",{onClick:()=>{S(G),y(!0)},className:"edit-btn",children:h.jsx(ZT,{})})]})})]},G.id)})})]})}),Pe>1&&h.jsxs("div",{className:"pagination-controls",children:[h.jsxs("div",{className:"pagination-info",children:["Showing ",ie+1," to ",Math.min(Ne,Me.length)," of ",Me.length," entries"]}),h.jsxs("div",{className:"pagination-buttons",children:[h.jsx("button",{onClick:()=>oe(1),disabled:b===1,className:"pagination-btn","aria-label":"First page",children:"First"}),h.jsx("button",{onClick:()=>oe(Math.max(1,b-1)),disabled:b===1,className:"pagination-btn","aria-label":"Previous page",children:"Previous"}),Array.from({length:Math.min(5,Pe)}).map((G,K)=>{let Q;return Pe<=5||b<=3?Q=K+1:b>=Pe-2?Q=Pe-4+K:Q=b-2+K,h.jsx("button",{onClick:()=>oe(Q),className:`pagination-btn ${b===Q?"active":""}`,"aria-label":`Page ${Q}`,"aria-current":b===Q?"page":void 0,children:Q},Q)}),h.jsx("button",{onClick:()=>oe(Math.min(Pe,b+1)),disabled:b===Pe,className:"pagination-btn","aria-label":"Next page",children:"Next"}),h.jsx("button",{onClick:()=>oe(Pe),disabled:b===Pe,className:"pagination-btn","aria-label":"Last page",children:"Last"})]})]}),h.jsx(jj,{isOpen:d,onClose:()=>m(!1),onCreate:ee}),h.jsx(Pj,{isOpen:g,onClose:()=>y(!1),user:E,onSave:ue}),h.jsx(Fj,{isOpen:_,onClose:()=>T(!1),user:E})]}):h.jsx("div",{className:"auth-message",children:"Please sign in to view this page"})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var fA=1252,Mj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},vx=function(t){Mj.indexOf(t)!=-1&&(fA=gx[0]=t)};function Bj(){vx(1252)}var Ka=function(t){vx(t)};function hA(){Ka(1200),Bj()}function i4(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Vj(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function dA(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var af=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Vj(t.slice(2)):e==254&&r==255?dA(t.slice(2)):e==65279?t.slice(1):t},$d=function(e){return String.fromCharCode(e)},o4=function(e){return String.fromCharCode(e)},Hg,to="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function l4(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,d=0,m=0;m<t.length;)r=t.charCodeAt(m++),o=r>>2,n=t.charCodeAt(m++),l=(r&3)<<4|n>>4,a=t.charCodeAt(m++),u=(n&15)<<2|a>>6,d=a&63,isNaN(n)?u=d=64:isNaN(a)&&(d=64),e+=to.charAt(o)+to.charAt(l)+to.charAt(u)+to.charAt(d);return e}function va(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<t.length;)o=to.indexOf(t.charAt(m++)),l=to.indexOf(t.charAt(m++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=to.indexOf(t.charAt(m++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),d=to.indexOf(t.charAt(m++)),a=(u&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var kt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),vl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function go(t){return kt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function c4(t){return kt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var qa=function(e){return kt?vl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function xl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function xx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return xx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Ji=kt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:vl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Uj(t){for(var e=[],r=0,n=t.length+250,a=go(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=go(65535),n=65530)}return e.push(a.slice(0,r)),Ji(e)}var qn=/\u0000/g,sf=/[\u0001-\u0006]/g;function Tc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Xa(t,e){var r=""+t;return r.length>=e?r:yr("0",e-r.length)+r}function _x(t,e){var r=""+t;return r.length>=e?r:yr(" ",e-r.length)+r}function G0(t,e){var r=""+t;return r.length>=e?r:r+yr(" ",e-r.length)}function zj(t,e){var r=""+Math.round(t);return r.length>=e?r:yr("0",e-r.length)+r}function Hj(t,e){var r=""+t;return r.length>=e?r:yr("0",e-r.length)+r}var u4=Math.pow(2,32);function cc(t,e){if(t>u4||t<-u4)return zj(t,e);var r=Math.round(t);return Hj(r,e)}function q0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var f4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ng=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Gj(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},h4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $0(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,d=1,m=0,g=0,y=Math.floor(a);m<e&&(y=Math.floor(a),u=y*l+o,g=y*m+d,!(a-y<5e-8));)a=1/(a-y),o=l,l=u,d=m,m=g;if(g>e&&(m>e?(g=d,u=o):(g=m,u=l)),!r)return[0,n*u,g];var _=Math.floor(n*u/g);return[_,n*u-_*g,g]}function el(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),n<60&&(o=(o+6)%7),r&&(o=Qj(d,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var mA=new Date(1899,11,31,0,0,0),$j=mA.getTime(),Yj=new Date(1900,2,1,0,0,0);function pA(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Yj&&(r+=24*60*60*1e3),(r-($j+(t.getTimezoneOffset()-mA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function yx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wj(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kj(t){var e=t<0?12:11,r=yx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Xj(t){var e=yx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Ff(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Kj(t):e===10?r=t.toFixed(10).substr(0,12):r=Xj(t),yx(Wj(r.toUpperCase()))}function fl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Ff(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ja(14,pA(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Qj(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Jj(t,e,r,n){var a="",o=0,l=0,u=r.y,d,m=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:d=u%100,m=2;break;default:d=u%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:d=r.m,m=e.length;break;case 3:return ng[r.m-1][1];case 5:return ng[r.m-1][0];default:return ng[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=r.d,m=e.length;break;case 3:return f4[r.q][0];default:return f4[r.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(r.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=r.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=r.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Xa(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=Xa(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:d=u,m=1;break}var g=m>0?Xa(d,m):"";return g}function ro(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var gA=/%/g;function Zj(t,e,r){var n=e.replace(gA,""),a=e.length-n.length;return fi(t,n,r*Math.pow(10,2*a))+yr("%",a)}function eP(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function vA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,m,g){return d+m+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xA=/# (\?+)( ?)\/( ?)(\d+)/;function tP(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?yr(" ",t[1].length+1+t[4].length):_x(l,t[1].length)+t[2]+"/"+t[3]+Xa(u,t[4].length))}function rP(t,e,r){return r+(e===0?"":""+e)+yr(" ",t[1].length+2+t[4].length)}var _A=/^#*0*\.([0#]+)/,yA=/\).*[0#]/,EA=/\(###\) ###\\?-####/;function Vn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function d4(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function m4(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function nP(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function aP(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Da(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Da("n",n,r):"("+Da("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return eP(t,e,r);if(e.indexOf("%")!==-1)return Zj(t,e,r);if(e.indexOf("E")!==-1)return vA(e,r);if(e.charCodeAt(0)===36)return"$"+Da(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,d=Math.abs(r),m=r<0?"-":"";if(e.match(/^00+$/))return m+cc(d,e.length);if(e.match(/^[#?]+$/))return a=cc(r,0),a==="0"&&(a=""),a.length>e.length?a:Vn(e.substr(0,e.length-a.length))+a;if(o=e.match(xA))return tP(o,d,m);if(e.match(/^#+0+$/))return m+cc(d,e.length-e.indexOf("0"));if(o=e.match(_A))return a=d4(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Vn(o[1])).replace(/\.$/,"."+Vn(o[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+yr("0",Vn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+d4(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+ro(cc(d,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Da(t,e,-r):ro(""+(Math.floor(r)+nP(r,o[1].length)))+"."+Xa(m4(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Da(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Tc(Da(t,e.replace(/[\\-]/g,""),r)),l=0,Tc(Tc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(EA))return a=Da(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=$0(d,Math.pow(10,l)-1,!1),a=""+m,g=fi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=G0(u[2],l),g.length<o[4].length&&(g=Vn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=$0(d,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_x(u[1],l)+o[2]+"/"+o[3]+G0(u[2],l):yr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=cc(r,0),e.length<=a.length?a:Vn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return Vn(e.substr(0,y)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=m4(r,o[1].length),r<0?"-"+Da(t,e,-r):ro(aP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Xa(0,3-E.length):"")+E})+"."+Xa(l,o[1].length);switch(e){case"###,##0.00":return Da(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var T=ro(cc(d,0));return T!=="0"?m+T:"";case"###,###.00":return Da(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Da(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function sP(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function iP(t,e,r){var n=e.replace(gA,""),a=e.length-n.length;return fi(t,n,r*Math.pow(10,2*a))+yr("%",a)}function TA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+TA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,m,g){return d+m+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ws(t,e,r){if(t.charCodeAt(0)===40&&!e.match(yA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ws("n",n,r):"("+ws("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return sP(t,e,r);if(e.indexOf("%")!==-1)return iP(t,e,r);if(e.indexOf("E")!==-1)return TA(e,r);if(e.charCodeAt(0)===36)return"$"+ws(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,d=Math.abs(r),m=r<0?"-":"";if(e.match(/^00+$/))return m+Xa(d,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Vn(e.substr(0,e.length-a.length))+a;if(o=e.match(xA))return rP(o,d,m);if(e.match(/^#+0+$/))return m+Xa(d,e.length-e.indexOf("0"));if(o=e.match(_A))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Vn(o[1])).replace(/\.$/,"."+Vn(o[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+yr("0",Vn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+ro(""+d);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ws(t,e,-r):ro(""+r)+"."+yr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return ws(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Tc(ws(t,e.replace(/[\\-]/g,""),r)),l=0,Tc(Tc(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(EA))return a=ws(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=$0(d,Math.pow(10,l)-1,!1),a=""+m,g=fi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=G0(u[2],l),g.length<o[4].length&&(g=Vn(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=$0(d,Math.pow(10,l)-1,!0),m+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_x(u[1],l)+o[2]+"/"+o[3]+G0(u[2],l):yr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Vn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=e.indexOf(".")-l,_=e.length-a.length-y;return Vn(e.substr(0,y)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ws(t,e,-r):ro(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Xa(0,3-E.length):"")+E})+"."+Xa(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=ro(""+d);return T!=="0"?m+T:"";default:if(e.match(/\.[0#?]*$/))return ws(t,e.slice(0,e.lastIndexOf(".")),r)+Vn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function fi(t,e,r){return(r|0)===r?ws(t,e,r):Da(t,e,r)}function oP(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var wA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Yc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":q0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(wA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function lP(t,e,r,n){for(var a=[],o="",l=0,u="",d="t",m,g,y,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!q0(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(y=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(y);a[a.length]={t:"t",v:o},++l;break;case"\\":var T=t.charAt(++l),E=T==="("||T===")"?T:"t";a[a.length]={t:E,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(m==null&&(m=el(e,r,t.charAt(l+1)==="2"),m==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=el(e,r),m==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},d=u;break;case"A":case"a":case"上":var S={t:u,v:u};if(m==null&&(m=el(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(S.v=m.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(S.v=m.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="上午/下午"?(m!=null&&(S.v=m.H>=12?"下午":"上午"),S.t="T",l+=5,_="h"):(S.t="t",++l),m==null&&S.t==="T")return"";a[a.length]=S,d=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(wA)){if(m==null&&(m=el(e,r),m==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Yc(t)||(a[a.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},d=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var b=0,O=0,L;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,d="h",b<1&&(b=1);break;case"s":(L=a[l].v.match(/\.0+$/))&&(O=Math.max(O,L[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var A="",D;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=Jj(a[l].t.charCodeAt(0),a[l].v,m,O),a[l].t="t";break;case"n":case"?":for(D=l+1;a[D]!=null&&((u=a[D].t)==="?"||u==="D"||(u===" "||u==="t")&&a[D+1]!=null&&(a[D+1].t==="?"||a[D+1].t==="t"&&a[D+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[D].v==="/"||a[D].v===" "&&a[D+1]!=null&&a[D+1].t=="?"));)a[l].v+=a[D].v,a[D]={v:"",t:";"},++D;A+=a[l].v,l=D-1;break;case"G":a[l].t="t",a[l].v=fl(e,r);break}var V="",H,C;if(A.length>0){A.charCodeAt(0)==40?(H=e<0&&A.charCodeAt(0)===45?-e:e,C=fi("n",A,H)):(H=e<0&&n>1?-e:e,C=fi("n",A,H),H<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),D=C.length-1;var N=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){N=l;break}var R=a.length;if(N===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(D>=a[l].v.length-1?(D-=a[l].v.length,a[l].v=C.substr(D+1,a[l].v.length)):D<0?a[l].v="":(a[l].v=C.substr(0,D+1),D=-1),a[l].t="t",R=l);D>=0&&R<a.length&&(a[R].v=C.substr(0,D+1)+a[R].v)}else if(N!==a.length&&C.indexOf("E")===-1){for(D=C.indexOf(".")-1,l=N;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===N?a[l].v.indexOf(".")-1:a[l].v.length-1,V=a[l].v.substr(g+1);g>=0;--g)D>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(V=C.charAt(D--)+V);a[l].v=V,a[l].t="t",R=l}for(D>=0&&R<a.length&&(a[R].v=C.substr(0,D+1)+a[R].v),D=C.indexOf(".")+1,l=N;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==N)){for(g=a[l].v.indexOf(".")>-1&&l===N?a[l].v.indexOf(".")+1:0,V=a[l].v.substr(0,g);g<a[l].v.length;++g)D<C.length&&(V+=C.charAt(D++));a[l].v=V,a[l].t="t",R=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(H=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=fi(a[l].t,a[l].v,H),a[l].t="t");var F="";for(l=0;l!==a.length;++l)a[l]!=null&&(F+=a[l].v);return F}var p4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function g4(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function cP(t,e){var r=oP(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(p4),u=r[1].match(p4);return g4(e,l)?[n,r[0]]:g4(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function ja(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[t],n==null&&(n=r.table&&r.table[h4[t]]||xt[h4[t]]),n==null&&(n=qj[t]||"General");break}if(q0(n,0))return fl(e,r);e instanceof Date&&(e=pA(e,r.date1904));var a=cP(n,e);if(q0(a[1]))return fl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return lP(a[1],e,r,a[0])}function tl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(xt[r]==null){e<0&&(e=r);continue}if(xt[r]==t){e=r;break}}e<0&&(e=391)}return xt[e]=t,e}function SA(){xt=Gj()}var uP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},bA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fP(t){var e=typeof t=="number"?xt[t]:t;return e=e.replace(bA,"(\\d+)"),new RegExp("^"+e+"$")}function hP(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,d=-1;(e.match(bA)||[]).forEach(function(y,_){var T=parseInt(r[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=T;break;case"d":o=T;break;case"h":l=T;break;case"s":d=T;break;case"m":l>=0?u=T:a=T;break}}),d>=0&&u==-1&&a>=0&&(u=a,a=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&u==-1&&d==-1?m:n==-1&&a==-1&&o==-1?g:m+"T"+g}var dP=function(){var t={};t.version="1.2.0";function e(){for(var C=0,N=new Array(256),R=0;R!=256;++R)C=R,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,N[R]=C;return typeof Int32Array<"u"?new Int32Array(N):N}var r=e();function n(C){var N=0,R=0,F=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)P[F]=C[F];for(F=0;F!=256;++F)for(R=C[F],N=256+F;N<4096;N+=256)R=P[N]=R>>>8^C[R&255];var M=[];for(F=1;F!=16;++F)M[F-1]=typeof Int32Array<"u"?P.subarray(F*256,F*256+256):P.slice(F*256,F*256+256);return M}var a=n(r),o=a[0],l=a[1],u=a[2],d=a[3],m=a[4],g=a[5],y=a[6],_=a[7],T=a[8],E=a[9],S=a[10],b=a[11],O=a[12],L=a[13],A=a[14];function D(C,N){for(var R=N^-1,F=0,P=C.length;F<P;)R=R>>>8^r[(R^C.charCodeAt(F++))&255];return~R}function V(C,N){for(var R=N^-1,F=C.length-15,P=0;P<F;)R=A[C[P++]^R&255]^L[C[P++]^R>>8&255]^O[C[P++]^R>>16&255]^b[C[P++]^R>>>24]^S[C[P++]]^E[C[P++]]^T[C[P++]]^_[C[P++]]^y[C[P++]]^g[C[P++]]^m[C[P++]]^d[C[P++]]^u[C[P++]]^l[C[P++]]^o[C[P++]]^r[C[P++]];for(F+=15;P<F;)R=R>>>8^r[(R^C[P++])&255];return~R}function H(C,N){for(var R=N^-1,F=0,P=C.length,M=0,U=0;F<P;)M=C.charCodeAt(F++),M<128?R=R>>>8^r[(R^M)&255]:M<2048?(R=R>>>8^r[(R^(192|M>>6&31))&255],R=R>>>8^r[(R^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,U=C.charCodeAt(F++)&1023,R=R>>>8^r[(R^(240|M>>8&7))&255],R=R>>>8^r[(R^(128|M>>2&63))&255],R=R>>>8^r[(R^(128|U>>6&15|(M&3)<<4))&255],R=R>>>8^r[(R^(128|U&63))&255]):(R=R>>>8^r[(R^(224|M>>12&15))&255],R=R>>>8^r[(R^(128|M>>6&63))&255],R=R>>>8^r[(R^(128|M&63))&255]);return~R}return t.table=r,t.bstr=D,t.buf=V,t.str=H,t}(),Mt=function(){var e={};e.version="1.2.1";function r(j,Z){for(var Y=j.split("/"),W=Z.split("/"),J=0,te=0,de=Math.min(Y.length,W.length);J<de;++J){if(te=Y[J].length-W[J].length)return te;if(Y[J]!=W[J])return Y[J]<W[J]?-1:1}return Y.length-W.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var Z=j.lastIndexOf("/");return Z===-1?j:j.slice(0,Z+1)}function a(j){if(j.charAt(j.length-1)=="/")return a(j.slice(0,-1));var Z=j.lastIndexOf("/");return Z===-1?j:j.slice(Z+1)}function o(j,Z){typeof Z=="string"&&(Z=new Date(Z));var Y=Z.getHours();Y=Y<<6|Z.getMinutes(),Y=Y<<5|Z.getSeconds()>>>1,j.write_shift(2,Y);var W=Z.getFullYear()-1980;W=W<<4|Z.getMonth()+1,W=W<<5|Z.getDate(),j.write_shift(2,W)}function l(j){var Z=j.read_shift(2)&65535,Y=j.read_shift(2)&65535,W=new Date,J=Y&31;Y>>>=5;var te=Y&15;Y>>>=4,W.setMilliseconds(0),W.setFullYear(Y+1980),W.setMonth(te-1),W.setDate(J);var de=Z&31;Z>>>=5;var Te=Z&63;return Z>>>=6,W.setHours(Z),W.setMinutes(Te),W.setSeconds(de<<1),W}function u(j){fn(j,0);for(var Z={},Y=0;j.l<=j.length-4;){var W=j.read_shift(2),J=j.read_shift(2),te=j.l+J,de={};switch(W){case 21589:Y=j.read_shift(1),Y&1&&(de.mtime=j.read_shift(4)),J>5&&(Y&2&&(de.atime=j.read_shift(4)),Y&4&&(de.ctime=j.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}j.l=te,Z[W]=de}return Z}var d;function m(){return d||(d={})}function g(j,Z){if(j[0]==80&&j[1]==75)return Fa(j,Z);if((j[0]|32)==109&&(j[1]|32)==105)return wl(j,Z);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var Y=3,W=512,J=0,te=0,de=0,Te=0,ce=0,ge=[],ve=j.slice(0,512);fn(ve,0);var Oe=y(ve);switch(Y=Oe[0],Y){case 3:W=512;break;case 4:W=4096;break;case 0:if(Oe[1]==0)return Fa(j,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}W!==512&&(ve=j.slice(0,W),fn(ve,28));var Be=j.slice(0,W);_(ve,Y);var $e=ve.read_shift(4,"i");if(Y===3&&$e!==0)throw new Error("# Directory Sectors: Expected 0 saw "+$e);ve.l+=4,de=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Te=ve.read_shift(4,"i"),J=ve.read_shift(4,"i"),ce=ve.read_shift(4,"i"),te=ve.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=ve.read_shift(4,"i"),!(Le<0));++Ge)ge[Ge]=Le;var ct=T(j,W);b(ce,te,ct,W,ge);var Ht=L(ct,de,ge,W);Ht[de].name="!Directory",J>0&&Te!==U&&(Ht[Te].name="!MiniFAT"),Ht[ge[0]].name="!FAT",Ht.fat_addrs=ge,Ht.ssz=W;var Dt={},Ot=[],na=[],ls=[];A(de,Ht,ct,Ot,J,Dt,na,Te),E(na,ls,Ot),Ot.shift();var Pn={FileIndex:na,FullPaths:ls};return Z&&Z.raw&&(Pn.raw={header:Be,sectors:ct}),Pn}function y(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(Me,"Header Signature: "),j.l+=16;var Z=j.read_shift(2,"u");return[j.read_shift(2,"u"),Z]}function _(j,Z){var Y=9;switch(j.l+=2,Y=j.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function T(j,Z){for(var Y=Math.ceil(j.length/Z)-1,W=[],J=1;J<Y;++J)W[J-1]=j.slice(J*Z,(J+1)*Z);return W[Y-1]=j.slice(Y*Z),W}function E(j,Z,Y){for(var W=0,J=0,te=0,de=0,Te=0,ce=Y.length,ge=[],ve=[];W<ce;++W)ge[W]=ve[W]=W,Z[W]=Y[W];for(;Te<ve.length;++Te)W=ve[Te],J=j[W].L,te=j[W].R,de=j[W].C,ge[W]===W&&(J!==-1&&ge[J]!==J&&(ge[W]=ge[J]),te!==-1&&ge[te]!==te&&(ge[W]=ge[te])),de!==-1&&(ge[de]=W),J!==-1&&W!=ge[W]&&(ge[J]=ge[W],ve.lastIndexOf(J)<Te&&ve.push(J)),te!==-1&&W!=ge[W]&&(ge[te]=ge[W],ve.lastIndexOf(te)<Te&&ve.push(te));for(W=1;W<ce;++W)ge[W]===W&&(te!==-1&&ge[te]!==te?ge[W]=ge[te]:J!==-1&&ge[J]!==J&&(ge[W]=ge[J]));for(W=1;W<ce;++W)if(j[W].type!==0){if(Te=W,Te!=ge[Te])do Te=ge[Te],Z[W]=Z[Te]+"/"+Z[W];while(Te!==0&&ge[Te]!==-1&&Te!=ge[Te]);ge[W]=-1}for(Z[0]+="/",W=1;W<ce;++W)j[W].type!==2&&(Z[W]+="/")}function S(j,Z,Y){for(var W=j.start,J=j.size,te=[],de=W;Y&&J>0&&de>=0;)te.push(Z.slice(de*M,de*M+M)),J-=M,de=Jo(Y,de*4);return te.length===0?Hr(0):Ji(te).slice(0,j.size)}function b(j,Z,Y,W,J){var te=U;if(j===U){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var de=Y[j],Te=(W>>>2)-1;if(!de)return;for(var ce=0;ce<Te&&(te=Jo(de,ce*4))!==U;++ce)J.push(te);b(Jo(de,W-4),Z-1,Y,W,J)}}function O(j,Z,Y,W,J){var te=[],de=[];J||(J=[]);var Te=W-1,ce=0,ge=0;for(ce=Z;ce>=0;){J[ce]=!0,te[te.length]=ce,de.push(j[ce]);var ve=Y[Math.floor(ce*4/W)];if(ge=ce*4&Te,W<4+ge)throw new Error("FAT boundary crossed: "+ce+" 4 "+W);if(!j[ve])break;ce=Jo(j[ve],ge)}return{nodes:te,data:A4([de])}}function L(j,Z,Y,W){var J=j.length,te=[],de=[],Te=[],ce=[],ge=W-1,ve=0,Oe=0,Be=0,$e=0;for(ve=0;ve<J;++ve)if(Te=[],Be=ve+Z,Be>=J&&(Be-=J),!de[Be]){ce=[];var Le=[];for(Oe=Be;Oe>=0;){Le[Oe]=!0,de[Oe]=!0,Te[Te.length]=Oe,ce.push(j[Oe]);var Ge=Y[Math.floor(Oe*4/W)];if($e=Oe*4&ge,W<4+$e)throw new Error("FAT boundary crossed: "+Oe+" 4 "+W);if(!j[Ge]||(Oe=Jo(j[Ge],$e),Le[Oe]))break}te[Be]={nodes:Te,data:A4([ce])}}return te}function A(j,Z,Y,W,J,te,de,Te){for(var ce=0,ge=W.length?2:0,ve=Z[j].data,Oe=0,Be=0,$e;Oe<ve.length;Oe+=128){var Le=ve.slice(Oe,Oe+128);fn(Le,64),Be=Le.read_shift(2),$e=bx(Le,0,Be-ge),W.push($e);var Ge={name:$e,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},ct=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);ct!==0&&(Ge.ct=D(Le,Le.l-8));var Ht=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ht!==0&&(Ge.mt=D(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=U,Ge.name=""),Ge.type===5?(ce=Ge.start,J>0&&ce!==U&&(Z[ce].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",Z[Ge.start]===void 0&&(Z[Ge.start]=O(Y,Ge.start,Z.fat_addrs,Z.ssz)),Z[Ge.start].name=Ge.name,Ge.content=Z[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:ce!==U&&Ge.start!==U&&Z[ce]&&(Ge.content=S(Ge,Z[ce].data,(Z[Te]||{}).data))),Ge.content&&fn(Ge.content,0),te[$e]=Ge,de.push(Ge)}}function D(j,Z){return new Date((ha(j,Z+4)/1e7*Math.pow(2,32)+ha(j,Z)/1e7-11644473600)*1e3)}function V(j,Z){return m(),g(d.readFileSync(j),Z)}function H(j,Z){var Y=Z&&Z.type;switch(Y||kt&&Buffer.isBuffer(j)&&(Y="buffer"),Y||"base64"){case"file":return V(j,Z);case"base64":return g(qa(va(j)),Z);case"binary":return g(qa(j),Z)}return g(j,Z)}function C(j,Z){var Y=Z||{},W=Y.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=W+"/",j.FileIndex[0]={name:W,type:5}),Y.CLSID&&(j.FileIndex[0].clsid=Y.CLSID),N(j)}function N(j){var Z="Sh33tJ5";if(!Mt.find(j,"/"+Z)){var Y=Hr(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,j.FileIndex.push({name:Z,type:2,content:Y,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+Z),R(j)}}function R(j,Z){C(j);for(var Y=!1,W=!1,J=j.FullPaths.length-1;J>=0;--J){var te=j.FileIndex[J];switch(te.type){case 0:W?Y=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:W=!0,isNaN(te.R*te.L*te.C)&&(Y=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!Z)){var de=new Date(1987,1,19),Te=0,ce=Object.create?Object.create(null):{},ge=[];for(J=0;J<j.FullPaths.length;++J)ce[j.FullPaths[J]]=!0,j.FileIndex[J].type!==0&&ge.push([j.FullPaths[J],j.FileIndex[J]]);for(J=0;J<ge.length;++J){var ve=n(ge[J][0]);W=ce[ve],W||(ge.push([ve,{name:a(ve).replace("/",""),type:1,clsid:ie,ct:de,mt:de,content:null}]),ce[ve]=!0)}for(ge.sort(function($e,Le){return r($e[0],Le[0])}),j.FullPaths=[],j.FileIndex=[],J=0;J<ge.length;++J)j.FullPaths[J]=ge[J][0],j.FileIndex[J]=ge[J][1];for(J=0;J<ge.length;++J){var Oe=j.FileIndex[J],Be=j.FullPaths[J];if(Oe.name=a(Be).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ie,J===0)Oe.C=ge.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Be.slice(-1)=="/"){for(Te=J+1;Te<ge.length&&n(j.FullPaths[Te])!=Be;++Te);for(Oe.C=Te>=ge.length?-1:Te,Te=J+1;Te<ge.length&&n(j.FullPaths[Te])!=n(Be);++Te);Oe.R=Te>=ge.length?-1:Te,Oe.type=1}else n(j.FullPaths[J+1]||"")==n(Be)&&(Oe.R=J+1),Oe.type=2}}}function F(j,Z){var Y=Z||{};if(Y.fileType=="mad")return ar(j,Y);switch(R(j),Y.fileType){case"zip":return La(j,Y)}var W=function($e){for(var Le=0,Ge=0,ct=0;ct<$e.FileIndex.length;++ct){var Ht=$e.FileIndex[ct];if(Ht.content){var Dt=Ht.content.length;Dt>0&&(Dt<4096?Le+=Dt+63>>6:Ge+=Dt+511>>9)}}for(var Ot=$e.FullPaths.length+3>>2,na=Le+7>>3,ls=Le+127>>7,Pn=na+Ge+Ot+ls,Kn=Pn+127>>7,cs=Kn<=109?0:Math.ceil((Kn-109)/127);Pn+Kn+cs+127>>7>Kn;)cs=++Kn<=109?0:Math.ceil((Kn-109)/127);var Fn=[1,cs,Kn,ls,Ot,Ge,Le,0];return $e.FileIndex[0].size=Le<<6,Fn[7]=($e.FileIndex[0].start=Fn[0]+Fn[1]+Fn[2]+Fn[3]+Fn[4]+Fn[5])+(Fn[6]+7>>3),Fn}(j),J=Hr(W[7]<<9),te=0,de=0;{for(te=0;te<8;++te)J.write_shift(1,Ne[te]);for(te=0;te<8;++te)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),te=0;te<3;++te)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,W[2]),J.write_shift(4,W[0]+W[1]+W[2]+W[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,W[3]?W[0]+W[1]+W[2]-1:U),J.write_shift(4,W[3]),J.write_shift(-4,W[1]?W[0]-1:U),J.write_shift(4,W[1]),te=0;te<109;++te)J.write_shift(-4,te<W[2]?W[1]+te:-1)}if(W[1])for(de=0;de<W[1];++de){for(;te<236+de*127;++te)J.write_shift(-4,te<W[2]?W[1]+te:-1);J.write_shift(-4,de===W[1]-1?U:de+1)}var Te=function($e){for(de+=$e;te<de-1;++te)J.write_shift(-4,te+1);$e&&(++te,J.write_shift(-4,U))};for(de=te=0,de+=W[1];te<de;++te)J.write_shift(-4,me.DIFSECT);for(de+=W[2];te<de;++te)J.write_shift(-4,me.FATSECT);Te(W[3]),Te(W[4]);for(var ce=0,ge=0,ve=j.FileIndex[0];ce<j.FileIndex.length;++ce)ve=j.FileIndex[ce],ve.content&&(ge=ve.content.length,!(ge<4096)&&(ve.start=de,Te(ge+511>>9)));for(Te(W[6]+7>>3);J.l&511;)J.write_shift(-4,me.ENDOFCHAIN);for(de=te=0,ce=0;ce<j.FileIndex.length;++ce)ve=j.FileIndex[ce],ve.content&&(ge=ve.content.length,!(!ge||ge>=4096)&&(ve.start=de,Te(ge+63>>6)));for(;J.l&511;)J.write_shift(-4,me.ENDOFCHAIN);for(te=0;te<W[4]<<2;++te){var Oe=j.FullPaths[te];if(!Oe||Oe.length===0){for(ce=0;ce<17;++ce)J.write_shift(4,0);for(ce=0;ce<3;++ce)J.write_shift(4,-1);for(ce=0;ce<12;++ce)J.write_shift(4,0);continue}ve=j.FileIndex[te],te===0&&(ve.start=ve.size?ve.start-1:U);var Be=te===0&&Y.root||ve.name;if(ge=2*(Be.length+1),J.write_shift(64,Be,"utf16le"),J.write_shift(2,ge),J.write_shift(1,ve.type),J.write_shift(1,ve.color),J.write_shift(-4,ve.L),J.write_shift(-4,ve.R),J.write_shift(-4,ve.C),ve.clsid)J.write_shift(16,ve.clsid,"hex");else for(ce=0;ce<4;++ce)J.write_shift(4,0);J.write_shift(4,ve.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,ve.start),J.write_shift(4,ve.size),J.write_shift(4,0)}for(te=1;te<j.FileIndex.length;++te)if(ve=j.FileIndex[te],ve.size>=4096)if(J.l=ve.start+1<<9,kt&&Buffer.isBuffer(ve.content))ve.content.copy(J,J.l,0,ve.size),J.l+=ve.size+511&-512;else{for(ce=0;ce<ve.size;++ce)J.write_shift(1,ve.content[ce]);for(;ce&511;++ce)J.write_shift(1,0)}for(te=1;te<j.FileIndex.length;++te)if(ve=j.FileIndex[te],ve.size>0&&ve.size<4096)if(kt&&Buffer.isBuffer(ve.content))ve.content.copy(J,J.l,0,ve.size),J.l+=ve.size+63&-64;else{for(ce=0;ce<ve.size;++ce)J.write_shift(1,ve.content[ce]);for(;ce&63;++ce)J.write_shift(1,0)}if(kt)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function P(j,Z){var Y=j.FullPaths.map(function(ce){return ce.toUpperCase()}),W=Y.map(function(ce){var ge=ce.split("/");return ge[ge.length-(ce.slice(-1)=="/"?2:1)]}),J=!1;Z.charCodeAt(0)===47?(J=!0,Z=Y[0].slice(0,-1)+Z):J=Z.indexOf("/")!==-1;var te=Z.toUpperCase(),de=J===!0?Y.indexOf(te):W.indexOf(te);if(de!==-1)return j.FileIndex[de];var Te=!te.match(sf);for(te=te.replace(qn,""),Te&&(te=te.replace(sf,"!")),de=0;de<Y.length;++de)if((Te?Y[de].replace(sf,"!"):Y[de]).replace(qn,"")==te||(Te?W[de].replace(sf,"!"):W[de]).replace(qn,"")==te)return j.FileIndex[de];return null}var M=64,U=-2,Me="d0cf11e0a1b11ae1",Ne=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:Me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(j,Z,Y){m();var W=F(j,Y);d.writeFileSync(Z,W)}function oe(j){for(var Z=new Array(j.length),Y=0;Y<j.length;++Y)Z[Y]=String.fromCharCode(j[Y]);return Z.join("")}function ee(j,Z){var Y=F(j,Z);switch(Z&&Z.type||"buffer"){case"file":return m(),d.writeFileSync(Z.filename,Y),Y;case"binary":return typeof Y=="string"?Y:oe(Y);case"base64":return l4(typeof Y=="string"?Y:oe(Y));case"buffer":if(kt)return Buffer.isBuffer(Y)?Y:vl(Y);case"array":return typeof Y=="string"?qa(Y):Y}return Y}var ue;function z(j){try{var Z=j.InflateRaw,Y=new Z;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)ue=j;else throw new Error("zlib does not expose bytesRead")}catch(W){console.error("cannot use native zlib: "+(W.message||W))}}function X(j,Z){if(!ue)return ra(j,Z);var Y=ue.InflateRaw,W=new Y,J=W._processChunk(j.slice(j.l),W._finishFlushFlag);return j.l+=W.bytesRead,J}function G(j){return ue?ue.deflateRawSync(j):tt(j)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(j){var Z=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Ae=typeof Uint8Array<"u",be=Ae?new Uint8Array(256):[],Ze=0;Ze<256;++Ze)be[Ze]=Ee(Ze);function re(j,Z){var Y=be[j&255];return Z<=8?Y>>>8-Z:(Y=Y<<8|be[j>>8&255],Z<=16?Y>>>16-Z:(Y=Y<<8|be[j>>16&255],Y>>>24-Z))}function Ct(j,Z){var Y=Z&7,W=Z>>>3;return(j[W]|(Y<=6?0:j[W+1]<<8))>>>Y&3}function We(j,Z){var Y=Z&7,W=Z>>>3;return(j[W]|(Y<=5?0:j[W+1]<<8))>>>Y&7}function lt(j,Z){var Y=Z&7,W=Z>>>3;return(j[W]|(Y<=4?0:j[W+1]<<8))>>>Y&15}function Fe(j,Z){var Y=Z&7,W=Z>>>3;return(j[W]|(Y<=3?0:j[W+1]<<8))>>>Y&31}function je(j,Z){var Y=Z&7,W=Z>>>3;return(j[W]|(Y<=1?0:j[W+1]<<8))>>>Y&127}function Wt(j,Z,Y){var W=Z&7,J=Z>>>3,te=(1<<Y)-1,de=j[J]>>>W;return Y<8-W||(de|=j[J+1]<<8-W,Y<16-W)||(de|=j[J+2]<<16-W,Y<24-W)||(de|=j[J+3]<<24-W),de&te}function Tr(j,Z,Y){var W=Z&7,J=Z>>>3;return W<=5?j[J]|=(Y&7)<<W:(j[J]|=Y<<W&255,j[J+1]=(Y&7)>>8-W),Z+3}function Rr(j,Z,Y){var W=Z&7,J=Z>>>3;return Y=(Y&1)<<W,j[J]|=Y,Z+1}function tr(j,Z,Y){var W=Z&7,J=Z>>>3;return Y<<=W,j[J]|=Y&255,Y>>>=8,j[J+1]=Y,Z+8}function On(j,Z,Y){var W=Z&7,J=Z>>>3;return Y<<=W,j[J]|=Y&255,Y>>>=8,j[J+1]=Y&255,j[J+2]=Y>>>8,Z+16}function lr(j,Z){var Y=j.length,W=2*Y>Z?2*Y:Z+5,J=0;if(Y>=Z)return j;if(kt){var te=c4(W);if(j.copy)j.copy(te);else for(;J<j.length;++J)te[J]=j[J];return te}else if(Ae){var de=new Uint8Array(W);if(de.set)de.set(j);else for(;J<Y;++J)de[J]=j[J];return de}return j.length=W,j}function wr(j){for(var Z=new Array(j),Y=0;Y<j;++Y)Z[Y]=0;return Z}function Wr(j,Z,Y){var W=1,J=0,te=0,de=0,Te=0,ce=j.length,ge=Ae?new Uint16Array(32):wr(32);for(te=0;te<32;++te)ge[te]=0;for(te=ce;te<Y;++te)j[te]=0;ce=j.length;var ve=Ae?new Uint16Array(ce):wr(ce);for(te=0;te<ce;++te)ge[J=j[te]]++,W<J&&(W=J),ve[te]=0;for(ge[0]=0,te=1;te<=W;++te)ge[te+16]=Te=Te+ge[te-1]<<1;for(te=0;te<ce;++te)Te=j[te],Te!=0&&(ve[te]=ge[Te+16]++);var Oe=0;for(te=0;te<ce;++te)if(Oe=j[te],Oe!=0)for(Te=re(ve[te],W)>>W-Oe,de=(1<<W+4-Oe)-1;de>=0;--de)Z[Te|de<<Oe]=Oe&15|te<<4;return W}var It=Ae?new Uint16Array(512):wr(512),Se=Ae?new Uint16Array(32):wr(32);if(!Ae){for(var Ke=0;Ke<512;++Ke)It[Ke]=0;for(Ke=0;Ke<32;++Ke)Se[Ke]=0}(function(){for(var j=[],Z=0;Z<32;Z++)j.push(5);Wr(j,Se,32);var Y=[];for(Z=0;Z<=143;Z++)Y.push(8);for(;Z<=255;Z++)Y.push(9);for(;Z<=279;Z++)Y.push(7);for(;Z<=287;Z++)Y.push(8);Wr(Y,It,288)})();var Je=function(){for(var Z=Ae?new Uint8Array(32768):[],Y=0,W=0;Y<ye.length-1;++Y)for(;W<ye[Y+1];++W)Z[W]=Y;for(;W<32768;++W)Z[W]=29;var J=Ae?new Uint8Array(259):[];for(Y=0,W=0;Y<Q.length-1;++Y)for(;W<Q[Y+1];++W)J[W]=Y;function te(Te,ce){for(var ge=0;ge<Te.length;){var ve=Math.min(65535,Te.length-ge),Oe=ge+ve==Te.length;for(ce.write_shift(1,+Oe),ce.write_shift(2,ve),ce.write_shift(2,~ve&65535);ve-- >0;)ce[ce.l++]=Te[ge++]}return ce.l}function de(Te,ce){for(var ge=0,ve=0,Oe=Ae?new Uint16Array(32768):[];ve<Te.length;){var Be=Math.min(65535,Te.length-ve);if(Be<10){for(ge=Tr(ce,ge,+(ve+Be==Te.length)),ge&7&&(ge+=8-(ge&7)),ce.l=ge/8|0,ce.write_shift(2,Be),ce.write_shift(2,~Be&65535);Be-- >0;)ce[ce.l++]=Te[ve++];ge=ce.l*8;continue}ge=Tr(ce,ge,+(ve+Be==Te.length)+2);for(var $e=0;Be-- >0;){var Le=Te[ve];$e=($e<<5^Le)&32767;var Ge=-1,ct=0;if((Ge=Oe[$e])&&(Ge|=ve&-32768,Ge>ve&&(Ge-=32768),Ge<ve))for(;Te[Ge+ct]==Te[ve+ct]&&ct<250;)++ct;if(ct>2){Le=J[ct],Le<=22?ge=tr(ce,ge,be[Le+1]>>1)-1:(tr(ce,ge,3),ge+=5,tr(ce,ge,be[Le-23]>>5),ge+=3);var Ht=Le<8?0:Le-4>>2;Ht>0&&(On(ce,ge,ct-Q[Le]),ge+=Ht),Le=Z[ve-Ge],ge=tr(ce,ge,be[Le]>>3),ge-=3;var Dt=Le<4?0:Le-2>>1;Dt>0&&(On(ce,ge,ve-Ge-ye[Le]),ge+=Dt);for(var Ot=0;Ot<ct;++Ot)Oe[$e]=ve&32767,$e=($e<<5^Te[ve])&32767,++ve;Be-=ct-1}else Le<=143?Le=Le+48:ge=Rr(ce,ge,1),ge=tr(ce,ge,be[Le]),Oe[$e]=ve&32767,++ve}ge=tr(ce,ge,0)-1}return ce.l=(ge+7)/8|0,ce.l}return function(ce,ge){return ce.length<8?te(ce,ge):de(ce,ge)}}();function tt(j){var Z=Hr(50+Math.floor(j.length*1.1)),Y=Je(j,Z);return Z.slice(0,Y)}var wt=Ae?new Uint16Array(32768):wr(32768),St=Ae?new Uint16Array(32768):wr(32768),gt=Ae?new Uint16Array(128):wr(128),or=1,cr=1;function xn(j,Z){var Y=Fe(j,Z)+257;Z+=5;var W=Fe(j,Z)+1;Z+=5;var J=lt(j,Z)+4;Z+=4;for(var te=0,de=Ae?new Uint8Array(19):wr(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ge=Ae?new Uint8Array(8):wr(8),ve=Ae?new Uint8Array(8):wr(8),Oe=de.length,Be=0;Be<J;++Be)de[K[Be]]=te=We(j,Z),ce<te&&(ce=te),ge[te]++,Z+=3;var $e=0;for(ge[0]=0,Be=1;Be<=ce;++Be)ve[Be]=$e=$e+ge[Be-1]<<1;for(Be=0;Be<Oe;++Be)($e=de[Be])!=0&&(Te[Be]=ve[$e]++);var Le=0;for(Be=0;Be<Oe;++Be)if(Le=de[Be],Le!=0){$e=be[Te[Be]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)gt[$e|Ge<<Le]=Le&7|Be<<3}var ct=[];for(ce=1;ct.length<Y+W;)switch($e=gt[je(j,Z)],Z+=$e&7,$e>>>=3){case 16:for(te=3+Ct(j,Z),Z+=2,$e=ct[ct.length-1];te-- >0;)ct.push($e);break;case 17:for(te=3+We(j,Z),Z+=3;te-- >0;)ct.push(0);break;case 18:for(te=11+je(j,Z),Z+=7;te-- >0;)ct.push(0);break;default:ct.push($e),ce<$e&&(ce=$e);break}var Ht=ct.slice(0,Y),Dt=ct.slice(Y);for(Be=Y;Be<286;++Be)Ht[Be]=0;for(Be=W;Be<30;++Be)Dt[Be]=0;return or=Wr(Ht,wt,286),cr=Wr(Dt,St,30),Z}function qt(j,Z){if(j[0]==3&&!(j[1]&3))return[go(Z),2];for(var Y=0,W=0,J=c4(Z||1<<18),te=0,de=J.length>>>0,Te=0,ce=0;(W&1)==0;){if(W=We(j,Y),Y+=3,W>>>1)W>>1==1?(Te=9,ce=5):(Y=xn(j,Y),Te=or,ce=cr);else{Y&7&&(Y+=8-(Y&7));var ge=j[Y>>>3]|j[(Y>>>3)+1]<<8;if(Y+=32,ge>0)for(!Z&&de<te+ge&&(J=lr(J,te+ge),de=J.length);ge-- >0;)J[te++]=j[Y>>>3],Y+=8;continue}for(;;){!Z&&de<te+32767&&(J=lr(J,te+32767),de=J.length);var ve=Wt(j,Y,Te),Oe=W>>>1==1?It[ve]:wt[ve];if(Y+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)J[te++]=Oe;else{if(Oe==256)break;Oe-=257;var Be=Oe<8?0:Oe-4>>2;Be>5&&(Be=0);var $e=te+Q[Oe];Be>0&&($e+=Wt(j,Y,Be),Y+=Be),ve=Wt(j,Y,ce),Oe=W>>>1==1?Se[ve]:St[ve],Y+=Oe&15,Oe>>>=4;var Le=Oe<4?0:Oe-2>>1,Ge=ye[Oe];for(Le>0&&(Ge+=Wt(j,Y,Le),Y+=Le),!Z&&de<$e&&(J=lr(J,$e+100),de=J.length);te<$e;)J[te]=J[te-Ge],++te}}}return Z?[J,Y+7>>>3]:[J.slice(0,te),Y+7>>>3]}function ra(j,Z){var Y=j.slice(j.l||0),W=qt(Y,Z);return j.l+=W[1],W[0]}function jn(j,Z){if(j)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function Fa(j,Z){var Y=j;fn(Y,0);var W=[],J=[],te={FileIndex:W,FullPaths:J};C(te,{root:Z.root});for(var de=Y.length-4;(Y[de]!=80||Y[de+1]!=75||Y[de+2]!=5||Y[de+3]!=6)&&de>=0;)--de;Y.l=de+4,Y.l+=4;var Te=Y.read_shift(2);Y.l+=6;var ce=Y.read_shift(4);for(Y.l=ce,de=0;de<Te;++de){Y.l+=20;var ge=Y.read_shift(4),ve=Y.read_shift(4),Oe=Y.read_shift(2),Be=Y.read_shift(2),$e=Y.read_shift(2);Y.l+=8;var Le=Y.read_shift(4),Ge=u(Y.slice(Y.l+Oe,Y.l+Oe+Be));Y.l+=Oe+Be+$e;var ct=Y.l;Y.l=Le+4,Yn(Y,ge,ve,te,Ge),Y.l=ct}return te}function Yn(j,Z,Y,W,J){j.l+=2;var te=j.read_shift(2),de=j.read_shift(2),Te=l(j);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var ce=j.read_shift(4),ge=j.read_shift(4),ve=j.read_shift(4),Oe=j.read_shift(2),Be=j.read_shift(2),$e="",Le=0;Le<Oe;++Le)$e+=String.fromCharCode(j[j.l++]);if(Be){var Ge=u(j.slice(j.l,j.l+Be));(Ge[21589]||{}).mt&&(Te=Ge[21589].mt),((J||{})[21589]||{}).mt&&(Te=J[21589].mt)}j.l+=Be;var ct=j.slice(j.l,j.l+ge);switch(de){case 8:ct=X(j,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Ht=!1;te&8&&(ce=j.read_shift(4),ce==134695760&&(ce=j.read_shift(4),Ht=!0),ge=j.read_shift(4),ve=j.read_shift(4)),ge!=Z&&jn(Ht,"Bad compressed size: "+Z+" != "+ge),ve!=Y&&jn(Ht,"Bad uncompressed size: "+Y+" != "+ve),ur(W,$e,ct,{unsafe:!0,mt:Te})}function La(j,Z){var Y=Z||{},W=[],J=[],te=Hr(1),de=Y.compression?8:0,Te=0,ce=0,ge=0,ve=0,Oe=0,Be=j.FullPaths[0],$e=Be,Le=j.FileIndex[0],Ge=[],ct=0;for(ce=1;ce<j.FullPaths.length;++ce)if($e=j.FullPaths[ce].slice(Be.length),Le=j.FileIndex[ce],!(!Le.size||!Le.content||$e=="Sh33tJ5")){var Ht=ve,Dt=Hr($e.length);for(ge=0;ge<$e.length;++ge)Dt.write_shift(1,$e.charCodeAt(ge)&127);Dt=Dt.slice(0,Dt.l),Ge[Oe]=dP.buf(Le.content,0);var Ot=Le.content;de==8&&(Ot=G(Ot)),te=Hr(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Te),te.write_shift(2,de),Le.mt?o(te,Le.mt):te.write_shift(4,0),te.write_shift(-4,Ge[Oe]),te.write_shift(4,Ot.length),te.write_shift(4,Le.content.length),te.write_shift(2,Dt.length),te.write_shift(2,0),ve+=te.length,W.push(te),ve+=Dt.length,W.push(Dt),ve+=Ot.length,W.push(Ot),te=Hr(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Te),te.write_shift(2,de),te.write_shift(4,0),te.write_shift(-4,Ge[Oe]),te.write_shift(4,Ot.length),te.write_shift(4,Le.content.length),te.write_shift(2,Dt.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,Ht),ct+=te.l,J.push(te),ct+=Dt.length,J.push(Dt),++Oe}return te=Hr(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Oe),te.write_shift(2,Oe),te.write_shift(4,ct),te.write_shift(4,ve),te.write_shift(2,0),Ji([Ji(W),Ji(J),te])}var ss={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xa(j,Z){if(j.ctype)return j.ctype;var Y=j.name||"",W=Y.match(/\.([^\.]+)$/);return W&&ss[W[1]]||Z&&(W=(Y=Z).match(/[\.\\]([^\.\\])+$/),W&&ss[W[1]])?ss[W[1]]:"application/octet-stream"}function wo(j){for(var Z=l4(j),Y=[],W=0;W<Z.length;W+=76)Y.push(Z.slice(W,W+76));return Y.join(`\r
`)+`\r
`}function is(j){var Z=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var ve=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],W=Z.split(`\r
`),J=0;J<W.length;++J){var te=W[J];if(te.length==0){Y.push("");continue}for(var de=0;de<te.length;){var Te=76,ce=te.slice(de,de+Te);ce.charAt(Te-1)=="="?Te--:ce.charAt(Te-2)=="="?Te-=2:ce.charAt(Te-3)=="="&&(Te-=3),ce=te.slice(de,de+Te),de+=Te,de<te.length&&(ce+="="),Y.push(ce)}}return Y.join(`\r
`)}function Ti(j){for(var Z=[],Y=0;Y<j.length;++Y){for(var W=j[Y];Y<=j.length&&W.charAt(W.length-1)=="=";)W=W.slice(0,W.length-1)+j[++Y];Z.push(W)}for(var J=0;J<Z.length;++J)Z[J]=Z[J].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return qa(Z.join(`\r
`))}function os(j,Z,Y){for(var W="",J="",te="",de,Te=0;Te<10;++Te){var ce=Z[Te];if(!ce||ce.match(/^\s*$/))break;var ge=ce.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":W=ge[2].trim();break;case"content-type":te=ge[2].trim();break;case"content-transfer-encoding":J=ge[2].trim();break}}switch(++Te,J.toLowerCase()){case"base64":de=qa(va(Z.slice(Te).join("")));break;case"quoted-printable":de=Ti(Z.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var ve=ur(j,W.slice(Y.length),de,{unsafe:!0});te&&(ve.ctype=te)}function wl(j,Z){if(oe(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=Z&&Z.root||"",W=(kt&&Buffer.isBuffer(j)?j.toString("binary"):oe(j)).split(`\r
`),J=0,te="";for(J=0;J<W.length;++J)if(te=W[J],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),Y||(Y=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),te.slice(0,Y.length)!=Y););var de=(W[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Te="--"+(de[1]||""),ce=[],ge=[],ve={FileIndex:ce,FullPaths:ge};C(ve);var Oe,Be=0;for(J=0;J<W.length;++J){var $e=W[J];$e!==Te&&$e!==Te+"--"||(Be++&&os(ve,W.slice(Oe,J),Y),Oe=J)}return ve}function ar(j,Z){var Y=Z||{},W=Y.boundary||"SheetJS";W="------="+W;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+W.slice(2)+'"',"","",""],te=j.FullPaths[0],de=te,Te=j.FileIndex[0],ce=1;ce<j.FullPaths.length;++ce)if(de=j.FullPaths[ce].slice(te.length),Te=j.FileIndex[ce],!(!Te.size||!Te.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var ge=Te.content,ve=kt&&Buffer.isBuffer(ge)?ge.toString("binary"):oe(ge),Oe=0,Be=Math.min(1024,ve.length),$e=0,Le=0;Le<=Be;++Le)($e=ve.charCodeAt(Le))>=32&&$e<128&&++Oe;var Ge=Oe>=Be*4/5;J.push(W),J.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+de),J.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),J.push("Content-Type: "+xa(Te,de)),J.push(""),J.push(Ge?is(ve):wo(ve))}return J.push(W+`--\r
`),J.join(`\r
`)}function Sr(j){var Z={};return C(Z,j),Z}function ur(j,Z,Y,W){var J=W&&W.unsafe;J||C(j);var te=!J&&Mt.find(j,Z);if(!te){var de=j.FullPaths[0];Z.slice(0,de.length)==de?de=Z:(de.slice(-1)!="/"&&(de+="/"),de=(de+Z).replace("//","/")),te={name:a(Z),type:2},j.FileIndex.push(te),j.FullPaths.push(de),J||Mt.utils.cfb_gc(j)}return te.content=Y,te.size=Y?Y.length:0,W&&(W.CLSID&&(te.clsid=W.CLSID),W.mt&&(te.mt=W.mt),W.ct&&(te.ct=W.ct)),te}function Wn(j,Z){C(j);var Y=Mt.find(j,Z);if(Y){for(var W=0;W<j.FileIndex.length;++W)if(j.FileIndex[W]==Y)return j.FileIndex.splice(W,1),j.FullPaths.splice(W,1),!0}return!1}function So(j,Z,Y){C(j);var W=Mt.find(j,Z);if(W){for(var J=0;J<j.FileIndex.length;++J)if(j.FileIndex[J]==W)return j.FileIndex[J].name=a(Y),j.FullPaths[J]=Y,!0}return!1}function Xc(j){R(j,!0)}return e.find=P,e.read=H,e.parse=g,e.write=ee,e.writeFile=Pe,e.utils={cfb_new:Sr,cfb_add:ur,cfb_del:Wn,cfb_mov:So,cfb_gc:Xc,ReadShift:pf,CheckField:YA,prep_blob:fn,bconcat:Ji,use_zlib:z,_deflateRaw:tt,_inflateRaw:ra,consts:me},e}();function mP(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ds(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ex(t){for(var e=[],r=Ds(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Y0=new Date(1899,11,30,0,0,0);function $n(t,e){var r=t.getTime(),n=Y0.getTime()+(t.getTimezoneOffset()-Y0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var AA=new Date,pP=Y0.getTime()+(AA.getTimezoneOffset()-Y0.getTimezoneOffset())*6e4,v4=AA.getTimezoneOffset();function jm(t){var e=new Date;return e.setTime(t*24*60*60*1e3+pP),e.getTimezoneOffset()!==v4&&e.setTime(e.getTime()+(e.getTimezoneOffset()-v4)*6e4),e}function gP(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var x4=new Date("2017-02-19T19:06:09.000Z"),CA=isNaN(x4.getFullYear())?new Date("2/19/17"):x4,vP=CA.getFullYear()==2017;function nn(t,e){var r=new Date(t);if(vP)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(CA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function hl(t,e){if(kt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return lf(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return lf(dA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return lf(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return lf(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function pn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=pn(t[r]));return e}function yr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ja(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var xP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ic(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&xP.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var _P=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}}();function NA(t){return t?t.content&&t.type?hl(t.content,!0):t.data?af(t.data):t.asNodeBuffer&&kt?af(t.asNodeBuffer().toString("binary")):t.asBinary?af(t.asBinary()):t._data&&t._data.getContent?af(hl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function RA(t){if(!t)return null;if(t.data)return i4(t.data);if(t.asNodeBuffer&&kt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?i4(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function yP(t){return t&&t.name.slice(-4)===".bin"?RA(t):NA(t)}function Oa(t,e){for(var r=t.FullPaths||Ds(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Tx(t,e){var r=Oa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Pr(t,e,r){if(!r)return yP(Tx(t,e));if(!e)return null;try{return Pr(t,e)}catch{return null}}function ma(t,e,r){if(!r)return NA(Tx(t,e));if(!e)return null;try{return ma(t,e)}catch{return null}}function EP(t,e,r){return RA(Tx(t,e))}function _4(t){for(var e=t.FullPaths||Ds(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function TP(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return kt?n=vl(r):n=Uj(r),Mt.utils.cfb_add(t,e,n)}Mt.utils.cfb_add(t,e,r)}else t.file(e,r)}function kA(t,e){switch(e.type){case"base64":return Mt.read(t,{type:"base64"});case"binary":return Mt.read(t,{type:"binary"});case"buffer":case"array":return Mt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function of(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var IA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,y4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,SP=/<[^>]*>/g,Dn=IA.match(y4)?y4:SP,bP=/<\w*:/,AP=/<(\/?)\w+:/;function ft(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(wP),u=0,d="",m=0,g="",y="",_=1;if(l)for(m=0;m!=l.length;++m){for(y=l[m],o=0;o!=y.length&&y.charCodeAt(o)!==61;++o);for(g=y.slice(0,o).trim();y.charCodeAt(o+1)==32;)++o;for(_=(a=y.charCodeAt(o+1))==34||a==39?1:0,d=y.slice(o+1+_,y.length-_),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=d,n[g.toLowerCase()]=d;else{var T=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[T]&&g.slice(u-3,u)=="ext")continue;n[T]=d,n[T.toLowerCase()]=d}}return n}function Fs(t){return t.replace(AP,"<$1")}var DA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},CP=Ex(DA),zt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,d){return DA[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}}(),NP=/[&<>'"]/g,RP=/[\u0000-\u001f]/g;function wx(t){var e=t+"";return e.replace(NP,function(r){return CP[r]}).replace(/\n/g,"<br/>").replace(RP,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var E4=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function hr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ag(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function T4(t){var e=go(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function w4(t){return vl(t,"binary").toString("utf8")}var Yd="foo bar bazâð£",ir=kt&&(w4(Yd)==ag(Yd)&&w4||T4(Yd)==ag(Yd)&&T4)||ag,lf=kt?function(t){return vl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Lf=function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),OA=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}}(),kP=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),IP=/<\/?(?:vt:)?variant>/g,DP=/<(?:vt:)([^>]*)>([\s\S]*)</;function S4(t,e){var r=ft(t),n=t.match(kP(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(IP,"").match(DP);l&&a.push({v:ir(l[2]),t:l[1]})}),a}var OP=/(^\s|\s$|\n)/;function jP(t){return Ds(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function PP(t,e,r){return"<"+t+(r!=null?jP(r):"")+(e!=null?(e.match(OP)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Sx(t){if(kt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ir(xl(xx(t)));throw new Error("Bad input format: expected Buffer or string")}var Mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,FP={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},LP=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function MP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function BP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var b4=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},A4=kt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:vl(e)})):b4(t)}:b4,C4=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(ii(t,a)));return n.join("").replace(qn,"")},bx=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(qn,""):C4(t,e,r)}:C4,N4=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},jA=kt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):N4(t,e,r)}:N4,R4=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(mc(t,a)));return n.join("")},vh=kt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):R4(e,r,n)}:R4,PA=function(t,e){var r=ha(t,e);return r>0?vh(t,e+4,e+4+r-1):""},FA=PA,LA=function(t,e){var r=ha(t,e);return r>0?vh(t,e+4,e+4+r-1):""},MA=LA,BA=function(t,e){var r=2*ha(t,e);return r>0?vh(t,e+4,e+4+r-1):""},VA=BA,UA=function(e,r){var n=ha(e,r);return n>0?bx(e,r+4,r+4+n):""},zA=UA,HA=function(t,e){var r=ha(t,e);return r>0?vh(t,e+4,e+4+r):""},GA=HA,qA=function(t,e){return MP(t,e)},W0=qA,$A=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kt&&(FA=function(e,r){if(!Buffer.isBuffer(e))return PA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},MA=function(e,r){if(!Buffer.isBuffer(e))return LA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},VA=function(e,r){if(!Buffer.isBuffer(e))return BA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zA=function(e,r){if(!Buffer.isBuffer(e))return UA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},GA=function(e,r){if(!Buffer.isBuffer(e))return HA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},W0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):qA(e,r)},$A=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var mc=function(t,e){return t[e]},ii=function(t,e){return t[e+1]*256+t[e]},VP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ha=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Jo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},UP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function pf(t,e){var r="",n,a,o=[],l,u,d,m;switch(e){case"dbcs":if(m=this.l,kt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)r+=String.fromCharCode(ii(this,m)),m+=2;t*=2;break;case"utf8":r=vh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=bx(this,this.l,this.l+t);break;case"wstr":return pf.call(this,t,"dbcs");case"lpstr-ansi":r=FA(this,this.l),t=4+ha(this,this.l);break;case"lpstr-cp":r=MA(this,this.l),t=4+ha(this,this.l);break;case"lpwstr":r=VA(this,this.l),t=4+2*ha(this,this.l);break;case"lpp4":t=4+ha(this,this.l),r=zA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ha(this,this.l),r=GA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=mc(this,this.l+t++))!==0;)o.push($d(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=ii(this,this.l+t))!==0;)o.push($d(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",m=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(m)!==-1)return l=mc(this,m),this.l=m+1,u=pf.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push($d(ii(this,m))),m+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",m=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(m)!==-1)return l=mc(this,m),this.l=m+1,u=pf.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push($d(mc(this,m))),m+=1}r=o.join("");break;default:switch(t){case 1:return n=mc(this,this.l),this.l++,n;case 2:return n=(e==="i"?VP:ii)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Jo:UP)(this,this.l),this.l+=4,n):(a=ha(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=W0(this,this.l):a=W0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=jA(this,this.l,t);break}}return this.l+=t,r}var zP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},HP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},GP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function qP(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)GP(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,zP(this,e,this.l);break;case 8:if(n=8,r==="f"){BP(this,e,this.l);break}case 16:break;case-4:n=4,HP(this,e,this.l);break}return this.l+=n,this}function YA(t,e){var r=jA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function fn(t,e){t.l=e,t.read_shift=pf,t.chk=YA,t.write_shift=qP}function In(t,e){t.l+=e}function Hr(t){var e=go(t);return fn(e,0),e}function Ei(t,e,r){if(t){var n,a,o;fn(t,t.l||0);for(var l=t.length,u=0,d=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var m=em[u]||em[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;d=t.l+o;var g=m.f&&m.f(t,o,r);if(t.l=d,e(g,m,u))return}}}function Gg(){var t=[],e=kt?256:2048,r=function(m){var g=Hr(m);return fn(g,0),g},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(m){return n&&m<n.length-n.l?n:(a(),n=r(Math.max(m+1,e)))},l=function(){return a(),Ji(t)},u=function(m){a(),n=m,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function gf(t,e,r){var n=pn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function k4(t,e,r){var n=pn(t);return n.s=gf(n.s,e.s,r),n.e=gf(n.e,e.s,r),n}function vf(t,e){if(t.cRel&&t.c<0)for(t=pn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=pn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=pt(t);return!t.cRel&&t.cRel!=null&&(r=WP(r)),!t.rRel&&t.rRel!=null&&(r=$P(r)),r}function sg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Gr(t.s.c)+":"+(t.e.cRel?"":"$")+Gr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+gn(t.s.r)+":"+(t.e.rRel?"":"$")+gn(t.e.r):vf(t.s,e.biff)+":"+vf(t.e,e.biff)}function Ax(t){return parseInt(YP(t),10)-1}function gn(t){return""+(t+1)}function $P(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function YP(t){return t.replace(/\$(\d+)$/,"$1")}function Cx(t){for(var e=KP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Gr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function WP(t){return t.replace(/^([A-Z])/,"$$$1")}function KP(t){return t.replace(/^\$([A-Z])/,"$1")}function XP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gn(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function pt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Wc(t){var e=t.indexOf(":");return e==-1?{s:Gn(t),e:Gn(t)}:{s:Gn(t.slice(0,e)),e:Gn(t.slice(e+1))}}function Bt(t,e){return typeof e>"u"||typeof e=="number"?Bt(t.s,t.e):(typeof t!="string"&&(t=pt(t)),typeof e!="string"&&(e=pt(e)),t==e?t:t+":"+e)}function Er(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function I4(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ja(t.z,r?$n(e):e)}catch{}try{return t.w=ja((t.XF||{}).numFmtId||(r?14:0),r?$n(e):e)}catch{return""+e}}function xi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?El[t.v]||t.v:e==null?I4(t,t.v):I4(t,e))}function To(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function WA(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Gn(n.origin):n.origin;l=d.r,u=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Er(o["!ref"]);m.s.c=g.s.c,m.s.r=g.s.r,m.e.c=Math.max(m.e.c,g.e.c),m.e.r=Math.max(m.e.r,g.e.r),l==-1&&(m.e.r=l=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[y].length;++_)if(!(typeof e[y][_]>"u")){var T={v:e[y][_]},E=l+y,S=u+_;if(m.s.r>E&&(m.s.r=E),m.s.c>S&&(m.s.c=S),m.e.r<E&&(m.e.r=E),m.e.c<S&&(m.e.c=S),e[y][_]&&typeof e[y][_]=="object"&&!Array.isArray(e[y][_])&&!(e[y][_]instanceof Date))T=e[y][_];else if(Array.isArray(T.v)&&(T.f=e[y][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||xt[14],n.cellDates?(T.t="d",T.w=ja(T.z,$n(T.v))):(T.t="n",T.v=$n(T.v),T.w=ja(T.z,T.v))):T.t="s";if(a)o[E]||(o[E]=[]),o[E][S]&&o[E][S].z&&(T.z=o[E][S].z),o[E][S]=T;else{var b=pt({c:S,r:E});o[b]&&o[b].z&&(T.z=o[b].z),o[b]=T}}}return m.s.c<1e7&&(o["!ref"]=Bt(m)),o}function Kc(t,e){return WA(null,t,e)}function QP(t){return t.read_shift(4,"i")}function Nn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function JP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Nx(t,e){var r=t.l,n=t.read_shift(1),a=Nn(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),d=0;d!=u;++d)o.push(JP(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}var ZP=Nx;function Pa(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function _l(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var eF=Nn;function Rx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var tF=Nn,qg=Rx;function kx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?W0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Jo(e,0)>>2;return r?a/100:a}function KA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var yl=KA;function bn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function rF(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),d=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var m=rl[a];m&&(e.rgb=Vf(m));break;case 2:e.rgb=Vf([l,u,d]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function nF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function XA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function aF(t){return XA(t,1)}function sF(t){return XA(t,2)}var Ix=2,ea=3,Wd=11,D4=12,K0=19,Kd=64,iF=65,oF=71,lF=4108,cF=4126,tn=80,QA=81,uF=[tn,QA],fF={1:{n:"CodePage",t:Ix},2:{n:"Category",t:tn},3:{n:"PresentationFormat",t:tn},4:{n:"ByteCount",t:ea},5:{n:"LineCount",t:ea},6:{n:"ParagraphCount",t:ea},7:{n:"SlideCount",t:ea},8:{n:"NoteCount",t:ea},9:{n:"HiddenCount",t:ea},10:{n:"MultimediaClipCount",t:ea},11:{n:"ScaleCrop",t:Wd},12:{n:"HeadingPairs",t:lF},13:{n:"TitlesOfParts",t:cF},14:{n:"Manager",t:tn},15:{n:"Company",t:tn},16:{n:"LinksUpToDate",t:Wd},17:{n:"CharacterCount",t:ea},19:{n:"SharedDoc",t:Wd},22:{n:"HyperlinksChanged",t:Wd},23:{n:"AppVersion",t:ea,p:"version"},24:{n:"DigSig",t:iF},26:{n:"ContentType",t:tn},27:{n:"ContentStatus",t:tn},28:{n:"Language",t:tn},29:{n:"Version",t:tn},255:{},2147483648:{n:"Locale",t:K0},2147483651:{n:"Behavior",t:K0},1919054434:{}},hF={1:{n:"CodePage",t:Ix},2:{n:"Title",t:tn},3:{n:"Subject",t:tn},4:{n:"Author",t:tn},5:{n:"Keywords",t:tn},6:{n:"Comments",t:tn},7:{n:"Template",t:tn},8:{n:"LastAuthor",t:tn},9:{n:"RevNumber",t:tn},10:{n:"EditTime",t:Kd},11:{n:"LastPrinted",t:Kd},12:{n:"CreatedDate",t:Kd},13:{n:"ModifiedDate",t:Kd},14:{n:"PageCount",t:ea},15:{n:"WordCount",t:ea},16:{n:"CharCount",t:ea},17:{n:"Thumbnail",t:oF},18:{n:"Application",t:tn},19:{n:"DocSecurity",t:ea},255:{},2147483648:{n:"Locale",t:K0},2147483651:{n:"Behavior",t:K0},1919054434:{}},O4={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},dF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var pF=mF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rl=pn(pF),El={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},JA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},j4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function gF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function vF(t){var e=gF();if(!t||!t.match)return e;var r={};if((t.match(Dn)||[]).forEach(function(n){var a=ft(n);switch(a[0].replace(bP,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[j4[a.ContentType]]!==void 0&&e[j4[a.ContentType]].push(a.PartName);break}}),e.xmlns!==FP.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var vc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $g(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function xf(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Dn)||[]).forEach(function(a){var o=ft(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:of(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}var xF="application/vnd.oasis.opendocument.spreadsheet";function _F(t,e){for(var r=Sx(t),n,a;n=Mf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ft(n[0],!1),a.path=="/"&&a.type!==xF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var _f=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yF=function(){for(var t=new Array(_f.length),e=0;e<_f.length;++e){var r=_f[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function ZA(t){var e={};t=ir(t);for(var r=0;r<_f.length;++r){var n=_f[r],a=t.match(yF[r]);a!=null&&a.length>0&&(e[n[1]]=zt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=nn(e[n[1]]))}return e}var EF=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function e3(t,e,r,n){var a=[];if(typeof t=="string")a=S4(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(g){return{v:g}}));var l=typeof e=="string"?S4(e,n).map(function(g){return g.v}):e,u=0,d=0;if(l.length>0)for(var m=0;m!==a.length;m+=2){switch(d=+a[m+1].v,a[m].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=l.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=d,r.DefinedNames=l.slice(u,u+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=l.slice(u,u+d);break}u+=d}}function TF(t,e,r){var n={};return e||(e={}),t=ir(t),EF.forEach(function(a){var o=(t.match(Lf(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=zt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&e3(n.HeadingPairs,n.TitlesOfParts,e,r),e}var wF=/<[^>]+>[^<]*/g;function SF(t,e){var r={},n="",a=t.match(wF);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=ft(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=zt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),m=d[0].slice(4),g=d[1];switch(m){case"lpstr":case"bstr":case"lpwstr":r[n]=zt(g);break;case"bool":r[n]=hr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=nn(g);break;case"cy":case"error":r[n]=zt(g);break;default:if(m.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,m,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}var bF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ig;function AF(t,e,r){ig||(ig=Ex(bF)),e=ig[e]||e,t[e]=r}function Dx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function t3(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function r3(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function n3(t,e,r){return e===31?r3(t):t3(t,e,r)}function Yg(t,e,r){return n3(t,e,r===!1?0:4)}function CF(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return n3(t,e,0)}function NF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(qn,""),t.l-a&2&&(t.l+=2)}return r}function RF(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(qn,"");return r}function kF(t){var e=t.l,r=X0(t,QA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=X0(t,ea);return[r,n]}function IF(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(kF(t));return r}function P4(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(qn,"").replace(sf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function a3(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function DF(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function X0(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==D4&&n!==e&&uF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===D4?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return t3(t,n,4).replace(qn,"");case 31:return r3(t);case 64:return Dx(t);case 65:return a3(t);case 71:return DF(t);case 80:return Yg(t,n,!o.raw).replace(qn,"");case 81:return CF(t,n).replace(qn,"");case 4108:return IF(t);case 4126:case 4127:return n==4127?NF(t):RF(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function F4(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,d=-1,m={};for(l=0;l!=a;++l){var g=t.read_shift(4),y=t.read_shift(4);o[l]=[g,y+r]}o.sort(function(L,A){return L[1]-A[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var T=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,T=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],T=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],T=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(T=!1,t.l=o[l][1]),T)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[o[l][0]];if(_[E.n]=X0(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ka(u=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(o[l][0]===1){if(u=_.CodePage=X0(t,Ix),Ka(u),d!==-1){var S=t.l;t.l=o[d][1],m=P4(t,u),t.l=S}}else if(o[l][0]===0){if(u===0){d=l,t.l=o[l+1][1];continue}m=P4(t,u)}else{var b=m[o[l][0]],O;switch(t[t.l]){case 65:t.l+=4,O=a3(t);break;case 30:t.l+=4,O=Yg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,O=Yg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,O=t.read_shift(4,"i");break;case 19:t.l+=4,O=t.read_shift(4);break;case 5:t.l+=4,O=t.read_shift(8,"f");break;case 11:t.l+=4,O=Cr(t,4);break;case 64:t.l+=4,O=nn(Dx(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[b]=O}}return t.l=r+n,_}function L4(t,e,r){var n=t.content;if(!n)return{};fn(n,0);var a,o,l,u,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),g=n.read_shift(16);if(g!==Mt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),d=n.read_shift(4));var y=F4(n,e),_={SystemIdentifier:m};for(var T in y)_[T]=y[T];if(_.FMTID=o,a===1)return _;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var E;try{E=F4(n,null)}catch{}for(T in E)_[T]=E[T];return _.FMTID=[o,l],_}function Yi(t,e){return t.read_shift(e),null}function OF(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Cr(t,e){return t.read_shift(e)===1}function Fr(t){return t.read_shift(2,"u")}function s3(t,e){return OF(t,e,Fr)}function jF(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function xh(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function PF(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,d={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,m);return a&&(t.l+=4*l),n&&(t.l+=u),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function dl(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function _h(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):dl(t,n,r)}function Tl(t,e,r){if(r.biff>5)return _h(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function FF(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function LF(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(qn,"");return n&&(t.l+=24),a}function MF(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(qn,"");return r+l}function BF(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return LF(t);case"0303000000000000c000000000000046":return MF(t);default:throw new Error("Unsupported Moniker "+r)}}function Xd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(qn,""):"";return r}function VF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,d,m="",g,y;a&16&&(o=Xd(t,r-t.l)),a&128&&(l=Xd(t,r-t.l)),(a&257)===257&&(u=Xd(t,r-t.l)),(a&257)===1&&(d=BF(t,r-t.l)),a&8&&(m=Xd(t,r-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(y=Dx(t)),t.l=r;var _=l||u||d||"";_&&m&&(_+="#"+m),_||(_="#"+m),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),y&&(T.time=y),o&&(T.Tooltip=o),T}function i3(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function o3(t,e){var r=i3(t);return r[3]=0,r}function Ls(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function UF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function zF(t,e,r){return e===0?"":Tl(t,e,r)}function HF(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function l3(t){var e=t.read_shift(2),r=kx(t);return[e,r]}function GF(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=xh(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function Pm(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function c3(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var qF=c3;function u3(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function $F(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function YF(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Tn(t){t.l+=2,t.l+=t.read_shift(2)}var WF={0:Tn,4:Tn,5:Tn,6:Tn,7:YF,8:Tn,9:Tn,10:Tn,11:Tn,12:Tn,13:$F,14:Tn,15:Tn,16:Tn,17:Tn,18:Tn,19:Tn,20:Tn,21:u3};function KF(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(WF[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Qd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function XF(t,e){return e===0||t.read_shift(2),1200}function QF(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=Tl(t,0,r);return t.read_shift(e+n-t.l),a}function JF(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function ZF(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=xh(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function e7(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(PF(t));return o.Count=n,o.Unique=a,o}function t7(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function r7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function n7(t){var e=UF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function a7(t){return t.read_shift(2),t.read_shift(4)}function M4(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function s7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),d=t.read_shift(2),m=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:d,TabRatio:m}}function i7(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function o7(){}function l7(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=xh(t,0,r),n}function c7(t){var e=Ls(t);return e.isst=t.read_shift(4),e}function u7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Ls(t);r.biff==2&&t.l++;var o=_h(t,n-t.l,r);return a.val=o,a}function f7(t,e,r){var n=t.read_shift(2),a=Tl(t,0,r);return[n,a]}var h7=Tl;function B4(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),d=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:d}}}function d7(t){var e=t.read_shift(2),r=t.read_shift(2),n=l3(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function m7(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(l3(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function p7(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function g7(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),d=t.read_shift(2);return a.patternType=dF[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function v7(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=g7(t,e,n.fStyle,r),n}function x7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function V4(t,e,r){var n=Ls(t);(r.biff==2||e==9)&&++t.l;var a=jF(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function _7(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ls(t),a=bn(t);return n.val=a,n}var U4=zF;function y7(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=dl(t,o),u=[];n>t.l;)u.push(_h(t));return[o,a,l,u]}function z4(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=GF(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var E7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function H4(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),d=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var m=dl(t,l,r);a&32&&(m=E7[m.charCodeAt(0)]);var g=n-t.l;r&&r.biff==2&&--g;var y=n==t.l||u===0||!(g>0)?[]:rV(t,g,r,u);return{chKey:o,Name:m,itab:d,rgce:y}}function f3(t,e,r){if(r.biff<8)return T7(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(HF(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function T7(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=xh(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function w7(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=dl(t,n,r),l=dl(t,a,r);return[o,l]}function S7(t,e,r){var n=c3(t);t.l++;var a=t.read_shift(1);return e-=8,[nV(t,e,r),a,n]}function G4(t,e,r){var n=qF(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,eV(t,e,r)]}function b7(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function A7(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=Tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function C7(t,e,r){return A7(t,e,r)}function N7(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Pm(t));return r}function R7(t,e,r){if(r&&r.biff<8)return I7(t,e,r);var n=u3(t),a=KF(t,e-22,n[1]);return{cmo:n,ft:a}}var k7={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function I7(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((k7[n]||In)(t,e,r)),{cmo:[a,n,o],ft:l}}function D7(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=FF(t,6,r);var u=t.read_shift(2);t.read_shift(2),Fr(t,2);var d=t.read_shift(2);t.l+=d;for(var m=1;m<t.lens.length-1;++m){if(t.l-n!=t.lens[m])throw new Error("TxO: bad continue record");var g=t[t.l],y=dl(t,t.lens[m+1]-t.lens[m]-1);if(a+=y,a.length>=(g?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function O7(t,e){var r=Pm(t);t.l+=16;var n=VF(t,e-24);return[r,n]}function j7(t,e){t.read_shift(2);var r=Pm(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(qn,""),[r,n]}function P7(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=O4[r]||r,r=t.read_shift(2),e[1]=O4[r]||r,e}function F7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(o3(t));return r}function L7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(o3(t));return r}function M7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function h3(t,e,r){if(!r.cellStyles)return In(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),d=t.read_shift(2);n==2&&(t.l+=2);var m={s:a,e:o,w:l,ixfe:u,flags:d};return(r.biff>=5||!r.biff)&&(m.level=d>>8&7),m}function B7(t,e){var r={};return e<32||(t.l+=16,r.header=bn(t),r.footer=bn(t),t.l+=2),r}function V7(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}var U7=Ls,z7=s3,H7=_h;function G7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function q7(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ls(t);++t.l;var a=Tl(t,e-7,r);return n.t="str",n.val=a,n}function $7(t){var e=Ls(t);++t.l;var r=bn(t);return e.t="n",e.val=r,e}function Y7(t){var e=Ls(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function W7(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function K7(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function X7(t,e,r){var n=t.l+e,a=Ls(t),o=t.read_shift(2),l=dl(t,o,r);return t.l=n,a.t="str",a.val=l,a}var Q7=[2,3,48,49,131,139,140,245],q4=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ex({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,d){var m=[],g=go(1);switch(d.type){case"base64":g=qa(va(u));break;case"binary":g=qa(u);break;case"buffer":case"array":g=u;break}fn(g,0);var y=g.read_shift(1),_=!!(y&136),T=!1,E=!1;switch(y){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var S=0,b=521;y==2&&(S=g.read_shift(2)),g.l+=3,y!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),y!=2&&(b=g.read_shift(2));var O=g.read_shift(2),L=d.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(L=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var A=[],D={},V=Math.min(g.length,y==2?521:b-10-(T?264:0)),H=E?32:11;g.l<V&&g[g.l]!=13;)switch(D={},D.name=Hg.utils.decode(L,g.slice(g.l,g.l+H)).replace(/[\u0000\r\n].*$/g,""),g.l+=H,D.type=String.fromCharCode(g.read_shift(1)),y!=2&&!E&&(D.offset=g.read_shift(4)),D.len=g.read_shift(1),y==2&&(D.offset=g.read_shift(2)),D.dec=g.read_shift(1),D.name.length&&A.push(D),y!=2&&(g.l+=E?13:14),D.type){case"B":(!T||D.len!=8)&&d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var C=0,N=0;for(m[0]=[],N=0;N!=A.length;++N)m[0][N]=A[N].name;for(;S-- >0;){if(g[g.l]===42){g.l+=O;continue}for(++g.l,m[++C]=[],N=0,N=0;N!=A.length;++N){var R=g.slice(g.l,g.l+A[N].len);g.l+=A[N].len,fn(R,0);var F=Hg.utils.decode(L,R);switch(A[N].type){case"C":F.trim().length&&(m[C][N]=F.replace(/\s+$/,""));break;case"D":F.length===8?m[C][N]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):m[C][N]=F;break;case"F":m[C][N]=parseFloat(F.trim());break;case"+":case"I":m[C][N]=E?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":m[C][N]=!0;break;case"N":case"F":m[C][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));m[C][N]="##MEMO##"+(E?parseInt(F.trim(),10):R.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(m[C][N]=+F||0);break;case"@":m[C][N]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":m[C][N]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":m[C][N]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[C][N]=-R.read_shift(-8,"f");break;case"B":if(T&&A[N].len==8){m[C][N]=R.read_shift(8,"f");break}case"G":case"P":R.l+=A[N].len;break;case"0":if(A[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[N].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(m=m.slice(0,d.sheetRows)),d.DBF=A,m}function n(u,d){var m=d||{};m.dateNF||(m.dateNF="yyyymmdd");var g=Kc(r(u,m),m);return g["!cols"]=m.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete m.DBF,g}function a(u,d){try{return To(n(u,d),d)}catch(m){if(d&&d.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,d){var m=d||{};if(+m.codepage>=0&&Ka(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var g=Gg(),y=ev(u,{header:1,raw:!0,cellDates:!0}),_=y[0],T=y.slice(1),E=u["!cols"]||[],S=0,b=0,O=0,L=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++O;continue}if(_[S]!=null){if(++O,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(b=0;b<1024;++b)if(_.indexOf(_[S]+"_"+b)==-1){_[S]+="_"+b;break}}}}var A=Er(u["!ref"]),D=[],V=[],H=[];for(S=0;S<=A.e.c-A.s.c;++S){var C="",N="",R=0,F=[];for(b=0;b<T.length;++b)T[b][S]!=null&&F.push(T[b][S]);if(F.length==0||_[S]==null){D[S]="?";continue}for(b=0;b<F.length;++b){switch(typeof F[b]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=F[b]instanceof Date?"D":"C";break;default:N="C"}R=Math.max(R,String(F[b]).length),C=C&&C!=N?"C":N}R>250&&(R=250),N=((E[S]||{}).DBF||{}).type,N=="C"&&E[S].DBF.len>R&&(R=E[S].DBF.len),C=="B"&&N=="N"&&(C="N",H[S]=E[S].DBF.dec,R=E[S].DBF.len),V[S]=C=="C"||N=="N"?R:o[C]||0,L+=V[S],D[S]=C}var P=g.next(32);for(P.write_shift(4,318902576),P.write_shift(4,T.length),P.write_shift(2,296+32*O),P.write_shift(2,L),S=0;S<4;++S)P.write_shift(4,0);for(P.write_shift(4,0|(+e[fA]||3)<<8),S=0,b=0;S<_.length;++S)if(_[S]!=null){var M=g.next(32),U=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,U,"sbcs"),M.write_shift(1,D[S]=="?"?"C":D[S],"sbcs"),M.write_shift(4,b),M.write_shift(1,V[S]||o[D[S]]||0),M.write_shift(1,H[S]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),b+=V[S]||o[D[S]]||0}var Me=g.next(264);for(Me.write_shift(4,13),S=0;S<65;++S)Me.write_shift(4,0);for(S=0;S<T.length;++S){var Ne=g.next(L);for(Ne.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(D[b]){case"L":Ne.write_shift(1,T[S][b]==null?63:T[S][b]?84:70);break;case"B":Ne.write_shift(8,T[S][b]||0,"f");break;case"N":var ie="0";for(typeof T[S][b]=="number"&&(ie=T[S][b].toFixed(H[b]||0)),O=0;O<V[b]-ie.length;++O)Ne.write_shift(1,32);Ne.write_shift(1,ie,"sbcs");break;case"D":T[S][b]?(Ne.write_shift(4,("0000"+T[S][b].getFullYear()).slice(-4),"sbcs"),Ne.write_shift(2,("00"+(T[S][b].getMonth()+1)).slice(-2),"sbcs"),Ne.write_shift(2,("00"+T[S][b].getDate()).slice(-2),"sbcs")):Ne.write_shift(8,"00000000","sbcs");break;case"C":var me=String(T[S][b]!=null?T[S][b]:"").slice(0,V[b]);for(Ne.write_shift(1,me,"sbcs"),O=0;O<V[b]-me.length;++O)Ne.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),J7=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ds(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,T){var E=t[T];return typeof E=="number"?o4(E):E},n=function(_,T,E){var S=T.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:o4(S)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return o(va(_),T);case"binary":return o(_,T);case"buffer":return o(kt&&Buffer.isBuffer(_)?_.toString("binary"):xl(_),T);case"array":return o(hl(_),T)}throw new Error("Unrecognized type "+T.type)}function o(_,T){var E=_.split(/[\n\r]+/),S=-1,b=-1,O=0,L=0,A=[],D=[],V=null,H={},C=[],N=[],R=[],F=0,P;for(+T.codepage>=0&&Ka(+T.codepage);O!==E.length;++O){F=0;var M=E[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),U=M.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Me=U[0],Ne;if(M.length>0)switch(Me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&D.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,me=!1,Pe=!1,oe=!1,ee=-1,ue=-1;for(L=1;L<U.length;++L)switch(U[L].charAt(0)){case"A":break;case"X":b=parseInt(U[L].slice(1))-1,me=!0;break;case"Y":for(S=parseInt(U[L].slice(1))-1,me||(b=0),P=A.length;P<=S;++P)A[P]=[];break;case"K":Ne=U[L].slice(1),Ne.charAt(0)==='"'?Ne=Ne.slice(1,Ne.length-1):Ne==="TRUE"?Ne=!0:Ne==="FALSE"?Ne=!1:isNaN(Ja(Ne))?isNaN(Ic(Ne).getDate())||(Ne=nn(Ne)):(Ne=Ja(Ne),V!==null&&Yc(V)&&(Ne=jm(Ne))),ie=!0;break;case"E":oe=!0;var z=wc(U[L].slice(1),{r:S,c:b});A[S][b]=[A[S][b],z];break;case"S":Pe=!0,A[S][b]=[A[S][b],"S5S"];break;case"G":break;case"R":ee=parseInt(U[L].slice(1))-1;break;case"C":ue=parseInt(U[L].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+M)}if(ie&&(A[S][b]&&A[S][b].length==2?A[S][b][0]=Ne:A[S][b]=Ne,V=null),Pe){if(oe)throw new Error("SYLK shared formula cannot have own formula");var X=ee>-1&&A[ee][ue];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");A[S][b][1]=T3(X[1],{r:S-ee,c:b-ue})}break;case"F":var G=0;for(L=1;L<U.length;++L)switch(U[L].charAt(0)){case"X":b=parseInt(U[L].slice(1))-1,++G;break;case"Y":for(S=parseInt(U[L].slice(1))-1,P=A.length;P<=S;++P)A[P]=[];break;case"M":F=parseInt(U[L].slice(1))/20;break;case"F":break;case"G":break;case"P":V=D[parseInt(U[L].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=U[L].slice(1).split(" "),P=parseInt(R[0],10);P<=parseInt(R[1],10);++P)F=parseInt(R[2],10),N[P-1]=F===0?{hidden:!0}:{wch:F},Dc(N[P-1]);break;case"C":b=parseInt(U[L].slice(1))-1,N[b]||(N[b]={});break;case"R":S=parseInt(U[L].slice(1))-1,C[S]||(C[S]={}),F>0?(C[S].hpt=F,C[S].hpx=Uf(F)):F===0&&(C[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+M)}G<1&&(V=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+M)}}return C.length>0&&(H["!rows"]=C),N.length>0&&(H["!cols"]=N),T&&T.sheetRows&&(A=A.slice(0,T.sheetRows)),[A,H]}function l(_,T){var E=a(_,T),S=E[0],b=E[1],O=Kc(S,T);return Ds(b).forEach(function(L){O[L]=b[L]}),O}function u(_,T){return To(l(_,T),T)}function d(_,T,E,S){var b="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+MM(_.f,{r:E,c:S}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function m(_,T){T.forEach(function(E,S){var b="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?b+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=J0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Z0(E.wpx)),typeof E.wch=="number"&&(b+=Math.round(E.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function g(_,T){T.forEach(function(E,S){var b="F;";E.hidden?b+="M0;":E.hpt?b+="M"+20*E.hpt+";":E.hpx&&(b+="M"+20*_3(E.hpx)+";"),b.length>2&&_.push(b+"R"+(S+1))})}function y(_,T){var E=["ID;PWXL;N;E"],S=[],b=Er(_["!ref"]),O,L=Array.isArray(_),A=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&m(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var D=b.s.r;D<=b.e.r;++D)for(var V=b.s.c;V<=b.e.c;++V){var H=pt({r:D,c:V});O=L?(_[D]||[])[V]:_[H],!(!O||O.v==null&&(!O.f||O.F))&&S.push(d(O,_,D,V))}return E.join(A)+A+S.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:l,from_sheet:y}}(),Z7=function(){function t(o,l){switch(l.type){case"base64":return e(va(o),l);case"binary":return e(o,l);case"buffer":return e(kt&&Buffer.isBuffer(o)?o.toString("binary"):xl(o),l);case"array":return e(hl(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),d=-1,m=-1,g=0,y=[];g!==u.length;++g){if(u[g].trim()==="BOT"){y[++d]=[],m=0;continue}if(!(d<0)){var _=u[g].trim().split(","),T=_[0],E=_[1];++g;for(var S=u[g]||"";(S.match(/["]/g)||[]).length&1&&g<u.length-1;)S+=`
`+u[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){y[++d]=[],m=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?y[d][m]=!0:S==="FALSE"?y[d][m]=!1:isNaN(Ja(E))?isNaN(Ic(E).getDate())?y[d][m]=E:y[d][m]=nn(E):y[d][m]=Ja(E),++m;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),y[d][m++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function r(o,l){return Kc(t(o,l),l)}function n(o,l){return To(r(o,l),l)}var a=function(){var o=function(d,m,g,y,_){d.push(m),d.push(g+","+y),d.push('"'+_.replace(/"/g,'""')+'"')},l=function(d,m,g,y){d.push(m+","+g),d.push(m==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(d){var m=[],g=Er(d["!ref"]),y,_=Array.isArray(d);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,g.e.r-g.s.r+1,""),o(m,"TUPLES",0,g.e.c-g.s.c+1,""),o(m,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(m,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=pt({r:T,c:E});if(y=_?(d[T]||[])[E]:d[S],!y){l(m,1,0,"");continue}switch(y.t){case"n":var b=y.w;!b&&y.v!=null&&(b=y.v),b==null?y.f&&!y.F?l(m,1,0,"="+y.f):l(m,1,0,""):l(m,0,b,"V");break;case"b":l(m,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=ja(y.z||xt[14],$n(nn(y.v)))),l(m,0,y.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var O=`\r
`,L=m.join(O);return L}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),eL=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,_){for(var T=y.split(`
`),E=-1,S=-1,b=0,O=[];b!==T.length;++b){var L=T[b].trim().split(":");if(L[0]==="cell"){var A=Gn(L[1]);if(O.length<=A.r)for(E=O.length;E<=A.r;++E)O[E]||(O[E]=[]);switch(E=A.r,S=A.c,L[2]){case"t":O[E][S]=t(L[3]);break;case"v":O[E][S]=+L[3];break;case"vtf":var D=L[L.length-1];case"vtc":switch(L[3]){case"nl":O[E][S]=!!+L[4];break;default:O[E][S]=+L[4];break}L[2]=="vtf"&&(O[E][S]=[O[E][S],D])}}}return _&&_.sheetRows&&(O=O.slice(0,_.sheetRows)),O}function n(y,_){return Kc(r(y,_),_)}function a(y,_){return To(n(y,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function m(y){if(!y||!y["!ref"])return"";for(var _=[],T=[],E,S="",b=Wc(y["!ref"]),O=Array.isArray(y),L=b.s.r;L<=b.e.r;++L)for(var A=b.s.c;A<=b.e.c;++A)if(S=pt({r:L,c:A}),E=O?(y[L]||[])[A]:y[S],!(!E||E.v==null||E.t==="z")){switch(T=["cell",S,"t"],E.t){case"s":case"str":T.push(e(E.v));break;case"n":E.f?(T[2]="vtf",T[3]="n",T[4]=E.v,T[5]=e(E.f)):(T[2]="v",T[3]=E.v);break;case"b":T[2]="vt"+(E.f?"f":"c"),T[3]="nl",T[4]=E.v?"1":"0",T[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var D=$n(nn(E.v));T[2]="vtc",T[3]="nd",T[4]=""+D,T[5]=E.w||ja(E.z||xt[14],D);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[o,l,u,l,m(y),d].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:g}}(),Bf=function(){function t(g,y,_,T,E){E.raw?y[_][T]=g:g===""||(g==="TRUE"?y[_][T]=!0:g==="FALSE"?y[_][T]=!1:isNaN(Ja(g))?isNaN(Ic(g).getDate())?y[_][T]=g:y[_][T]=nn(g):y[_][T]=Ja(g))}function e(g,y){var _=y||{},T=[];if(!g||g.length===0)return T;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var b=10,O=0,L=0;L<=S;++L)O=E[L].indexOf(" "),O==-1?O=E[L].length:O++,b=Math.max(b,O);for(L=0;L<=S;++L){T[L]=[];var A=0;for(t(E[L].slice(0,b).trim(),T,L,A,_),A=1;A<=(E[L].length-b)/10+1;++A)t(E[L].slice(b+(A-1)*10,b+A*10).trim(),T,L,A,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,T=0,E=0;T<g.length;++T)(E=g.charCodeAt(T))==34?_=!_:!_&&E in r&&(y[E]=(y[E]||0)+1);E=[];for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&E.push([y[T],T]);if(!E.length){y=n;for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&E.push([y[T],T])}return E.sort(function(S,b){return S[0]-b[0]||n[S[1]]-n[b[1]]}),r[E.pop()[1]]||44}function o(g,y){var _=y||{},T="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var b=0,O=0,L=0,A=0,D=0,V=T.charCodeAt(0),H=!1,C=0,N=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var R=_.dateNF!=null?fP(_.dateNF):null;function F(){var P=g.slice(A,D),M={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)M.t="z";else if(_.raw)M.t="s",M.v=P;else if(P.trim().length===0)M.t="s",M.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(M.t="s",M.v=P.slice(2,-1).replace(/""/g,'"')):VM(P)?(M.t="n",M.f=P.slice(1)):(M.t="s",M.v=P);else if(P=="TRUE")M.t="b",M.v=!0;else if(P=="FALSE")M.t="b",M.v=!1;else if(!isNaN(L=Ja(P)))M.t="n",_.cellText!==!1&&(M.w=P),M.v=L;else if(!isNaN(Ic(P).getDate())||R&&P.match(R)){M.z=_.dateNF||xt[14];var U=0;R&&P.match(R)&&(P=hP(P,_.dateNF,P.match(R)||[]),U=1),_.cellDates?(M.t="d",M.v=nn(P,U)):(M.t="n",M.v=$n(nn(P,U))),_.cellText!==!1&&(M.w=ja(M.z,M.v instanceof Date?$n(M.v):M.v)),_.cellNF||delete M.z}else M.t="s",M.v=P;if(M.t=="z"||(_.dense?(E[b]||(E[b]=[]),E[b][O]=M):E[pt({c:O,r:b})]=M),A=D+1,N=g.charCodeAt(A),S.e.c<O&&(S.e.c=O),S.e.r<b&&(S.e.r=b),C==V)++O;else if(O=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;D<g.length;++D)switch(C=g.charCodeAt(D)){case 34:N===34&&(H=!H);break;case V:case 10:case 13:if(!H&&F())break e;break}return D-A>0&&F(),E["!ref"]=Bt(S),E}function l(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,y):Kc(e(g,y),y)}function u(g,y){var _="",T=y.type=="string"?[0,0,0,0]:Vx(g,y);switch(y.type){case"base64":_=va(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):(y.codepage,_=kt&&Buffer.isBuffer(g)?g.toString("binary"):xl(g));break;case"array":_=hl(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=ir(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=ir(_):y.type=="binary",_.slice(0,19)=="socialcalc:version:"?eL.to_sheet(y.type=="string"?_:ir(_),y):l(_,y)}function d(g,y){return To(u(g,y),y)}function m(g){for(var y=[],_=Er(g["!ref"]),T,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var b=[],O=_.s.c;O<=_.e.c;++O){var L=pt({r:S,c:O});if(T=E?(g[S]||[])[O]:g[L],!T||T.v==null){b.push("          ");continue}for(var A=(T.w||(xi(T),T.w)||"").slice(0,10);A.length<10;)A+=" ";b.push(A+(O===0?" ":""))}y.push(b.join(""))}return y.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:m}}();function tL(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=J7.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Bf.to_workbook(t,e)}}var yf=function(){function t(z,X,G){if(z){fn(z,z.l||0);for(var K=G.Enum||ee;z.l<z.length;){var Q=z.read_shift(2),ye=K[Q]||K[65535],Ee=z.read_shift(2),Ae=z.l+Ee,be=ye.f&&ye.f(z,Ee,G);if(z.l=Ae,X(be,ye,Q))return}}}function e(z,X){switch(X.type){case"base64":return r(qa(va(z)),X);case"binary":return r(qa(z),X);case"buffer":case"array":return r(z,X)}throw"Unsupported type "+X.type}function r(z,X){if(!z)return z;var G=X||{},K=G.dense?[]:{},Q="Sheet1",ye="",Ee=0,Ae={},be=[],Ze=[],re={s:{r:0,c:0},e:{r:0,c:0}},Ct=G.sheetRows||0;if(z[2]==0&&(z[3]==8||z[3]==9)&&z.length>=16&&z[14]==5&&z[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(z[2]==2)G.Enum=ee,t(z,function(je,Wt,Tr){switch(Tr){case 0:G.vers=je,je>=4096&&(G.qpro=!0);break;case 6:re=je;break;case 204:je&&(ye=je);break;case 222:ye=je;break;case 15:case 51:G.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:Tr==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=G.dateNF||xt[14],G.cellDates&&(je[1].t="d",je[1].v=jm(je[1].v))),G.qpro&&je[3]>Ee&&(K["!ref"]=Bt(re),Ae[Q]=K,be.push(Q),K=G.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},Ee=je[3],Q=ye||"Sheet"+(Ee+1),ye="");var Rr=G.dense?(K[je[0].r]||[])[je[0].c]:K[pt(je[0])];if(Rr){Rr.t=je[1].t,Rr.v=je[1].v,je[1].z!=null&&(Rr.z=je[1].z),je[1].f!=null&&(Rr.f=je[1].f);break}G.dense?(K[je[0].r]||(K[je[0].r]=[]),K[je[0].r][je[0].c]=je[1]):K[pt(je[0])]=je[1];break}},G);else if(z[2]==26||z[2]==14)G.Enum=ue,z[2]==14&&(G.qpro=!0,z.l=0),t(z,function(je,Wt,Tr){switch(Tr){case 204:Q=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Ee&&(K["!ref"]=Bt(re),Ae[Q]=K,be.push(Q),K=G.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},Ee=je[3],Q="Sheet"+(Ee+1)),Ct>0&&je[0].r>=Ct)break;G.dense?(K[je[0].r]||(K[je[0].r]=[]),K[je[0].r][je[0].c]=je[1]):K[pt(je[0])]=je[1],re.e.c<je[0].c&&(re.e.c=je[0].c),re.e.r<je[0].r&&(re.e.r=je[0].r);break;case 27:je[14e3]&&(Ze[je[14e3][0]]=je[14e3][1]);break;case 1537:Ze[je[0]]=je[1],je[0]==Ee&&(Q=je[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+z[2]);if(K["!ref"]=Bt(re),Ae[ye||Q]=K,be.push(ye||Q),!Ze.length)return{SheetNames:be,Sheets:Ae};for(var We={},lt=[],Fe=0;Fe<Ze.length;++Fe)Ae[be[Fe]]?(lt.push(Ze[Fe]||be[Fe]),We[Ze[Fe]]=Ae[Ze[Fe]]||Ae[be[Fe]]):(lt.push(Ze[Fe]),We[Ze[Fe]]={"!ref":"A1"});return{SheetNames:lt,Sheets:We}}function n(z,X){var G=X||{};if(+G.codepage>=0&&Ka(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Gg(),Q=Er(z["!ref"]),ye=Array.isArray(z),Ee=[];Ha(K,0,o(1030)),Ha(K,6,d(Q));for(var Ae=Math.min(Q.e.r,8191),be=Q.s.r;be<=Ae;++be)for(var Ze=gn(be),re=Q.s.c;re<=Q.e.c;++re){be===Q.s.r&&(Ee[re]=Gr(re));var Ct=Ee[re]+Ze,We=ye?(z[be]||[])[re]:z[Ct];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Ha(K,13,T(be,re,We.v)):Ha(K,14,S(be,re,We.v));else{var lt=xi(We);Ha(K,15,y(be,re,lt.slice(0,239)))}}return Ha(K,1),K.end()}function a(z,X){var G=X||{};if(+G.codepage>=0&&Ka(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Gg();Ha(K,0,l(z));for(var Q=0,ye=0;Q<z.SheetNames.length;++Q)(z.Sheets[z.SheetNames[Q]]||{})["!ref"]&&Ha(K,27,oe(z.SheetNames[Q],ye++));var Ee=0;for(Q=0;Q<z.SheetNames.length;++Q){var Ae=z.Sheets[z.SheetNames[Q]];if(!(!Ae||!Ae["!ref"])){for(var be=Er(Ae["!ref"]),Ze=Array.isArray(Ae),re=[],Ct=Math.min(be.e.r,8191),We=be.s.r;We<=Ct;++We)for(var lt=gn(We),Fe=be.s.c;Fe<=be.e.c;++Fe){We===be.s.r&&(re[Fe]=Gr(Fe));var je=re[Fe]+lt,Wt=Ze?(Ae[We]||[])[Fe]:Ae[je];if(!(!Wt||Wt.t=="z"))if(Wt.t=="n")Ha(K,23,F(We,Fe,Ee,Wt.v));else{var Tr=xi(Wt);Ha(K,22,C(We,Fe,Ee,Tr.slice(0,239)))}}++Ee}}return Ha(K,1),K.end()}function o(z){var X=Hr(2);return X.write_shift(2,z),X}function l(z){var X=Hr(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var G=0,K=0,Q=0,ye=0;ye<z.SheetNames.length;++ye){var Ee=z.SheetNames[ye],Ae=z.Sheets[Ee];if(!(!Ae||!Ae["!ref"])){++Q;var be=Wc(Ae["!ref"]);G<be.e.r&&(G=be.e.r),K<be.e.c&&(K=be.e.c)}}return G>8191&&(G=8191),X.write_shift(2,G),X.write_shift(1,Q),X.write_shift(1,K),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(z,X,G){var K={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&G.qpro?(K.s.c=z.read_shift(1),z.l++,K.s.r=z.read_shift(2),K.e.c=z.read_shift(1),z.l++,K.e.r=z.read_shift(2),K):(K.s.c=z.read_shift(2),K.s.r=z.read_shift(2),X==12&&G.qpro&&(z.l+=2),K.e.c=z.read_shift(2),K.e.r=z.read_shift(2),X==12&&G.qpro&&(z.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function d(z){var X=Hr(8);return X.write_shift(2,z.s.c),X.write_shift(2,z.s.r),X.write_shift(2,z.e.c),X.write_shift(2,z.e.r),X}function m(z,X,G){var K=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(K[0].c=z.read_shift(1),K[3]=z.read_shift(1),K[0].r=z.read_shift(2),z.l+=2):(K[2]=z.read_shift(1),K[0].c=z.read_shift(2),K[0].r=z.read_shift(2)),K}function g(z,X,G){var K=z.l+X,Q=m(z,X,G);if(Q[1].t="s",G.vers==20768){z.l++;var ye=z.read_shift(1);return Q[1].v=z.read_shift(ye,"utf8"),Q}return G.qpro&&z.l++,Q[1].v=z.read_shift(K-z.l,"cstr"),Q}function y(z,X,G){var K=Hr(7+G.length);K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,z),K.write_shift(1,39);for(var Q=0;Q<K.length;++Q){var ye=G.charCodeAt(Q);K.write_shift(1,ye>=128?95:ye)}return K.write_shift(1,0),K}function _(z,X,G){var K=m(z,X,G);return K[1].v=z.read_shift(2,"i"),K}function T(z,X,G){var K=Hr(7);return K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,z),K.write_shift(2,G,"i"),K}function E(z,X,G){var K=m(z,X,G);return K[1].v=z.read_shift(8,"f"),K}function S(z,X,G){var K=Hr(13);return K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,z),K.write_shift(8,G,"f"),K}function b(z,X,G){var K=z.l+X,Q=m(z,X,G);if(Q[1].v=z.read_shift(8,"f"),G.qpro)z.l=K;else{var ye=z.read_shift(2);D(z.slice(z.l,z.l+ye),Q),z.l+=ye}return Q}function O(z,X,G){var K=X&32768;return X&=-32769,X=(K?z:0)+(X>=8192?X-16384:X),(K?"":"$")+(G?Gr(X):gn(X))}var L={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(z,X){fn(z,0);for(var G=[],K=0,Q="",ye="",Ee="",Ae="";z.l<z.length;){var be=z[z.l++];switch(be){case 0:G.push(z.read_shift(8,"f"));break;case 1:ye=O(X[0].c,z.read_shift(2),!0),Q=O(X[0].r,z.read_shift(2),!1),G.push(ye+Q);break;case 2:{var Ze=O(X[0].c,z.read_shift(2),!0),re=O(X[0].r,z.read_shift(2),!1);ye=O(X[0].c,z.read_shift(2),!0),Q=O(X[0].r,z.read_shift(2),!1),G.push(Ze+re+":"+ye+Q)}break;case 3:if(z.l<z.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(z.read_shift(2));break;case 6:{for(var Ct="";be=z[z.l++];)Ct+=String.fromCharCode(be);G.push('"'+Ct.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:Ae=G.pop(),Ee=G.pop(),G.push(["AND","OR"][be-20]+"("+Ee+","+Ae+")");break;default:if(be<32&&A[be])Ae=G.pop(),Ee=G.pop(),G.push(Ee+A[be]+Ae);else if(L[be]){if(K=L[be][1],K==69&&(K=z[z.l++]),K>G.length){console.error("WK1 bad formula parse 0x"+be.toString(16)+":|"+G.join("|")+"|");return}var We=G.slice(-K);G.length-=K,G.push(L[be][0]+"("+We.join(",")+")")}else return be<=7?console.error("WK1 invalid opcode "+be.toString(16)):be<=24?console.error("WK1 unsupported op "+be.toString(16)):be<=30?console.error("WK1 invalid opcode "+be.toString(16)):be<=115?console.error("WK1 unsupported function opcode "+be.toString(16)):console.error("WK1 unrecognized opcode "+be.toString(16))}}G.length==1?X[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function V(z){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=z.read_shift(2),X[3]=z[z.l++],X[0].c=z[z.l++],X}function H(z,X){var G=V(z);return G[1].t="s",G[1].v=z.read_shift(X-4,"cstr"),G}function C(z,X,G,K){var Q=Hr(6+K.length);Q.write_shift(2,z),Q.write_shift(1,G),Q.write_shift(1,X),Q.write_shift(1,39);for(var ye=0;ye<K.length;++ye){var Ee=K.charCodeAt(ye);Q.write_shift(1,Ee>=128?95:Ee)}return Q.write_shift(1,0),Q}function N(z,X){var G=V(z);G[1].v=z.read_shift(2);var K=G[1].v>>1;if(G[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return G[1].v=K,G}function R(z,X){var G=V(z),K=z.read_shift(4),Q=z.read_shift(4),ye=z.read_shift(2);if(ye==65535)return K===0&&Q===3221225472?(G[1].t="e",G[1].v=15):K===0&&Q===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var Ee=ye&32768;return ye=(ye&32767)-16446,G[1].v=(1-Ee*2)*(Q*Math.pow(2,ye+32)+K*Math.pow(2,ye)),G}function F(z,X,G,K){var Q=Hr(14);if(Q.write_shift(2,z),Q.write_shift(1,G),Q.write_shift(1,X),K==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var ye=0,Ee=0,Ae=0,be=0;return K<0&&(ye=1,K=-K),Ee=Math.log2(K)|0,K/=Math.pow(2,Ee-31),be=K>>>0,(be&2147483648)==0&&(K/=2,++Ee,be=K>>>0),K-=be,be|=2147483648,be>>>=0,K*=Math.pow(2,32),Ae=K>>>0,Q.write_shift(4,Ae),Q.write_shift(4,be),Ee+=16383+(ye?32768:0),Q.write_shift(2,Ee),Q}function P(z,X){var G=R(z);return z.l+=X-14,G}function M(z,X){var G=V(z),K=z.read_shift(4);return G[1].v=K>>6,G}function U(z,X){var G=V(z),K=z.read_shift(8,"f");return G[1].v=K,G}function Me(z,X){var G=U(z);return z.l+=X-10,G}function Ne(z,X){return z[z.l+X-1]==0?z.read_shift(X,"cstr"):""}function ie(z,X){var G=z[z.l++];G>X-1&&(G=X-1);for(var K="";K.length<G;)K+=String.fromCharCode(z[z.l++]);return K}function me(z,X,G){if(!(!G.qpro||X<21)){var K=z.read_shift(1);z.l+=17,z.l+=1,z.l+=2;var Q=z.read_shift(X-21,"cstr");return[K,Q]}}function Pe(z,X){for(var G={},K=z.l+X;z.l<K;){var Q=z.read_shift(2);if(Q==14e3){for(G[Q]=[0,""],G[Q][0]=z.read_shift(2);z[z.l];)G[Q][1]+=String.fromCharCode(z[z.l]),z.l++;z.l++}}return G}function oe(z,X){var G=Hr(5+z.length);G.write_shift(2,14e3),G.write_shift(2,X);for(var K=0;K<z.length;++K){var Q=z.charCodeAt(K);G[G.l++]=Q>127?95:Q}return G[G.l++]=0,G}var ee={0:{n:"BOF",f:Fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ne},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:Me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}}();function rL(t){var e={},r=t.match(Dn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=ft(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=gx[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var nL=function(){var t=Lf("t"),e=Lf("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:zt(l[1])},d=o.match(e);return d&&(u.s=rL(d[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}}(),aL=function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(o.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),sL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,iL=/<(?:\w+:)?r>/,oL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ox(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=zt(ir(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ir(t),r&&(n.h=wx(n.t))):t.match(iL)&&(n.r=ir(t),n.t=zt(ir((t.replace(oL,"").match(sL)||[]).join("").replace(Dn,""))),r&&(n.h=aL(nL(n.r)))),n):{t:""}}var lL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,cL=/<(?:\w+:)?(?:si|sstItem)>/g,uL=/<\/(?:\w+:)?(?:si|sstItem)>/;function fL(t,e){var r=[],n="";if(!t)return r;var a=t.match(lL);if(a){n=a[2].replace(cL,"").split(uL);for(var o=0;o!=n.length;++o){var l=Ox(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=ft(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function hL(t){return[t.read_shift(4),t.read_shift(4)]}function dL(t,e){var r=[],n=!1;return Ei(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function d3(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function hi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function mL(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=hi(t,4),e.U=hi(t,4),e.W=hi(t,4),e}function pL(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function gL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(pL(t));return e}function vL(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function xL(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=hi(t,4),e.U=hi(t,4),e.W=hi(t,4),e}function _L(t){var e=xL(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function m3(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function p3(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function yL(t){var e=hi(t);switch(e.Minor){case 2:return[e.Minor,EL(t)];case 3:return[e.Minor,TL()];case 4:return[e.Minor,wL(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function EL(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=m3(t,r),a=p3(t,t.length-t.l);return{t:"Std",h:n,v:a}}function TL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wL(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Dn,function(o){var l=ft(o);switch(Fs(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function SL(t,e){var r={},n=r.EncryptionVersionInfo=hi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=m3(t,a),e-=a,r.EncryptionVerifier=p3(t,e),r}function bL(t){var e={},r=e.EncryptionVersionInfo=hi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function AL(t){var e=0,r,n=d3(t),a=n.length+1,o,l,u,d,m;for(r=go(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,d=e<<1&32767,m=u|d,e=m^l;return e^52811}var g3=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],d=104,m=l.length-1;m>=0;--m)for(var g=l[m],y=0;y!=7;++y)g&64&&(u^=r[d]),g*=2,--d;return u};return function(l){for(var u=d3(l),d=o(u),m=u.length,g=go(16),y=0;y!=16;++y)g[y]=0;var _,T,E;for((m&1)===1&&(_=d>>8,g[m]=a(t[0],_),--m,_=d&255,T=u[u.length-1],g[m]=a(T,_));m>0;)--m,_=d>>8,g[m]=a(u[m],_),--m,_=d&255,g[m]=a(u[m],_);for(m=15,E=15-u.length;E>0;)_=d>>8,g[m]=a(t[E],_),--m,--E,_=d&255,g[m]=a(u[m],_),--m,--E;return g}}(),CL=function(t,e,r,n,a){a||(a=e),n||(n=g3(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},NL=function(t){var e=0,r=g3(t);return function(n){var a=CL("",n,e,r);return e=a[1],a[0]}};function RL(t,e,r,n){var a={key:Fr(t),verificationBytes:Fr(t)};return r.password&&(a.verifier=AL(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=NL(r.password)),a}function kL(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=bL(t):n.Data=SL(t,e),n}function IL(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?kL(t,e-2,n):RL(t,r.biff>=8?e:e-2,r,n),n}var DL=function(){function t(a,o){switch(o.type){case"base64":return e(va(a),o);case"binary":return e(a,o);case"buffer":return e(kt&&Buffer.isBuffer(a)?a.toString("binary"):xl(a),o);case"array":return e(hl(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,T=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var b=g.slice(T,_.lastIndex-E[0].length);if(b[0]==" "&&(b=b.slice(1)),++S,b.length){var O={v:b,t:"s"};Array.isArray(u)?u[y][S]=O:u[pt({r:y,c:S})]=O}break}T=_.lastIndex}S>m.e.c&&(m.e.c=S)}),u["!ref"]=Bt(m),u}function r(a,o){return To(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Er(a["!ref"]),u,d=Array.isArray(a),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var y=pt({r:m,c:g});u=d?(a[m]||[])[g]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(xi(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function OL(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Vf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function jL(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,d=0,m=a+o;switch(d=l/(m>1?2-m:m),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,d,m/2]}function PL(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,d;if(r!==0)switch(u|0){case 0:case 6:d=a*u,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-u),l[0]+=d,l[1]+=a;break;case 2:d=a*(u-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-u),l[1]+=d,l[2]+=a;break;case 4:d=a*(u-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-u),l[2]+=d,l[0]+=a;break}for(var m=0;m!=3;++m)l[m]=Math.round(l[m]*255);return l}function Q0(t,e){if(e===0)return t;var r=jL(OL(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Vf(PL(r))}var v3=6,FL=15,LL=1,zn=v3;function J0(t){return Math.floor((t+Math.round(128/zn)/256)*zn)}function Z0(t){return Math.floor((t-5)/zn*100+.5)/100}function Wg(t){return Math.round((t*zn+5)/zn*256)/256}function og(t){return Wg(Z0(J0(t)))}function jx(t){var e=Math.abs(t-og(t)),r=zn;if(e>.005)for(zn=LL;zn<FL;++zn)Math.abs(t-og(t))<=e&&(e=Math.abs(t-og(t)),r=zn);zn=r}function Dc(t){t.width?(t.wpx=J0(t.width),t.wch=Z0(t.wpx),t.MDW=zn):t.wpx?(t.wch=Z0(t.wpx),t.width=Wg(t.wch),t.MDW=zn):typeof t.wch=="number"&&(t.width=Wg(t.wch),t.wpx=J0(t.width),t.MDW=zn),t.customWidth&&delete t.customWidth}var ML=96,x3=ML;function _3(t){return t*96/x3}function Uf(t){return t*x3/96}var BL={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function VL(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(Dn)||[]).forEach(function(l){var u=ft(l);switch(Fs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=hr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=hr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function UL(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(Dn)||[]).forEach(function(l){var u=ft(l);switch(Fs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function zL(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(Dn)||[]).forEach(function(l){var u=ft(l);switch(Fs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=ir(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?hr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?hr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?hr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?hr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?hr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?hr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?hr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=gx[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=hr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var d=rl[a.color.index];a.color.index==81&&(d=rl[1]),d||(d=rl[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Q0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function HL(t,e,r){e.NumberFmt=[];for(var n=Ds(xt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=xt[n[a]];var o=t[0].match(Dn);if(o)for(a=0;a<o.length;++a){var l=ft(o[a]);switch(Fs(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=zt(ir(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=u}tl(u,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Jd=["numFmtId","fillId","fontId","borderId","xfId"],Zd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function GL(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Dn)||[]).forEach(function(o){var l=ft(o),u=0;switch(Fs(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<Jd.length;++u)n[Jd[u]]&&(n[Jd[u]]=parseInt(n[Jd[u]],10));for(u=0;u<Zd.length;++u)n[Zd[u]]&&(n[Zd[u]]=hr(n[Zd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=hr(l.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var qL=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,m){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(e))&&HL(y,g,m),(y=u.match(a))&&zL(y,g,d,m),(y=u.match(n))&&UL(y,g,d,m),(y=u.match(o))&&VL(y,g,d,m),(y=u.match(r))&&GL(y,g,m),g}}();function $L(t,e){var r=t.read_shift(2),n=Nn(t);return[r,n]}function YL(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=nF(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var d=t.read_shift(1);switch(d>0&&(n.charset=d),t.l++,n.color=rF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Nn(t),n}var WL=In;function KL(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}var XL=In;function QL(t,e,r){var n={};n.NumberFmt=[];for(var a in xt)n.NumberFmt[a]=xt[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return Ei(t,function(d,m,g){switch(g){case 44:n.NumberFmt[d[0]]=d[1],tl(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=Q0(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(g),l=!0;break;case 38:o.pop(),l=!1;break;default:if(m.T>0)o.push(g);else if(m.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}var JL=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ZL(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Dn)||[]).forEach(function(a){var o=ft(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[JL.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function eM(){}function tM(){}var rM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sM(t,e,r){e.themeElements={};var n;[["clrScheme",rM,ZL],["fontScheme",nM,eM],["fmtScheme",aM,tM]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var iM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function y3(t,e){(!t||t.length===0)&&(t=oM());var r,n={};if(!(r=t.match(iM)))throw new Error("themeElements not found in theme");return sM(r[0],n,e),n.raw=t,n}function oM(t,e){var r=[IA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function lM(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=kA(o,{type:"array"})}catch{return}var u=ma(l,"theme/theme/theme1.xml",!0);if(u)return y3(u,r)}}function cM(t){return t.read_shift(4)}function uM(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=fM(t,4);break;case 2:e.xclrValue=i3(t);break;case 3:e.xclrValue=cM(t);break;case 4:t.l+=4;break}return t.l+=8,e}function fM(t,e){return In(t,e)}function hM(t,e){return In(t,e)}function dM(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=uM(t);break;case 6:n[1]=hM(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function mM(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(dM(t,r-t.l));return{ixfe:n,ext:o}}function pM(t,e){e.forEach(function(r){r[0]})}function gM(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Nn(t)}}function vM(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function xM(t){return t.l+=4,t.read_shift(4)!=0}function _M(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return Ei(t,function(d,m,g){switch(g){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(y){u==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):u==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:o.push(g),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!m.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function yM(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(Dn,function(u){var d=ft(u);switch(Fs(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==d.name&&(l=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):o==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),n}function EM(t){var e=[];if(!t)return e;var r=1;return(t.match(Dn)||[]).forEach(function(n){var a=ft(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function TM(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=pt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function wM(t,e,r){var n=[];return Ei(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function SM(t,e,r,n){if(!t)return t;var a=n||{},o=!1;Ei(t,function(u,d,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},a)}function bM(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function $4(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=Gn(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var d=Er(t["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var m=Bt(d);m!==t["!ref"]&&(t["!ref"]=m)}o.c||(o.c=[]);var g={a:l.author,t:l.t,r:l.r,T:r};l.h&&(g.h=l.h);for(var y=o.c.length-1;y>=0;--y){if(!r&&o.c[y].T)return;r&&!o.c[y].T&&o.c.splice(y,1)}if(r&&n){for(y=0;y<n.length;++y)if(g.a==n[y].id){g.a=n[y].name||g.a;break}}o.c.push(g)})}function AM(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=ft(u[0]),m={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=Gn(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&Ox(y[1])||{r:"",t:"",h:""};m.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),m.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(m.h=_.h),n.push(m)}}}}),n}function CM(t,e){var r=[],n=!1,a={},o=0;return t.replace(Dn,function(u,d){var m=ft(u);switch(Fs(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=d+u.length;break;case"</text>":a.t=t.slice(o,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return u}),r}function NM(t,e){var r=[],n=!1;return t.replace(Dn,function(o){var l=ft(o);switch(Fs(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function RM(t){var e={};e.iauthor=t.read_shift(4);var r=yl(t);return e.rfx=r.s,e.ref=pt(r.s),t.l+=16,e}var kM=Nn;function IM(t,e){var r=[],n=[],a={},o=!1;return Ei(t,function(u,d,m){switch(m){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}var DM="application/vnd.ms-office.vbaProject";function OM(t){var e=Mt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Mt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),Mt.write(e)}function jM(){return{"!type":"dialog"}}function PM(){return{"!type":"dialog"}}function FM(){return{"!type":"macro"}}function LM(){return{"!type":"macro"}}var wc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return u?g+=e.c:--g,d?m+=e.r:--m,a+(u?"":"$")+Gr(g)+(d?"":"$")+gn(m)}return function(a,o){return e=o,a.replace(t,r)}}(),E3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,MM=function(){return function(e,r){return e.replace(E3,function(n,a,o,l,u,d){var m=Cx(l)-(o?0:r.c),g=Ax(d)-(u?0:r.r),y=g==0?"":u?g+1:"["+g+"]",_=m==0?"":o?m+1:"["+m+"]";return a+"R"+y+"C"+_})}}();function T3(t,e){return t.replace(E3,function(r,n,a,o,l,u){return n+(a=="$"?a+o:Gr(Cx(o)+e.c))+(l=="$"?l+u:gn(Ax(u)+e.r))})}function BM(t,e,r){var n=Wc(e),a=n.s,o=Gn(r),l={r:o.r-a.r,c:o.c-a.c};return T3(t,l)}function VM(t){return t.length!=1}function Y4(t){return t.replace(/_xlfn\./g,"")}function Or(t){t.l+=1}function vo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function w3(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return S3(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=vo(t),u=vo(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function S3(t){var e=vo(t),r=vo(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function UM(t,e,r){if(r.biff<8)return S3(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=vo(t),l=vo(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function b3(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return zM(t);var n=t.read_shift(r&&r.biff==12?4:2),a=vo(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function zM(t){var e=vo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function HM(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function GM(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qM(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function qM(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function $M(t,e,r){var n=(t[t.l++]&96)>>5,a=w3(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function YM(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=w3(t,o,r);return[n,a,l]}function WM(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function KM(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function XM(t,e,r){var n=(t[t.l++]&96)>>5,a=UM(t,e-1,r);return[n,a]}function QM(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function W4(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function JM(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function ZM(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function eB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function tB(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function rB(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function A3(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function nB(t){return t.read_shift(2),A3(t)}function aB(t){return t.read_shift(2),A3(t)}function sB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=b3(t,0,r);return[n,a]}function iB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=GM(t,0,r);return[n,a]}function oB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=b3(t,0,r);return[n,a,o]}function lB(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[cV[a],R3[a],n]}function cB(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:uB(t);return[a,(o[0]===0?R3:lV)[o[1]]]}function uB(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function fB(t,e,r){t.l+=r&&r.biff==2?3:4}function hB(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function dB(t){return t.l++,El[t.read_shift(1)]}function mB(t){return t.l++,t.read_shift(2)}function pB(t){return t.l++,t.read_shift(1)!==0}function gB(t){return t.l++,bn(t)}function vB(t,e,r){return t.l++,xh(t,e-1,r)}function xB(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Cr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=El[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=bn(t);break;case 2:r[1]=Tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _B(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?yl:Pm)(t));return a}function yB(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=xB(t,r.biff);return l}function EB(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function TB(t,e,r){if(r.biff==5)return wB(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function wB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function SB(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function bB(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function AB(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function CB(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var NB=In,RB=In,kB=In;function yh(t,e,r){return t.l+=2,[HM(t)]}function Px(t){return t.l+=6,[]}var IB=yh,DB=Px,OB=Px,jB=yh;function C3(t){return t.l+=2,[Fr(t),t.read_shift(2)&1]}var PB=yh,FB=C3,LB=Px,MB=yh,BB=yh,VB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function UB(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=VB[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function zB(t){return t.l+=2,[t.read_shift(4)]}function HB(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function GB(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function qB(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $B(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function YB(t){return t.l+=4,[0,0]}var K4={1:{n:"PtgExp",f:hB},2:{n:"PtgTbl",f:kB},3:{n:"PtgAdd",f:Or},4:{n:"PtgSub",f:Or},5:{n:"PtgMul",f:Or},6:{n:"PtgDiv",f:Or},7:{n:"PtgPower",f:Or},8:{n:"PtgConcat",f:Or},9:{n:"PtgLt",f:Or},10:{n:"PtgLe",f:Or},11:{n:"PtgEq",f:Or},12:{n:"PtgGe",f:Or},13:{n:"PtgGt",f:Or},14:{n:"PtgNe",f:Or},15:{n:"PtgIsect",f:Or},16:{n:"PtgUnion",f:Or},17:{n:"PtgRange",f:Or},18:{n:"PtgUplus",f:Or},19:{n:"PtgUminus",f:Or},20:{n:"PtgPercent",f:Or},21:{n:"PtgParen",f:Or},22:{n:"PtgMissArg",f:Or},23:{n:"PtgStr",f:vB},26:{n:"PtgSheet",f:HB},27:{n:"PtgEndSheet",f:GB},28:{n:"PtgErr",f:dB},29:{n:"PtgBool",f:pB},30:{n:"PtgInt",f:mB},31:{n:"PtgNum",f:gB},32:{n:"PtgArray",f:QM},33:{n:"PtgFunc",f:lB},34:{n:"PtgFuncVar",f:cB},35:{n:"PtgName",f:EB},36:{n:"PtgRef",f:sB},37:{n:"PtgArea",f:$M},38:{n:"PtgMemArea",f:SB},39:{n:"PtgMemErr",f:NB},40:{n:"PtgMemNoMem",f:RB},41:{n:"PtgMemFunc",f:bB},42:{n:"PtgRefErr",f:AB},43:{n:"PtgAreaErr",f:WM},44:{n:"PtgRefN",f:iB},45:{n:"PtgAreaN",f:XM},46:{n:"PtgMemAreaN",f:qB},47:{n:"PtgMemNoMemN",f:$B},57:{n:"PtgNameX",f:TB},58:{n:"PtgRef3d",f:oB},59:{n:"PtgArea3d",f:YM},60:{n:"PtgRefErr3d",f:CB},61:{n:"PtgAreaErr3d",f:KM},255:{}},WB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KB={1:{n:"PtgElfLel",f:C3},2:{n:"PtgElfRw",f:MB},3:{n:"PtgElfCol",f:IB},6:{n:"PtgElfRwV",f:BB},7:{n:"PtgElfColV",f:jB},10:{n:"PtgElfRadical",f:PB},11:{n:"PtgElfRadicalS",f:LB},13:{n:"PtgElfColS",f:DB},15:{n:"PtgElfColSV",f:OB},16:{n:"PtgElfRadicalLel",f:FB},25:{n:"PtgList",f:UB},29:{n:"PtgSxName",f:zB},255:{}},XB={0:{n:"PtgAttrNoop",f:YB},1:{n:"PtgAttrSemi",f:rB},2:{n:"PtgAttrIf",f:eB},4:{n:"PtgAttrChoose",f:JM},8:{n:"PtgAttrGoto",f:ZM},16:{n:"PtgAttrSum",f:fB},32:{n:"PtgAttrBaxcel",f:W4},33:{n:"PtgAttrBaxcel",f:W4},64:{n:"PtgAttrSpace",f:nB},65:{n:"PtgAttrSpaceSemi",f:aB},128:{n:"PtgAttrIfError",f:tB},255:{}};function Eh(t,e,r,n){if(n.biff<8)return In(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=yB(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=_B(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(In(t,e)),o}function Th(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=K4[o]||K4[WB[o]],(o===24||o===25)&&(a=(o===24?KB:XB)[t[t.l+1]]),!a||!a.f?In(t,e):l.push([a.n,a.f(t,e,r)]);return l}function QB(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var JB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ZB(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function N3(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function X4(t,e,r){var n=N3(t,e,r);return n=="#REF"?n:ZB(n,r)}function Sn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],d,m,g,y=0,_=0,T,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,b="",O=0,L=t[0].length;O<L;++O){var A=t[0][O];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),m=u.pop(),S>=0){switch(t[0][S][1][0]){case 0:b=yr(" ",t[0][S][1][1]);break;case 1:b=yr("\r",t[0][S][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}m=m+b,S=-1}u.push(m+JB[A[0]]+d);break;case"PtgIsect":d=u.pop(),m=u.pop(),u.push(m+" "+d);break;case"PtgUnion":d=u.pop(),m=u.pop(),u.push(m+","+d);break;case"PtgRange":d=u.pop(),m=u.pop(),u.push(m+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=gf(A[1][1],l,a),u.push(vf(g,o));break;case"PtgRefN":g=r?gf(A[1][1],r,a):A[1][1],u.push(vf(g,o));break;case"PtgRef3d":y=A[1][1],g=gf(A[1][2],l,a),E=X4(n,y,a),u.push(E+"!"+vf(g,o));break;case"PtgFunc":case"PtgFuncVar":var D=A[1][0],V=A[1][1];D||(D=0),D&=127;var H=D==0?[]:u.slice(-D);u.length-=D,V==="User"&&(V=H.shift()),u.push(V+"("+H.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":T=k4(A[1][1],r?{s:r}:l,a),u.push(sg(T,a));break;case"PtgArea":T=k4(A[1][1],l,a),u.push(sg(T,a));break;case"PtgArea3d":y=A[1][1],T=A[1][2],E=X4(n,y,a),u.push(E+"!"+sg(T,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=A[1][2];var C=(n.names||[])[_-1]||(n[0]||[])[_],N=C?C.Name:"SH33TJSNAME"+String(_);N&&N.slice(0,6)=="_xlfn."&&!a.xlfn&&(N=N.slice(6)),u.push(N);break;case"PtgNameX":var R=A[1][1];_=A[1][2];var F;if(a.biff<=5)R<0&&(R=-R),n[R]&&(F=n[R][_]);else{var P="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][_]&&n[R][_].itab>0&&(P=n.SheetNames[n[R][_].itab-1]+"!"):P=n.SheetNames[_-1]+"!"),n[R]&&n[R][_])P+=n[R][_].Name;else if(n[0]&&n[0][_])P+=n[0][_].Name;else{var M=(N3(n,R,a)||"").split(";;");M[_-1]?P=M[_-1]:P+="SH33TJSERRX"}u.push(P);break}F||(F={Name:"SH33TJSERRY"}),u.push(F.Name);break;case"PtgParen":var U="(",Me=")";if(S>=0){switch(b="",t[0][S][1][0]){case 2:U=yr(" ",t[0][S][1][1])+U;break;case 3:U=yr("\r",t[0][S][1][1])+U;break;case 4:Me=yr(" ",t[0][S][1][1])+Me;break;case 5:Me=yr("\r",t[0][S][1][1])+Me;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}u.push(U+u.pop()+Me);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:A[1][1],r:A[1][0]};var Ne={c:r.c,r:r.r};if(n.sharedf[pt(g)]){var ie=n.sharedf[pt(g)];u.push(Sn(ie,l,Ne,n,a))}else{var me=!1;for(d=0;d!=n.arrayf.length;++d)if(m=n.arrayf[d],!(g.c<m[0].s.c||g.c>m[0].e.c)&&!(g.r<m[0].s.r||g.r>m[0].e.r)){u.push(Sn(m[1],l,Ne,n,a)),me=!0;break}me||u.push(A[1])}break;case"PtgArray":u.push("{"+QB(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&Pe.indexOf(t[0][O][0])==-1){A=t[0][S];var oe=!0;switch(A[1][0]){case 4:oe=!1;case 0:b=yr(" ",A[1][1]);break;case 5:oe=!1;case 1:b=yr("\r",A[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((oe?b:"")+u.pop()+(oe?"":b)),S=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function eV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],In(t,e-2)];var u=Th(t,l,r);return e!==l+a&&(o=Eh(t,e-l-a,u,r)),t.l=n,[u,o]}function tV(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],In(t,e-2)];var u=Th(t,l,r);return e!==l+a&&(o=Eh(t,e-l-a,u,r)),t.l=n,[u,o]}function rV(t,e,r,n){var a=t.l+e,o=Th(t,n,r),l;return a!==t.l&&(l=Eh(t,a-t.l,o,r)),[o,l]}function nV(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=Th(t,o,r);return o==65535?[[],In(t,e-2)]:(e!==o+2&&(a=Eh(t,n-o-2,l,r)),[l,a])}function aV(t){var e;if(ii(t,t.l+6)!==65535)return[bn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function lg(t,e,r){var n=t.l+e,a=Ls(t);r.biff==2&&++t.l;var o=aV(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=tV(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function Fm(t,e,r){var n=t.read_shift(4),a=Th(t,n,r),o=t.read_shift(4),l=o>0?Eh(t,o,a,r):null;return[a,l]}var sV=Fm,Lm=Fm,iV=Fm,oV=Fm,lV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},R3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},cV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Q4(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function cg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Ef={},Sc={};function Tf(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function k3(t,e,r,n,a,o){try{n.cellNF&&(t.z=xt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=nn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(xt[e]==null&&tl(uP[e]||"General",e),t.t==="e")t.w=t.w||El[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ff(t.v);else if(t.t==="d"){var l=$n(t.v);(l|0)===l?t.w=l.toString(10):t.w=Ff(l)}else{if(t.v===void 0)return"";t.w=fl(t.v,Sc)}else t.t==="d"?t.w=ja(e,$n(t.v),Sc):t.w=ja(e,t.v,Sc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Q0(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Q0(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function uV(t,e){var r=Er(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Bt(r))}var fV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dV=/<(?:\w:)?hyperlink [^>]*>/mg,mV=/"(\w*:\w*)"/,pV=/<(?:\w:)?col\b[^>]*[\/]?>/g,gV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vV=/<(?:\w:)?pageMargins[^>]*\/>/g,I3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_V=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yV(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",g="",y=t.match(hV);y?(m=t.slice(0,y.index),g=t.slice(y.index+y[0].length)):m=g=t;var _=m.match(I3);_?Fx(_[0],u,a,r):(_=m.match(xV))&&EV(_[0],_[1]||"",u,a,r);var T=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var E=m.slice(T,T+50).match(mV);E&&uV(u,E[1])}var S=m.match(_V);S&&S[1]&&CV(S[1],a);var b=[];if(e.cellStyles){var O=m.match(pV);O&&SV(b,O)}y&&NV(y[1],u,e,d,o,l);var L=g.match(gV);L&&(u["!autofilter"]=bV(L[0]));var A=[],D=g.match(fV);if(D)for(T=0;T!=D.length;++T)A[T]=Er(D[T].slice(D[T].indexOf('"')+1));var V=g.match(dV);V&&TV(u,V,n);var H=g.match(vV);if(H&&(u["!margins"]=wV(ft(H[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=Bt(d)),e.sheetRows>0&&u["!ref"]){var C=Er(u["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>d.e.r&&(C.e.r=d.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>d.e.c&&(C.e.c=d.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Bt(C))}return b.length>0&&(u["!cols"]=b),A.length>0&&(u["!merges"]=A),u}function Fx(t,e,r,n){var a=ft(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=zt(ir(a.codeName)))}function EV(t,e,r,n,a){Fx(t.slice(0,t.indexOf(">")),r,n,a)}function TV(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=ft(ir(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+zt(o.location))):(o.Target="#"+zt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Er(o.ref),d=u.s.r;d<=u.e.r;++d)for(var m=u.s.c;m<=u.e.c;++m){var g=pt({c:m,r:d});n?(t[d]||(t[d]=[]),t[d][m]||(t[d][m]={t:"z",v:void 0}),t[d][m].l=o):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=o)}}}function wV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function SV(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ft(e[n],!0);a.hidden&&(a.hidden=hr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,jx(a.width)),Dc(a);o<=l;)t[o++]=pn(a)}}function bV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var AV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function CV(t,e){e.Views||(e.Views=[{}]),(t.match(AV)||[]).forEach(function(r,n){var a=ft(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),hr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}var NV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Lf("v"),l=Lf("f");return function(d,m,g,y,_,T){for(var E=0,S="",b=[],O=[],L=0,A=0,D=0,V="",H,C,N=0,R=0,F,P,M=0,U=0,Me=Array.isArray(T.CellXf),Ne,ie=[],me=[],Pe=Array.isArray(m),oe=[],ee={},ue=!1,z=!!g.sheetStubs,X=d.split(e),G=0,K=X.length;G!=K;++G){S=X[G].trim();var Q=S.length;if(Q!==0){var ye=0;e:for(E=0;E<Q;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(C=ft(S.slice(ye,E),!0),N=C.r!=null?parseInt(C.r,10):N+1,R=-1,g.sheetRows&&g.sheetRows<N)continue;ee={},ue=!1,C.ht&&(ue=!0,ee.hpt=parseFloat(C.ht),ee.hpx=Uf(ee.hpt)),C.hidden=="1"&&(ue=!0,ee.hidden=!0),C.outlineLevel!=null&&(ue=!0,ee.level=+C.outlineLevel),ue&&(oe[N-1]=ee)}break;case"<":ye=E;break}if(ye>=E)break;if(C=ft(S.slice(ye,E),!0),N=C.r!=null?parseInt(C.r,10):N+1,R=-1,!(g.sheetRows&&g.sheetRows<N)){y.s.r>N-1&&(y.s.r=N-1),y.e.r<N-1&&(y.e.r=N-1),g&&g.cellStyles&&(ee={},ue=!1,C.ht&&(ue=!0,ee.hpt=parseFloat(C.ht),ee.hpx=Uf(ee.hpt)),C.hidden=="1"&&(ue=!0,ee.hidden=!0),C.outlineLevel!=null&&(ue=!0,ee.level=+C.outlineLevel),ue&&(oe[N-1]=ee)),b=S.slice(E).split(t);for(var Ee=0;Ee!=b.length&&b[Ee].trim().charAt(0)=="<";++Ee);for(b=b.slice(Ee),E=0;E!=b.length;++E)if(S=b[E].trim(),S.length!==0){if(O=S.match(r),L=E,A=0,D=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,O!=null&&O.length===2){for(L=0,V=O[1],A=0;A!=V.length&&!((D=V.charCodeAt(A)-64)<1||D>26);++A)L=26*L+D;--L,R=L}else++R;for(A=0;A!=S.length&&S.charCodeAt(A)!==62;++A);if(++A,C=ft(S.slice(0,A),!0),C.r||(C.r=pt({r:N-1,c:R})),V=S.slice(A),H={t:""},(O=V.match(o))!=null&&O[1]!==""&&(H.v=zt(O[1])),g.cellFormula){if((O=V.match(l))!=null&&O[1]!==""){if(H.f=zt(ir(O[1])).replace(/\r\n/g,`
`),g.xlfn||(H.f=Y4(H.f)),O[0].indexOf('t="array"')>-1)H.F=(V.match(a)||[])[1],H.F.indexOf(":")>-1&&ie.push([Er(H.F),H.F]);else if(O[0].indexOf('t="shared"')>-1){P=ft(O[0]);var Ae=zt(ir(O[1]));g.xlfn||(Ae=Y4(Ae)),me[parseInt(P.si,10)]=[P,Ae,C.r]}}else(O=V.match(/<f[^>]*\/>/))&&(P=ft(O[0]),me[P.si]&&(H.f=BM(me[P.si][1],me[P.si][2],C.r)));var be=Gn(C.r);for(A=0;A<ie.length;++A)be.r>=ie[A][0].s.r&&be.r<=ie[A][0].e.r&&be.c>=ie[A][0].s.c&&be.c<=ie[A][0].e.c&&(H.F=ie[A][1])}if(C.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(z)H.t="z";else continue;else H.t=C.t||"n";switch(y.s.c>R&&(y.s.c=R),y.e.c<R&&(y.e.c=R),H.t){case"n":if(H.v==""||H.v==null){if(!z)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!z)continue;H.t="z"}else F=Ef[parseInt(H.v,10)],H.v=F.t,H.r=F.r,g.cellHTML&&(H.h=F.h);break;case"str":H.t="s",H.v=H.v!=null?ir(H.v):"",g.cellHTML&&(H.h=wx(H.v));break;case"inlineStr":O=V.match(n),H.t="s",O!=null&&(F=Ox(O[1]))?(H.v=F.t,g.cellHTML&&(H.h=F.h)):H.v="";break;case"b":H.v=hr(H.v);break;case"d":g.cellDates?H.v=nn(H.v,1):(H.v=$n(nn(H.v,1)),H.t="n");break;case"e":(!g||g.cellText!==!1)&&(H.w=H.v),H.v=JA[H.v];break}if(M=U=0,Ne=null,Me&&C.s!==void 0&&(Ne=T.CellXf[C.s],Ne!=null&&(Ne.numFmtId!=null&&(M=Ne.numFmtId),g.cellStyles&&Ne.fillId!=null&&(U=Ne.fillId))),k3(H,M,U,g,_,T),g.cellDates&&Me&&H.t=="n"&&Yc(xt[M])&&(H.t="d",H.v=jm(H.v)),C.cm&&g.xlmeta){var Ze=(g.xlmeta.Cell||[])[+C.cm-1];Ze&&Ze.type=="XLDAPR"&&(H.D=!0)}if(Pe){var re=Gn(C.r);m[re.r]||(m[re.r]=[]),m[re.r][re.c]=H}else m[C.r]=H}}}}oe.length>0&&(m["!rows"]=oe)}}();function RV(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}var kV=yl;function IV(){}function DV(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=eF(t),r}function OV(t){var e=Pa(t);return[e]}function jV(t){var e=_l(t);return[e]}function PV(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"b"]}function FV(t){var e=_l(t),r=t.read_shift(1);return[e,r,"b"]}function LV(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"e"]}function MV(t){var e=_l(t),r=t.read_shift(1);return[e,r,"e"]}function BV(t){var e=Pa(t),r=t.read_shift(4);return[e,r,"s"]}function VV(t){var e=_l(t),r=t.read_shift(4);return[e,r,"s"]}function UV(t){var e=Pa(t),r=bn(t);return[e,r,"n"]}function D3(t){var e=_l(t),r=bn(t);return[e,r,"n"]}function zV(t){var e=Pa(t),r=kx(t);return[e,r,"n"]}function HV(t){var e=_l(t),r=kx(t);return[e,r,"n"]}function GV(t){var e=Pa(t),r=Nx(t);return[e,r,"is"]}function qV(t){var e=Pa(t),r=Nn(t);return[e,r,"str"]}function $V(t){var e=_l(t),r=Nn(t);return[e,r,"str"]}function YV(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);l[3]=Sn(u,null,a,r.supbooks,r)}else t.l=n;return l}function WV(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);l[3]=Sn(u,null,a,r.supbooks,r)}else t.l=n;return l}function KV(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=bn(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);l[3]=Sn(u,null,a,r.supbooks,r)}else t.l=n;return l}function XV(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=Nn(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);l[3]=Sn(u,null,a,r.supbooks,r)}else t.l=n;return l}var QV=yl;function JV(t,e){var r=t.l+e,n=yl(t),a=Rx(t),o=Nn(t),l=Nn(t),u=Nn(t);t.l=r;var d={rfx:n,relId:a,loc:o,display:u};return l&&(d.Tooltip=l),d}function ZV(){}function eU(t,e,r){var n=t.l+e,a=KA(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=sV(t,n-t.l,r);l[1]=u}else t.l=n;return l}function tU(t,e,r){var n=t.l+e,a=yl(t),o=[a];if(r.cellFormula){var l=oV(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}var rU=["left","right","top","bottom","header","footer"];function nU(t){var e={};return rU.forEach(function(r){e[r]=bn(t)}),e}function aU(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function sU(){}function iU(){}function oU(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var d=u.dense?[]:{},m,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,T,E,S,b,O,L,A,D,V,H=[];u.biff=12,u["!row"]=0;var C=0,N=!1,R=[],F={},P=u.supbooks||a.supbooks||[[]];if(P.sharedf=F,P.arrayf=R,P.SheetNames=a.SheetNames||a.Sheets.map(function(Pe){return Pe.name}),!u.supbooks&&(u.supbooks=P,a.Names))for(var M=0;M<a.Names.length;++M)P[0][M+1]=a.Names[M];var U=[],Me=[],Ne=!1;em[16]={n:"BrtShortReal",f:D3};var ie;if(Ei(t,function(oe,ee,ue){if(!_)switch(ue){case 148:m=oe;break;case 0:T=oe,u.sheetRows&&u.sheetRows<=T.r&&(_=!0),D=gn(b=T.r),u["!row"]=T.r,(oe.hidden||oe.hpt||oe.level!=null)&&(oe.hpt&&(oe.hpx=Uf(oe.hpt)),Me[oe.r]=oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:oe[2]},oe[2]){case"n":E.v=oe[1];break;case"s":A=Ef[oe[1]],E.v=A.t,E.r=A.r;break;case"b":E.v=!!oe[1];break;case"e":E.v=oe[1],u.cellText!==!1&&(E.w=El[E.v]);break;case"str":E.t="s",E.v=oe[1];break;case"is":E.t="s",E.v=oe[1].t;break}if((S=l.CellXf[oe[0].iStyleRef])&&k3(E,S.numFmtId,null,u,o,l),O=oe[0].c==-1?O+1:oe[0].c,u.dense?(d[b]||(d[b]=[]),d[b][O]=E):d[Gr(O)+D]=E,u.cellFormula){for(N=!1,C=0;C<R.length;++C){var z=R[C];T.r>=z[0].s.r&&T.r<=z[0].e.r&&O>=z[0].s.c&&O<=z[0].e.c&&(E.F=Bt(z[0]),N=!0)}!N&&oe.length>3&&(E.f=oe[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>O&&(g.s.c=O),g.e.r<T.r&&(g.e.r=T.r),g.e.c<O&&(g.e.c=O),u.cellDates&&S&&E.t=="n"&&Yc(xt[S.numFmtId])){var X=el(E.v);X&&(E.t="d",E.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;E={t:"z",v:void 0},O=oe[0].c==-1?O+1:oe[0].c,u.dense?(d[b]||(d[b]=[]),d[b][O]=E):d[Gr(O)+D]=E,g.s.r>T.r&&(g.s.r=T.r),g.s.c>O&&(g.s.c=O),g.e.r<T.r&&(g.e.r=T.r),g.e.c<O&&(g.e.c=O),ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 176:H.push(oe);break;case 49:ie=((u.xlmeta||{}).Cell||[])[oe-1];break;case 494:var G=n["!id"][oe.relId];for(G?(oe.Target=G.Target,oe.loc&&(oe.Target+="#"+oe.loc),oe.Rel=G):oe.relId==""&&(oe.Target="#"+oe.loc),b=oe.rfx.s.r;b<=oe.rfx.e.r;++b)for(O=oe.rfx.s.c;O<=oe.rfx.e.c;++O)u.dense?(d[b]||(d[b]=[]),d[b][O]||(d[b][O]={t:"z",v:void 0}),d[b][O].l=oe):(L=pt({c:O,r:b}),d[L]||(d[L]={t:"z",v:void 0}),d[L].l=oe);break;case 426:if(!u.cellFormula)break;R.push(oe),V=u.dense?d[b][O]:d[Gr(O)+D],V.f=Sn(oe[1],g,{r:T.r,c:O},P,u),V.F=Bt(oe[0]);break;case 427:if(!u.cellFormula)break;F[pt(oe[0].s)]=oe[1],V=u.dense?d[b][O]:d[Gr(O)+D],V.f=Sn(oe[1],g,{r:T.r,c:O},P,u);break;case 60:if(!u.cellStyles)break;for(;oe.e>=oe.s;)U[oe.e--]={width:oe.w/256,hidden:!!(oe.flags&1),level:oe.level},Ne||(Ne=!0,jx(oe.w/256)),Dc(U[oe.e+1]);break;case 161:d["!autofilter"]={ref:Bt(oe)};break;case 476:d["!margins"]=oe;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),oe.name&&(a.Sheets[r].CodeName=oe.name),(oe.above||oe.left)&&(d["!outline"]={above:oe.above,left:oe.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),oe.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!ee.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(g.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(d["!ref"]=Bt(m||g)),u.sheetRows&&d["!ref"]){var me=Er(d["!ref"]);u.sheetRows<=+me.e.r&&(me.e.r=u.sheetRows-1,me.e.r>g.e.r&&(me.e.r=g.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>g.e.c&&(me.e.c=g.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Bt(me))}return H.length>0&&(d["!merges"]=H),U.length>0&&(d["!cols"]=U),Me.length>0&&(d["!rows"]=Me),d}function lU(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=zt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function cU(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,d=0,m="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=lU(y);g.s.r=g.s.c=0,g.e.c=u,m=Gr(u),_[0].forEach(function(T,E){l[m+gn(E)]={t:"n",v:T,z:_[1]},d=E}),g.e.r<d&&(g.e.r=d),++u}),u>0&&(l["!ref"]=Bt(g)),l}function uU(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(I3);return u&&Fx(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function fU(t,e){t.l+=10;var r=Nn(t);return{name:r}}function hU(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ei(t,function(d,m,g){switch(g){case 550:o["!rel"]=d;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),d.name&&(a.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var O3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dU=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],mU=[],pU=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function J4(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=hr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function Z4(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=hr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function j3(t){Z4(t.WBProps,O3),Z4(t.CalcPr,pU),J4(t.WBView,dU),J4(t.Sheets,mU),Sc.date1904=hr(t.WBProps.date1904)}var gU="][*?/\\".split("");function vU(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return gU.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var xU=/<\w+:workbook/;function _U(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(Dn,function(d,m){var g=ft(d);switch(Fs(g[0])){case"<?xml":break;case"<workbook":d.match(xU)&&(a="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":O3.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":r.WBProps[y[0]]=hr(g[y[0]]);break;case"int":r.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:r.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(r.WBProps.CodeName=ir(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=zt(ir(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=ir(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),hr(g.hidden||"0")&&(o.Hidden=!0),l=m+d.length;break;case"</definedName>":o.Ref=zt(ir(t.slice(l,m))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),LP.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return j3(r),r}function yU(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=qg(t),r.name=Nn(t),r}function EU(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Nn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TU(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function wU(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=tF(t),l=iV(t,0,r),u=Rx(t);t.l=n;var d={Name:o,Ptg:l};return a<268435455&&(d.Sheet=a),u&&(d.Comment=u),d}function SU(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],em[16]={n:"BrtFRTArchID$",f:TU},Ei(t,function(d,m,g){switch(g){case 156:l.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=Sn(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,o.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(g),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!m.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),j3(r),r.Names=o,r.supbooks=l,r}function bU(t,e,r){return e.slice(-4)===".bin"?SU(t,r):_U(t,r)}function AU(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?oU(t,n,r,a,o,l,u):yV(t,n,r,a,o,l,u)}function CU(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?hU(t,n,r,a,o):uU(t,n,r,a,o)}function NU(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?FM():LM()}function RU(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?jM():PM()}function kU(t,e,r,n){return e.slice(-4)===".bin"?QL(t,r,n):qL(t,r,n)}function IU(t,e,r){return y3(t,r)}function DU(t,e,r){return e.slice(-4)===".bin"?dL(t,r):fL(t,r)}function OU(t,e,r){return e.slice(-4)===".bin"?IM(t,r):AM(t,r)}function jU(t,e,r){return e.slice(-4)===".bin"?wM(t):EM(t)}function PU(t,e,r,n){return r.slice(-4)===".bin"?SM(t,e,r,n):void 0}function FU(t,e,r){return e.slice(-4)===".bin"?_M(t,e,r):yM(t,e,r)}var P3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,F3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function za(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(P3),o,l,u,d;if(a)for(d=0;d!=a.length;++d)o=a[d].match(F3),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function LU(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(P3),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(F3),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var wf;function MU(t,e){var r=wf[t]||zt(t);return r==="General"?fl(e):ja(r,e)}function BU(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=hr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=nn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[zt(e)]=a}function VU(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||El[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ff(t.v):t.w=fl(t.v):t.w=MU(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=wf[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Yc(n)){var a=el(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function UU(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=BL[n.Pattern]||n.Pattern)}t[e.ID]=e}function zU(t,e,r,n,a,o,l,u,d,m){var g="General",y=n.StyleID,_={};m=m||{};var T=[],E=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&l&&(y=l.StyleID);o[y]!==void 0&&(o[y].nf&&(g=o[y].nf),o[y].Interior&&T.push(o[y].Interior),!!o[y].Parent);)y=o[y].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=hr(t);break;case"String":n.t="s",n.r=E4(zt(t)),n.v=t.indexOf("<")>-1?zt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(nn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=zt(t):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=JA[t],m.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=E4(e||t));break}if(VU(n,g,m),m.cellFormula!==!1)if(n.Formula){var S=zt(n.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),n.f=wc(S,a),delete n.Formula,n.ArrayRange=="RC"?n.F=wc("RC:RC",a):n.ArrayRange&&(n.F=wc(n.ArrayRange,a),d.push([Er(n.F),n.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(n.F=d[E][1]);m.cellStyles&&(T.forEach(function(b){!_.patternType&&b.patternType&&(_.patternType=b.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function HU(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function ug(t,e){var r=e||{};SA();var n=af(Sx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ir(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=pn(r);return l.type="string",Bf.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Wt){a.indexOf("<"+Wt)>=0&&(o=!0)}),o)return JU(n,r);wf={"General Number":"General","General Date":xt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xt[15],"Short Date":xt[14],"Long Time":xt[19],"Medium Time":xt[18],"Short Time":xt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xt[2],Standard:xt[4],Percent:xt[10],Scientific:xt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],m,g={},y=[],_=r.dense?[]:{},T="",E={},S={},b=za('<Data ss:Type="String">'),O=0,L=0,A=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},H={},C="",N=0,R=[],F={},P={},M=0,U=[],Me=[],Ne={},ie=[],me,Pe=!1,oe=[],ee=[],ue={},z=0,X=0,G={Sheets:[],WBProps:{date1904:!1}},K={};Mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";u=Mf.exec(n);)switch(u[3]=(Q=u[3]).toLowerCase()){case"data":if(Q=="data"){if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?zU(n.slice(O,u.index),C,b,d[d.length-1][0]=="comment"?Ne:E,{c:L,r:A},V,ie[L],S,oe,r):(C="",b=za(u[0]),O=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Me.length>0&&(E.c=Me),(!r.sheetRows||r.sheetRows>A)&&E.v!==void 0&&(r.dense?(_[A]||(_[A]=[]),_[A][L]=E):_[Gr(L)+gn(A)]=E),E.HRef&&(E.l={Target:zt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(z=L+(parseInt(E.MergeAcross,10)|0),X=A+(parseInt(E.MergeDown,10)|0),R.push({s:{c:L,r:A},e:{c:z,r:X}})),!r.sheetStubs)E.MergeAcross?L=z+1:++L;else if(E.MergeAcross||E.MergeDown){for(var ye=L;ye<=z;++ye)for(var Ee=A;Ee<=X;++Ee)(ye>L||Ee>A)&&(r.dense?(_[Ee]||(_[Ee]=[]),_[Ee][ye]={t:"z"}):_[Gr(ye)+gn(Ee)]={t:"z"});L=z+1}else++L;else E=LU(u[0]),E.Index&&(L=+E.Index-1),L<D.s.c&&(D.s.c=L),L>D.e.c&&(D.e.c=L),u[0].slice(-2)==="/>"&&++L,Me=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(A<D.s.r&&(D.s.r=A),A>D.e.r&&(D.e.r=A),u[0].slice(-2)==="/>"&&(S=za(u[0]),S.Index&&(A=+S.Index-1)),L=0,++A):(S=za(u[0]),S.Index&&(A=+S.Index-1),ue={},(S.AutoFitHeight=="0"||S.Height)&&(ue.hpx=parseInt(S.Height,10),ue.hpt=_3(ue.hpx),ee[A]=ue),S.Hidden=="1"&&(ue.hidden=!0,ee[A]=ue));break;case"worksheet":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));y.push(T),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(_["!ref"]=Bt(D),r.sheetRows&&r.sheetRows<=D.e.r&&(_["!fullref"]=_["!ref"],D.e.r=r.sheetRows-1,_["!ref"]=Bt(D))),R.length&&(_["!merges"]=R),ie.length>0&&(_["!cols"]=ie),ee.length>0&&(_["!rows"]=ee),g[T]=_}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=L=0,d.push([u[3],!1]),m=za(u[0]),T=zt(m.Name),_=r.dense?[]:{},R=[],oe=[],ee=[],K={name:T,Hidden:0},G.Sheets.push(K);break;case"table":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),ie=[],Pe=!1}break;case"style":u[1]==="/"?UU(V,H,r):H=za(u[0]);break;case"numberformat":H.nf=zt(za(u[0]).Format||"General"),wf[H.nf]&&(H.nf=wf[H.nf]);for(var Ae=0;Ae!=392&&xt[Ae]!=H.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(xt[Ae]==null){tl(H.nf,Ae);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(me=za(u[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!Pe&&me.wpx>10){Pe=!0,zn=v3;for(var be=0;be<ie.length;++be)ie[be]&&Dc(ie[be])}Pe&&Dc(me),ie[me.Index-1||ie.length]=me;for(var Ze=0;Ze<+me.Span;++Ze)ie[ie.length]=pn(me);break;case"namedrange":if(u[1]==="/")break;G.Names||(G.Names=[]);var re=ft(u[0]),Ct={Name:re.Name,Ref:wc(re.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Ct.Sheet=G.Sheets.length-1),G.Names.push(Ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?C+=n.slice(N,u.index):N=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;H.Interior=za(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?AF(F,Q,n.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"));HU(Ne),Me.push(Ne)}else d.push([u[3],!1]),m=za(u[0]),Ne={a:m.Author};break;case"autofilter":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var We=za(u[0]);_["!autofilter"]={ref:wc(We.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((m=d.pop())[0]!==u[3])throw new Error("Bad state: "+m.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return sw(n,r);var lt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:lt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:lt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:lt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:lt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(M,u.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else M=u.index+u[0].length;break;case"header":_["!margins"]||Tf(_["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(_["!margins"].header=+ft(u[0]).Margin);break;case"footer":_["!margins"]||Tf(_["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(_["!margins"].footer=+ft(u[0]).Margin);break;case"pagemargins":var Fe=ft(u[0]);_["!margins"]||Tf(_["!margins"]={},"xlml"),isNaN(+Fe.Top)||(_["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(_["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(_["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(_["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:lt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:lt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:lt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:lt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:lt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:lt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:lt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:lt=!1}break;case"smarttags":break;default:lt=!1;break}if(lt||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?BU(P,Q,U,n.slice(M,u.index)):(U=u,M=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=g),je.SheetNames=y,je.Workbook=G,je.SSF=pn(xt),je.Props=F,je.Custprops=P,je}function Kg(t,e){switch(Bx(e=e||{}),e.type||"base64"){case"base64":return ug(va(t),e);case"binary":case"buffer":case"file":return ug(t,e);case"array":return ug(xl(t),e)}}function GU(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=aF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=sF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var qU=[60,1084,2066,2165,2175];function $U(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var d=ii(r,r.l),m=Xg[d],g=0;m!=null&&qU.indexOf(d)>-1;)o=ii(r,r.l+2),g=r.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),u=r.slice(g,r.l+4+o),l.push(u),r.l+=4+o,m=Xg[d=ii(r,r.l)];var y=Ji(l);fn(y,0);var _=0;y.lens=[];for(var T=0;T<l.length;++T)y.lens.push(_),_+=l[T].length;if(y.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+y.length+" < "+n;return e.f(y,y.length,a)}function Ts(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=xt[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||El[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Ff(t.v):t.w=fl(t.v):t.w=ja(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&Yc(xt[n]||String(n))){var a=el(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function e0(t,e,r){return{v:t,ixfe:e,t:r}}function YU(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,d=[],m="",g={},y,_="",T,E,S,b,O={},L=[],A,D,V=[],H=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},R=function(tt){return tt<8?rl[tt]:tt<64&&H[tt-8]||rl[tt]},F=function(tt,wt,St){var gt=wt.XF.data;if(!(!gt||!gt.patternType||!St||!St.cellStyles)){wt.s={},wt.s.patternType=gt.patternType;var or;(or=Vf(R(gt.icvFore)))&&(wt.s.fgColor={rgb:or}),(or=Vf(R(gt.icvBack)))&&(wt.s.bgColor={rgb:or})}},P=function(tt,wt,St){if(!(ue>1)&&!(St.sheetRows&&tt.r>=St.sheetRows)){if(St.cellStyles&&wt.XF&&wt.XF.data&&F(tt,wt,St),delete wt.ixfe,delete wt.XF,y=tt,_=pt(tt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<l.s.r&&(l.s.r=tt.r),tt.c<l.s.c&&(l.s.c=tt.c),tt.r+1>l.e.r&&(l.e.r=tt.r+1),tt.c+1>l.e.c&&(l.e.c=tt.c+1),St.cellFormula&&wt.f){for(var gt=0;gt<L.length;++gt)if(!(L[gt][0].s.c>tt.c||L[gt][0].s.r>tt.r)&&!(L[gt][0].e.c<tt.c||L[gt][0].e.r<tt.r)){wt.F=Bt(L[gt][0]),(L[gt][0].s.c!=tt.c||L[gt][0].s.r!=tt.r)&&delete wt.f,wt.f&&(wt.f=""+Sn(L[gt][1],l,tt,oe,M));break}}St.dense?(a[tt.r]||(a[tt.r]=[]),a[tt.r][tt.c]=wt):a[_]=wt}},M={enc:!1,sbcch:0,snames:[],sharedf:O,arrayf:L,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var U,Me=[],Ne=[],ie=[],me=[],Pe=!1,oe=[];oe.SheetNames=M.snames,oe.sharedf=M.sharedf,oe.arrayf=M.arrayf,oe.names=[],oe.XTI=[];var ee=0,ue=0,z=0,X=[],G=[],K;M.codepage=1200,Ka(1200);for(var Q=!1;t.l<t.length-1;){var ye=t.l,Ee=t.read_shift(2);if(Ee===0&&ee===10)break;var Ae=t.l===t.length?0:t.read_shift(2),be=Xg[Ee];if(be&&be.f){if(e.bookSheets&&ee===133&&Ee!==133)break;if(ee=Ee,be.r===2||be.r==12){var Ze=t.read_shift(2);if(Ae-=2,!M.enc&&Ze!==Ee&&((Ze&255)<<8|Ze>>8)!==Ee)throw new Error("rt mismatch: "+Ze+"!="+Ee);be.r==12&&(t.l+=10,Ae-=10)}var re={};if(Ee===10?re=be.f(t,Ae,M):re=$U(Ee,be,t,Ae,M),ue==0&&[9,521,1033,2057].indexOf(ee)===-1)continue;switch(Ee){case 34:r.opts.Date1904=C.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=re,!e.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=re;break;case 66:var Ct=Number(re);switch(Ct){case 21010:Ct=1200;break;case 32768:Ct=1e4;break;case 32769:Ct=1252;break}Ka(M.codepage=Ct),Q=!0;break;case 317:M.rrtabid=re;break;case 25:M.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:M.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(a["!type"]="dialog"),re.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),re.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:V.push(re);break;case 430:oe.push([re]),oe[oe.length-1].XTI=[];break;case 35:case 547:oe[oe.length-1].push(re);break;case 24:case 536:K={Name:re.Name,Ref:Sn(re.rgce,l,null,oe,M)},re.itab>0&&(K.Sheet=re.itab-1),oe.names.push(K),oe[0]||(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(G[re.itab-1]={ref:Bt(re.rgce[0][0][1][2])});break;case 22:M.ExternCount=re;break;case 23:oe.length==0&&(oe[0]=[],oe[0].XTI=[]),oe[oe.length-1].XTI=oe[oe.length-1].XTI.concat(re),oe.XTI=oe.XTI.concat(re);break;case 2196:if(M.biff<8)break;K!=null&&(K.Comment=re[1]);break;case 18:a["!protect"]=re;break;case 19:re!==0&&M.WTF&&console.error("Password verifier: "+re);break;case 133:o[re.pos]=re,M.snames.push(re.name);break;case 10:{if(--ue)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Bt(l),e.sheetRows&&e.sheetRows<=l.e.r){var We=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Bt(l),l.e.r=We}l.e.r++,l.e.c++}Me.length>0&&(a["!merges"]=Me),Ne.length>0&&(a["!objects"]=Ne),ie.length>0&&(a["!cols"]=ie),me.length>0&&(a["!rows"]=me),C.Sheets.push(N)}m===""?g=a:n[m]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),M.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(M.biff=5,Q=!0,Ka(M.codepage=28591)),M.biff==8&&re.BIFFVer==0&&re.dt==16&&(M.biff=2),ue++)break;if(a=e.dense?[]:{},M.biff<8&&!Q&&(Q=!0,Ka(M.codepage=e.codepage||1252)),M.biff<5||re.BIFFVer==0&&re.dt==4096){m===""&&(m="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var lt={pos:t.l-Ae,name:m};o[lt.pos]=lt,M.snames.push(m)}else m=(o[ye]||{name:""}).name;re.dt==32&&(a["!type"]="chart"),re.dt==64&&(a["!type"]="macro"),Me=[],Ne=[],M.arrayf=L=[],ie=[],me=[],Pe=!1,N={Hidden:(o[ye]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[re.r]||[])[re.c]:a[pt({c:re.c,r:re.r})])&&++re.c,A={ixfe:re.ixfe,XF:V[re.ixfe]||{},v:re.val,t:"n"},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e);break;case 5:case 517:A={ixfe:re.ixfe,XF:V[re.ixfe],v:re.val,t:re.t},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e);break;case 638:A={ixfe:re.ixfe,XF:V[re.ixfe],v:re.rknum,t:"n"},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e);break;case 189:for(var Fe=re.c;Fe<=re.C;++Fe){var je=re.rkrec[Fe-re.c][0];A={ixfe:je,XF:V[je],v:re.rkrec[Fe-re.c][1],t:"n"},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:Fe,r:re.r},A,e)}break;case 6:case 518:case 1030:{if(re.val=="String"){u=re;break}if(A=e0(re.val,re.cell.ixfe,re.tt),A.XF=V[A.ixfe],e.cellFormula){var Wt=re.formula;if(Wt&&Wt[0]&&Wt[0][0]&&Wt[0][0][0]=="PtgExp"){var Tr=Wt[0][0][1][0],Rr=Wt[0][0][1][1],tr=pt({r:Tr,c:Rr});O[tr]?A.f=""+Sn(re.formula,l,re.cell,oe,M):A.F=((e.dense?(a[Tr]||[])[Rr]:a[tr])||{}).F}else A.f=""+Sn(re.formula,l,re.cell,oe,M)}z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P(re.cell,A,e),u=re}break;case 7:case 519:if(u)u.val=re,A=e0(re,u.cell.ixfe,"s"),A.XF=V[A.ixfe],e.cellFormula&&(A.f=""+Sn(u.formula,l,u.cell,oe,M)),z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P(u.cell,A,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{L.push(re);var On=pt(re[0].s);if(T=e.dense?(a[re[0].s.r]||[])[re[0].s.c]:a[On],e.cellFormula&&T){if(!u||!On||!T)break;T.f=""+Sn(re[1],l,re[0],oe,M),T.F=Bt(re[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;O[pt(u.cell)]=re[0],T=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[pt(u.cell)],(T||{}).f=""+Sn(re[0],l,y,oe,M)}}break;case 253:A=e0(d[re.isst].t,re.ixfe,"s"),d[re.isst].h&&(A.h=d[re.isst].h),A.XF=V[A.ixfe],z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e);break;case 513:e.sheetStubs&&(A={ixfe:re.ixfe,XF:V[re.ixfe],t:"z"},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e));break;case 190:if(e.sheetStubs)for(var lr=re.c;lr<=re.C;++lr){var wr=re.ixfe[lr-re.c];A={ixfe:wr,XF:V[wr],t:"z"},z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:lr,r:re.r},A,e)}break;case 214:case 516:case 4:A=e0(re.val,re.ixfe,"s"),A.XF=V[A.ixfe],z>0&&(A.z=X[A.ixfe>>8&63]),Ts(A,e,r.opts.Date1904),P({c:re.c,r:re.r},A,e);break;case 0:case 512:ue===1&&(l=re);break;case 252:d=re;break;case 1054:if(M.biff==4){X[z++]=re[1];for(var Wr=0;Wr<z+163&&xt[Wr]!=re[1];++Wr);Wr>=163&&tl(re[1],z+163)}else tl(re[1],re[0]);break;case 30:{X[z++]=re;for(var It=0;It<z+163&&xt[It]!=re;++It);It>=163&&tl(re,z+163)}break;case 229:Me=Me.concat(re);break;case 93:Ne[re.cmo[0]]=M.lastobj=re;break;case 438:M.lastobj.TxO=re;break;case 127:M.lastobj.ImData=re;break;case 440:for(b=re[0].s.r;b<=re[0].e.r;++b)for(S=re[0].s.c;S<=re[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[pt({c:S,r:b})],T&&(T.l=re[1]);break;case 2048:for(b=re[0].s.r;b<=re[0].e.r;++b)for(S=re[0].s.c;S<=re[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[pt({c:S,r:b})],T&&T.l&&(T.l.Tooltip=re[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;T=e.dense?(a[re[0].r]||[])[re[0].c]:a[pt(re[0])];var Se=Ne[re[2]];T||(e.dense?(a[re[0].r]||(a[re[0].r]=[]),T=a[re[0].r][re[0].c]={t:"z"}):T=a[pt(re[0])]={t:"z"},l.e.r=Math.max(l.e.r,re[0].r),l.s.r=Math.min(l.s.r,re[0].r),l.e.c=Math.max(l.e.c,re[0].c),l.s.c=Math.min(l.s.c,re[0].c)),T.c||(T.c=[]),E={a:re[1],t:Se.TxO.t},T.c.push(E)}break;case 2173:pM(V[re.ixfe],re.ext);break;case 125:{if(!M.cellStyles)break;for(;re.e>=re.s;)ie[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},Pe||(Pe=!0,jx(re.w/256)),Dc(ie[re.e+1])}break;case 520:{var Ke={};re.level!=null&&(me[re.r]=Ke,Ke.level=re.level),re.hidden&&(me[re.r]=Ke,Ke.hidden=!0),re.hpt&&(me[re.r]=Ke,Ke.hpt=re.hpt,Ke.hpx=Uf(re.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Tf(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=re;break;case 161:a["!margins"]||Tf(a["!margins"]={}),a["!margins"].header=re.header,a["!margins"].footer=re.footer;break;case 574:re.RTL&&(C.Views[0].RTL=!0);break;case 146:H=re;break;case 2198:U=re;break;case 140:D=re;break;case 442:m?N.CodeName=re||N.name:C.WBProps.CodeName=re||"ThisWorkbook";break}}else be||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=Ae}return r.SheetNames=Ds(o).sort(function(Je,tt){return Number(Je)-Number(tt)}).map(function(Je){return o[Je].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&G.forEach(function(Je,tt){r.Sheets[r.SheetNames[tt]]["!autofilter"]=Je}),r.Strings=d,r.SSF=pn(xt),M.enc&&(r.Encryption=M.enc),U&&(r.Themes=U),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),oe.names.length>0&&(C.Names=oe.names),r.Workbook=C,r}var ew={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function WU(t,e,r){var n=Mt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=L4(n,fF,ew.DSI);for(var o in a)e[o]=a[o]}catch(m){if(r.WTF)throw m}var l=Mt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=L4(l,hF,ew.SI);for(var d in u)e[d]==null&&(e[d]=u[d])}catch(m){if(r.WTF)throw m}e.HeadingPairs&&e.TitlesOfParts&&(e3(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function L3(t,e){e||(e={}),Bx(e),hA(),e.codepage&&vx(e.codepage);var r,n;if(t.FullPaths){if(Mt.find(t,"/encryption"))throw new Error("File is password-protected");r=Mt.find(t,"!CompObj"),n=Mt.find(t,"/Workbook")||Mt.find(t,"/Book")}else{switch(e.type){case"base64":t=qa(va(t));break;case"binary":t=qa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}fn(t,0),n={content:t}}var a,o;if(r&&GU(r),e.bookProps&&!e.bookSheets)a={};else{var l=kt?"buffer":"array";if(n&&n.content)a=YU(n.content,e);else if((o=Mt.find(t,"PerfectOffice_MAIN"))&&o.content)a=yf.to_workbook(o.content,(e.type=l,e));else if((o=Mt.find(t,"NativeContent_MAIN"))&&o.content)a=yf.to_workbook(o.content,(e.type=l,e));else throw(o=Mt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Mt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=OM(t))}var u={};return t.FullPaths&&WU(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}var em={0:{f:RV},1:{f:OV},2:{f:zV},3:{f:LV},4:{f:PV},5:{f:UV},6:{f:qV},7:{f:BV},8:{f:XV},9:{f:KV},10:{f:YV},11:{f:WV},12:{f:jV},13:{f:HV},14:{f:MV},15:{f:FV},16:{f:D3},17:{f:$V},18:{f:VV},19:{f:Nx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wU},40:{},42:{},43:{f:YL},44:{f:$L},45:{f:WL},46:{f:XL},47:{f:KL},48:{},49:{f:QP},50:{},51:{f:vM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:h3},62:{f:GV},63:{f:TM},64:{f:sU},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:In,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aU},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DV},148:{f:kV,p:16},151:{f:ZV},152:{},153:{f:EU},154:{},155:{},156:{f:yU},157:{},158:{},159:{T:1,f:hL},160:{T:-1},161:{T:1,f:yl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:QV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gM},336:{T:-1},337:{f:xM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:f3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eU},427:{f:tU},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nU},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:JV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:kM},633:{T:1},634:{T:-1},635:{T:1,f:RM},636:{T:-1},637:{f:ZP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:fU},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iU},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xg={6:{f:lg},10:{f:Yi},12:{f:Fr},13:{f:Fr},14:{f:Cr},15:{f:Cr},16:{f:bn},17:{f:Cr},18:{f:Cr},19:{f:Fr},20:{f:U4},21:{f:U4},23:{f:f3},24:{f:H4},25:{f:Cr},26:{},27:{},28:{f:C7},29:{},34:{f:Cr},35:{f:z4},38:{f:bn},39:{f:bn},40:{f:bn},41:{f:bn},42:{f:Cr},43:{f:Cr},47:{f:IL},49:{f:l7},51:{f:Fr},60:{},61:{f:s7},64:{f:Cr},65:{f:o7},66:{f:Fr},77:{},80:{},81:{},82:{},85:{f:Fr},89:{},90:{},91:{},92:{f:QF},93:{f:R7},94:{},95:{f:Cr},96:{},97:{},99:{f:Cr},125:{f:h3},128:{f:x7},129:{f:JF},130:{f:Fr},131:{f:Cr},132:{f:Cr},133:{f:ZF},134:{},140:{f:P7},141:{f:Fr},144:{},146:{f:L7},151:{},152:{},153:{},154:{},155:{},156:{f:Fr},157:{},158:{},160:{f:z7},161:{f:B7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:m7},190:{f:p7},193:{f:Yi},197:{},198:{},199:{},200:{},201:{},202:{f:Cr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fr},220:{},221:{f:Cr},222:{},224:{f:v7},225:{f:XF},226:{f:Yi},227:{},229:{f:N7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:e7},253:{f:c7},255:{f:t7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:s3},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Cr},353:{f:Yi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:y7},431:{f:Cr},432:{},433:{},434:{},437:{},438:{f:D7},439:{f:Cr},440:{f:O7},441:{},442:{f:_h},443:{},444:{f:Fr},445:{},446:{},448:{f:Yi},449:{f:a7,r:2},450:{f:Yi},512:{f:B4},513:{f:U7},515:{f:_7},516:{f:u7},517:{f:V4},519:{f:H7},520:{f:r7},523:{},545:{f:G4},549:{f:M4},566:{},574:{f:i7},638:{f:d7},659:{},1048:{},1054:{f:f7},1084:{},1212:{f:S7},2048:{f:j7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:M7,r:12},2173:{f:mM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Cr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:w7,r:12},2197:{},2198:{f:lM,r:12},2199:{},2200:{},2201:{},2202:{f:b7,r:12},2203:{f:Yi},2204:{},2205:{},2206:{},2207:{},2211:{f:n7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:V7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:F7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:B4},1:{},2:{f:Y7},3:{f:$7},4:{f:q7},5:{f:V4},7:{f:W7},8:{},9:{f:Qd},11:{},22:{f:Fr},30:{f:h7},31:{},32:{},33:{f:G4},36:{},37:{f:M4},50:{f:K7},62:{},52:{},67:{},68:{f:Fr},69:{},86:{},126:{},127:{f:G7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:X7},223:{},234:{},354:{},421:{},518:{f:lg},521:{f:Qd},536:{f:H4},547:{f:z4},561:{},579:{},1030:{f:lg},1033:{f:Qd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ha(t,e,r,n){var a=e;if(!isNaN(a)){var o=(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&$A(r)&&t.push(r)}}function tw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,d=_P(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,g=0,y=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),b=S.slice(0,3).toLowerCase();if(b=="<tr"){if(++m,r.sheetRows&&r.sheetRows<=m){--m;break}g=0;continue}if(!(b!="<td"&&b!="<th")){var O=S.split(/<\/t[dh]>/i);for(u=0;u<O.length;++u){var L=O[u].trim();if(L.match(/<t[dh]/i)){for(var A=L,D=0;A.charAt(0)=="<"&&(D=A.indexOf(">"))>-1;)A=A.slice(D+1);for(var V=0;V<E.length;++V){var H=E[V];H.s.c==g&&H.s.r<m&&m<=H.e.r&&(g=H.e.c+1,V=-1)}var C=ft(L.slice(0,L.indexOf(">")));_=C.colspan?+C.colspan:1,((y=+C.rowspan)>1||_>1)&&E.push({s:{r:m,c:g},e:{r:m+(y||1)-1,c:g+_-1}});var N=C.t||C["data-t"]||"";if(!A.length){g+=_;continue}if(A=OA(A),T.s.r>m&&(T.s.r=m),T.e.r<m&&(T.e.r=m),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!A.length){g+=_;continue}var R={t:"s",v:A};r.raw||!A.trim().length||N=="s"||(A==="TRUE"?R={t:"b",v:!0}:A==="FALSE"?R={t:"b",v:!1}:isNaN(Ja(A))?isNaN(Ic(A).getDate())||(R={t:"d",v:nn(A)},r.cellDates||(R={t:"n",v:$n(R.v)}),R.z=r.dateNF||xt[14]):R={t:"n",v:Ja(A)}),r.dense?(n[m]||(n[m]=[]),n[m][g]=R):n[pt({r:m,c:g})]=R,g+=_}}}}return n["!ref"]=Bt(T),E.length&&(n["!merges"]=E),n}function KU(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,d=0,m=0;m<a.length;++m)if(!(a[m].s.r>r||a[m].s.c>l)&&!(a[m].e.r<r||a[m].e.c<l)){if(a[m].s.r<r||a[m].s.c<l){u=-1;break}u=a[m].e.r-a[m].s.r+1,d=a[m].e.c-a[m].s.c+1;break}if(!(u<0)){var g=pt({r,c:l}),y=n.dense?(t[r]||[])[l]:t[g],_=y&&y.v!=null&&(y.h||wx(y.w||(xi(y),y.w)||""))||"",T={};u>1&&(T.rowspan=u),d>1&&(T.colspan=d),n.editable?_='<span contenteditable="true">'+_+"</span>":y&&(T["data-t"]=y&&y.t||"z",y.v!=null&&(T["data-v"]=y.v),y.z!=null&&(T["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),T.id=(n.id||"sjs")+"-"+g,o.push(PP("td",_,T))}}var E="<tr>";return E+o.join("")+"</tr>"}var XU='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QU="</body></html>";function JU(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return To(tw(r[0],e),e);var n=Ux();return r.forEach(function(a,o){zx(n,tw(a,e),"Sheet"+(o+1))}),n}function ZU(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ez(t,e){var r=e||{},n=r.header!=null?r.header:XU,a=r.footer!=null?r.footer:QU,o=[n],l=Wc(t["!ref"]);r.dense=Array.isArray(t),o.push(ZU(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(KU(t,l,u,r));return o.push("</table>"+a),o.join("")}function M3(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Gn(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,u.length),m={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var g=Wc(t["!ref"]);m.s.r=Math.min(m.s.r,g.s.r),m.s.c=Math.min(m.s.c,g.s.c),m.e.r=Math.max(m.e.r,g.e.r),m.e.c=Math.max(m.e.c,g.e.c),a==-1&&(m.e.r=a=g.e.r+1)}var y=[],_=0,T=t["!rows"]||(t["!rows"]=[]),E=0,S=0,b=0,O=0,L=0,A=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&S<d;++E){var D=u[E];if(rw(D)){if(n.display)continue;T[S]={hidden:!0}}var V=D.children;for(b=O=0;b<V.length;++b){var H=V[b];if(!(n.display&&rw(H))){var C=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):OA(H.innerHTML),N=H.getAttribute("data-z")||H.getAttribute("z");for(_=0;_<y.length;++_){var R=y[_];R.s.c==O+o&&R.s.r<S+a&&S+a<=R.e.r&&(O=R.e.c+1-o,_=-1)}A=+H.getAttribute("colspan")||1,((L=+H.getAttribute("rowspan")||1)>1||A>1)&&y.push({s:{r:S+a,c:O+o},e:{r:S+a+(L||1)-1,c:O+o+(A||1)-1}});var F={t:"s",v:C},P=H.getAttribute("data-t")||H.getAttribute("t")||"";C!=null&&(C.length==0?F.t=P||"z":n.raw||C.trim().length==0||P=="s"||(C==="TRUE"?F={t:"b",v:!0}:C==="FALSE"?F={t:"b",v:!1}:isNaN(Ja(C))?isNaN(Ic(C).getDate())||(F={t:"d",v:nn(C)},n.cellDates||(F={t:"n",v:$n(F.v)}),F.z=n.dateNF||xt[14]):F={t:"n",v:Ja(C)})),F.z===void 0&&N!=null&&(F.z=N);var M="",U=H.getElementsByTagName("A");if(U&&U.length)for(var Me=0;Me<U.length&&!(U[Me].hasAttribute("href")&&(M=U[Me].getAttribute("href"),M.charAt(0)!="#"));++Me);M&&M.charAt(0)!="#"&&(F.l={Target:M}),n.dense?(t[S+a]||(t[S+a]=[]),t[S+a][O+o]=F):t[pt({c:O+o,r:S+a})]=F,m.e.c<O+o&&(m.e.c=O+o),O+=A}}++S}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),m.e.r=Math.max(m.e.r,S-1+a),t["!ref"]=Bt(m),S>=d&&(t["!fullref"]=Bt((m.e.r=u.length-E+S-1+a,m))),t}function B3(t,e){var r=e||{},n=r.dense?[]:{};return M3(n,t,e)}function tz(t,e){return To(B3(t,e),e)}function rw(t){var e="",r=rz(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function rz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nz(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=zt(e.replace(/<[^>]*>/g,""));return[r]}var nw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function V3(t,e){var r=e||{},n=Sx(t),a=[],o,l,u={name:""},d="",m=0,g,y,_={},T=[],E=r.dense?[]:{},S,b,O={value:""},L="",A=0,D=[],V=-1,H=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,R={},F=[],P={},M=0,U=0,Me=[],Ne=1,ie=1,me=[],Pe={Names:[]},oe={},ee=["",""],ue=[],z={},X="",G=0,K=!1,Q=!1,ye=0;for(Mf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=Mf.exec(n);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?E["!ref"]=Bt(C):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(E["!fullref"]=E["!ref"],C.e.r=r.sheetRows-1,E["!ref"]=Bt(C)),F.length&&(E["!merges"]=F),Me.length&&(E["!rows"]=Me),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=E,Q=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=ft(S[0],!1),V=H=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,E=r.dense?[]:{},F=[],Me=[],Q=!0);break;case"table-row-group":S[1]==="/"?--N:++N;break;case"table-row":case"行":if(S[1]==="/"){V+=Ne,Ne=1;break}if(y=ft(S[0],!1),y.行号?V=y.行号-1:V==-1&&(V=0),Ne=+y["number-rows-repeated"]||1,Ne<10)for(ye=0;ye<Ne;++ye)N>0&&(Me[V+ye]={level:N});H=-1;break;case"covered-table-cell":S[1]!=="/"&&++H,r.sheetStubs&&(r.dense?(E[V]||(E[V]=[]),E[V][H]={t:"z"}):E[pt({r:V,c:H})]={t:"z"}),L="",D=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++H,O=ft(S[0],!1),ie=parseInt(O["number-columns-repeated"]||"1",10),b={t:"z",v:null},O.formula&&r.cellFormula!=!1&&(b.f=Q4(zt(O.formula))),(O.数据类型||O["value-type"])=="string"&&(b.t="s",b.v=zt(O["string-value"]||""),r.dense?(E[V]||(E[V]=[]),E[V][H]=b):E[pt({r:V,c:H})]=b),H+=ie-1;else if(S[1]!=="/"){++H,L="",A=0,D=[],ie=1;var Ee=Ne?V+Ne-1:V;if(H>C.e.c&&(C.e.c=H),H<C.s.c&&(C.s.c=H),V<C.s.r&&(C.s.r=V),Ee>C.e.r&&(C.e.r=Ee),O=ft(S[0],!1),ue=[],z={},b={t:O.数据类型||O["value-type"],v:null},r.cellFormula)if(O.formula&&(O.formula=zt(O.formula)),O["number-matrix-columns-spanned"]&&O["number-matrix-rows-spanned"]&&(M=parseInt(O["number-matrix-rows-spanned"],10)||0,U=parseInt(O["number-matrix-columns-spanned"],10)||0,P={s:{r:V,c:H},e:{r:V+M-1,c:H+U-1}},b.F=Bt(P),me.push([P,b.F])),O.formula)b.f=Q4(O.formula);else for(ye=0;ye<me.length;++ye)V>=me[ye][0].s.r&&V<=me[ye][0].e.r&&H>=me[ye][0].s.c&&H<=me[ye][0].e.c&&(b.F=me[ye][1]);switch((O["number-columns-spanned"]||O["number-rows-spanned"])&&(M=parseInt(O["number-rows-spanned"],10)||0,U=parseInt(O["number-columns-spanned"],10)||0,P={s:{r:V,c:H},e:{r:V+M-1,c:H+U-1}},F.push(P)),O["number-columns-repeated"]&&(ie=parseInt(O["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=hr(O["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(O.value);break;case"percentage":b.t="n",b.v=parseFloat(O.value);break;case"currency":b.t="n",b.v=parseFloat(O.value);break;case"date":b.t="d",b.v=nn(O["date-value"]),r.cellDates||(b.t="n",b.v=$n(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=gP(O["time-value"])/86400,r.cellDates&&(b.t="d",b.v=jm(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(O.数据数值);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",O["string-value"]!=null&&(L=zt(O["string-value"]),D=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(K=!1,b.t==="s"&&(b.v=L||"",D.length&&(b.R=D),K=A==0),oe.Target&&(b.l=oe),ue.length>0&&(b.c=ue,ue=[]),L&&r.cellText!==!1&&(b.w=L),K&&(b.t="z",delete b.v),(!K||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=V))for(var Ae=0;Ae<Ne;++Ae){if(ie=parseInt(O["number-columns-repeated"]||"1",10),r.dense)for(E[V+Ae]||(E[V+Ae]=[]),E[V+Ae][H]=Ae==0?b:pn(b);--ie>0;)E[V+Ae][H+ie]=pn(b);else for(E[pt({r:V+Ae,c:H})]=b;--ie>0;)E[pt({r:V+Ae,c:H+ie})]=pn(b);C.e.c<=H&&(C.e.c=H)}ie=parseInt(O["number-columns-repeated"]||"1",10),H+=ie-1,ie=0,b={},L="",D=[]}oe={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o;z.t=L,D.length&&(z.R=D),z.a=X,ue.push(z)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);X="",G=0,L="",A=0,D=[];break;case"creator":S[1]==="/"?X=n.slice(G,S.index):G=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);L="",A=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(R[u.name]=d,(o=a.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&(d="",u=ft(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(S[0],!1),d+=nw[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=ft(S[0],!1),d+=nw[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(m,S.index);break}else m=S.index+S[0].length;break;case"named-range":l=ft(S[0],!1),ee=cg(l["cell-range-address"]);var be={Name:l.name,Ref:ee[0]+"!"+ee[1]};Q&&(be.Sheet=T.length),Pe.Names.push(be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!O||!O["string-value"])){var Ze=nz(n.slice(A,S.index));L=(L.length>0?L+`
`:"")+Ze[0]}else ft(S[0],!1),A=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{ee=cg(ft(S[0])["target-range-address"]),_[ee[0]]["!autofilter"]={ref:ee[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(oe=ft(S[0],!1),!oe.href)break;oe.Target=zt(oe.href),delete oe.href,oe.Target.charAt(0)=="#"&&oe.Target.indexOf(".")>-1?(ee=cg(oe.Target.slice(1)),oe.Target="#"+ee[0]+"!"+ee[1]):oe.Target.match(/^\.\.[\\\/]/)&&(oe.Target=oe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(S)}}var re={Sheets:_,SheetNames:T,Workbook:Pe};return r.bookSheets&&delete re.Sheets,re}function aw(t,e){e=e||{},Oa(t,"META-INF/manifest.xml")&&_F(Pr(t,"META-INF/manifest.xml"),e);var r=ma(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=V3(ir(r),e);return Oa(t,"meta.xml")&&(n.Props=ZA(Pr(t,"meta.xml"))),n}function sw(t,e){return V3(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Qg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ir(xl(t))}function Jg(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function iw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function az(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function zf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Yr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function An(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=zf(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var d=r[0];t[r[0]++]>=128;);u=t.slice(d,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=zf(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var m={data:u,type:o};e[a]==null?e[a]=[m]:e[a].push(m)}return e}function Mx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function sz(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=zf(t,n),o=An(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Yr(o[1][0].data),messages:[]};o[2].forEach(function(u){var d=An(u.data),m=Yr(d[3][0].data);l.messages.push({meta:d,data:t.slice(n[0],n[0]+m)}),n[0]+=m}),(e=o[3])!=null&&e[0]&&(l.merge=Yr(o[3][0].data)>>>0>0),r.push(l)}return r}function iz(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=zf(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var d=0,m=0;if(o==1?(m=(e[r[0]]>>2&7)+4,d=(e[r[0]++]&224)<<3,d|=e[r[0]++]):(m=(e[r[0]++]>>2)+1,o==2?(d=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(d=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Jg(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(m>=d)for(a.push(a[0].slice(-d)),m-=d;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-d,-d+m))}}var g=Jg(a);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function oz(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(iz(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Jg(e)}function lz(t,e,r,n){var a=Lx(t),o=a.getUint32(4,!0),l=(n>1?12:8)+iw(o&(n>1?3470:398))*4,u=-1,d=-1,m=NaN,g=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=iw(o&(n>1?12288:4096))*4,o&16&&(d=a.getUint32(l,!0),l+=4),o&32&&(m=a.getFloat64(l,!0),l+=8),o&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(t[2]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:e[d]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:r[u]};else if(d>-1)y={t:"s",v:e[d]};else if(!isNaN(m))y={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return y}function cz(t,e,r){var n=Lx(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,d=NaN,m=NaN,g=new Date(2001,0,1);a&1&&(d=az(t,o),o+=16),a&2&&(m=n.getFloat64(o,!0),o+=8),a&4&&(g.setTime(g.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var y;switch(t[1]){case 0:break;case 2:y={t:"n",v:d};break;case 3:y={t:"s",v:e[u]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:m>0};break;case 7:y={t:"n",v:m/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:y={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return y}function uz(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return lz(t,e,r,t[0]);case 5:return cz(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function oo(t){var e=An(t);return zf(e[1][0].data)}function ow(t,e){var r=An(e.data),n=Yr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=An(l.data),d=Yr(u[1][0].data)>>>0;switch(n){case 1:o[d]=Qg(u[3][0].data);break;case 8:{var m=t[oo(u[9][0].data)][0],g=An(m.data),y=t[oo(g[1][0].data)][0],_=Yr(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=An(y.data);o[d]=T[3].map(function(E){return Qg(E.data)}).join("")}break}}),o}function fz(t,e){var r,n,a,o,l,u,d,m,g,y,_,T,E,S,b=An(t),O=Yr(b[1][0].data)>>>0,L=Yr(b[2][0].data)>>>0,A=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Yr(b[8][0].data)>0||!1,D,V;if((o=(a=b[7])==null?void 0:a[0])!=null&&o.data&&e!=0)D=(u=(l=b[7])==null?void 0:l[0])==null?void 0:u.data,V=(m=(d=b[6])==null?void 0:d[0])==null?void 0:m.data;else if((y=(g=b[4])==null?void 0:g[0])!=null&&y.data&&e!=1)D=(T=(_=b[4])==null?void 0:_[0])==null?void 0:T.data,V=(S=(E=b[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=A?4:1,C=Lx(D),N=[],R=0;R<D.length/2;++R){var F=C.getUint16(R*2,!0);F<65535&&N.push([R,F])}if(N.length!=L)throw"Expected ".concat(L," cells, found ").concat(N.length);var P=[];for(R=0;R<N.length-1;++R)P[N[R][0]]=V.subarray(N[R][1]*H,N[R+1][1]*H);return N.length>=1&&(P[N[N.length-1][0]]=V.subarray(N[N.length-1][1]*H)),{R:O,cells:P}}function hz(t,e){var r,n=An(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Yr(n[7][0].data)>>>0>0?1:0:-1,o=Mx(n[5],function(l){return fz(l,a)});return{nrows:Yr(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(d,m){if(l[u.R][m])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(m));l[u.R][m]=d}),l},[])}}function dz(t,e,r){var n,a=An(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Yr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Yr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Bt(o);var l=An(a[4][0].data),u=ow(t,t[oo(l[4][0].data)][0]),d=(n=l[17])!=null&&n[0]?ow(t,t[oo(l[17][0].data)][0]):[],m=An(l[3][0].data),g=0;m[1].forEach(function(y){var _=An(y.data),T=t[oo(_[2][0].data)][0],E=Yr(T.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=hz(t,T);S.data.forEach(function(b,O){b.forEach(function(L,A){var D=pt({r:g+O,c:A}),V=uz(L,u,d);V&&(r[D]=V)})}),g+=S.nrows})}function mz(t,e){var r=An(e.data),n={"!ref":"A1"},a=t[oo(r[2][0].data)],o=Yr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return dz(t,a[0],n),n}function pz(t,e){var r,n=An(e.data),a={name:(r=n[1])!=null&&r[0]?Qg(n[1][0].data):"",sheets:[]},o=Mx(n[2],oo);return o.forEach(function(l){t[l].forEach(function(u){var d=Yr(u.meta[1][0].data);d==6e3&&a.sheets.push(mz(t,u))})}),a}function gz(t,e){var r=Ux(),n=An(e.data),a=Mx(n[1],oo);if(a.forEach(function(o){t[o].forEach(function(l){var u=Yr(l.meta[1][0].data);if(u==2){var d=pz(t,l);d.sheets.forEach(function(m,g){zx(r,m,g==0?d.name:d.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function fg(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var m;try{m=oz(d.content)}catch(y){return console.log("?? "+d.content.length+" "+(y.message||y))}var g;try{g=sz(m)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){o[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o==null?void 0:o[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Yr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(d){o[d].forEach(function(m){var g=Yr(m.meta[1][0].data)>>>0;if(g==1)if(!u)u=m;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return gz(o,u)}function vz(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Bx(t){vz([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function xz(t){return vc.WS.indexOf(t)>-1?"sheet":t==vc.CS?"chart":t==vc.DS?"dialog":t==vc.MS?"macro":t&&t.length?t:"sheet"}function _z(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,xz(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function yz(t,e,r,n,a,o,l,u,d,m,g,y){try{o[n]=xf(ma(t,r,!0),e);var _=Pr(t,e),T;switch(u){case"sheet":T=AU(_,e,a,d,o[n],m,g,y);break;case"chart":if(T=CU(_,e,a,d,o[n],m,g,y),!T||!T["!drawel"])break;var E=of(T["!drawel"].Target,e),S=$g(E),b=bM(ma(t,E,!0),xf(ma(t,S,!0),E)),O=of(b,E),L=$g(O);T=cU(ma(t,O,!0),O,d,xf(ma(t,L,!0),O),m,T);break;case"macro":T=NU(_,e,a,d,o[n],m,g,y);break;case"dialog":T=RU(_,e,a,d,o[n],m,g,y);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=T;var A=[];o&&o[n]&&Ds(o[n]).forEach(function(D){var V="";if(o[n][D].Type==vc.CMNT){V=of(o[n][D].Target,e);var H=OU(Pr(t,V,!0),V,d);if(!H||!H.length)return;$4(T,H,!1)}o[n][D].Type==vc.TCMNT&&(V=of(o[n][D].Target,e),A=A.concat(CM(Pr(t,V,!0),d)))}),A&&A.length&&$4(T,A,!0,d.people||[])}catch(D){if(d.WTF)throw D}}function Ia(t){return t.charAt(0)=="/"?t.slice(1):t}function Ez(t,e){if(SA(),e=e||{},Bx(e),Oa(t,"META-INF/manifest.xml")||Oa(t,"objectdata.xml"))return aw(t,e);if(Oa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fg<"u"){if(t.FileIndex)return fg(t);var r=Mt.utils.cfb_new();return _4(t).forEach(function(Me){TP(r,Me,EP(t,Me))}),fg(r)}throw new Error("Unsupported NUMBERS file")}if(!Oa(t,"[Content_Types].xml"))throw Oa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_4(t),a=vF(ma(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Pr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Pr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var d={},m={};if(!e.bookSheets&&!e.bookProps){if(Ef=[],a.sst)try{Ef=DU(Pr(t,Ia(a.sst)),a.sst,e)}catch(Me){if(e.WTF)throw Me}e.cellStyles&&a.themes.length&&(d=IU(ma(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(m=kU(Pr(t,Ia(a.style)),a.style,d,e))}a.links.map(function(Me){try{var Ne=xf(ma(t,$g(Ia(Me))),Me);return PU(Pr(t,Ia(Me)),Ne,Me,e)}catch{}});var g=bU(Pr(t,Ia(a.workbooks[0])),a.workbooks[0],e),y={},_="";a.coreprops.length&&(_=Pr(t,Ia(a.coreprops[0]),!0),_&&(y=ZA(_)),a.extprops.length!==0&&(_=Pr(t,Ia(a.extprops[0]),!0),_&&TF(_,y,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=ma(t,Ia(a.custprops[0]),!0),_&&(T=SF(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(Ne){return Ne.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),e.bookProps&&(E.Props=y,E.Custprops=T),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=jU(Pr(t,Ia(a.calcchain)),a.calcchain));var b=0,O={},L,A;{var D=g.Sheets;y.Worksheets=D.length,y.SheetNames=[];for(var V=0;V!=D.length;++V)y.SheetNames[V]=D[V].name}var H=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),N=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Oa(t,N)||(N="xl/_rels/workbook."+H+".rels");var R=xf(ma(t,N,!0),N.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=FU(Pr(t,Ia(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=NM(Pr(t,Ia(a.people[0])),e)),R&&(R=_z(R,g.Sheets));var F=Pr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=y.Worksheets;++b){var P="sheet";if(R&&R[b]?(L="xl/"+R[b][1].replace(/[\/]?xl\//,""),Oa(t,L)||(L=R[b][1]),Oa(t,L)||(L=N.replace(/_rels\/.*$/,"")+R[b][1]),P=R[b][2]):(L="xl/worksheets/sheet"+(b+1-F)+"."+H,L=L.replace(/sheet0\./,"sheet.")),A=L.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(y.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,U=0;U!=e.sheets.length;++U)typeof e.sheets[U]=="number"&&e.sheets[U]==b&&(M=1),typeof e.sheets[U]=="string"&&e.sheets[U].toLowerCase()==y.SheetNames[b].toLowerCase()&&(M=1);if(!M)continue e}}yz(t,L,A,y.SheetNames[b],b,O,l,P,e,g,d,m)}return E={Directory:a,Workbook:g,Props:y,Custprops:T,Deps:S,Sheets:l,SheetNames:y.SheetNames,Strings:Ef,Styles:m,Themes:d,SSF:pn(xt)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Me,Ne){Me=Me.replace(/^Root Entry[\/]/,""),E.keys.push(Me),E.files[Me]=t.FileIndex[Ne]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=Pr(t,Ia(a.vba[0]),!0):a.defaults&&a.defaults.bin===DM&&(E.vbaraw=Pr(t,"xl/vbaProject.bin",!0))),E}function Tz(t,e){var r=e||{},n="Workbook",a=Mt.find(t,n);try{if(n="/!DataSpaces/Version",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(mL(a.content),n="/!DataSpaces/DataSpaceMap",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=gL(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=vL(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);_L(a.content)}catch{}if(n="/EncryptionInfo",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=yL(a.content);if(n="/EncryptedPackage",a=Mt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Vx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=va(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wz(t,e){return Mt.find(t,"EncryptedPackage")?Tz(t,e):L3(t,e)}function Sz(t,e){var r,n=t,a=e||{};return a.type||(a.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r=kA(n,a),Ez(r,a)}function U3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Kg(t.slice(r),e);default:break e}return Bf.to_workbook(t,e)}function bz(t,e){var r="",n=Vx(t,e);switch(e.type){case"base64":r=va(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=hl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ir(r)),e.type="binary",U3(r,e)}function Az(t,e){var r=t;return e.type=="base64"&&(r=va(r)),r=Hg.utils.decode(1200,r.slice(2),"str"),e.type="binary",U3(r,e)}function Cz(t){return t.match(/[^\x00-\x7F]/)?lf(t):t}function hg(t,e,r,n){return n?(r.type="string",Bf.to_workbook(t,r)):Bf.to_workbook(e,r)}function Zg(t,e){hA();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Zg(new Uint8Array(t),(r=pn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Sc={},r.dateNF&&(Sc.dateNF=r.dateNF),r.type||(r.type=kt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=kt?"buffer":"binary",n=mP(t),typeof Uint8Array<"u"&&!kt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=Cz(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=pn(r),r.type="array",Zg(xx(n),r)}switch((a=Vx(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return wz(Mt.read(n,r),r);break;case 9:if(a[1]<=8)return L3(n,r);break;case 60:return Kg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return tL(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Z7.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Sz(n,r):hg(t,n,r,o);case 239:return a[3]===60?Kg(n,r):hg(t,n,r,o);case 255:if(a[1]===254)return Az(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return yf.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return yf.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return q4.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return DL.to_workbook(n,r);break;case 10:case 13:case 32:return bz(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Q7.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?q4.to_workbook(n,r):hg(t,n,r,o)}function Nz(t,e,r,n,a,o,l,u){var d=gn(r),m=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var T=e.s.c;T<=e.e.c;++T){var E=l?t[r][T]:t[n[T]+d];if(E===void 0||E.t===void 0){if(m===void 0)continue;o[T]!=null&&(_[o[T]]=m);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(o[T]!=null){if(S==null)if(E.t=="e"&&S===null)_[o[T]]=null;else if(m!==void 0)_[o[T]]=m;else if(g&&S===null)_[o[T]]=null;else continue;else _[o[T]]=g&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?S:xi(E,S,u);S!=null&&(y=!1)}}return{row:_,isempty:y}}function ev(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},g=m.range!=null?m.range:t["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof g){case"string":d=Er(g);break;case"number":d=Er(t["!ref"]),d.s.r=g;break;default:d=g}n>0&&(a=0);var y=gn(d.s.r),_=[],T=[],E=0,S=0,b=Array.isArray(t),O=d.s.r,L=0,A={};b&&!t[O]&&(t[O]=[]);var D=m.skipHidden&&t["!cols"]||[],V=m.skipHidden&&t["!rows"]||[];for(L=d.s.c;L<=d.e.c;++L)if(!(D[L]||{}).hidden)switch(_[L]=Gr(L),r=b?t[O][L]:t[_[L]+y],n){case 1:o[L]=L-d.s.c;break;case 2:o[L]=_[L];break;case 3:o[L]=m.header[L-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=xi(r,null,m),S=A[l]||0,!S)A[l]=1;else{do u=l+"_"+S++;while(A[u]);A[l]=S,A[u]=1}o[L]=u}for(O=d.s.r+a;O<=d.e.r;++O)if(!(V[O]||{}).hidden){var H=Nz(t,d,O,_,n,o,b,m);(H.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(T[E++]=H.row)}return T.length=E,T}var lw=/"/g;function Rz(t,e,r,n,a,o,l,u){for(var d=!0,m=[],g="",y=gn(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var T=u.dense?(t[r]||[])[_]:t[n[_]+y];if(T==null)g="";else if(T.v!=null){d=!1,g=""+(u.rawNumbers&&T.t=="n"?T.v:xi(T,null,u));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===o||S===34||u.forceQuotes){g='"'+g.replace(lw,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(d=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(lw,'""')+'"')):g="";m.push(g)}return u.blankrows===!1&&d?null:m.join(l)}function z3(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Er(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,d=u.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),g="",y=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],T=n.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(y[E]=Gr(E));for(var S=0,b=a.s.r;b<=a.e.r;++b)(T[b]||{}).hidden||(g=Rz(t,a,b,y,l,d,o,n),g!=null&&(n.strip&&(g=g.replace(m,"")),(g||n.blankrows!==!1)&&r.push((S++?u:"")+g)));return delete n.dense,r.join("")}function kz(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=z3(t,e);return r}function Iz(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Er(t["!ref"]),o="",l=[],u,d=[],m=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=Gr(u);for(var g=a.s.r;g<=a.e.r;++g)for(o=gn(g),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=m?(t[g]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}d[d.length]=e+"="+n}return d}function H3(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var d=typeof n.origin=="string"?Gn(n.origin):n.origin;l=d.r,u=d.c}var m,g={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var y=Er(o["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),l==-1&&(l=y.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=n.header||[],T=0;e.forEach(function(S,b){Ds(S).forEach(function(O){(T=_.indexOf(O))==-1&&(_[T=_.length]=O);var L=S[O],A="z",D="",V=pt({c:u+T,r:l+b+a});m=Hf(o,V),L&&typeof L=="object"&&!(L instanceof Date)?o[V]=L:(typeof L=="number"?A="n":typeof L=="boolean"?A="b":typeof L=="string"?A="s":L instanceof Date?(A="d",n.cellDates||(A="n",L=$n(L)),D=n.dateNF||xt[14]):L===null&&n.nullError&&(A="e",L=0),m?(m.t=A,m.v=L,delete m.w,delete m.R,D&&(m.z=D)):o[V]=m={t:A,v:L},D&&(m.z=D))})}),g.e.c=Math.max(g.e.c,u+_.length-1);var E=gn(l);if(a)for(T=0;T<_.length;++T)o[Gr(T+u)+E]={t:"s",v:_[T]};return o["!ref"]=Bt(g),o}function Dz(t,e){return H3(null,t,e)}function Hf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Gn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Hf(t,pt(e)):Hf(t,pt({r:e,c:r||0}))}function Oz(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Ux(){return{SheetNames:[],Sheets:{}}}function zx(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(vU(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function jz(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Oz(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Pz(t,e){return t.z=e,t}function G3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Fz(t,e,r){return G3(t,"#"+e,r)}function Lz(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Mz(t,e,r,n){for(var a=typeof e!="string"?e:Er(e),o=typeof e=="string"?e:Bt(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var d=Hf(t,l,u);d.t="n",d.F=o,delete d.v,l==a.s.r&&u==a.s.c&&(d.f=r,n&&(d.D=!0))}return t}var Bz={encode_col:Gr,encode_row:gn,encode_cell:pt,encode_range:Bt,decode_col:Cx,decode_row:Ax,split_cell:XP,decode_cell:Gn,decode_range:Wc,format_cell:xi,sheet_add_aoa:WA,sheet_add_json:H3,sheet_add_dom:M3,aoa_to_sheet:Kc,json_to_sheet:Dz,table_to_sheet:B3,table_to_book:tz,sheet_to_csv:z3,sheet_to_txt:kz,sheet_to_json:ev,sheet_to_html:ez,sheet_to_formulae:Iz,sheet_to_row_object_array:ev,sheet_get_cell:Hf,book_new:Ux,book_append_sheet:zx,book_set_sheet_visibility:jz,cell_set_number_format:Pz,cell_set_hyperlink:G3,cell_set_internal_link:Fz,cell_add_comment:Lz,sheet_set_array_formula:Mz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Vz="_modalOverlay_9tr5m_1",Uz="_enrollModal_9tr5m_31",zz="_scaledModal_9tr5m_55",Hz="_modalHeader_9tr5m_87",Gz="_modalTitle_9tr5m_109",qz="_closeBtn_9tr5m_121",$z="_enrollForm_9tr5m_217",Yz="_formSection_9tr5m_229",Wz="_sectionTitle_9tr5m_237",Kz="_formRow_9tr5m_255",Xz="_formGroup_9tr5m_269",Qz="_formLabel_9tr5m_279",Jz="_formInput_9tr5m_293",Zz="_formSelect_9tr5m_309",eH="_disabledInput_9tr5m_317",tH="_profilePhotoContainer_9tr5m_327",rH="_profilePhotoWrapper_9tr5m_339",nH="_profilePhoto_9tr5m_327",aH="_profilePhotoPlaceholder_9tr5m_369",sH="_profileIcon_9tr5m_393",iH="_selectPhotoBtn_9tr5m_401",oH="_removePhotoBtn_9tr5m_403",lH="_formActions_9tr5m_457",cH="_cancelBtn_9tr5m_475",uH="_submitBtn_9tr5m_477",Ue={modalOverlay:Vz,enrollModal:Uz,scaledModal:zz,modalHeader:Hz,modalTitle:Gz,closeBtn:qz,enrollForm:$z,formSection:Yz,sectionTitle:Wz,formRow:Kz,formGroup:Xz,formLabel:Qz,formInput:Jz,formSelect:Zz,disabledInput:eH,profilePhotoContainer:tH,profilePhotoWrapper:rH,profilePhoto:nH,profilePhotoPlaceholder:aH,profileIcon:sH,selectPhotoBtn:iH,removePhotoBtn:oH,formActions:lH,cancelBtn:cH,submitBtn:uH},fH=({show:t,onClose:e})=>{const[r,n]=ne.useState({department:"",lrn:"",firstName:"",middleName:"",lastName:"",email:"",phone:"",username:"",password:"",address:"",province:"",zipCode:"",city:"",emergencyName:"",emergencyContact:"",emergencyRelation:"",profilePhoto:null}),[a,o]=ne.useState(null),[l,u]=ne.useState("Generating..."),[d,m]=ne.useState(!1),g=ne.useRef(null),y=[{value:"",label:"Select Department"},{value:"college",label:"College"},{value:"tvet",label:"TVET"},{value:"shs",label:"Senior High School (SHS)"},{value:"jhs",label:"Junior High School (JHS)"}],_=[{value:"",label:"Select Relation"},{value:"father",label:"Father"},{value:"mother",label:"Mother"},{value:"sister",label:"Sister"},{value:"brother",label:"Brother"},{value:"guardian",label:"Guardian"}];ne.useEffect(()=>{t?(async()=>{const D=`SPC${new Date().getFullYear().toString().slice(-2)}-`;try{const V=kn(Ut,"counters","studentIds"),H=await u9(Ut,async C=>{const N=await C.get(V),F=(N.exists()&&N.data().lastNumber||0)+1;return C.set(V,{lastNumber:F},{merge:!0}),`${D}${F.toString().padStart(4,"0")}`});u(H)}catch(V){console.error("ID generation error:",V);const H=Date.now().toString().slice(-4);u(`${D}${H}`)}})():u("Generating...")},[t]);const T=L=>{const{name:A,value:D}=L.target;n(V=>({...V,[A]:D}))},E=L=>{const A=L.target.files[0];if(A){if(!A.type.match("image.*")){alert("Please select an image file (jpg, png, etc.)");return}if(A.size>5*1024*1024){alert("Image size should be less than 5MB");return}const D=new FileReader;D.onloadend=()=>{o(D.result),n(V=>({...V,profilePhoto:A}))},D.readAsDataURL(A)}},S=()=>{o(null),n(L=>({...L,profilePhoto:null})),g.current&&(g.current.value="")},b=async L=>{var A;if(L.preventDefault(),!ui.currentUser){alert("Please sign in to enroll students");return}m(!0);try{const V=["department","firstName","lastName","email","phone","username","password","address","province","city","zipCode","emergencyName","emergencyContact","emergencyRelation"].filter(N=>!r[N]);if(V.length>0)throw new Error(`Missing required fields: ${V.join(", ")}`);if((r.department==="shs"||r.department==="jhs")&&!r.lrn)throw new Error("LRN is required for SHS/JHS students");let H=null;if(r.profilePhoto)try{const N=await px(r.profilePhoto);H=(N==null?void 0:N.secure_url)||null}catch(N){console.error("Photo upload failed:",N)}const C={studentId:l,department:r.department,lrn:r.lrn||null,firstName:r.firstName.trim(),middleName:((A=r.middleName)==null?void 0:A.trim())||null,lastName:r.lastName.trim(),email:r.email.toLowerCase().trim(),phone:r.phone.trim(),username:r.username.toLowerCase().trim(),password:r.password,address:{street:r.address.trim(),province:r.province.trim(),city:r.city.trim(),zipCode:r.zipCode.trim()},emergencyContact:{name:r.emergencyName.trim(),phone:r.emergencyContact.trim(),relation:r.emergencyRelation},profilePhoto:H,createdAt:new Date,updatedAt:new Date,status:"active",isVerified:!1,academicStatus:"enrolled",enrolledBy:ui.currentUser.uid};await Nm(mn(Ut,"students"),C),alert(`Student ${l} enrolled successfully!`),O(),e()}catch(D){console.error("Enrollment error:",D),alert(D.message||"Failed to enroll student. Please try again.")}finally{m(!1)}},O=()=>{n({department:"",lrn:"",firstName:"",middleName:"",lastName:"",email:"",phone:"",username:"",password:"",address:"",province:"",zipCode:"",city:"",emergencyName:"",emergencyContact:"",emergencyRelation:"",profilePhoto:null}),o(null),u("Generating...")};return t?h.jsx("div",{className:Ue.modalOverlay,children:h.jsxs("div",{className:`${Ue.enrollModal} ${Ue.scaledModal}`,children:[h.jsxs("div",{className:Ue.modalHeader,children:[h.jsx("h2",{className:Ue.modalTitle,children:"Enroll New Student"}),h.jsx("button",{className:Ue.closeBtn,onClick:e,disabled:d,children:"×"})]}),h.jsxs("form",{onSubmit:b,className:Ue.enrollForm,children:[h.jsxs("div",{className:Ue.formSection,children:[h.jsx("h3",{className:Ue.sectionTitle,children:"Academic Information"}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"studentId",className:Ue.formLabel,children:"Student ID"}),h.jsx("input",{id:"studentId",type:"text",value:l,disabled:!0,className:`${Ue.formInput} ${Ue.disabledInput}`})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"department",className:Ue.formLabel,children:"Department *"}),h.jsx("select",{id:"department",name:"department",value:r.department,onChange:T,required:!0,disabled:d,className:`${Ue.formInput} ${Ue.formSelect}`,children:y.map(L=>h.jsx("option",{value:L.value,children:L.label},L.value))})]}),(r.department==="shs"||r.department==="jhs")&&h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"lrn",className:Ue.formLabel,children:"LRN *"}),h.jsx("input",{id:"lrn",type:"text",name:"lrn",value:r.lrn,onChange:T,required:!0,disabled:d,pattern:"[0-9]{12}",title:"LRN must be 12 digits",className:Ue.formInput})]})]})]}),h.jsxs("div",{className:Ue.formSection,children:[h.jsx("h3",{className:Ue.sectionTitle,children:"Personal Details"}),h.jsx("div",{className:Ue.profilePhotoContainer,children:h.jsxs("div",{className:Ue.profilePhotoWrapper,children:[a?h.jsxs(h.Fragment,{children:[h.jsx("img",{src:a,alt:"Profile Preview",className:Ue.profilePhoto}),h.jsx("button",{type:"button",className:Ue.removePhotoBtn,onClick:S,disabled:d,children:"Remove"})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:Ue.profilePhotoPlaceholder,children:h.jsx("i",{className:`fas fa-user ${Ue.profileIcon}`})}),h.jsx("button",{type:"button",className:Ue.selectPhotoBtn,onClick:()=>g.current.click(),disabled:d,children:"Select Photo"})]}),h.jsx("input",{type:"file",ref:g,onChange:E,accept:"image/*",style:{display:"none"},disabled:d})]})}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"firstName",className:Ue.formLabel,children:"First Name *"}),h.jsx("input",{id:"firstName",type:"text",name:"firstName",value:r.firstName,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"middleName",className:Ue.formLabel,children:"Middle Name"}),h.jsx("input",{id:"middleName",type:"text",name:"middleName",value:r.middleName,onChange:T,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"lastName",className:Ue.formLabel,children:"Last Name *"}),h.jsx("input",{id:"lastName",type:"text",name:"lastName",value:r.lastName,onChange:T,required:!0,disabled:d,className:Ue.formInput})]})]}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"email",className:Ue.formLabel,children:"Email Address *"}),h.jsx("input",{id:"email",type:"email",name:"email",value:r.email,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"phone",className:Ue.formLabel,children:"Cellphone Number *"}),h.jsx("input",{id:"phone",type:"tel",name:"phone",value:r.phone,onChange:T,required:!0,disabled:d,pattern:"[0-9]{11}",title:"Phone number must be 11 digits",className:Ue.formInput})]})]}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"username",className:Ue.formLabel,children:"Username *"}),h.jsx("input",{id:"username",type:"text",name:"username",value:r.username,onChange:T,required:!0,disabled:d,minLength:"4",className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"password",className:Ue.formLabel,children:"Password *"}),h.jsx("input",{id:"password",type:"password",name:"password",value:r.password,onChange:T,required:!0,disabled:d,minLength:"6",className:Ue.formInput})]})]})]}),h.jsxs("div",{className:Ue.formSection,children:[h.jsx("h3",{className:Ue.sectionTitle,children:"Address Information"}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"address",className:Ue.formLabel,children:"Present Address *"}),h.jsx("input",{id:"address",type:"text",name:"address",value:r.address,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"province",className:Ue.formLabel,children:"Province *"}),h.jsx("input",{id:"province",type:"text",name:"province",value:r.province,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"city",className:Ue.formLabel,children:"City *"}),h.jsx("input",{id:"city",type:"text",name:"city",value:r.city,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"zipCode",className:Ue.formLabel,children:"ZIP Code *"}),h.jsx("input",{id:"zipCode",type:"text",name:"zipCode",value:r.zipCode,onChange:T,required:!0,disabled:d,pattern:"[0-9]{4}",title:"ZIP code must be 4 digits",className:Ue.formInput})]})]})]}),h.jsxs("div",{className:Ue.formSection,children:[h.jsx("h3",{className:Ue.sectionTitle,children:"Emergency Contact"}),h.jsxs("div",{className:Ue.formRow,children:[h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"emergencyName",className:Ue.formLabel,children:"Full Name *"}),h.jsx("input",{id:"emergencyName",type:"text",name:"emergencyName",value:r.emergencyName,onChange:T,required:!0,disabled:d,className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"emergencyContact",className:Ue.formLabel,children:"Contact Number *"}),h.jsx("input",{id:"emergencyContact",type:"tel",name:"emergencyContact",value:r.emergencyContact,onChange:T,required:!0,disabled:d,pattern:"[0-9]{11}",title:"Phone number must be 11 digits",className:Ue.formInput})]}),h.jsxs("div",{className:Ue.formGroup,children:[h.jsx("label",{htmlFor:"emergencyRelation",className:Ue.formLabel,children:"Relationship *"}),h.jsx("select",{id:"emergencyRelation",name:"emergencyRelation",value:r.emergencyRelation,onChange:T,required:!0,disabled:d,className:`${Ue.formInput} ${Ue.formSelect}`,children:_.map(L=>h.jsx("option",{value:L.value,children:L.label},L.value))})]})]})]}),h.jsxs("div",{className:Ue.formActions,children:[h.jsx("button",{type:"button",className:Ue.cancelBtn,onClick:e,disabled:d,children:"Cancel"}),h.jsx("button",{type:"submit",className:Ue.submitBtn,disabled:d,children:d?"Enrolling...":"Submit Enrollment"})]})]})]})}):null},hH="_modalOverlay_1jp9n_1",dH="_editModal_1jp9n_27",mH="_modalHeader_1jp9n_47",pH="_modalTitle_1jp9n_63",gH="_closeBtn_1jp9n_75",vH="_errorMessage_1jp9n_103",xH="_editForm_1jp9n_123",_H="_formSection_1jp9n_131",yH="_sectionTitle_1jp9n_139",EH="_formRow_1jp9n_151",TH="_formGroup_1jp9n_165",wH="_formLabel_1jp9n_175",SH="_formInput_1jp9n_189",bH="_formSelect_1jp9n_189",AH="_disabledInput_1jp9n_217",CH="_profilePhotoContainer_1jp9n_229",NH="_profilePhotoWrapper_1jp9n_237",RH="_profilePhoto_1jp9n_229",kH="_profilePhotoPlaceholder_1jp9n_267",IH="_profileIcon_1jp9n_289",DH="_selectPhotoBtn_1jp9n_299",OH="_removePhotoBtn_1jp9n_299",jH="_formActions_1jp9n_353",PH="_cancelBtn_1jp9n_371",FH="_submitBtn_1jp9n_371",ze={modalOverlay:hH,editModal:dH,modalHeader:mH,modalTitle:pH,closeBtn:gH,errorMessage:vH,editForm:xH,formSection:_H,sectionTitle:yH,formRow:EH,formGroup:TH,formLabel:wH,formInput:SH,formSelect:bH,disabledInput:AH,profilePhotoContainer:CH,profilePhotoWrapper:NH,profilePhoto:RH,profilePhotoPlaceholder:kH,profileIcon:IH,selectPhotoBtn:DH,removePhotoBtn:OH,formActions:jH,cancelBtn:PH,submitBtn:FH},LH=({show:t,onClose:e,student:r,onUpdate:n})=>{const[a,o]=ne.useState({department:"",lrn:"",firstName:"",middleName:"",lastName:"",email:"",phone:"",username:"",password:"",address:"",province:"",zipCode:"",city:"",emergencyName:"",emergencyContact:"",emergencyRelation:"",profilePhoto:null}),[l,u]=ne.useState((r==null?void 0:r.profilePhoto)||null),[d,m]=ne.useState(!1),[g,y]=ne.useState(null),_=ne.useRef(null),T=[{value:"college",label:"College"},{value:"tvet",label:"TVET"},{value:"shs",label:"Senior High School (SHS)"},{value:"jhs",label:"Junior High School (JHS)"}],E=[{value:"father",label:"Father"},{value:"mother",label:"Mother"},{value:"sister",label:"Sister"},{value:"brother",label:"Brother"},{value:"guardian",label:"Guardian"}];ne.useEffect(()=>{var A,D,V,H,C,N,R;r&&(o({department:r.department||"",lrn:r.lrn||"",firstName:r.firstName||"",middleName:r.middleName||"",lastName:r.lastName||"",email:r.email||"",phone:r.phone||"",username:r.username||"",password:r.password||"",address:((A=r.address)==null?void 0:A.street)||"",province:((D=r.address)==null?void 0:D.province)||"",zipCode:((V=r.address)==null?void 0:V.zipCode)||"",city:((H=r.address)==null?void 0:H.city)||"",emergencyName:((C=r.emergencyContact)==null?void 0:C.name)||"",emergencyContact:((N=r.emergencyContact)==null?void 0:N.phone)||"",emergencyRelation:((R=r.emergencyContact)==null?void 0:R.relation)||"",profilePhoto:null}),u(r.profilePhoto||null))},[r]);const S=A=>{const{name:D,value:V}=A.target;o(H=>({...H,[D]:V}))},b=A=>{const D=A.target.files[0];if(D){if(!D.type.match("image.*")){y("Please select an image file (jpg, png, etc.)");return}if(D.size>5*1024*1024){y("Image size should be less than 5MB");return}const V=new FileReader;V.onloadend=()=>{u(V.result),o(H=>({...H,profilePhoto:D}))},V.readAsDataURL(D)}},O=()=>{u(null),o(A=>({...A,profilePhoto:null})),_.current&&(_.current.value="")},L=async A=>{var D;A.preventDefault(),y(null),m(!0);try{const H=["department","firstName","lastName","email","phone","username","address","province","city","zipCode","emergencyName","emergencyContact","emergencyRelation"].filter(R=>!a[R]);if(H.length>0)throw new Error(`Missing required fields: ${H.join(", ")}`);if((a.department==="shs"||a.department==="jhs")&&!a.lrn)throw new Error("LRN is required for SHS/JHS students");let C=l;if(a.profilePhoto)try{const R=await px(a.profilePhoto);C=(R==null?void 0:R.secure_url)||l}catch(R){console.error("Photo upload failed:",R)}const N={department:a.department,lrn:a.lrn||null,firstName:a.firstName.trim(),middleName:((D=a.middleName)==null?void 0:D.trim())||null,lastName:a.lastName.trim(),email:a.email.toLowerCase().trim(),phone:a.phone.trim(),username:a.username.toLowerCase().trim(),...a.password&&{password:a.password},address:{street:a.address.trim(),province:a.province.trim(),city:a.city.trim(),zipCode:a.zipCode.trim()},emergencyContact:{name:a.emergencyName.trim(),phone:a.emergencyContact.trim(),relation:a.emergencyRelation},...C&&{profilePhoto:C},updatedAt:M0()};await ul(kn(Ut,"students",r.id),N),n({id:r.id,...N,profilePhoto:C||r.profilePhoto}),e()}catch(V){console.error("Update error:",V),y(V.message||"Failed to update student. Please try again.")}finally{m(!1)}};return!t||!r?null:h.jsx("div",{className:ze.modalOverlay,children:h.jsxs("div",{className:ze.editModal,children:[h.jsxs("div",{className:ze.modalHeader,children:[h.jsxs("h2",{className:ze.modalTitle,children:["Edit Student: ",r.studentId]}),h.jsx("button",{className:ze.closeBtn,onClick:e,disabled:d,children:"×"})]}),g&&h.jsx("div",{className:ze.errorMessage,children:g}),h.jsxs("form",{onSubmit:L,className:ze.editForm,children:[h.jsxs("div",{className:ze.formSection,children:[h.jsx("h3",{className:ze.sectionTitle,children:"Academic Information"}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"studentId",className:ze.formLabel,children:"Student ID"}),h.jsx("input",{id:"studentId",type:"text",value:r.studentId,disabled:!0,className:`${ze.formInput} ${ze.disabledInput}`})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"department",className:ze.formLabel,children:"Department *"}),h.jsx("select",{id:"department",name:"department",value:a.department,onChange:S,required:!0,disabled:d,className:`${ze.formInput} ${ze.formSelect}`,children:T.map(A=>h.jsx("option",{value:A.value,children:A.label},A.value))})]}),(a.department==="shs"||a.department==="jhs")&&h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"lrn",className:ze.formLabel,children:"LRN *"}),h.jsx("input",{id:"lrn",type:"text",name:"lrn",value:a.lrn,onChange:S,required:!0,disabled:d,pattern:"[0-9]{12}",title:"LRN must be 12 digits",className:ze.formInput})]})]})]}),h.jsxs("div",{className:ze.formSection,children:[h.jsx("h3",{className:ze.sectionTitle,children:"Personal Details"}),h.jsx("div",{className:ze.profilePhotoContainer,children:h.jsxs("div",{className:ze.profilePhotoWrapper,children:[l?h.jsxs(h.Fragment,{children:[h.jsx("img",{src:l,alt:"Profile Preview",className:ze.profilePhoto}),h.jsx("button",{type:"button",className:ze.removePhotoBtn,onClick:O,disabled:d,children:"Remove"})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:ze.profilePhotoPlaceholder,children:h.jsx("i",{className:`fas fa-user ${ze.profileIcon}`})}),h.jsx("button",{type:"button",className:ze.selectPhotoBtn,onClick:()=>_.current.click(),disabled:d,children:"Select Photo"})]}),h.jsx("input",{type:"file",ref:_,onChange:b,accept:"image/*",style:{display:"none"},disabled:d})]})}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"firstName",className:ze.formLabel,children:"First Name *"}),h.jsx("input",{id:"firstName",type:"text",name:"firstName",value:a.firstName,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"middleName",className:ze.formLabel,children:"Middle Name"}),h.jsx("input",{id:"middleName",type:"text",name:"middleName",value:a.middleName,onChange:S,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"lastName",className:ze.formLabel,children:"Last Name *"}),h.jsx("input",{id:"lastName",type:"text",name:"lastName",value:a.lastName,onChange:S,required:!0,disabled:d,className:ze.formInput})]})]}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"email",className:ze.formLabel,children:"Email Address *"}),h.jsx("input",{id:"email",type:"email",name:"email",value:a.email,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"phone",className:ze.formLabel,children:"Cellphone Number *"}),h.jsx("input",{id:"phone",type:"tel",name:"phone",value:a.phone,onChange:S,required:!0,disabled:d,pattern:"[0-9]{11}",title:"Phone number must be 11 digits",className:ze.formInput})]})]}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"username",className:ze.formLabel,children:"Username *"}),h.jsx("input",{id:"username",type:"text",name:"username",value:a.username,onChange:S,required:!0,disabled:d,minLength:"4",className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"password",className:ze.formLabel,children:"New Password"}),h.jsx("input",{id:"password",type:"password",name:"password",value:a.password,onChange:S,disabled:d,minLength:"6",placeholder:"Leave blank to keep current",className:ze.formInput})]})]})]}),h.jsxs("div",{className:ze.formSection,children:[h.jsx("h3",{className:ze.sectionTitle,children:"Address Information"}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"address",className:ze.formLabel,children:"Present Address *"}),h.jsx("input",{id:"address",type:"text",name:"address",value:a.address,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"province",className:ze.formLabel,children:"Province *"}),h.jsx("input",{id:"province",type:"text",name:"province",value:a.province,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"city",className:ze.formLabel,children:"City *"}),h.jsx("input",{id:"city",type:"text",name:"city",value:a.city,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"zipCode",className:ze.formLabel,children:"ZIP Code *"}),h.jsx("input",{id:"zipCode",type:"text",name:"zipCode",value:a.zipCode,onChange:S,required:!0,disabled:d,pattern:"[0-9]{4}",title:"ZIP code must be 4 digits",className:ze.formInput})]})]})]}),h.jsxs("div",{className:ze.formSection,children:[h.jsx("h3",{className:ze.sectionTitle,children:"Emergency Contact"}),h.jsxs("div",{className:ze.formRow,children:[h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"emergencyName",className:ze.formLabel,children:"Full Name *"}),h.jsx("input",{id:"emergencyName",type:"text",name:"emergencyName",value:a.emergencyName,onChange:S,required:!0,disabled:d,className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"emergencyContact",className:ze.formLabel,children:"Contact Number *"}),h.jsx("input",{id:"emergencyContact",type:"tel",name:"emergencyContact",value:a.emergencyContact,onChange:S,required:!0,disabled:d,pattern:"[0-9]{11}",title:"Phone number must be 11 digits",className:ze.formInput})]}),h.jsxs("div",{className:ze.formGroup,children:[h.jsx("label",{htmlFor:"emergencyRelation",className:ze.formLabel,children:"Relationship *"}),h.jsx("select",{id:"emergencyRelation",name:"emergencyRelation",value:a.emergencyRelation,onChange:S,required:!0,disabled:d,className:`${ze.formInput} ${ze.formSelect}`,children:E.map(A=>h.jsx("option",{value:A.value,children:A.label},A.value))})]})]})]}),h.jsxs("div",{className:ze.formActions,children:[h.jsx("button",{type:"button",className:ze.cancelBtn,onClick:e,disabled:d,children:"Cancel"}),h.jsx("button",{type:"submit",className:ze.submitBtn,disabled:d,children:d?"Updating...":"Update Student"})]})]})]})})},MH="_modalOverlay_15czh_3",BH="_modalContent_15czh_31",VH="_modalHeader_15czh_57",UH="_closeButton_15czh_85",zH="_modalBody_15czh_105",HH="_searchContainer_15czh_119",GH="_studentIdInput_15czh_133",qH="_formLabel_15czh_149",$H="_formInput_15czh_161",YH="_searchBtn_15czh_177",WH="_notFoundMessage_15czh_219",KH="_enrollmentContainer_15czh_235",XH="_enrollmentForm_15czh_245",QH="_profileSection_15czh_261",JH="_profileImage_15czh_277",ZH="_profilePlaceholder_15czh_293",eG="_studentName_15czh_321",tG="_formGroup_15czh_333",rG="_formSelect_15czh_345",nG="_schoolYearInputs_15czh_361",aG="_schoolYearSeparator_15czh_381",sG="_submitBtn_15czh_389",iG="_studentDetails_15czh_433",oG="_sectionTitle_15czh_449",lG="_detailRow_15czh_465",cG="_detailLabel_15czh_477",uG="_detailValue_15czh_489",fG="_loadSubjectsBtn_15czh_501",hG="_modalFooter_15czh_547",dG="_cancelBtn_15czh_561",mG="_errorContainer_15czh_603",pG="_error_15czh_603",gG="_termTitle_15czh_693",vG="_tableWrapper_15czh_707",xG="_subjectsTable_15czh_715",_G="_headerButtons_15czh_767",yG="_printButton_15czh_779",Ve={modalOverlay:MH,modalContent:BH,modalHeader:VH,closeButton:UH,modalBody:zH,searchContainer:HH,studentIdInput:GH,formLabel:qH,formInput:$H,searchBtn:YH,notFoundMessage:WH,enrollmentContainer:KH,enrollmentForm:XH,profileSection:QH,profileImage:JH,profilePlaceholder:ZH,studentName:eG,formGroup:tG,formSelect:rG,schoolYearInputs:nG,schoolYearSeparator:aG,submitBtn:sG,studentDetails:iG,sectionTitle:oG,detailRow:lG,detailLabel:cG,detailValue:uG,loadSubjectsBtn:fG,modalFooter:hG,cancelBtn:dG,errorContainer:mG,error:pG,termTitle:gG,tableWrapper:vG,subjectsTable:xG,headerButtons:_G,printButton:yG},EG=({show:t,onClose:e})=>{var ie,me,Pe,oe,ee,ue,z;const[r,n]=ne.useState(""),[a,o]=ne.useState(null),[l,u]=ne.useState(!1),[d,m]=ne.useState(null),[g,y]=ne.useState([]),[_,T]=ne.useState(!1),[E,S]=ne.useState(!1),[b,O]=ne.useState({course:"",yearLevel:"",semester:"",schoolYearFrom:new Date().getFullYear(),schoolYearTo:new Date().getFullYear()+1}),L=["Select Course","BSIT","BSHM","BSBA","BSTM"],A=["Select Course","BTVTeD-AT","BTVTeD-HVACR TECH","BTVTeD-FSM","BTVTeD-ET"],D=["Select Course","Select","SHS"],V=["Select Course","Select","JHS"],H={college:["Select Year","1st Year","2nd Year","3rd Year","4th Year"],tvet:["Select Year","1st Year","2nd Year","3rd Year","4th Year"],shs:["Select Grade","Grade 11","Grade 12"],jhs:["Select Grade","Grade 7","Grade 8","Grade 9","Grade 10"]},C=["Select Semester","1st Semester","2nd Semester","Summer"];ne.useEffect(()=>{t||(n(""),o(null),y([]),T(!1),m(null),S(!1))},[t]);const N=async()=>{if(r){u(!0),m(null),S(!0);try{let X,G,K=null;const Q=mn(Ut,"students"),ye=Ya(Q,Un("studentId","==",r)),Ee=await Qa(ye);if(Ee.empty?(X=kn(Ut,"students",r),G=await L0(X),G.exists()&&(K=G.data())):(G=Ee.docs[0],X=kn(Ut,"students",G.id),K=G.data()),K){o(K),n(K.studentId||r);let Ae="",be="";const Ze=K.department;if(Ze==="college"?(Ae="BSIT",be="1st Year"):Ze==="tvet"?(Ae="BTVTeD-AT",be="1st Year"):Ze==="shs"?(Ae="SHS",be="Grade 11"):Ze==="jhs"&&(Ae="JHS",be="Grade 7"),K.enrollment){const[re,Ct]=K.enrollment.schoolYear.split("-").map(Number);O({course:K.enrollment.course||Ae,yearLevel:K.enrollment.yearLevel||be,semester:K.enrollment.semester||"1st Semester",schoolYearFrom:re||new Date().getFullYear(),schoolYearTo:Ct||new Date().getFullYear()+1})}else O({course:Ae,yearLevel:be,semester:"1st Semester",schoolYearFrom:new Date().getFullYear(),schoolYearTo:new Date().getFullYear()+1})}else m("Student not found. Please check the ID and try again.")}catch(X){console.error("Error fetching student:",X),m("Failed to fetch student data. Please try again.")}finally{u(!1)}}},R=X=>{const{name:G,value:K}=X.target;O(Q=>({...Q,[G]:K}))},F=X=>{const{name:G,value:K}=X.target,Q=parseInt(K)||0;O(ye=>{const Ee={...ye,[G]:Q};return G==="schoolYearFrom"&&(Ee.schoolYearTo=Q+1),Ee})},P=async X=>{X.preventDefault(),u(!0),T(!1);try{if(!a)throw new Error("No student data loaded");const G=mn(Ut,"students"),K=Ya(G,Un("studentId","==",r)),Q=await Qa(K);if(Q.empty)throw new Error("Student document not found");const ye=Q.docs[0].ref;await ul(ye,{enrollment:{...b,schoolYear:`${b.schoolYearFrom}-${b.schoolYearTo}`,enrolledAt:new Date},updatedAt:new Date,status:"Enrolled"});const Ee=await L0(ye);o(Ee.data()),m(null)}catch(G){console.error("Error updating enrollment:",G),m(G.message||"Failed to update enrollment")}finally{u(!1)}},M=async()=>{if(!(a!=null&&a.enrollment)){alert("Please complete enrollment details first");return}u(!0),m(null);try{const{course:X,yearLevel:G,semester:K}=b,Q=mn(Ut,"subjects"),ye=Ya(Q,Un("course","==",X),Un("yearLevel","==",G),Un("semester","==",K)),Ee=await Qa(ye);if(Ee.empty){m("No subjects found for the selected course, year level, and semester"),y([]),T(!1);return}const Ae=[];Ee.forEach(be=>{const Ze=be.data();Ae.push({id:be.id,subjectName:Ze.subjectName,subjectCode:Ze.subjectCode,terms:Ze.terms||{firstTerm:[],secondTerm:[]}})}),y(Ae),T(!0)}catch(X){console.error("Error loading subjects:",X),m("Failed to load subjects. Please try again."),y([]),T(!1)}finally{u(!1)}},U=()=>{if(!a)return[];switch(a.department){case"college":return L;case"tvet":return A;case"shs":return D;case"jhs":return V;default:return[]}},Me=()=>{if(!a)return[];switch(a.department){case"college":return H.college;case"tvet":return H.tvet;case"shs":return H.shs;case"jhs":return H.jhs;default:return[]}},Ne=()=>{var Q,ye,Ee,Ae,be,Ze,re,Ct;const X=window.open("","_blank"),G=new Date().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});`${a.lastName}${a.firstName}${((Q=a.middleName)==null?void 0:Q.charAt(0))||""}`;const K=((ye=a.enrollment)==null?void 0:ye.schoolYear)||"2025-2026";X.document.write(`
          <html>
            <head>
              <title>Student Enrollment Details</title>
              <style>
                @page {
                  size: A4;
                  margin: 1cm;
                }
                body { 
                  font-family: Arial, sans-serif; 
                  margin: 0;
                  padding: 0;
                }
                .header {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 20px;
                  padding-bottom: 10px;
                  border-bottom: 2px solid #333;
                }
                .school-info {
                  text-align: right;
                }
                .school-name {
                  font-size: 18px;
                  font-weight: bold;
                  margin-bottom: 5px;
                }
                .school-address {
                  font-size: 12px;
                }
                .logo {
                  height: 80px;
                  width: auto;
                }
                .registration-title {
                  text-align: center;
                  font-size: 16px;
                  font-weight: bold;
                  margin: 15px 0;
                  text-decoration: underline;
                }
                .student-info {
                  width: 100%;
                  margin-bottom: 20px;
                }
                .student-info-row {
                  display: flex;
                  margin-bottom: 8px;
                }
                .info-label {
                  font-weight: bold;
                  min-width: 120px;
                }
                .subjects-title {
                  text-align: center;
                  font-weight: bold;
                  margin: 20px 0 10px 0;
                  padding-bottom: 5px;
                  border-bottom: 1px solid #000;
                }
                .subject-table {
                  width: 100%;
                  border-collapse: collapse;
                  margin-bottom: 20px;
                }
                .subject-table th, .subject-table td {
                  border: 1px solid #ddd;
                  padding: 8px;
                  text-align: left;
                }
                .subject-table th {
                  background-color: #f2f2f2;
                  text-align: center;
                }
                .term-title {
                  background-color: #f5f5f5;
                  padding: 5px 10px;
                  margin: 20px 0 10px 0;
                  text-align: center;
                }
                .total-units {
                  text-align: right;
                  font-weight: bold;
                  margin-bottom: 20px;
                }
                .footer {
                  display: flex;
                  justify-content: space-between;
                  margin-top: 40px;
                  font-size: 12px;
                }
                .footer-section {
                  width: 23%;
                }
                .footer-label {
                  font-weight: bold;
                  margin-bottom: 30px;
                }
                .footer-line {
                  border-top: 1px solid #000;
                  padding-top: 5px;
                  margin-top: 30px;
                }
                .page-break {
                  page-break-after: always;
                }
                .copy-title {
                  text-align: center;
                  font-weight: bold;
                  margin: 20px 0;
                  font-size: 14px;
                }
              </style>
            </head>
            <body>
              <!-- Student's Copy -->
              <div class="copy-title">STUDENT'S COPY</div>
              
              <div class="header">
                <img src="/school-logo.png" class="logo" alt="School Logo">
                <div class="school-info">
                  <div class="school-name">SAMPLE POLYTECHNIC COLLEGE</div>
                  <div class="school-address">123 Education St., Learning City, 2000</div>
                </div>
              </div>
              
              <div class="registration-title">REGISTRATION DETAILS</div>
              
              <table class="student-info">
                <tr class="student-info-row">
                  <td class="info-label">Date of Admission/Enrollment:</td>
                  <td>${G}</td>
                  <td class="info-label">School Year:</td>
                  <td>${K}</td>
                  <td class="info-label">Status:</td>
                  <td>${a.status||"Enrolled"}</td>
                </tr>
                <tr class="student-info-row">
                  <td class="info-label">Family Name:</td>
                  <td>${a.lastName}</td>
                  <td class="info-label">First Name:</td>
                  <td>${a.firstName}</td>
                  <td class="info-label">Middle Name:</td>
                  <td>${a.middleName||""}</td>
                </tr>
                <tr class="student-info-row">
                  <td class="info-label">Course:</td>
                  <td>${((Ee=a.enrollment)==null?void 0:Ee.course)||"Not enrolled"}</td>
                  <td class="info-label">Year Level:</td>
                  <td>${((Ae=a.enrollment)==null?void 0:Ae.yearLevel)||"Not enrolled"}</td>
                  <td class="info-label">Semester:</td>
                  <td>${((be=a.enrollment)==null?void 0:be.semester)||"Not enrolled"}</td>
                </tr>
              </table>
              
              <div class="subjects-title">ENROLLED SUBJECTS</div>
              
              ${g.map(We=>{var lt;return`
                <div>
                  ${We.terms.firstTerm.length>0?`
                    <div class="term-title">FIRST TERM</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.firstTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.firstTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                  
                  ${We.terms.secondTerm.length>0?`
                    <div class="term-title">SECOND TERM</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.secondTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.secondTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                  
                  ${((lt=a.enrollment)==null?void 0:lt.semester)==="Summer"?`
                    <div class="term-title">SUMMER</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.firstTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.firstTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                </div>
              `}).join("")}
              
              <div class="footer">
                <div class="footer-section">
                  <div class="footer-label">Confirmed By:</div>
                  <div>Student's Signature / Date:</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Approved By:</div>
                  <div>Program Head Dean of College / Date:</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Assisted By:</div>
                  <div>Cashier / Date</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Copy Received By:</div>
                  <div>Registrar / Date</div>
                  <div class="footer-line"></div>
                </div>
              </div>
              
              <!-- Registrar's Copy -->
              <div class="page-break"></div>
              <div class="copy-title">REGISTRAR'S COPY</div>
              
              <!-- Repeat all content for registrar's copy -->
              <div class="header">
                <img src="/school-logo.png" class="logo" alt="School Logo">
                <div class="school-info">
                  <div class="school-name">SAMPLE POLYTECHNIC COLLEGE</div>
                  <div class="school-address">123 Education St., Learning City, 2000</div>
                </div>
              </div>
              
              <div class="registration-title">REGISTRATION DETAILS</div>
              
              <table class="student-info">
                <tr class="student-info-row">
                  <td class="info-label">Date of Admission/Enrollment:</td>
                  <td>${G}</td>
                  <td class="info-label">School Year:</td>
                  <td>${K}</td>
                  <td class="info-label">Status:</td>
                  <td>${a.status||"Enrolled"}</td>
                </tr>
                <tr class="student-info-row">
                  <td class="info-label">Family Name:</td>
                  <td>${a.lastName}</td>
                  <td class="info-label">First Name:</td>
                  <td>${a.firstName}</td>
                  <td class="info-label">Middle Name:</td>
                  <td>${a.middleName||""}</td>
                </tr>
                <tr class="student-info-row">
                  <td class="info-label">Course:</td>
                  <td>${((Ze=a.enrollment)==null?void 0:Ze.course)||"Not enrolled"}</td>
                  <td class="info-label">Year Level:</td>
                  <td>${((re=a.enrollment)==null?void 0:re.yearLevel)||"Not enrolled"}</td>
                  <td class="info-label">Semester:</td>
                  <td>${((Ct=a.enrollment)==null?void 0:Ct.semester)||"Not enrolled"}</td>
                </tr>
              </table>
              
              <div class="subjects-title">ENROLLED SUBJECTS</div>
              
              ${g.map(We=>{var lt;return`
                <div>
                  ${We.terms.firstTerm.length>0?`
                    <div class="term-title">FIRST TERM</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.firstTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.firstTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                  
                  ${We.terms.secondTerm.length>0?`
                    <div class="term-title">SECOND TERM</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.secondTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.secondTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                  
                  ${((lt=a.enrollment)==null?void 0:lt.semester)==="Summer"?`
                    <div class="term-title">SUMMER</div>
                    <table class="subject-table">
                      <thead>
                        <tr>
                          <th>Code</th>
                          <th>Description</th>
                          <th>Lec</th>
                          <th>Lab</th>
                          <th>Units</th>
                          <th>Days</th>
                          <th>Time</th>
                          <th>Room No.</th>
                        </tr>
                      </thead>
                      <tbody>
                        ${We.terms.firstTerm.map(Fe=>`
                          <tr>
                            <td>${Fe.subjectCode}</td>
                            <td>${Fe.description}</td>
                            <td>${Fe.lec}</td>
                            <td>${Fe.lab}</td>
                            <td>${Fe.units}</td>
                            <td></td>
                            <td></td>
                            <td></td>
                          </tr>
                        `).join("")}
                      </tbody>
                    </table>
                    <div class="total-units">
                      Total Units: ${We.terms.firstTerm.reduce((Fe,je)=>Fe+(parseFloat(je.units),0))}
                    </div>
                  `:""}
                </div>
              `}).join("")}
              
              <div class="footer">
                <div class="footer-section">
                  <div class="footer-label">Confirmed By:</div>
                  <div>Student's Signature / Date:</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Approved By:</div>
                  <div>Program Head Dean of College / Date:</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Assisted By:</div>
                  <div>Cashier / Date</div>
                  <div class="footer-line"></div>
                </div>
                <div class="footer-section">
                  <div class="footer-label">Copy Received By:</div>
                  <div>Registrar / Date</div>
                  <div class="footer-line"></div>
                </div>
              </div>
              
            </body>
          </html>
        `),X.document.close(),setTimeout(()=>{X.print()},500)};return t?h.jsx("div",{className:Ve.modalOverlay,children:h.jsxs("div",{className:Ve.modalContent,children:[h.jsxs("div",{className:Ve.modalHeader,children:[h.jsx("h3",{children:"Enroll Existing Student"}),h.jsxs("div",{className:Ve.headerButtons,children:[_&&h.jsxs("button",{className:Ve.printButton,onClick:Ne,title:"Print Details",children:[h.jsx(km,{})," Print Details"]}),h.jsx("button",{className:Ve.closeButton,onClick:e,children:"×"})]})]}),h.jsxs("div",{className:Ve.modalBody,children:[d&&h.jsx("div",{className:Ve.errorContainer,children:h.jsx("div",{className:Ve.error,children:d})}),a?h.jsxs("div",{className:Ve.enrollmentContainer,children:[h.jsxs("div",{className:Ve.enrollmentForm,children:[h.jsxs("div",{className:Ve.profileSection,children:[a.profilePhoto?h.jsx("img",{src:a.profilePhoto,alt:"Profile",className:Ve.profileImage}):h.jsx("div",{className:Ve.profilePlaceholder,children:h.jsxs("span",{children:[a.firstName.charAt(0),a.lastName.charAt(0)]})}),h.jsxs("h4",{className:Ve.studentName,children:[a.firstName," ",a.lastName]})]}),h.jsxs("div",{className:Ve.formGroup,children:[h.jsx("label",{className:Ve.formLabel,children:"Course *"}),h.jsx("select",{name:"course",value:b.course,onChange:R,className:`${Ve.formInput} ${Ve.formSelect}`,disabled:l,children:U().map(X=>h.jsx("option",{value:X,children:X},X))})]}),h.jsxs("div",{className:Ve.formGroup,children:[h.jsx("label",{className:Ve.formLabel,children:"Year Level *"}),h.jsx("select",{name:"yearLevel",value:b.yearLevel,onChange:R,className:`${Ve.formInput} ${Ve.formSelect}`,disabled:l,children:Me().map(X=>h.jsx("option",{value:X,children:X},X))})]}),h.jsxs("div",{className:Ve.formGroup,children:[h.jsx("label",{className:Ve.formLabel,children:"Semester *"}),h.jsx("select",{name:"semester",value:b.semester,onChange:R,className:`${Ve.formInput} ${Ve.formSelect}`,disabled:l,children:C.map(X=>h.jsx("option",{value:X,children:X},X))})]}),h.jsxs("div",{className:Ve.formGroup,children:[h.jsx("label",{className:Ve.formLabel,children:"School Year *"}),h.jsxs("div",{className:Ve.schoolYearInputs,children:[h.jsx("input",{type:"number",name:"schoolYearFrom",value:b.schoolYearFrom,onChange:F,className:Ve.formInput,disabled:l}),h.jsx("span",{className:Ve.schoolYearSeparator,children:"-"}),h.jsx("input",{type:"number",name:"schoolYearTo",value:b.schoolYearTo,onChange:F,className:Ve.formInput,disabled:l})]})]}),h.jsx("button",{type:"button",className:Ve.submitBtn,onClick:P,disabled:l||!b.course||!b.yearLevel||!b.semester,children:l?"Updating...":"Submit Enrollment"})]}),h.jsxs("div",{className:Ve.studentDetails,children:[h.jsx("h3",{className:Ve.sectionTitle,children:"Student Details"}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"ID:"}),h.jsx("span",{className:Ve.detailValue,children:a.studentId||r})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Department:"}),h.jsx("span",{className:Ve.detailValue,children:a.department==="college"?"College":a.department==="tvet"?"TVET":a.department==="shs"?"Senior High School":a.department==="jhs"?"Junior High School":""})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Course:"}),h.jsx("span",{className:Ve.detailValue,children:((ie=a.enrollment)==null?void 0:ie.course)||"Not enrolled"})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Year Level:"}),h.jsx("span",{className:Ve.detailValue,children:((me=a.enrollment)==null?void 0:me.yearLevel)||"Not enrolled"})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Semester:"}),h.jsx("span",{className:Ve.detailValue,children:((Pe=a.enrollment)==null?void 0:Pe.semester)||"Not enrolled"})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"School Year:"}),h.jsx("span",{className:Ve.detailValue,children:((oe=a.enrollment)==null?void 0:oe.schoolYear)||"Not enrolled"})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Full Name:"}),h.jsx("span",{className:Ve.detailValue,children:`${a.firstName} ${a.middleName?a.middleName+" ":""}${a.lastName}`})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Email:"}),h.jsx("span",{className:Ve.detailValue,children:a.email})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Phone:"}),h.jsx("span",{className:Ve.detailValue,children:a.phone})]}),h.jsxs("div",{className:Ve.detailRow,children:[h.jsx("span",{className:Ve.detailLabel,children:"Address:"}),h.jsx("span",{className:Ve.detailValue,children:`${(ee=a.address)==null?void 0:ee.street}, ${(ue=a.address)==null?void 0:ue.city}, ${(z=a.address)==null?void 0:z.province}`})]}),a.enrollment&&h.jsx("button",{type:"button",className:Ve.loadSubjectsBtn,onClick:M,disabled:l,children:l?"Loading...":"Load Subjects"})]})]}):h.jsxs("div",{className:Ve.searchContainer,children:[h.jsxs("div",{className:Ve.studentIdInput,children:[h.jsx("label",{htmlFor:"existingStudentId",className:Ve.formLabel,children:"Enter Student ID"}),h.jsx("input",{id:"existingStudentId",type:"text",value:r,onChange:X=>n(X.target.value),className:Ve.formInput,placeholder:"e.g., SPC25-0001"}),h.jsx("button",{className:Ve.searchBtn,onClick:N,disabled:!r.trim()||l,children:l?"Searching...":"Search"})]}),E&&!l&&!a&&h.jsx("p",{className:Ve.notFoundMessage,children:"Student not found. Please check the ID and try again."})]}),_&&g.length>0&&h.jsxs("div",{className:Ve.subjectsContainer,children:[h.jsxs("h4",{className:Ve.subjectsTitle,children:["Subjects for ",b.course," - ",b.yearLevel," - ",b.semester]}),g.map((X,G)=>h.jsxs("div",{className:Ve.subjectGroup,children:[X.terms.firstTerm.length>0&&h.jsxs("div",{className:Ve.termContainer,children:[h.jsx("h6",{className:Ve.termTitle,children:"First Term"}),h.jsx("div",{className:Ve.tableWrapper,children:h.jsxs("table",{className:Ve.subjectsTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:X.terms.firstTerm.map((K,Q)=>h.jsxs("tr",{children:[h.jsx("td",{children:K.subjectCode}),h.jsx("td",{children:K.description}),h.jsx("td",{children:K.lec}),h.jsx("td",{children:K.lab}),h.jsx("td",{children:K.units}),h.jsx("td",{children:K.preReq||"-"})]},`first-${Q}`))})]})})]}),X.terms.secondTerm.length>0&&h.jsxs("div",{className:Ve.termContainer,children:[h.jsx("h6",{className:Ve.termTitle,children:"Second Term"}),h.jsx("div",{className:Ve.tableWrapper,children:h.jsxs("table",{className:Ve.subjectsTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:X.terms.secondTerm.map((K,Q)=>h.jsxs("tr",{children:[h.jsx("td",{children:K.subjectCode}),h.jsx("td",{children:K.description}),h.jsx("td",{children:K.lec}),h.jsx("td",{children:K.lab}),h.jsx("td",{children:K.units}),h.jsx("td",{children:K.preReq||"-"})]},`second-${Q}`))})]})})]})]},G))]})]}),h.jsx("div",{className:Ve.modalFooter,children:h.jsx("button",{type:"button",className:Ve.cancelBtn,onClick:e,disabled:l,children:"Close"})})]})}):null},TG="_modalOverlay_gyawz_1",wG="_modalContainer_gyawz_29",SG="_modalHeader_gyawz_53",bG="_closeButton_gyawz_81",AG="_modalContent_gyawz_103",CG="_studentDetails_gyawz_115",NG="_subjectsSection_gyawz_129",RG="_profileSection_gyawz_145",kG="_profileImage_gyawz_159",IG="_profilePlaceholder_gyawz_175",DG="_studentName_gyawz_203",OG="_detailsGrid_gyawz_215",jG="_detailItem_gyawz_227",PG="_detailLabel_gyawz_237",FG="_detailValue_gyawz_249",LG="_statusBadge_gyawz_261",MG="_sectionHeader_gyawz_307",BG="_exportButtons_gyawz_321",VG="_exportButton_gyawz_321",UG="_subjectsContainer_gyawz_363",zG="_subjectGroup_gyawz_373",HG="_subjectTitle_gyawz_387",GG="_termContainer_gyawz_399",qG="_termTitle_gyawz_407",$G="_subjectTable_gyawz_419",YG="_noSubjects_gyawz_471",WG="_loading_gyawz_489",KG="_error_gyawz_491",Qe={modalOverlay:TG,modalContainer:wG,modalHeader:SG,closeButton:bG,modalContent:AG,studentDetails:CG,subjectsSection:NG,profileSection:RG,profileImage:kG,profilePlaceholder:IG,studentName:DG,detailsGrid:OG,detailItem:jG,detailLabel:PG,detailValue:FG,statusBadge:LG,sectionHeader:MG,exportButtons:BG,exportButton:VG,subjectsContainer:UG,subjectGroup:zG,subjectTitle:HG,termContainer:GG,termTitle:qG,subjectTable:$G,noSubjects:YG,loading:WG,error:KG},XG=({studentId:t,onClose:e})=>{var L,A,D,V,H,C,N;const[r,n]=ne.useState(null),[a,o]=ne.useState(!0),[l,u]=ne.useState(null),[d,m]=ne.useState([]),[g,y]=ne.useState(null),[_,T]=ne.useState(!1);ne.useEffect(()=>{t&&(async()=>{try{o(!0),u(null);const F=kn(Ut,"students",t),P=await L0(F);if(P.exists()){const M=P.data();n({id:P.id,...M}),M.enrollment&&await E(M.enrollment)}else u("Student not found")}catch(F){console.error("Error fetching student:",F),u(`Failed to load student data: ${F.message}`)}finally{o(!1)}})()},[t]);const E=async R=>{try{T(!0),y(null);const{course:F,yearLevel:P,semester:M}=R;console.log("Loading subjects for:",{course:F,yearLevel:P,semester:M});const U=mn(Ut,"subjects"),Me=Ya(U,Un("course","==",F),Un("yearLevel","==",P),Un("semester","==",M)),Ne=await Qa(Me);if(console.log("Found subjects:",Ne.docs.length),Ne.empty){y("No subjects found for this enrollment"),m([]);return}const ie=Ne.docs.map(me=>({id:me.id,...me.data(),terms:me.data().terms||{firstTerm:[],secondTerm:[]}}));m(ie)}catch(F){console.error("Error loading subjects:",F),y(`Failed to load subjects: ${F.message}`),m([])}finally{T(!1)}},S=R=>({college:"College",tvet:"TVET",shs:"Senior High",jhs:"Junior High"})[R]||R,b=R=>`${R.lastName}, ${R.firstName}${R.middleName?` ${R.middleName.charAt(0)}.`:""}`,O=R=>R.address?`${R.address.street||""}, ${R.address.city||""}, ${R.address.province||""}`:"";return t?h.jsx("div",{className:Qe.modalOverlay,children:h.jsxs("div",{className:Qe.modalContainer,children:[h.jsxs("div",{className:Qe.modalHeader,children:[h.jsx("h2",{children:"Student Details"}),h.jsx("button",{className:Qe.closeButton,onClick:e,children:h.jsx(gh,{})})]}),h.jsx("div",{className:Qe.modalContent,children:a?h.jsx("div",{className:Qe.loading,children:"Loading student data..."}):l?h.jsx("div",{className:Qe.error,children:l}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:Qe.studentDetails,children:[h.jsxs("div",{className:Qe.profileSection,children:[r.profilePhoto?h.jsx("img",{src:r.profilePhoto,alt:"Profile",className:Qe.profileImage}):h.jsxs("div",{className:Qe.profilePlaceholder,children:[(L=r.firstName)==null?void 0:L.charAt(0),(A=r.lastName)==null?void 0:A.charAt(0)]}),h.jsx("h3",{className:Qe.studentName,children:b(r)})]}),h.jsxs("div",{className:Qe.detailsGrid,children:[h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Student ID:"}),h.jsx("span",{className:Qe.detailValue,children:r.studentId})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Department:"}),h.jsx("span",{className:Qe.detailValue,children:S(r.department)})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Course:"}),h.jsx("span",{className:Qe.detailValue,children:((D=r.enrollment)==null?void 0:D.course)||"Not enrolled"})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Year Level:"}),h.jsx("span",{className:Qe.detailValue,children:((V=r.enrollment)==null?void 0:V.yearLevel)||"Not enrolled"})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Semester:"}),h.jsx("span",{className:Qe.detailValue,children:((H=r.enrollment)==null?void 0:H.semester)||"Not enrolled"})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"School Year:"}),h.jsx("span",{className:Qe.detailValue,children:((C=r.enrollment)==null?void 0:C.schoolYear)||"Not enrolled"})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Status:"}),h.jsx("span",{className:`${Qe.detailValue} ${Qe.statusBadge} ${(N=r.status)==null?void 0:N.toLowerCase()}`,children:r.status||"Unknown"})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Email:"}),h.jsx("span",{className:Qe.detailValue,children:r.email})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Phone:"}),h.jsx("span",{className:Qe.detailValue,children:r.phone})]}),h.jsxs("div",{className:Qe.detailItem,children:[h.jsx("span",{className:Qe.detailLabel,children:"Address:"}),h.jsx("span",{className:Qe.detailValue,children:O(r)})]})]})]}),h.jsxs("div",{className:Qe.subjectsSection,children:[h.jsxs("div",{className:Qe.sectionHeader,children:[h.jsx("h3",{children:"Enrolled Subjects"}),h.jsxs("div",{className:Qe.exportButtons,children:[r.enrollment&&h.jsxs("button",{className:Qe.refreshButton,onClick:()=>E(r.enrollment),disabled:_,children:[h.jsx(aj,{})," Refresh"]}),d.length>0&&h.jsxs(h.Fragment,{children:[h.jsxs(Om,{data:d,filename:`${r.studentId}-subjects.csv`,className:Qe.exportButton,children:[h.jsx(H0,{})," Excel"]}),h.jsxs("button",{className:Qe.exportButton,children:[h.jsx(hx,{})," PDF"]}),h.jsxs("button",{className:Qe.exportButton,children:[h.jsx(km,{})," Print"]})]})]})]}),g&&h.jsx("div",{className:Qe.subjectError,children:g}),_?h.jsx("div",{className:Qe.loading,children:"Loading subjects..."}):d.length>0?h.jsx("div",{className:Qe.subjectsContainer,children:d.map((R,F)=>h.jsxs("div",{className:Qe.subjectGroup,children:[h.jsx("h4",{className:Qe.subjectTitle,children:R.subjectName}),R.terms.firstTerm.length>0&&h.jsxs("div",{className:Qe.termContainer,children:[h.jsx("h5",{className:Qe.termTitle,children:"First Term"}),h.jsxs("table",{className:Qe.subjectTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:R.terms.firstTerm.map((P,M)=>h.jsxs("tr",{children:[h.jsx("td",{children:P.subjectCode}),h.jsx("td",{children:P.description}),h.jsx("td",{children:P.lec}),h.jsx("td",{children:P.lab}),h.jsx("td",{children:P.units}),h.jsx("td",{children:P.preReq||"-"})]},`first-${M}`))})]})]}),R.terms.secondTerm.length>0&&h.jsxs("div",{className:Qe.termContainer,children:[h.jsx("h5",{className:Qe.termTitle,children:"Second Term"}),h.jsxs("table",{className:Qe.subjectTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:R.terms.secondTerm.map((P,M)=>h.jsxs("tr",{children:[h.jsx("td",{children:P.subjectCode}),h.jsx("td",{children:P.description}),h.jsx("td",{children:P.lec}),h.jsx("td",{children:P.lab}),h.jsx("td",{children:P.units}),h.jsx("td",{children:P.preReq||"-"})]},`second-${M}`))})]})]})]},F))}):h.jsx("div",{className:Qe.noSubjects,children:r.enrollment?"No subjects found for this enrollment":"Student is not currently enrolled"})]})]})})]})}):null},QG=()=>{const[t,e]=ne.useState(!1),[r,n]=ne.useState(!1),[a,o]=ne.useState("college"),[l,u]=ne.useState(""),[d,m]=ne.useState(1),[g,y]=ne.useState(10),[_,T]=ne.useState({key:"createdAt",direction:"desc",firestoreField:"createdAt"}),[E,S]=ne.useState([]),[b,O]=ne.useState(!0),[L,A]=ne.useState(null),[D,V]=ne.useState(null),[H,C]=ne.useState(""),[N,R]=ne.useState(""),[F,P]=ne.useState(""),[M,U]=ne.useState([]),[Me,Ne]=ne.useState([]),[ie,me]=ne.useState([]),[Pe,oe]=ne.useState(!1),[ee,ue]=ne.useState(null),[z,X]=ne.useState(0),[G,K]=ne.useState(""),[Q,ye]=ne.useState(null),[Ee,Ae]=ne.useState(!1),be=Se=>{S(Ke=>Ke.map(Je=>Je.id===Se.id?{...Je,...Se}:Je))},Ze=async()=>{if(ee){K("Reading file..."),X(10);try{const Se=await ee.arrayBuffer(),Ke=Zg(Se),Je=Ke.Sheets[Ke.SheetNames[0]],tt=Bz.sheet_to_json(Je);K("Validating data..."),X(30);const wt={college:[],tvet:[],shs:[],jhs:[]};tt.forEach((qt,ra)=>{var Yn;const jn={studentId:qt["Student ID"]||`TEMP-${Date.now()}-${ra}`,department:((Yn=qt.Department)==null?void 0:Yn.toLowerCase())||a,lrn:qt.LRN||null,firstName:qt["First Name"]||"",middleName:qt["Middle Name"]||null,lastName:qt["Last Name"]||"",email:qt.Email||"",phone:qt.Phone||"",username:qt.Username||"",password:qt.Password||"defaultPassword123",address:{street:qt.Address||"",province:qt.Province||"",city:qt.City||"",zipCode:qt["ZIP Code"]||""},emergencyContact:{name:qt["Emergency Name"]||"",phone:qt["Emergency Contact"]||"",relation:qt["Emergency Relation"]||"guardian"},createdAt:new Date,updatedAt:new Date,status:"active",isVerified:!1,academicStatus:"not enrolled",enrollment:{course:"Not Enrolled",yearLevel:"Not Enrolled",semester:"Not Enrolled",schoolYear:"Not Enrolled"}};if(!["college","tvet","shs","jhs"].includes(jn.department))throw new Error(`Invalid department '${jn.department}' in row ${ra+2}`);wt[jn.department].push(jn)}),K("Uploading students..."),X(60);const St=f9(Ut),gt=mn(Ut,"students");Object.entries(wt).forEach(([qt,ra])=>{ra.forEach(jn=>{const Fa=kn(gt);St.set(Fa,jn)})}),await St.commit(),K("Successfully imported!"),X(100);const or=Ya(gt,Un("department","==",a)),xn=(await Qa(or)).docs.map(qt=>({id:qt.id,...qt.data()}));S(xn),setTimeout(()=>{oe(!1),ue(null),X(0),K("")},2e3)}catch(Se){console.error("Import error:",Se),K(`Error: ${Se.message}`),X(0)}}},re=async Se=>{const Ke=Se.target.files[0];Ke&&(ue(Ke),oe(!0))},Ct={college:{courses:["BSIT","BSHM","BSBA","BSTM"],yearLevels:["1st Year","2nd Year","3rd Year","4th Year"],semesters:["1st Semester","2nd Semester","Summer"]},tvet:{courses:["BTVTeD-AT","BTVTeD-HVACR TECH","BTVTeD-FSM","BTVTeD-ET"],yearLevels:["1st Year","2nd Year","3rd Year","4th Year"],semesters:["1st Semester","2nd Semester","Summer"]},shs:{courses:["SHS"],yearLevels:["Grade 11","Grade 12"],semesters:["1st Semester","2nd Semester"]},jhs:{courses:["JHS"],yearLevels:["Grade 7","Grade 8","Grade 9","Grade 10"],semesters:["1st Semester","2nd Semester"]}},We={studentId:"studentId",lastName:"lastName",phone:"phone",department:"department",status:"status",createdAt:"createdAt","enrollment.course":"enrollment.course","enrollment.yearLevel":"enrollment.yearLevel","enrollment.semester":"enrollment.semester"};ne.useEffect(()=>{const Se=Ct[a]||{};U(Se.courses||[]),Ne(Se.yearLevels||[]),me(Se.semesters||[]),C(""),R(""),P(""),m(1)},[a]),ne.useEffect(()=>{(async()=>{O(!0),A(null);try{const Ke=mn(Ut,"students");let Je=[Un("department","==",a)];H&&Je.push(Un("enrollment.course","==",H)),N&&Je.push(Un("enrollment.yearLevel","==",N)),F&&Je.push(Un("enrollment.semester","==",F)),_.key&&We[_.key]&&Je.push(Ug(We[_.key],_.direction));const tt=Ya(Ke,...Je),St=(await Qa(tt)).docs.map(gt=>({id:gt.id,...gt.data()}));_.key&&!We[_.key]&&St.sort((gt,or)=>{const cr=gt[_.key]||"",xn=or[_.key]||"";return _.direction==="asc"?cr.localeCompare(xn):xn.localeCompare(cr)}),S(St)}catch(Ke){console.error("Error fetching students:",Ke),A(`Failed to load students. ${Ke.message}`)}finally{O(!1)}})()},[a,_,H,N,F]),ne.useEffect(()=>{(async()=>{O(!0),A(null);try{const Ke=mn(Ut,"students");let Je=Ya(Ke,Un("department","==",a));_.key&&We[_.key]&&(Je=Ya(Je,Ug(We[_.key],_.direction)));const wt=(await Qa(Je)).docs.map(St=>({id:St.id,...St.data()}));_.key&&!We[_.key]&&wt.sort((St,gt)=>{const or=St[_.key]||"",cr=gt[_.key]||"";return _.direction==="asc"?or.localeCompare(cr):cr.localeCompare(or)}),S(wt)}catch(Ke){console.error("Error fetching students:",Ke),A(`Failed to load students. ${Ke.message}`)}finally{O(!1)}})()},[a,_]);const lt=Se=>{let Ke="asc";if(_.key===Se&&_.direction==="asc"&&(Ke="desc"),!We[Se]){const Je=[...E];Je.sort((tt,wt)=>{const St=tt[Se]||"",gt=wt[Se]||"";return Ke==="asc"?St.localeCompare(gt):gt.localeCompare(St)}),S(Je)}T({key:Se,direction:Ke,firestoreField:We[Se]||null})},Fe=E.filter(Se=>{var wt,St,gt,or,cr,xn;const Ke=l.toLowerCase(),Je=Se.studentId.toLowerCase().includes(Ke)||`${Se.firstName} ${Se.lastName}`.toLowerCase().includes(Ke)||Se.email.toLowerCase().includes(Ke)||((gt=(St=(wt=Se.address)==null?void 0:wt.street)==null?void 0:St.toLowerCase())==null?void 0:gt.includes(Ke))||!1||Se.phone.toLowerCase().includes(Ke);if(!H&&!N&&!F)return Je;const tt=(!H||((or=Se.enrollment)==null?void 0:or.course)===H)&&(!N||((cr=Se.enrollment)==null?void 0:cr.yearLevel)===N)&&(!F||((xn=Se.enrollment)==null?void 0:xn.semester)===F);return Je&&tt}),je=()=>{C(""),R(""),P(""),u(""),m(1)},Wt=d*g,Tr=Wt-g,Rr=Fe.slice(Tr,Wt),tr=Math.ceil(Fe.length/g),On=Se=>m(Se),lr=Se=>_.key!==Se?h.jsx(nA,{}):_.direction==="asc"?h.jsx(rA,{}):h.jsx(tA,{}),wr=Se=>`${Se.lastName}, ${Se.firstName}${Se.middleName?` ${Se.middleName.charAt(0)}.`:""}`,Wr=Se=>Se.address?`${Se.address.street||""}, ${Se.address.city||""}, ${Se.address.province||""} ${Se.address.zipCode||""}`:"",It=Se=>({college:"College",tvet:"TVET",shs:"Senior High",jhs:"Junior High"})[Se]||Se;return h.jsx("div",{className:"student-management-container",children:h.jsxs("div",{className:"student-management",children:[h.jsxs("h2",{className:"management-header",children:[h.jsx(qc,{})," Student Management"]}),L&&h.jsxs("div",{className:"error-message",children:[h.jsx("p",{children:L}),L.includes("index")&&h.jsxs(h.Fragment,{children:[h.jsx("p",{children:"This query requires a Firestore index."}),h.jsx("a",{href:`https://console.firebase.google.com/v1/r/project/${YOUR_PROJECT_ID}/firestore/indexes`,target:"_blank",rel:"noopener noreferrer",className:"index-link",children:"Click here to create the required index"})]})]}),h.jsx("div",{className:"department-tabs",children:["college","tvet","shs","jhs"].map(Se=>h.jsx("button",{className:`dept-tab ${a===Se?"active":""}`,onClick:()=>{o(Se),m(1)},children:It(Se)},Se))}),h.jsxs("div",{className:"table-controls",children:[h.jsxs("div",{className:"left-controls",children:[h.jsxs("div",{className:"search-bar",children:[h.jsx(Im,{className:"search-icon"}),h.jsx("input",{type:"text",placeholder:"Search students...",value:l,onChange:Se=>{u(Se.target.value),m(1)}})]}),h.jsxs("div",{className:"filter-controls",children:[h.jsxs("div",{className:"filter-dropdown",children:[h.jsx("label",{children:"Course:"}),h.jsxs("select",{value:H,onChange:Se=>{C(Se.target.value),m(1)},children:[h.jsx("option",{value:"",children:"All Courses"}),M.map(Se=>h.jsx("option",{value:Se,children:Se},Se))]})]}),h.jsxs("div",{className:"filter-dropdown",children:[h.jsx("label",{children:"Year Level:"}),h.jsxs("select",{value:N,onChange:Se=>{R(Se.target.value),m(1)},children:[h.jsx("option",{value:"",children:"All Year Levels"}),Me.map(Se=>h.jsx("option",{value:Se,children:Se},Se))]})]}),h.jsxs("div",{className:"filter-dropdown",children:[h.jsx("label",{children:"Semester:"}),h.jsxs("select",{value:F,onChange:Se=>{P(Se.target.value),m(1)},children:[h.jsx("option",{value:"",children:"All Semesters"}),ie.map(Se=>h.jsx("option",{value:Se,children:Se},Se))]})]}),h.jsxs("button",{className:"reset-filters-btn",onClick:je,disabled:!H&&!N&&!F&&!l,children:[h.jsx(tj,{})," Reset Filters"]})]}),h.jsxs("div",{className:"enroll-buttons",children:[h.jsxs("button",{className:"enroll-btn primary",onClick:()=>e(!0),children:[h.jsx(zg,{})," Enroll New Student"]}),h.jsxs("button",{className:"enroll-btn secondary",onClick:()=>n(!0),children:[h.jsx(zg,{})," Enroll Existing Student"]})]})]}),h.jsxs("div",{className:"right-controls",children:[h.jsxs("div",{className:"items-per-page",children:[h.jsx("span",{children:"Show:"}),h.jsx("select",{value:g,onChange:Se=>{y(Number(Se.target.value)),m(1)},children:[5,10,20,50].map(Se=>h.jsx("option",{value:Se,children:Se},Se))}),h.jsx("span",{children:"entries"})]}),h.jsxs("div",{className:"export-buttons",children:[h.jsxs(Om,{data:Fe,filename:`students-${a}.csv`,className:"export-btn",children:[h.jsx(H0,{})," Excel"]}),h.jsxs("button",{className:"export-btn",children:[h.jsx(hx,{})," PDF"]}),h.jsxs("button",{className:"export-btn",children:[h.jsx(km,{})," Print"]}),h.jsxs("button",{className:"export-btn",onClick:()=>document.getElementById("import-file").click(),children:[h.jsx(H0,{})," Import"]}),h.jsx("input",{type:"file",id:"import-file",accept:".xlsx,.xls,.csv",style:{display:"none"},onChange:re})]})]})]}),h.jsx("div",{className:"students-table",children:b?h.jsx("div",{className:"loading-indicator",children:"Loading students..."}):h.jsxs("table",{children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsxs("th",{onClick:()=>lt("studentId"),children:["Student ID ",lr("studentId")]}),h.jsx("th",{children:"Profile"}),h.jsxs("th",{onClick:()=>lt("lastName"),children:["Full Name ",lr("lastName")]}),h.jsx("th",{children:"Address"}),h.jsxs("th",{onClick:()=>lt("phone"),children:["Phone ",lr("phone")]}),h.jsxs("th",{onClick:()=>lt("enrollment.course"),children:["Course ",lr("enrollment.course")]}),h.jsxs("th",{onClick:()=>lt("enrollment.yearLevel"),children:["Year ",lr("enrollment.yearLevel")]}),h.jsxs("th",{onClick:()=>lt("enrollment.semester"),children:["Semester ",lr("enrollment.semester")]}),h.jsxs("th",{onClick:()=>lt("department"),children:["Department ",lr("department")]}),h.jsxs("th",{onClick:()=>lt("status"),children:["Status ",lr("status")]}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:Rr.length>0?Rr.map(Se=>{var Ke,Je,tt;return h.jsxs("tr",{children:[h.jsx("td",{children:Se.studentId}),h.jsx("td",{children:Se.profilePhoto?h.jsx("img",{src:Se.profilePhoto,alt:"Profile",style:{width:"40px",height:"40px",borderRadius:"50%",objectFit:"cover"}}):h.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#ccc",display:"flex",alignItems:"center",justifyContent:"center"},children:h.jsx("i",{className:"fas fa-user"})})}),h.jsx("td",{children:wr(Se)}),h.jsx("td",{children:Wr(Se).length>12?`${Wr(Se).slice(0,12)}...`:Wr(Se)}),h.jsx("td",{children:Se.phone}),h.jsx("td",{children:((Ke=Se.enrollment)==null?void 0:Ke.course)||"Not enrolled"}),h.jsx("td",{children:((Je=Se.enrollment)==null?void 0:Je.yearLevel)||"Not enrolled"}),h.jsx("td",{children:((tt=Se.enrollment)==null?void 0:tt.semester)||"Not enrolled"}),h.jsx("td",{children:It(Se.department)}),h.jsx("td",{children:h.jsx("span",{className:`status-badge ${Se.status.toLowerCase()}`,children:Se.status})}),h.jsx("td",{children:h.jsxs("div",{className:"action-buttons",children:[h.jsx("button",{className:"view-btn",title:"View",onClick:()=>V(Se.id),children:h.jsx(fx,{})}),h.jsx("button",{className:"edit-btn",title:"Edit",onClick:()=>{ye(Se),Ae(!0)},children:h.jsx(Rm,{})}),h.jsx("button",{className:"delete-btn",title:"Delete",children:h.jsx(Dm,{})})]})})]},Se.id)}):h.jsx("tr",{children:h.jsx("td",{colSpan:"11",className:"no-data",children:E.length===0?"No students found in this department":"No matching students found"})})})]})}),tr>1&&h.jsxs("div",{className:"pagination-controls",children:[h.jsxs("div",{className:"pagination-info",children:["Showing ",Tr+1," to ",Math.min(Wt,Fe.length)," of ",Fe.length," entries"]}),h.jsxs("div",{className:"pagination-buttons",children:[h.jsx("button",{onClick:()=>On(1),disabled:d===1,className:"pagination-btn",children:"First"}),h.jsx("button",{onClick:()=>On(Math.max(1,d-1)),disabled:d===1,className:"pagination-btn",children:"Previous"}),Array.from({length:Math.min(5,tr)}).map((Se,Ke)=>{let Je;return tr<=5||d<=3?Je=Ke+1:d>=tr-2?Je=tr-4+Ke:Je=d-2+Ke,h.jsx("button",{onClick:()=>On(Je),className:`pagination-btn ${d===Je?"active":""}`,children:Je},Je)}),h.jsx("button",{onClick:()=>On(Math.min(tr,d+1)),disabled:d===tr,className:"pagination-btn",children:"Next"}),h.jsx("button",{onClick:()=>On(tr),disabled:d===tr,className:"pagination-btn",children:"Last"})]})]}),h.jsx(fH,{show:t,onClose:()=>e(!1)}),h.jsx(EG,{show:r,onClose:()=>n(!1)}),h.jsx(LH,{show:Ee,onClose:()=>Ae(!1),student:Q,onUpdate:be}),D&&h.jsx(XG,{studentId:D,onClose:()=>V(null)}),Pe&&h.jsx("div",{className:"import-modal-overlay",children:h.jsxs("div",{className:"import-modal",children:[h.jsx("h3",{children:"Import Students"}),h.jsxs("p",{children:["File: ",ee==null?void 0:ee.name]}),h.jsxs("div",{className:"import-info",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Note:"})," Students will be imported to their specified departments."]}),h.jsx("p",{children:"Valid department values: College, TVET, SHS, JHS"})]}),h.jsx("div",{className:"progress-container",children:h.jsx("div",{className:"progress-bar",style:{width:`${z}%`}})}),h.jsx("p",{className:"import-status",children:G}),h.jsxs("div",{className:"import-actions",children:[h.jsx("button",{onClick:()=>{oe(!1),ue(null),X(0),K("")},disabled:z>0&&z<100,children:"Cancel"}),h.jsx("button",{onClick:Ze,disabled:!ee||z>0&&z<100,children:z===0?"Start Import":"Importing..."})]})]})})]})})},JG=()=>{const[t,e]=ne.useState([]),[r,n]=ne.useState(!0),[a,o]=ne.useState(!1),[l,u]=ne.useState(null),[d,m]=ne.useState({name:"",code:"",description:"",head:"",status:"active"});ne.useEffect(()=>{g()},[]);const g=async()=>{try{const S=(await Qa(mn(Ut,"departments"))).docs.map(b=>({id:b.id,...b.data()}));e(S),n(!1)}catch(E){console.error("Error fetching departments:",E),n(!1)}},y=async E=>{E.preventDefault();try{l?await ul(kn(Ut,"departments",l.id),d):await Nm(mn(Ut,"departments"),d),o(!1),u(null),m({name:"",code:"",description:"",head:"",status:"active"}),g()}catch(S){console.error("Error saving department:",S)}},_=E=>{u(E),m(E),o(!0)},T=async E=>{if(window.confirm("Are you sure you want to delete this department?"))try{await $b(kn(Ut,"departments",E)),g()}catch(S){console.error("Error deleting department:",S)}};return r?h.jsx("div",{className:"loading",children:"Loading..."}):h.jsxs("div",{className:"department-container",children:[h.jsxs("div",{className:"department-header",children:[h.jsx("h2",{children:"Department Management"}),h.jsxs("button",{className:"add-button",onClick:()=>o(!0),children:[h.jsx(dx,{})," Add Department"]})]}),h.jsx("div",{className:"departments-grid",children:t.map(E=>h.jsxs("div",{className:"department-card",children:[h.jsxs("div",{className:"department-info",children:[h.jsx("h3",{children:E.name}),h.jsxs("p",{className:"department-code",children:["Code: ",E.code]}),h.jsxs("p",{className:"department-head",children:["Head: ",E.head]}),h.jsx("p",{className:"department-description",children:E.description}),h.jsx("span",{className:`status-badge ${E.status}`,children:E.status})]}),h.jsxs("div",{className:"department-actions",children:[h.jsx("button",{onClick:()=>_(E),className:"edit-button",children:h.jsx(Rm,{})}),h.jsx("button",{onClick:()=>T(E.id),className:"delete-button",children:h.jsx(Dm,{})})]})]},E.id))}),a&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:l?"Edit Department":"Add New Department"}),h.jsxs("form",{onSubmit:y,children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Department Name"}),h.jsx("input",{type:"text",value:d.name,onChange:E=>m({...d,name:E.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Department Code"}),h.jsx("input",{type:"text",value:d.code,onChange:E=>m({...d,code:E.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Department Head"}),h.jsx("input",{type:"text",value:d.head,onChange:E=>m({...d,head:E.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Description"}),h.jsx("textarea",{value:d.description,onChange:E=>m({...d,description:E.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Status"}),h.jsxs("select",{value:d.status,onChange:E=>m({...d,status:E.target.value}),children:[h.jsx("option",{value:"active",children:"Active"}),h.jsx("option",{value:"inactive",children:"Inactive"})]})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"submit",className:"save-button",children:l?"Update":"Save"}),h.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{o(!1),u(null),m({name:"",code:"",description:"",head:"",status:"active"})},children:"Cancel"})]})]})]})})]})},ZG=()=>h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:"Course"}),eq="_modalOverlay_1md7c_1",tq="_modalContent_1md7c_27",rq="_modalHeader_1md7c_49",nq="_closeBtn_1md7c_79",aq="_subjectForm_1md7c_107",sq="_formGroup_1md7c_119",iq="_formInput_1md7c_143",oq="_formSelect_1md7c_143",lq="_formRow_1md7c_167",cq="_termSection_1md7c_185",uq="_termTable_1md7c_211",fq="_tableInput_1md7c_353",hq="_addRowBtn_1md7c_369",dq="_removeBtn_1md7c_397",mq="_formActions_1md7c_425",pq="_cancelBtn_1md7c_443",gq="_submitBtn_1md7c_443",vq="_checkboxLabel_1md7c_517",xq="_inputWithCheckbox_1md7c_529",ht={modalOverlay:eq,modalContent:tq,modalHeader:rq,closeBtn:nq,subjectForm:aq,formGroup:sq,formInput:iq,formSelect:oq,formRow:lq,termSection:cq,termTable:uq,tableInput:fq,addRowBtn:hq,removeBtn:dq,formActions:mq,cancelBtn:pq,submitBtn:gq,checkboxLabel:vq,inputWithCheckbox:xq},_q=({show:t,onClose:e,onAddSubject:r})=>{const[n,a]=ne.useState({subjectId:"",subjectName:"",course:"BSIT",yearLevel:"1st Year",semester:"1st Semester",status:"Active",terms:{firstTerm:[],secondTerm:[]}}),[o,l]=ne.useState(!1),[u,d]=ne.useState(null),[m,g]=ne.useState(!0),y=["BSIT","BSHM","BSBA","BSTM","BTVTeD-AT","BTVTeD-HVACR TECH","BTVTeD-FSM","BTVTeD-ET","SHS","JHS"],_=["1st Year","2nd Year","3rd Year","4th Year","Grade 11","Grade 12"],T=[{value:"1st Semester",label:"1st Semester"},{value:"2nd Semester",label:"2nd Semester"},{value:"Summer",label:"Summer"}],E=["Active","Inactive"],S=(H,C,N)=>{const R=C.includes("Year")?C.replace(" Year",""):C.replace("Grade ",""),F=N.includes("Semester")?N.replace(" Semester","Sem"):N,P=`${H}-${R}-${F}`,M=`${H} ${C} ${N}`;return{subjectId:P,subjectName:M}};ne.useEffect(()=>{if(m){const{subjectId:H,subjectName:C}=S(n.course,n.yearLevel,n.semester);a(N=>({...N,subjectId:H,subjectName:C}))}},[n.course,n.yearLevel,n.semester,m]);const b=H=>{const{name:C,value:N}=H.target;a(R=>({...R,[C]:N}))},O=(H,C,N,R)=>{a(F=>{const P={...F.terms};return P[H][C]={...P[H][C],[N]:R},{...F,terms:P}})},L=H=>{a(C=>{const N={...C.terms};return N[H]=[...N[H],{subjectCode:"",description:"",lec:0,lab:0,units:0,preReq:""}],{...C,terms:N}})},A=(H,C)=>{a(N=>{const R={...N.terms};return R[H]=R[H].filter((F,P)=>P!==C),{...N,terms:R}})},D=()=>{g(!m)},V=async H=>{H.preventDefault(),l(!0),d(null);try{const C=await Nm(mn(Ut,"subjects"),{...n,createdAt:M0(),updatedAt:M0()});r({id:C.id,...n}),e(),a({subjectId:"",subjectName:"",course:"BSIT",yearLevel:"1st Year",semester:"1st Semester",status:"Active",terms:{firstTerm:[],secondTerm:[]}})}catch(C){console.error("Error adding subject:",C),d("Failed to add subject. Please try again.")}finally{l(!1)}};return t?h.jsx("div",{className:ht.modalOverlay,children:h.jsxs("div",{className:ht.modalContent,children:[h.jsxs("div",{className:ht.modalHeader,children:[h.jsx("h3",{children:"Add New Subject"}),h.jsx("button",{className:ht.closeBtn,onClick:e,children:"×"})]}),h.jsxs("form",{onSubmit:V,className:ht.subjectForm,children:[h.jsxs("div",{className:ht.formRow,children:[h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"course",children:"Course"}),h.jsx("select",{id:"course",name:"course",value:n.course,onChange:b,className:ht.formSelect,children:y.map(H=>h.jsx("option",{value:H,children:H},H))})]}),h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"yearLevel",children:"Year Level"}),h.jsx("select",{id:"yearLevel",name:"yearLevel",value:n.yearLevel,onChange:b,className:ht.formSelect,children:_.map(H=>h.jsx("option",{value:H,children:H},H))})]}),h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"semester",children:"Semester"}),h.jsx("select",{id:"semester",name:"semester",value:n.semester,onChange:b,className:ht.formSelect,children:T.map(H=>h.jsx("option",{value:H.value,children:H.label},H.value))})]})]}),h.jsxs("div",{className:ht.formRow,children:[h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"subjectId",children:"Subject ID"}),h.jsxs("div",{className:ht.inputWithCheckbox,children:[h.jsx("input",{type:"text",id:"subjectId",name:"subjectId",value:n.subjectId,onChange:b,required:!0,className:ht.formInput,disabled:m}),h.jsxs("label",{className:ht.checkboxLabel,children:[h.jsx("input",{type:"checkbox",checked:m,onChange:D,className:ht.checkboxInput}),"Auto-generate"]})]})]}),h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"subjectName",children:"Subject Name"}),h.jsx("input",{type:"text",id:"subjectName",name:"subjectName",value:n.subjectName,onChange:b,required:!0,className:ht.formInput,disabled:m})]}),h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{htmlFor:"status",children:"Status"}),h.jsx("select",{id:"status",name:"status",value:n.status,onChange:b,className:ht.formSelect,children:E.map(H=>h.jsx("option",{value:H,children:H},H))})]})]}),h.jsxs("div",{className:ht.formGroup,children:[h.jsx("label",{children:"Subject Loading Details"}),h.jsxs("div",{className:ht.termSection,children:[h.jsx("h4",{children:"1st Term:"}),h.jsxs("table",{className:ht.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:n.terms.firstTerm.map((H,C)=>h.jsxs("tr",{children:[h.jsx("td",{children:h.jsx("input",{type:"text",value:H.subjectCode,onChange:N=>O("firstTerm",C,"subjectCode",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:H.description,onChange:N=>O("firstTerm",C,"description",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.lec,onChange:N=>O("firstTerm",C,"lec",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.lab,onChange:N=>O("firstTerm",C,"lab",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.units,onChange:N=>O("firstTerm",C,"units",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:H.preReq,onChange:N=>O("firstTerm",C,"preReq",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("button",{type:"button",onClick:()=>A("firstTerm",C),className:ht.removeBtn,children:"Remove"})})]},`firstTerm-${C}`))})]}),h.jsx("button",{type:"button",onClick:()=>L("firstTerm"),className:ht.addRowBtn,children:"Add Row"})]}),n.semester!=="Summer"&&h.jsxs("div",{className:ht.termSection,children:[h.jsx("h4",{children:"2nd Term:"}),h.jsxs("table",{className:ht.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:n.terms.secondTerm.map((H,C)=>h.jsxs("tr",{children:[h.jsx("td",{children:h.jsx("input",{type:"text",value:H.subjectCode,onChange:N=>O("secondTerm",C,"subjectCode",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:H.description,onChange:N=>O("secondTerm",C,"description",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.lec,onChange:N=>O("secondTerm",C,"lec",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.lab,onChange:N=>O("secondTerm",C,"lab",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:H.units,onChange:N=>O("secondTerm",C,"units",parseInt(N.target.value)||0),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:H.preReq,onChange:N=>O("secondTerm",C,"preReq",N.target.value),className:ht.tableInput})}),h.jsx("td",{children:h.jsx("button",{type:"button",onClick:()=>A("secondTerm",C),className:ht.removeBtn,children:"Remove"})})]},`secondTerm-${C}`))})]}),h.jsx("button",{type:"button",onClick:()=>L("secondTerm"),className:ht.addRowBtn,children:"Add Row"})]})]}),h.jsxs("div",{className:ht.formActions,children:[h.jsx("button",{type:"button",className:ht.cancelBtn,onClick:e,children:"Cancel"}),h.jsx("button",{type:"submit",className:ht.submitBtn,disabled:o,children:o?"Adding...":"Add Subject"})]})]})]})}):null},yq="_modalOverlay_mvizi_1",Eq="_modalContent_mvizi_27",Tq="_modalHeader_mvizi_47",wq="_closeBtn_mvizi_75",Sq="_subjectDetails_mvizi_103",bq="_detailRow_mvizi_111",Aq="_detailGroup_mvizi_125",Cq="_statusBadge_mvizi_165",Nq="_termDetails_mvizi_201",Rq="_termSection_mvizi_221",kq="_termTable_mvizi_241",Iq="_noData_mvizi_287",Dq="_modalFooter_mvizi_305",Oq="_closeButton_mvizi_319",pr={modalOverlay:yq,modalContent:Eq,modalHeader:Tq,closeBtn:wq,subjectDetails:Sq,detailRow:bq,detailGroup:Aq,statusBadge:Cq,termDetails:Nq,termSection:Rq,termTable:kq,noData:Iq,modalFooter:Dq,closeButton:Oq},jq=({show:t,onClose:e,subject:r})=>{var n,a,o,l;return!t||!r?null:h.jsx("div",{className:pr.modalOverlay,children:h.jsxs("div",{className:pr.modalContent,children:[h.jsxs("div",{className:pr.modalHeader,children:[h.jsx("h3",{children:"Subject Details"}),h.jsx("button",{className:pr.closeBtn,onClick:e,children:"×"})]}),h.jsxs("div",{className:pr.subjectDetails,children:[h.jsxs("div",{className:pr.detailRow,children:[h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Subject ID:"}),h.jsx("p",{children:r.subjectId})]}),h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Subject Name:"}),h.jsx("p",{children:r.subjectName})]})]}),h.jsxs("div",{className:pr.detailRow,children:[h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Course:"}),h.jsx("p",{children:r.course})]}),h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Year Level:"}),h.jsx("p",{children:r.yearLevel})]}),h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Semester:"}),h.jsx("p",{children:r.semester})]})]}),h.jsxs("div",{className:pr.detailGroup,children:[h.jsx("label",{children:"Status:"}),h.jsx("p",{className:`${pr.statusBadge} ${r.status.toLowerCase()}`,children:r.status})]}),h.jsxs("div",{className:pr.termDetails,children:[h.jsx("h4",{children:"Subject Loading Details"}),h.jsxs("div",{className:pr.termSection,children:[h.jsx("h5",{children:"1st Term:"}),((a=(n=r.terms)==null?void 0:n.firstTerm)==null?void 0:a.length)>0?h.jsxs("table",{className:pr.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:r.terms.firstTerm.map((u,d)=>h.jsxs("tr",{children:[h.jsx("td",{children:u.subjectCode}),h.jsx("td",{children:u.description}),h.jsx("td",{children:u.lec}),h.jsx("td",{children:u.lab}),h.jsx("td",{children:u.units}),h.jsx("td",{children:u.preReq})]},`firstTerm-${d}`))})]}):h.jsx("p",{className:pr.noData,children:"No first term subjects"})]}),r.semester!=="Summer"&&h.jsxs("div",{className:pr.termSection,children:[h.jsx("h5",{children:"2nd Term:"}),((l=(o=r.terms)==null?void 0:o.secondTerm)==null?void 0:l.length)>0?h.jsxs("table",{className:pr.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"})]})}),h.jsx("tbody",{children:r.terms.secondTerm.map((u,d)=>h.jsxs("tr",{children:[h.jsx("td",{children:u.subjectCode}),h.jsx("td",{children:u.description}),h.jsx("td",{children:u.lec}),h.jsx("td",{children:u.lab}),h.jsx("td",{children:u.units}),h.jsx("td",{children:u.preReq})]},`secondTerm-${d}`))})]}):h.jsx("p",{className:pr.noData,children:"No second term subjects"})]})]})]}),h.jsx("div",{className:pr.modalFooter,children:h.jsx("button",{type:"button",className:pr.closeButton,onClick:e,children:"Close"})})]})})},Pq="_modalOverlay_11uuf_1",Fq="_modalContent_11uuf_27",Lq="_modalHeader_11uuf_49",Mq="_closeBtn_11uuf_79",Bq="_subjectForm_11uuf_107",Vq="_formGroup_11uuf_119",Uq="_formInput_11uuf_143",zq="_formSelect_11uuf_143",Hq="_formRow_11uuf_167",Gq="_termSection_11uuf_185",qq="_termTable_11uuf_211",$q="_tableInput_11uuf_309",Yq="_addRowBtn_11uuf_325",Wq="_removeBtn_11uuf_353",Kq="_formActions_11uuf_381",Xq="_cancelBtn_11uuf_399",Qq="_submitBtn_11uuf_399",Jq="_errorMessage_11uuf_453",mt={modalOverlay:Pq,modalContent:Fq,modalHeader:Lq,closeBtn:Mq,subjectForm:Bq,formGroup:Vq,formInput:Uq,formSelect:zq,formRow:Hq,termSection:Gq,termTable:qq,tableInput:$q,addRowBtn:Yq,removeBtn:Wq,formActions:Kq,cancelBtn:Xq,submitBtn:Qq,errorMessage:Jq},Zq=({show:t,onClose:e,subject:r,onUpdateSubject:n})=>{const[a,o]=ne.useState({subjectId:"",subjectName:"",course:"BSIT",yearLevel:"1st Year",semester:"1st Semester",status:"Active",terms:{firstTerm:[],secondTerm:[]}}),[l,u]=ne.useState(!1),[d,m]=ne.useState(null),g=["BSIT","BSHM","BSBA","BSTM","BTVTeD-AT","BTVTeD-HVACR TECH","BTVTeD-FSM","BTVTeD-ET","SHS","JHS"],y=["1st Year","2nd Year","3rd Year","4th Year","Grade 11","Grade 12"],_=[{value:"1st Semester",label:"1st Semester"},{value:"2nd Semester",label:"2nd Semester"},{value:"Summer",label:"Summer"}],T=["Active","Inactive"];ne.useEffect(()=>{r&&o({subjectId:r.subjectId||"",subjectName:r.subjectName||"",course:r.course||"BSIT",yearLevel:r.yearLevel||"1st Year",semester:r.semester||"1st Semester",status:r.status||"Active",terms:r.terms||{firstTerm:[],secondTerm:[]}})},[r]);const E=A=>{const{name:D,value:V}=A.target;o(H=>({...H,[D]:V}))},S=(A,D,V,H)=>{o(C=>{const N={...C.terms};return N[A][D]={...N[A][D],[V]:H},{...C,terms:N}})},b=A=>{o(D=>{const V={...D.terms};return V[A]=[...V[A],{subjectCode:"",description:"",lec:0,lab:0,units:0,preReq:""}],{...D,terms:V}})},O=(A,D)=>{o(V=>{const H={...V.terms};return H[A]=H[A].filter((C,N)=>N!==D),{...V,terms:H}})},L=async A=>{A.preventDefault(),u(!0),m(null);try{const D=kn(Ut,"subjects",r.id);await ul(D,{...a,updatedAt:M0()}),n({id:r.id,...a}),e()}catch(D){console.error("Error updating subject:",D),m("Failed to update subject. Please try again.")}finally{u(!1)}};return!t||!r?null:h.jsx("div",{className:mt.modalOverlay,children:h.jsxs("div",{className:mt.modalContent,children:[h.jsxs("div",{className:mt.modalHeader,children:[h.jsx("h3",{children:"Edit Subject"}),h.jsx("button",{className:mt.closeBtn,onClick:e,children:"×"})]}),h.jsxs("form",{onSubmit:L,className:mt.subjectForm,children:[h.jsxs("div",{className:mt.formRow,children:[h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"course",children:"Course"}),h.jsx("select",{id:"course",name:"course",value:a.course,onChange:E,className:mt.formSelect,children:g.map(A=>h.jsx("option",{value:A,children:A},A))})]}),h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"yearLevel",children:"Year Level"}),h.jsx("select",{id:"yearLevel",name:"yearLevel",value:a.yearLevel,onChange:E,className:mt.formSelect,children:y.map(A=>h.jsx("option",{value:A,children:A},A))})]}),h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"semester",children:"Semester"}),h.jsx("select",{id:"semester",name:"semester",value:a.semester,onChange:E,className:mt.formSelect,children:_.map(A=>h.jsx("option",{value:A.value,children:A.label},A.value))})]})]}),h.jsxs("div",{className:mt.formRow,children:[h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"subjectId",children:"Subject ID"}),h.jsx("input",{type:"text",id:"subjectId",name:"subjectId",value:a.subjectId,onChange:E,required:!0,className:mt.formInput})]}),h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"subjectName",children:"Subject Name"}),h.jsx("input",{type:"text",id:"subjectName",name:"subjectName",value:a.subjectName,onChange:E,required:!0,className:mt.formInput})]}),h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{htmlFor:"status",children:"Status"}),h.jsx("select",{id:"status",name:"status",value:a.status,onChange:E,className:mt.formSelect,children:T.map(A=>h.jsx("option",{value:A,children:A},A))})]})]}),h.jsxs("div",{className:mt.formGroup,children:[h.jsx("label",{children:"Subject Loading Details"}),h.jsxs("div",{className:mt.termSection,children:[h.jsx("h4",{children:"1st Term:"}),h.jsxs("table",{className:mt.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:a.terms.firstTerm.map((A,D)=>h.jsxs("tr",{children:[h.jsx("td",{children:h.jsx("input",{type:"text",value:A.subjectCode,onChange:V=>S("firstTerm",D,"subjectCode",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:A.description,onChange:V=>S("firstTerm",D,"description",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.lec,onChange:V=>S("firstTerm",D,"lec",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.lab,onChange:V=>S("firstTerm",D,"lab",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.units,onChange:V=>S("firstTerm",D,"units",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:A.preReq,onChange:V=>S("firstTerm",D,"preReq",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("button",{type:"button",onClick:()=>O("firstTerm",D),className:mt.removeBtn,children:"Remove"})})]},`firstTerm-${D}`))})]}),h.jsx("button",{type:"button",onClick:()=>b("firstTerm"),className:mt.addRowBtn,children:"Add Row"})]}),a.semester!=="Summer"&&h.jsxs("div",{className:mt.termSection,children:[h.jsx("h4",{children:"2nd Term:"}),h.jsxs("table",{className:mt.termTable,children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Subject Code"}),h.jsx("th",{children:"Description"}),h.jsx("th",{children:"Lec"}),h.jsx("th",{children:"Lab"}),h.jsx("th",{children:"Units"}),h.jsx("th",{children:"Pre Req"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:a.terms.secondTerm.map((A,D)=>h.jsxs("tr",{children:[h.jsx("td",{children:h.jsx("input",{type:"text",value:A.subjectCode,onChange:V=>S("secondTerm",D,"subjectCode",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:A.description,onChange:V=>S("secondTerm",D,"description",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.lec,onChange:V=>S("secondTerm",D,"lec",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.lab,onChange:V=>S("secondTerm",D,"lab",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"number",value:A.units,onChange:V=>S("secondTerm",D,"units",parseInt(V.target.value)||0),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("input",{type:"text",value:A.preReq,onChange:V=>S("secondTerm",D,"preReq",V.target.value),className:mt.tableInput})}),h.jsx("td",{children:h.jsx("button",{type:"button",onClick:()=>O("secondTerm",D),className:mt.removeBtn,children:"Remove"})})]},`secondTerm-${D}`))})]}),h.jsx("button",{type:"button",onClick:()=>b("secondTerm"),className:mt.addRowBtn,children:"Add Row"})]})]}),d&&h.jsx("div",{className:mt.errorMessage,children:d}),h.jsxs("div",{className:mt.formActions,children:[h.jsx("button",{type:"button",className:mt.cancelBtn,onClick:e,disabled:l,children:"Cancel"}),h.jsx("button",{type:"submit",className:mt.submitBtn,disabled:l,children:l?"Updating...":"Update Subject"})]})]})]})})},e$=()=>{const[t,e]=ne.useState([]),[r,n]=ne.useState(!0),[a,o]=ne.useState(null),[l,u]=ne.useState(""),[d,m]=ne.useState(1),[g,y]=ne.useState(10),[_,T]=ne.useState({key:"subjectId",direction:"asc"}),[E,S]=ne.useState(!1),[b,O]=ne.useState(null),[L,A]=ne.useState(!1),[D,V]=ne.useState(null),[H,C]=ne.useState(!1),N=Q=>{e(ye=>ye.map(Ee=>Ee.id===Q.id?Q:Ee))},R=["All","BSIT","BSHM","BSBA","BSTM","BTVTeD-AT","BTVTeD-HVACR TECH","BTVTeD-FSM","BTVTeD-ET","SHS","JHS"],F=["All","1st Year","2nd Year","3rd Year","4th Year","Grade 11","Grade 12"],P=["All","1st Semester","2nd Semester","Summer"],M=["All","Active","Inactive"],[U,Me]=ne.useState({course:"All",yearLevel:"All",semester:"All",status:"All"});ne.useEffect(()=>{(async()=>{try{n(!0);const ye=mn(Ut,"subjects"),Ae=(await Qa(ye)).docs.map(be=>({id:be.id,...be.data()}));e(Ae)}catch(ye){console.error("Error fetching subjects:",ye),o("Failed to load subjects. Please try again.")}finally{n(!1)}})()},[]);const Ne=Q=>{let ye="asc";_.key===Q&&_.direction==="asc"&&(ye="desc"),T({key:Q,direction:ye})},me=(()=>{const Q=[...t];return _.key&&Q.sort((ye,Ee)=>{const Ae=ye[_.key]||"",be=Ee[_.key]||"";return Ae<be?_.direction==="asc"?-1:1:Ae>be?_.direction==="asc"?1:-1:0}),Q})().filter(Q=>{const ye=Q.subjectId&&Q.subjectId.toLowerCase().includes(l.toLowerCase())||Q.subjectName&&Q.subjectName.toLowerCase().includes(l.toLowerCase())||Q.course&&Q.course.toLowerCase().includes(l.toLowerCase()),Ee=(U.course==="All"||Q.course===U.course)&&(U.yearLevel==="All"||Q.yearLevel===U.yearLevel)&&(U.semester==="All"||Q.semester===U.semester)&&(U.status==="All"||Q.status===U.status);return ye&&Ee}),Pe=d*g,oe=Pe-g,ee=me.slice(oe,Pe),ue=Math.ceil(me.length/g),z=Q=>m(Q),X=Q=>_.key!==Q?h.jsx(nA,{}):_.direction==="asc"?h.jsx(rA,{}):h.jsx(tA,{}),G=(Q,ye)=>{Me({...U,[Q]:ye}),m(1)},K=Q=>{e(ye=>[...ye,Q])};return r?h.jsx("div",{className:"loading",children:"Loading subjects..."}):a?h.jsx("div",{className:"error",children:a}):h.jsxs("div",{className:"subjects-container",children:[h.jsxs("div",{className:"subjects-management",children:[h.jsx("h2",{className:"management-header",children:"Subjects Management"}),h.jsxs("div",{className:"filters-container",children:[h.jsxs("div",{className:"filter-group",children:[h.jsx("label",{children:"Course:"}),h.jsx("select",{value:U.course,onChange:Q=>G("course",Q.target.value),children:R.map(Q=>h.jsx("option",{value:Q,children:Q},Q))})]}),h.jsxs("div",{className:"filter-group",children:[h.jsx("label",{children:"Year Level:"}),h.jsx("select",{value:U.yearLevel,onChange:Q=>G("yearLevel",Q.target.value),children:F.map(Q=>h.jsx("option",{value:Q,children:Q},Q))})]}),h.jsxs("div",{className:"filter-group",children:[h.jsx("label",{children:"Semester:"}),h.jsx("select",{value:U.semester,onChange:Q=>G("semester",Q.target.value),children:P.map(Q=>h.jsx("option",{value:Q,children:Q},Q))})]}),h.jsxs("div",{className:"filter-group",children:[h.jsx("label",{children:"Status:"}),h.jsx("select",{value:U.status,onChange:Q=>G("status",Q.target.value),children:M.map(Q=>h.jsx("option",{value:Q,children:Q},Q))})]})]}),h.jsxs("div",{className:"table-controls",children:[h.jsxs("div",{className:"left-controls",children:[h.jsxs("div",{className:"search-bar",children:[h.jsx(Im,{className:"search-icon"}),h.jsx("input",{type:"text",placeholder:"Search subjects...",value:l,onChange:Q=>{u(Q.target.value),m(1)}})]}),h.jsxs("button",{className:"add-btn",onClick:()=>S(!0),children:[h.jsx(dx,{})," Add Subject"]})]}),h.jsxs("div",{className:"right-controls",children:[h.jsxs("div",{className:"items-per-page",children:[h.jsx("span",{children:"Show:"}),h.jsx("select",{value:g,onChange:Q=>{y(Number(Q.target.value)),m(1)},children:[5,10,20,50].map(Q=>h.jsx("option",{value:Q,children:Q},Q))}),h.jsx("span",{children:"entries"})]}),h.jsxs("div",{className:"export-buttons",children:[h.jsxs(Om,{data:me,filename:"subjects-list.csv",className:"export-btn",children:[h.jsx(H0,{})," Excel"]}),h.jsxs("button",{className:"export-btn",children:[h.jsx(hx,{})," PDF"]}),h.jsxs("button",{className:"export-btn",children:[h.jsx(km,{})," Print"]})]})]})]}),h.jsx("div",{className:"subjects-table",children:h.jsxs("table",{children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsxs("th",{onClick:()=>Ne("subjectId"),children:["Subject ID ",X("subjectId")]}),h.jsxs("th",{onClick:()=>Ne("subjectName"),children:["Subject Name ",X("subjectName")]}),h.jsxs("th",{onClick:()=>Ne("course"),children:["Course ",X("course")]}),h.jsxs("th",{onClick:()=>Ne("yearLevel"),children:["Year Level ",X("yearLevel")]}),h.jsxs("th",{onClick:()=>Ne("semester"),children:["Semester ",X("semester")]}),h.jsxs("th",{onClick:()=>Ne("status"),children:["Status ",X("status")]}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:ee.length>0?ee.map(Q=>h.jsxs("tr",{children:[h.jsx("td",{children:Q.subjectId}),h.jsx("td",{children:Q.subjectName}),h.jsx("td",{children:Q.course}),h.jsx("td",{children:Q.yearLevel}),h.jsx("td",{children:Q.semester}),h.jsx("td",{children:h.jsx("span",{className:`status-badge ${Q.status.toLowerCase()}`,children:Q.status})}),h.jsx("td",{children:h.jsxs("div",{className:"action-buttons",children:[h.jsx("button",{className:"view-btn",title:"View",onClick:()=>{O(Q),A(!0)},children:h.jsx(fx,{})}),h.jsx("button",{className:"edit-btn",title:"Edit",onClick:()=>{V(Q),C(!0)},children:h.jsx(Rm,{})}),h.jsx("button",{className:"delete-btn",title:"Delete",children:h.jsx(Dm,{})})]})})]},Q.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"7",className:"no-data",children:t.length===0?"No subjects found in database":"No subjects match your criteria"})})})]})}),ue>1&&h.jsxs("div",{className:"pagination-controls",children:[h.jsxs("div",{className:"pagination-info",children:["Showing ",oe+1," to ",Math.min(Pe,me.length)," of ",me.length," entries"]}),h.jsxs("div",{className:"pagination-buttons",children:[h.jsx("button",{onClick:()=>z(1),disabled:d===1,className:"pagination-btn",children:"First"}),h.jsx("button",{onClick:()=>z(Math.max(1,d-1)),disabled:d===1,className:"pagination-btn",children:"Previous"}),Array.from({length:Math.min(5,ue)}).map((Q,ye)=>{let Ee;return ue<=5||d<=3?Ee=ye+1:d>=ue-2?Ee=ue-4+ye:Ee=d-2+ye,h.jsx("button",{onClick:()=>z(Ee),className:`pagination-btn ${d===Ee?"active":""}`,children:Ee},Ee)}),h.jsx("button",{onClick:()=>z(Math.min(ue,d+1)),disabled:d===ue,className:"pagination-btn",children:"Next"}),h.jsx("button",{onClick:()=>z(ue),disabled:d===ue,className:"pagination-btn",children:"Last"})]})]})]}),h.jsx(_q,{show:E,onClose:()=>S(!1),onAddSubject:K}),h.jsx(jq,{show:L,onClose:()=>A(!1),subject:b}),h.jsx(Zq,{show:H,onClose:()=>C(!1),subject:D,onUpdateSubject:N})]})},t$=()=>{const[t,e]=ne.useState([]),[r,n]=ne.useState([]),[a,o]=ne.useState(!0),[l,u]=ne.useState(!1),[d,m]=ne.useState(null),[g,y]=ne.useState(""),[_,T]=ne.useState({studentId:"",amount:"",paymentType:"tuition",paymentMethod:"cash",description:"",status:"pending",dueDate:"",paymentDate:""});ne.useEffect(()=>{E(),S()},[]);const E=async()=>{try{const D=Ya(mn(Ut,"payments"),Ug("paymentDate","desc")),H=(await Qa(D)).docs.map(C=>({id:C.id,...C.data()}));e(H),o(!1)}catch(D){console.error("Error fetching payments:",D),o(!1)}},S=async()=>{try{const V=(await Qa(mn(Ut,"students"))).docs.map(H=>({id:H.id,...H.data()}));n(V)}catch(D){console.error("Error fetching students:",D)}},b=async D=>{D.preventDefault();try{const V={..._,paymentDate:_.paymentDate||new Date().toISOString().split("T")[0],amount:parseFloat(_.amount)};d?await ul(kn(Ut,"payments",d.id),V):await Nm(mn(Ut,"payments"),V),u(!1),m(null),T({studentId:"",amount:"",paymentType:"tuition",paymentMethod:"cash",description:"",status:"pending",dueDate:"",paymentDate:""}),E()}catch(V){console.error("Error saving payment:",V)}},O=D=>{m(D),T(D),u(!0)},L=async D=>{if(window.confirm("Are you sure you want to delete this payment record?"))try{await $b(kn(Ut,"payments",D)),E()}catch(V){console.error("Error deleting payment:",V)}},A=t.filter(D=>{const V=r.find(C=>C.id===D.studentId);return`${(V==null?void 0:V.firstName)||""} ${(V==null?void 0:V.lastName)||""} ${D.amount} ${D.paymentType} ${D.status}`.toLowerCase().includes(g.toLowerCase())});return a?h.jsx("div",{className:"loading",children:"Loading..."}):h.jsxs("div",{className:"payment-container",children:[h.jsxs("div",{className:"payment-header",children:[h.jsx("h2",{children:"Payment Management"}),h.jsxs("div",{className:"header-actions",children:[h.jsxs("div",{className:"search-box",children:[h.jsx(Im,{className:"search-icon"}),h.jsx("input",{type:"text",placeholder:"Search payments...",value:g,onChange:D=>y(D.target.value)})]}),h.jsxs("button",{className:"add-button",onClick:()=>u(!0),children:[h.jsx(dx,{})," Add Payment"]})]})]}),h.jsx("div",{className:"payments-table-container",children:h.jsxs("table",{className:"payments-table",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Student"}),h.jsx("th",{children:"Amount"}),h.jsx("th",{children:"Type"}),h.jsx("th",{children:"Method"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Due Date"}),h.jsx("th",{children:"Payment Date"}),h.jsx("th",{children:"Actions"})]})}),h.jsx("tbody",{children:A.map(D=>{const V=r.find(H=>H.id===D.studentId);return h.jsxs("tr",{children:[h.jsx("td",{children:V?`${V.firstName} ${V.lastName}`:"N/A"}),h.jsxs("td",{children:["$",D.amount.toFixed(2)]}),h.jsx("td",{children:D.paymentType}),h.jsx("td",{children:D.paymentMethod}),h.jsx("td",{children:h.jsx("span",{className:`status-badge ${D.status}`,children:D.status})}),h.jsx("td",{children:D.dueDate}),h.jsx("td",{children:D.paymentDate}),h.jsx("td",{children:h.jsxs("div",{className:"table-actions",children:[h.jsx("button",{onClick:()=>O(D),className:"edit-button",children:h.jsx(Rm,{})}),h.jsx("button",{onClick:()=>L(D.id),className:"delete-button",children:h.jsx(Dm,{})})]})})]},D.id)})})]})}),l&&h.jsx("div",{className:"modal-overlay",children:h.jsxs("div",{className:"modal-content",children:[h.jsx("h3",{children:d?"Edit Payment":"Add New Payment"}),h.jsxs("form",{onSubmit:b,children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Student"}),h.jsxs("select",{value:_.studentId,onChange:D=>T({..._,studentId:D.target.value}),required:!0,children:[h.jsx("option",{value:"",children:"Select Student"}),r.map(D=>h.jsxs("option",{value:D.id,children:[D.firstName," ",D.lastName]},D.id))]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Amount"}),h.jsx("input",{type:"number",step:"0.01",value:_.amount,onChange:D=>T({..._,amount:D.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Payment Type"}),h.jsxs("select",{value:_.paymentType,onChange:D=>T({..._,paymentType:D.target.value}),required:!0,children:[h.jsx("option",{value:"tuition",children:"Tuition"}),h.jsx("option",{value:"registration",children:"Registration"}),h.jsx("option",{value:"library",children:"Library"}),h.jsx("option",{value:"other",children:"Other"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Payment Method"}),h.jsxs("select",{value:_.paymentMethod,onChange:D=>T({..._,paymentMethod:D.target.value}),required:!0,children:[h.jsx("option",{value:"cash",children:"Cash"}),h.jsx("option",{value:"credit_card",children:"Credit Card"}),h.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),h.jsx("option",{value:"check",children:"Check"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Description"}),h.jsx("textarea",{value:_.description,onChange:D=>T({..._,description:D.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Status"}),h.jsxs("select",{value:_.status,onChange:D=>T({..._,status:D.target.value}),required:!0,children:[h.jsx("option",{value:"pending",children:"Pending"}),h.jsx("option",{value:"completed",children:"Completed"}),h.jsx("option",{value:"failed",children:"Failed"}),h.jsx("option",{value:"refunded",children:"Refunded"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Due Date"}),h.jsx("input",{type:"date",value:_.dueDate,onChange:D=>T({..._,dueDate:D.target.value}),required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{children:"Payment Date"}),h.jsx("input",{type:"date",value:_.paymentDate,onChange:D=>T({..._,paymentDate:D.target.value}),required:!0})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"submit",className:"save-button",children:d?"Update":"Save"}),h.jsx("button",{type:"button",className:"cancel-button",onClick:()=>{u(!1),m(null),T({studentId:"",amount:"",paymentType:"tuition",paymentMethod:"cash",description:"",status:"pending",dueDate:"",paymentDate:""})},children:"Cancel"})]})]})]})})]})},r$=()=>h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:"Grading System"}),n$=()=>h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:"Attendance"}),a$=()=>h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:"Announcement"}),s$=()=>h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)"},children:"Permission"}),Ga=({children:t,requiredPermissions:e=[]})=>{const{currentUser:r,userData:n,loading:a,hasPermission:o}=ux();if(a)return h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",zIndex:1e3},children:h.jsx("div",{style:{width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite"}})});if(!r)return h.jsx(mg,{to:"/",replace:!0});const l=e.every(u=>o(u));return e.length>0&&!l?h.jsx(mg,{to:"/dashboard",replace:!0}):t};function i$(){return h.jsx(Jb,{children:h.jsx(G6,{children:h.jsxs(y6,{children:[h.jsx(Zn,{path:"/",element:h.jsx(lj,{})}),h.jsxs(Zn,{path:"/dashboard/*",element:h.jsx(Ga,{children:h.jsx(hj,{})}),children:[h.jsx(Zn,{path:"account-user-settings",element:h.jsx(Ga,{requiredPermissions:["accountSettings"],children:h.jsx(Lj,{})})}),h.jsx(Zn,{path:"manage-student",element:h.jsx(Ga,{requiredPermissions:["manageStudent"],children:h.jsx(QG,{})})}),h.jsx(Zn,{path:"department",element:h.jsx(Ga,{requiredPermissions:["department"],children:h.jsx(JG,{})})}),h.jsx(Zn,{path:"course",element:h.jsx(Ga,{requiredPermissions:["course"],children:h.jsx(ZG,{})})}),h.jsx(Zn,{path:"subjects",element:h.jsx(Ga,{requiredPermissions:["subjects"],children:h.jsx(e$,{})})}),h.jsx(Zn,{path:"payment",element:h.jsx(Ga,{requiredPermissions:["payment"],children:h.jsx(t$,{})})}),h.jsx(Zn,{path:"grading-system",element:h.jsx(Ga,{requiredPermissions:["gradingSystem"],children:h.jsx(r$,{})})}),h.jsx(Zn,{path:"attendance",element:h.jsx(Ga,{requiredPermissions:["attendance"],children:h.jsx(n$,{})})}),h.jsx(Zn,{path:"announcement",element:h.jsx(Ga,{requiredPermissions:["announcement"],children:h.jsx(a$,{})})}),h.jsx(Zn,{path:"permission",element:h.jsx(Ga,{requiredPermissions:["accountPermission"],children:h.jsx(s$,{})})})]}),h.jsx(Zn,{path:"*",element:h.jsx(mg,{to:"/",replace:!0})})]})})})}CN.createRoot(document.getElementById("root")).render(h.jsx(ne.StrictMode,{children:h.jsx(Jb,{children:h.jsx(i$,{})})}));
